[0m11:52:07.664951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264BB5B4D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264BAA90EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264BB5B4770>]}


============================== 11:52:07.681392 | 3c7893e7-ee8c-431b-a525-59a1922b760a ==============================
[0m11:52:07.681392 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:52:07.682391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:07.683392 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Development\IntegrityDBT\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:52:07.684391 [debug] [MainThread]: Command `dbt deps` failed at 11:52:07.683392 after 0.15 seconds
[0m11:52:07.684391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264BAA31A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B88D0E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B8D50E90>]}
[0m11:52:07.684391 [debug] [MainThread]: Flushing usage events
[0m12:22:49.625591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDA73E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDA1EEF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDA73D3D0>]}


============================== 12:22:49.628594 | b3ca3c45-07ca-4766-aa99-7bd65e06973e ==============================
[0m12:22:49.628594 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:22:49.629495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init integrity-dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:49.654733 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': WindowsPath('C:/Users/seanm/.dbt')}
[0m12:22:49.655732 [info ] [MainThread]: Creating dbt configuration folder at 
[0m12:23:13.819438 [debug] [MainThread]: Starter project path: C:\Development\IntegrityDBT\IntegrityDBT\Lib\site-packages\dbt\include\starter_project
[0m12:23:13.878326 [info ] [MainThread]: 
Your new dbt project "integrity_energy_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m12:23:13.880349 [info ] [MainThread]: Setting up your profile.
[0m12:23:33.953543 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m12:23:33.954571 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m12:27:05.591796 [info ] [MainThread]: Profile integrity_energy_dbt written to C:\Users\seanm\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:27:05.595806 [debug] [MainThread]: Command `dbt init` succeeded at 12:27:05.594808 after 256.10 seconds
[0m12:27:05.596806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD9C49640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDA2DDDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDB12C350>]}
[0m12:27:05.597791 [debug] [MainThread]: Flushing usage events
[0m12:27:19.561940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E8AF9E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E8A848A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E8A8AEF00>]}


============================== 12:27:19.564985 | 1e21d245-7767-496f-8a21-704b55f424f2 ==============================
[0m12:27:19.564985 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:27:19.564985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:19.588139 [info ] [MainThread]: dbt version: 1.8.3
[0m12:27:19.589138 [info ] [MainThread]: python version: 3.12.4
[0m12:27:19.589138 [info ] [MainThread]: python path: C:\Development\IntegrityDBT\IntegrityDBT\Scripts\python.exe
[0m12:27:19.590138 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:27:19.685186 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m12:27:19.686150 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m12:27:19.718573 [info ] [MainThread]: Using profiles dir at C:\Users\seanm\.dbt
[0m12:27:19.718573 [info ] [MainThread]: Using profiles.yml file at C:\Users\seanm\.dbt\profiles.yml
[0m12:27:19.719559 [info ] [MainThread]: Using dbt_project.yml file at C:\Development\IntegrityDBT\dbt_project.yml
[0m12:27:19.720557 [info ] [MainThread]: adapter type: redshift
[0m12:27:19.720557 [info ] [MainThread]: adapter version: 1.8.1
[0m12:27:19.720557 [info ] [MainThread]: Configuration:
[0m12:27:19.720557 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:27:19.721557 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:27:19.721557 [info ] [MainThread]: Required dependencies:
[0m12:27:19.722558 [debug] [MainThread]: Executing "git --help"
[0m12:27:19.745558 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:27:19.745558 [debug] [MainThread]: STDERR: "b''"
[0m12:27:19.746557 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:27:19.746557 [info ] [MainThread]: Connection:
[0m12:27:19.746557 [info ] [MainThread]:   host: integrity-energy.cm7f5da54gqs.us-east-1.redshift.amazonaws.com
[0m12:27:19.747557 [info ] [MainThread]:   user: integrityadmin
[0m12:27:19.747557 [info ] [MainThread]:   port: 5439
[0m12:27:19.747557 [info ] [MainThread]:   database: integrity-db
[0m12:27:19.747557 [info ] [MainThread]:   method: database
[0m12:27:19.748557 [info ] [MainThread]:   cluster_id: None
[0m12:27:19.748557 [info ] [MainThread]:   iam_profile: None
[0m12:27:19.748557 [info ] [MainThread]:   schema: dbt
[0m12:27:19.749557 [info ] [MainThread]:   sslmode: prefer
[0m12:27:19.749557 [info ] [MainThread]:   region: None
[0m12:27:19.750557 [info ] [MainThread]:   sslmode: prefer
[0m12:27:19.750557 [info ] [MainThread]:   region: None
[0m12:27:19.751557 [info ] [MainThread]:   iam_profile: None
[0m12:27:19.751557 [info ] [MainThread]:   autocreate: False
[0m12:27:19.751557 [info ] [MainThread]:   db_groups: []
[0m12:27:19.751557 [info ] [MainThread]:   ra3_node: False
[0m12:27:19.752557 [info ] [MainThread]:   connect_timeout: None
[0m12:27:19.752557 [info ] [MainThread]:   role: None
[0m12:27:19.753557 [info ] [MainThread]:   retries: 1
[0m12:27:19.753557 [info ] [MainThread]:   autocommit: True
[0m12:27:19.754574 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m12:27:19.756572 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m12:27:19.759555 [debug] [MainThread]: Using redshift connection "debug"
[0m12:27:19.759555 [debug] [MainThread]: On debug: select 1 as id
[0m12:27:19.760558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:19.762556 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m12:27:19.763560 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m12:27:20.662187 [debug] [MainThread]: SQL status: SUCCESS in 0.901 seconds
[0m12:27:20.664184 [debug] [MainThread]: On debug: Close
[0m12:27:20.665187 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:27:20.667197 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:27:20.668198 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Development\IntegrityDBT\dbt_project.yml> not found

[0m12:27:20.669197 [debug] [MainThread]: Command `dbt debug` failed at 12:27:20.669197 after 1.26 seconds
[0m12:27:20.669197 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:27:20.670196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E8A848A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E851B2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E8AF9ED20>]}
[0m12:27:20.670196 [debug] [MainThread]: Flushing usage events
[0m12:29:38.988853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E247073B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E21080740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E247AFEC0>]}


============================== 12:29:38.991854 | 6803e6da-139b-47ea-99ae-bd8b85bb697a ==============================
[0m12:29:38.991854 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:29:38.991854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:39.004256 [info ] [MainThread]: dbt version: 1.8.3
[0m12:29:39.005242 [info ] [MainThread]: python version: 3.12.4
[0m12:29:39.005242 [info ] [MainThread]: python path: C:\Development\IntegrityDBT\IntegrityDBT\Scripts\python.exe
[0m12:29:39.005242 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:29:39.094204 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m12:29:39.094204 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m12:29:39.126035 [info ] [MainThread]: Using profiles dir at C:\Users\seanm\.dbt
[0m12:29:39.127322 [info ] [MainThread]: Using profiles.yml file at C:\Users\seanm\.dbt\profiles.yml
[0m12:29:39.127322 [info ] [MainThread]: Using dbt_project.yml file at C:\Development\IntegrityDBT\dbt_project.yml
[0m12:29:39.128975 [info ] [MainThread]: adapter type: redshift
[0m12:29:39.128975 [info ] [MainThread]: adapter version: 1.8.1
[0m12:29:39.179622 [info ] [MainThread]: Configuration:
[0m12:29:39.180621 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:29:39.181621 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:29:39.181621 [info ] [MainThread]: Required dependencies:
[0m12:29:39.182621 [debug] [MainThread]: Executing "git --help"
[0m12:29:39.203524 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:29:39.203524 [debug] [MainThread]: STDERR: "b''"
[0m12:29:39.203524 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:29:39.203524 [info ] [MainThread]: Connection:
[0m12:29:39.204978 [info ] [MainThread]:   host: integrity-energy.cm7f5da54gqs.us-east-1.redshift.amazonaws.com
[0m12:29:39.205432 [info ] [MainThread]:   user: integrityadmin
[0m12:29:39.205432 [info ] [MainThread]:   port: 5439
[0m12:29:39.205432 [info ] [MainThread]:   database: integrity-db
[0m12:29:39.206491 [info ] [MainThread]:   method: database
[0m12:29:39.206491 [info ] [MainThread]:   cluster_id: None
[0m12:29:39.206491 [info ] [MainThread]:   iam_profile: None
[0m12:29:39.207448 [info ] [MainThread]:   schema: dbt
[0m12:29:39.207448 [info ] [MainThread]:   sslmode: prefer
[0m12:29:39.207448 [info ] [MainThread]:   region: None
[0m12:29:39.208444 [info ] [MainThread]:   sslmode: prefer
[0m12:29:39.208444 [info ] [MainThread]:   region: None
[0m12:29:39.208444 [info ] [MainThread]:   iam_profile: None
[0m12:29:39.208444 [info ] [MainThread]:   autocreate: False
[0m12:29:39.209444 [info ] [MainThread]:   db_groups: []
[0m12:29:39.209444 [info ] [MainThread]:   ra3_node: False
[0m12:29:39.209444 [info ] [MainThread]:   connect_timeout: None
[0m12:29:39.209444 [info ] [MainThread]:   role: None
[0m12:29:39.210447 [info ] [MainThread]:   retries: 1
[0m12:29:39.210447 [info ] [MainThread]:   autocommit: True
[0m12:29:39.210447 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m12:29:39.211802 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m12:29:39.213814 [debug] [MainThread]: Using redshift connection "debug"
[0m12:29:39.214807 [debug] [MainThread]: On debug: select 1 as id
[0m12:29:39.214807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:39.217825 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m12:29:39.217825 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m12:29:39.812430 [debug] [MainThread]: SQL status: SUCCESS in 0.597 seconds
[0m12:29:39.815457 [debug] [MainThread]: On debug: Close
[0m12:29:39.817452 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:29:39.820448 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:29:39.822445 [debug] [MainThread]: Command `dbt debug` succeeded at 12:29:39.822445 after 0.97 seconds
[0m12:29:39.823444 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:29:39.823444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E247073B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E23D3CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E2478DF10>]}
[0m12:29:39.823444 [debug] [MainThread]: Flushing usage events
[0m12:30:51.479449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C504B6D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C504B6D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C504B6F200>]}


============================== 12:30:51.483500 | 10004e23-ff32-467c-af0b-8c5f715a8279 ==============================
[0m12:30:51.483500 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:30:51.484465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:30:51.548170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10004e23-ff32-467c-af0b-8c5f715a8279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C505236ED0>]}
[0m12:30:51.565962 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:30:51.566981 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:30:51.567964 [debug] [MainThread]: Command `dbt deps` succeeded at 12:30:51.567964 after 0.22 seconds
[0m12:30:51.568963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C505444620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C505236ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5052DC650>]}
[0m12:30:51.568963 [debug] [MainThread]: Flushing usage events
[0m12:32:08.381075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D19A9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D43D5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D43D4770>]}


============================== 12:32:08.385082 | bcf1d904-d70d-47ed-a51a-c70ed950e74e ==============================
[0m12:32:08.385082 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:32:08.385082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:32:08.449449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcf1d904-d70d-47ed-a51a-c70ed950e74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D43D47A0>]}
[0m12:32:08.465812 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:32:08.466812 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:32:08.467812 [debug] [MainThread]: Command `dbt deps` succeeded at 12:32:08.467812 after 0.17 seconds
[0m12:32:08.467812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D1E5A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D43D46E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D43D4D40>]}
[0m12:32:08.468811 [debug] [MainThread]: Flushing usage events
[0m12:32:27.901176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954D1FFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954D802F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954D60E210>]}


============================== 12:32:27.904713 | 4c73659e-558d-4aae-929b-9a4299311920 ==============================
[0m12:32:27.904713 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:32:27.904713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:32:27.998646 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m12:32:27.998646 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m12:32:28.091307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c73659e-558d-4aae-929b-9a4299311920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954E4877A0>]}
[0m12:32:28.125308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c73659e-558d-4aae-929b-9a4299311920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954CB545C0>]}
[0m12:32:28.126177 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m12:32:28.158561 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:32:28.159519 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:32:28.159519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c73659e-558d-4aae-929b-9a4299311920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954D96BFE0>]}
[0m12:32:29.731828 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.example
[0m12:32:29.734893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c73659e-558d-4aae-929b-9a4299311920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954E3EB9E0>]}
[0m12:32:29.782854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c73659e-558d-4aae-929b-9a4299311920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954F64A960>]}
[0m12:32:29.782854 [info ] [MainThread]: Found 481 macros
[0m12:32:29.783855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c73659e-558d-4aae-929b-9a4299311920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954F62D730>]}
[0m12:32:29.784854 [info ] [MainThread]: 
[0m12:32:29.784854 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:32:29.785885 [debug] [MainThread]: Command end result
[0m12:32:29.799248 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:29.799248 after 1.98 seconds
[0m12:32:29.799248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954E515760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954D683980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002954D683740>]}
[0m12:32:29.800255 [debug] [MainThread]: Flushing usage events
[0m12:58:38.036492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029386FD1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293846E48C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293871A6CC0>]}


============================== 12:58:38.039613 | a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1 ==============================
[0m12:58:38.039613 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:58:38.040630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:38.136978 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m12:58:38.137985 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m12:58:38.227769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029387D26C90>]}
[0m12:58:38.259842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029387CE8920>]}
[0m12:58:38.261321 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m12:58:38.268326 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:58:38.320055 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:58:38.321039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029386ADDDC0>]}
[0m12:58:38.769313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m12:58:38.774535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388FDBFE0>]}
[0m12:58:38.806324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029387C34920>]}
[0m12:58:38.806324 [info ] [MainThread]: Found 481 macros
[0m12:58:38.807324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3abd43e-ea84-4ac9-b700-bfa2c84ff6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029387E660F0>]}
[0m12:58:38.808354 [info ] [MainThread]: 
[0m12:58:38.808354 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:58:38.809325 [debug] [MainThread]: Command end result
[0m12:58:38.861379 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:38.861379 after 0.99 seconds
[0m12:58:38.861379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938645BE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293870E3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293870E1E80>]}
[0m12:58:38.862436 [debug] [MainThread]: Flushing usage events
[0m13:00:15.105813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62E44C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E631CA88F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E631CABF20>]}


============================== 13:00:15.109836 | 7969cc69-81c4-463f-b537-f32ce9856145 ==============================
[0m13:00:15.109836 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:00:15.110813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:15.173880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7969cc69-81c4-463f-b537-f32ce9856145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62F89A660>]}
[0m13:00:15.201812 [debug] [MainThread]: Command `dbt clean` succeeded at 13:00:15.201812 after 0.24 seconds
[0m13:00:15.202863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E631594500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E631ABCBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6312CFBC0>]}
[0m13:00:15.202863 [debug] [MainThread]: Flushing usage events
[0m13:00:20.568628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A7F3E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A7F3FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A7F3E930>]}


============================== 13:00:20.573932 | 93c4ee74-42c4-443c-8438-7df56e851055 ==============================
[0m13:00:20.573932 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:00:20.574930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:20.641467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c4ee74-42c4-443c-8438-7df56e851055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A87353D0>]}
[0m13:00:20.659228 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:00:20.660228 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:00:20.661228 [debug] [MainThread]: Command `dbt deps` succeeded at 13:00:20.661228 after 0.20 seconds
[0m13:00:20.662228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A86A88F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A86F51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294A88F56A0>]}
[0m13:00:20.662228 [debug] [MainThread]: Flushing usage events
[0m13:02:47.447664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536116CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536116DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536116C140>]}


============================== 13:02:47.450797 | e9dc0d75-1612-429e-b4f7-c76c140618ea ==============================
[0m13:02:47.450797 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:02:47.451809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:02:47.517452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9dc0d75-1612-429e-b4f7-c76c140618ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002535EF4A630>]}
[0m13:02:47.534986 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-coat6vhw'
[0m13:02:47.534986 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:02:47.680472 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:02:47.682471 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:02:47.751924 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:02:47.763967 [info ] [MainThread]: Updating lock file in file path: C:\Development\IntegrityDBT/package-lock.yml
[0m13:02:47.771238 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-cxqf3oiu'
[0m13:02:47.773277 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:02:48.111153 [info ] [MainThread]: Installed from version 1.0.0
[0m13:02:48.112153 [info ] [MainThread]: Updated version available: 1.2.0
[0m13:02:48.112153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e9dc0d75-1612-429e-b4f7-c76c140618ea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253617134A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025361731490>]}
[0m13:02:48.112153 [info ] [MainThread]: 
[0m13:02:48.113158 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:02:48.114154 [debug] [MainThread]: Command `dbt deps` succeeded at 13:02:48.114154 after 0.83 seconds
[0m13:02:48.115154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025360799A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253614C0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253614C07A0>]}
[0m13:02:48.115154 [debug] [MainThread]: Flushing usage events
[0m13:03:11.967064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8476C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86B61B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86B63770>]}


============================== 13:03:11.971082 | b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53 ==============================
[0m13:03:11.971082 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:03:11.972065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:03:12.068950 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:03:12.068950 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:03:12.167654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C872ABE30>]}
[0m13:03:12.201600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87446D20>]}
[0m13:03:12.202585 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:03:12.225365 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:03:12.226359 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:03:12.227319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87E7F770>]}
[0m13:03:13.347012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:03:13.390660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87E7DAF0>]}
[0m13:03:13.425432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87DA96A0>]}
[0m13:03:13.425432 [info ] [MainThread]: Found 593 macros
[0m13:03:13.426432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b98680ca-96f5-4ab8-ba8a-ddcfb4cd7d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87ED5850>]}
[0m13:03:13.427432 [info ] [MainThread]: 
[0m13:03:13.427432 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:03:13.427432 [debug] [MainThread]: Command end result
[0m13:03:13.443432 [debug] [MainThread]: Command `dbt run` succeeded at 13:03:13.443432 after 1.57 seconds
[0m13:03:13.443432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87334B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86FF0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86FF30E0>]}
[0m13:03:13.443432 [debug] [MainThread]: Flushing usage events
[0m13:12:20.002478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CA67BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C9800C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CA67B410>]}


============================== 13:12:20.005525 | f4884eaa-cc66-49fb-82fb-0ede15912f76 ==============================
[0m13:12:20.005525 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:12:20.005525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:12:20.070576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4884eaa-cc66-49fb-82fb-0ede15912f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CA3FE030>]}
[0m13:12:20.089619 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-2x13vub9'
[0m13:12:20.090619 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:12:20.222300 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:12:20.224250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:12:20.296599 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:12:20.305595 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m13:12:20.459952 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m13:12:20.465950 [info ] [MainThread]: Updating lock file in file path: C:\Development\IntegrityDBT/package-lock.yml
[0m13:12:20.490953 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-roifyo89'
[0m13:12:20.493456 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:12:20.812174 [info ] [MainThread]: Installed from version 1.0.0
[0m13:12:20.813175 [info ] [MainThread]: Updated version available: 1.2.0
[0m13:12:20.814176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4884eaa-cc66-49fb-82fb-0ede15912f76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C9F0F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CA99F7A0>]}
[0m13:12:20.814176 [info ] [MainThread]: Installing dbt-labs/redshift
[0m13:12:21.084456 [info ] [MainThread]: Installed from version 0.9.0
[0m13:12:21.085887 [info ] [MainThread]: Up to date!
[0m13:12:21.085887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4884eaa-cc66-49fb-82fb-0ede15912f76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C9832F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C98323F0>]}
[0m13:12:21.085887 [info ] [MainThread]: 
[0m13:12:21.087189 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:12:21.089203 [debug] [MainThread]: Command `dbt deps` succeeded at 13:12:21.088198 after 1.22 seconds
[0m13:12:21.089203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1C9E967E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CA6C5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CA2D28A0>]}
[0m13:12:21.089203 [debug] [MainThread]: Flushing usage events
[0m13:13:01.901624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C9FB73B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C98EEA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C98EEAE0>]}


============================== 13:13:01.904620 | 7a208382-5ad6-4067-9dbc-7b40207a0dad ==============================
[0m13:13:01.904620 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:13:01.905614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:01.999973 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:13:02.000957 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:13:02.095535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CA05BB60>]}
[0m13:13:02.129842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CAADAB10>]}
[0m13:13:02.130857 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:13:02.163794 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:13:02.207794 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:13:02.208799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBD98C50>]}
[0m13:13:03.344370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:13:03.348717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBEC08C0>]}
[0m13:13:03.394972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CABA97F0>]}
[0m13:13:03.394972 [info ] [MainThread]: Found 24 models, 615 macros
[0m13:13:03.395968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C98B09B0>]}
[0m13:13:03.396970 [info ] [MainThread]: 
[0m13:13:03.397987 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:13:03.400970 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m13:13:03.412061 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m13:13:03.412061 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m13:13:03.412991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:03.415012 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:03.415970 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:04.188056 [debug] [ThreadPool]: SQL status: SUCCESS in 0.775 seconds
[0m13:13:04.192131 [debug] [ThreadPool]: On list_integrity-db: Close
[0m13:13:04.198106 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m13:13:04.209119 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:13:04.209119 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m13:13:04.210120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:04.210120 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:04.210120 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:04.640902 [debug] [ThreadPool]: SQL status: SUCCESS in 0.431 seconds
[0m13:13:04.642885 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:13:04.643883 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m13:13:04.749953 [debug] [ThreadPool]: SQL status: SUCCESS in 0.105 seconds
[0m13:13:04.752986 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m13:13:04.831571 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m13:13:04.843571 [debug] [MainThread]: Using redshift connection "master"
[0m13:13:04.844575 [debug] [MainThread]: On master: BEGIN
[0m13:13:04.844575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:04.845576 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:04.845576 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:05.258006 [debug] [MainThread]: SQL status: SUCCESS in 0.413 seconds
[0m13:13:05.259003 [debug] [MainThread]: Using redshift connection "master"
[0m13:13:05.260136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:13:05.389309 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m13:13:05.393333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CAAA8350>]}
[0m13:13:05.394337 [debug] [MainThread]: On master: ROLLBACK
[0m13:13:05.467672 [debug] [MainThread]: Using redshift connection "master"
[0m13:13:05.468668 [debug] [MainThread]: On master: BEGIN
[0m13:13:05.505670 [debug] [MainThread]: SQL status: SUCCESS in 0.036 seconds
[0m13:13:05.506717 [debug] [MainThread]: On master: COMMIT
[0m13:13:05.507714 [debug] [MainThread]: Using redshift connection "master"
[0m13:13:05.508678 [debug] [MainThread]: On master: COMMIT
[0m13:13:05.585922 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m13:13:05.587946 [debug] [MainThread]: On master: Close
[0m13:13:05.588928 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:13:05.590091 [info ] [MainThread]: 
[0m13:13:05.623202 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m13:13:05.623202 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m13:13:05.624219 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m13:13:05.624219 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m13:13:05.624219 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m13:13:05.625202 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m13:13:05.625202 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m13:13:05.625202 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m13:13:05.625202 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m13:13:05.625202 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m13:13:05.626202 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m13:13:05.626202 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m13:13:05.626202 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m13:13:05.627202 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m13:13:05.628202 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m13:13:05.629226 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m13:13:05.629226 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m13:13:05.630203 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m13:13:05.630203 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m13:13:05.630203 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m13:13:05.630203 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m13:13:05.631202 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m13:13:05.631202 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m13:13:05.631202 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m13:13:05.632203 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m13:13:05.633202 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m13:13:05.634034 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m13:13:05.635057 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m13:13:05.637072 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m13:13:05.638057 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m13:13:05.640057 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m13:13:05.641061 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m13:13:05.643060 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m13:13:05.644062 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m13:13:05.644062 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m13:13:05.646062 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m13:13:05.646062 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m13:13:05.647061 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m13:13:05.647061 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m13:13:05.648062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m13:13:05.648062 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m13:13:05.648062 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m13:13:05.649062 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m13:13:05.649062 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m13:13:05.649062 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m13:13:05.650061 [debug] [Thread-8 (]: Began running node model.redshift.stl_query
[0m13:13:05.650061 [debug] [Thread-7 (]: Began running node model.redshift.stl_wlm_query
[0m13:13:05.650061 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m13:13:05.650061 [debug] [Thread-6 (]: Began running node model.redshift.stv_blocklist
[0m13:13:05.651061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m13:13:05.651061 [debug] [Thread-5 (]: Began running node model.redshift.stv_partitions
[0m13:13:05.651061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m13:13:05.652061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m13:13:05.652061 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_query)
[0m13:13:05.652061 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_wlm_query)
[0m13:13:05.654061 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m13:13:05.654061 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_blocklist)
[0m13:13:05.654061 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m13:13:05.655565 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stv_partitions)
[0m13:13:05.655565 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m13:13:05.655565 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m13:13:05.655565 [debug] [Thread-8 (]: Began compiling node model.redshift.stl_query
[0m13:13:05.656622 [debug] [Thread-7 (]: Began compiling node model.redshift.stl_wlm_query
[0m13:13:05.656622 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_blocklist
[0m13:13:05.656622 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m13:13:05.659005 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m13:13:05.659005 [debug] [Thread-5 (]: Began compiling node model.redshift.stv_partitions
[0m13:13:05.661141 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m13:13:05.662254 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m13:13:05.663329 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m13:13:05.665282 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m13:13:05.666306 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m13:13:05.666306 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m13:13:05.668262 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m13:13:05.668262 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m13:13:05.669577 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m13:13:05.669577 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m13:13:05.670859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m13:13:05.670859 [debug] [Thread-7 (]: Finished running node model.redshift.stl_wlm_query
[0m13:13:05.670859 [debug] [Thread-8 (]: Finished running node model.redshift.stl_query
[0m13:13:05.672284 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m13:13:05.672284 [debug] [Thread-6 (]: Finished running node model.redshift.stv_blocklist
[0m13:13:05.673293 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m13:13:05.673293 [debug] [Thread-5 (]: Finished running node model.redshift.stv_partitions
[0m13:13:05.674366 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m13:13:05.674366 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m13:13:05.675355 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:13:05.675355 [debug] [Thread-8 (]: Began running node model.redshift.redshift_cost
[0m13:13:05.675355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m13:13:05.676367 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m13:13:05.676367 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m13:13:05.677735 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m13:13:05.678742 [info ] [Thread-7 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m13:13:05.678742 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_cost)
[0m13:13:05.679978 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m13:13:05.679978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m13:13:05.680988 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m13:13:05.680988 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m13:13:05.680988 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_cost
[0m13:13:05.682342 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m13:13:05.683392 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m13:13:05.683392 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m13:13:05.684350 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m13:13:05.684350 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m13:13:05.689733 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m13:13:05.695209 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m13:13:05.699610 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:05.700612 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m13:13:05.706612 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:05.708612 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_table_stats
[0m13:13:05.709611 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_cost
[0m13:13:05.709611 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m13:13:05.710611 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m13:13:05.710611 [info ] [Thread-6 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m13:13:05.711749 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m13:13:05.733822 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m13:13:05.736896 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:05.737860 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m13:13:05.738461 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m13:13:05.740509 [debug] [Thread-7 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:05.741516 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m13:13:05.741516 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m13:13:05.755394 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m13:13:05.758554 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:05.759567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m13:13:05.761530 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:05.764625 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:05.765530 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:13:05.765530 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m13:13:05.765530 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m13:13:05.765530 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:13:05.766960 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:13:05.766960 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:13:05.773057 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m13:13:05.775336 [debug] [Thread-6 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m13:13:05.775336 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:05.775336 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:13:05.776258 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:05.776258 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:05.777567 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m13:13:05.777567 [debug] [Thread-7 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:05.785216 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:05.785216 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:05.786150 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:05.788175 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m13:13:05.788175 [debug] [Thread-7 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:05.789118 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:13:05.792403 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:13:05.792403 [debug] [Thread-6 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:05.796707 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:05.796707 [debug] [Thread-6 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:05.798725 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:13:05.802718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:05.804692 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:05.806690 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:06.230434 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.463 seconds
[0m13:13:06.231483 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:06.232488 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m13:13:06.252703 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.450 seconds
[0m13:13:06.254690 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:06.254690 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m13:13:06.265245 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.490 seconds
[0m13:13:06.266241 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:06.266241 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m13:13:06.299286 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.524 seconds
[0m13:13:06.302305 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:06.303305 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.510 seconds
[0m13:13:06.304336 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m13:13:06.305627 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:06.307696 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m13:13:06.422044 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.189 seconds
[0m13:13:06.432506 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:06.432506 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m13:13:06.475662 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.220 seconds
[0m13:13:06.480744 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:06.481659 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m13:13:06.503769 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.236 seconds
[0m13:13:06.507815 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:06.507815 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m13:13:06.525988 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.219 seconds
[0m13:13:06.529984 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:06.530984 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m13:13:06.552847 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.119 seconds
[0m13:13:06.568374 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:13:06.568374 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.260 seconds
[0m13:13:06.569541 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:06.571604 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:06.571604 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m13:13:06.571604 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:13:06.592559 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.111 seconds
[0m13:13:06.594594 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:13:06.594594 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:06.594594 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:13:06.627962 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.120 seconds
[0m13:13:06.631980 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:13:06.632979 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:06.633978 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:13:06.642845 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.111 seconds
[0m13:13:06.645854 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:13:06.646858 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:06.647855 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:13:06.691282 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.118 seconds
[0m13:13:06.694280 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:13:06.695278 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:06.695278 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:13:06.881590 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.308 seconds
[0m13:13:06.884588 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.249 seconds
[0m13:13:06.885585 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.237 seconds
[0m13:13:06.886583 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.291 seconds
[0m13:13:06.888591 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:06.890579 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.195 seconds
[0m13:13:06.892578 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:13:06.966095 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.073 seconds
[0m13:13:06.976084 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m13:13:06.979089 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:06.979089 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m13:13:07.054615 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:13:07.056120 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:13:07.057125 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:07.057125 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:13:07.151159 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.094 seconds
[0m13:13:07.153202 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:13:07.154204 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:13:07.196220 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.041 seconds
[0m13:13:07.200213 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:07.201214 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:13:07.281042 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:13:07.286058 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m13:13:07.288058 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:07.289057 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m13:13:07.367640 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.078 seconds
[0m13:13:07.370630 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:13:07.371632 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:07.372630 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:13:07.487223 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.114 seconds
[0m13:13:07.489186 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:13:07.491181 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:13:07.528894 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.037 seconds
[0m13:13:07.532865 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:07.533862 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:13:07.614582 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:13:07.619576 [debug] [Thread-7 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:13:07.621643 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:07.622667 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m13:13:07.700195 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:13:07.703147 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:13:07.704155 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:07.705589 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:13:07.804337 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.098 seconds
[0m13:13:07.806330 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:13:07.807532 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:13:07.848551 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.040 seconds
[0m13:13:07.850551 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:07.850551 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:13:07.924947 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.073 seconds
[0m13:13:07.929956 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m13:13:07.930909 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:07.931905 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m13:13:08.005414 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m13:13:08.009446 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:13:08.010451 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:08.011403 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:13:08.125060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.112 seconds
[0m13:13:08.127030 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:13:08.128050 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:13:08.163861 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.035 seconds
[0m13:13:08.165859 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:08.166889 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:13:08.248742 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:13:08.252780 [debug] [Thread-6 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m13:13:08.254739 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:08.255693 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m13:13:08.334419 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.078 seconds
[0m13:13:08.337407 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:13:08.338473 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:08.339438 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:13:08.437326 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.096 seconds
[0m13:13:08.439519 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:13:08.440530 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:13:08.487394 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.046 seconds
[0m13:13:08.491388 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m13:13:08.492372 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m13:13:08.493363 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m13:13:08.495358 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m13:13:08.496415 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m13:13:08.570701 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m13:13:08.575669 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CAC3A9F0>]}
[0m13:13:08.579622 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m13:13:08.580621 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: Close
[0m13:13:08.577624 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.89s]
[0m13:13:08.581674 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m13:13:08.583634 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m13:13:08.585621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CC654800>]}
[0m13:13:08.586653 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CC6B7BF0>]}
[0m13:13:08.587622 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m13:13:08.588620 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C7D78AD0>]}
[0m13:13:08.589622 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a208382-5ad6-4067-9dbc-7b40207a0dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4CBC8F7A0>]}
[0m13:13:08.591668 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 2.83s]
[0m13:13:08.592619 [info ] [Thread-6 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.85s]
[0m13:13:08.594619 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.91s]
[0m13:13:08.596617 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m13:13:08.594619 [info ] [Thread-7 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.91s]
[0m13:13:08.597617 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m13:13:08.597617 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m13:13:08.598617 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:13:08.601491 [debug] [MainThread]: Using redshift connection "master"
[0m13:13:08.601491 [debug] [MainThread]: On master: BEGIN
[0m13:13:08.602681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:08.603690 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:13:08.603690 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:13:09.031534 [debug] [MainThread]: SQL status: SUCCESS in 0.429 seconds
[0m13:13:09.032527 [debug] [MainThread]: On master: COMMIT
[0m13:13:09.033528 [debug] [MainThread]: Using redshift connection "master"
[0m13:13:09.034529 [debug] [MainThread]: On master: COMMIT
[0m13:13:09.114754 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m13:13:09.115864 [debug] [MainThread]: On master: Close
[0m13:13:09.116792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:09.116792 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m13:13:09.117795 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m13:13:09.117795 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m13:13:09.117795 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m13:13:09.118792 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m13:13:09.118792 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m13:13:09.118792 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m13:13:09.119797 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m13:13:09.119797 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m13:13:09.120791 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m13:13:09.120791 [info ] [MainThread]: 
[0m13:13:09.122795 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m13:13:09.123794 [debug] [MainThread]: Command end result
[0m13:13:09.147024 [info ] [MainThread]: 
[0m13:13:09.147024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:09.147024 [info ] [MainThread]: 
[0m13:13:09.148524 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:13:09.148524 [debug] [MainThread]: Command `dbt run` succeeded at 13:13:09.148524 after 7.33 seconds
[0m13:13:09.149531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C9CE3A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C99476B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C9946ED0>]}
[0m13:13:09.149531 [debug] [MainThread]: Flushing usage events
[0m13:14:32.528594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4BC468D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4BA99670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4E145D30>]}


============================== 13:14:32.531611 | 002f3bad-e5ae-48d5-a4a4-5ac9c1c5064a ==============================
[0m13:14:32.531611 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:14:32.532593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:14:32.599173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '002f3bad-e5ae-48d5-a4a4-5ac9c1c5064a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4BF4A450>]}
[0m13:14:32.645311 [debug] [MainThread]: Command `dbt clean` succeeded at 13:14:32.645311 after 0.24 seconds
[0m13:14:32.645311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4E2B6C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4E219340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC4E218BF0>]}
[0m13:14:32.646305 [debug] [MainThread]: Flushing usage events
[0m13:14:41.035222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A45E6E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6093CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A60915B0>]}


============================== 13:14:41.039186 | 50853374-63b0-49e9-814d-313310fafe85 ==============================
[0m13:14:41.039186 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:14:41.040311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m13:14:41.108026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50853374-63b0-49e9-814d-313310fafe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A682EF60>]}
[0m13:14:41.128297 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-mkhda_bw'
[0m13:14:41.129298 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:14:41.252904 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:14:41.252904 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:14:41.328461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:14:41.334455 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m13:14:41.473027 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m13:14:41.475035 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:14:41.821269 [info ] [MainThread]: Installed from version 1.0.0
[0m13:14:41.822276 [info ] [MainThread]: Updated version available: 1.2.0
[0m13:14:41.822276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '50853374-63b0-49e9-814d-313310fafe85', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A71270E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A71FE8D0>]}
[0m13:14:41.823276 [info ] [MainThread]: Installing dbt-labs/redshift
[0m13:14:42.090503 [info ] [MainThread]: Installed from version 0.9.0
[0m13:14:42.090503 [info ] [MainThread]: Up to date!
[0m13:14:42.091504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '50853374-63b0-49e9-814d-313310fafe85', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A710F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A710E840>]}
[0m13:14:42.091504 [info ] [MainThread]: 
[0m13:14:42.092503 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:14:42.093509 [debug] [MainThread]: Command `dbt deps` succeeded at 13:14:42.093509 after 1.14 seconds
[0m13:14:42.094504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A45E6E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6B7FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A4ACA2A0>]}
[0m13:14:42.094504 [debug] [MainThread]: Flushing usage events
[0m13:14:50.389824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF26EFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF26EC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF26EE900>]}


============================== 13:14:50.392841 | cd50ef34-bf89-419f-bee6-0f57727c6e8b ==============================
[0m13:14:50.392841 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:14:50.393824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:50.489420 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:14:50.489420 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:14:50.583125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF31F43B0>]}
[0m13:14:50.616086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF1FFB0B0>]}
[0m13:14:50.617459 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:14:50.643597 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:14:50.644599 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:14:50.645597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF326C9E0>]}
[0m13:14:51.574765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:14:51.578764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF42E5EB0>]}
[0m13:14:51.632668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF43F3DD0>]}
[0m13:14:51.632668 [info ] [MainThread]: Found 24 models, 615 macros
[0m13:14:51.634067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF43553A0>]}
[0m13:14:51.635103 [info ] [MainThread]: 
[0m13:14:51.636073 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:14:51.639074 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m13:14:51.648109 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m13:14:51.649111 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m13:14:51.649111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:51.651109 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:51.652180 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:52.234669 [debug] [ThreadPool]: SQL status: SUCCESS in 0.585 seconds
[0m13:14:52.236667 [debug] [ThreadPool]: On list_integrity-db: Close
[0m13:14:52.239289 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m13:14:52.245296 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:14:52.246298 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m13:14:52.246298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:52.246298 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:52.247297 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:52.640738 [debug] [ThreadPool]: SQL status: SUCCESS in 0.394 seconds
[0m13:14:52.641724 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:14:52.642732 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m13:14:52.755998 [debug] [ThreadPool]: SQL status: SUCCESS in 0.111 seconds
[0m13:14:52.760954 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m13:14:52.833364 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m13:14:52.849356 [debug] [MainThread]: Using redshift connection "master"
[0m13:14:52.849356 [debug] [MainThread]: On master: BEGIN
[0m13:14:52.849356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:52.850351 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:52.850351 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:53.281103 [debug] [MainThread]: SQL status: SUCCESS in 0.431 seconds
[0m13:14:53.281103 [debug] [MainThread]: Using redshift connection "master"
[0m13:14:53.282153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:14:53.416028 [debug] [MainThread]: SQL status: SUCCESS in 0.133 seconds
[0m13:14:53.418803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF32C5A30>]}
[0m13:14:53.419834 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:53.502046 [debug] [MainThread]: Using redshift connection "master"
[0m13:14:53.504045 [debug] [MainThread]: On master: BEGIN
[0m13:14:53.543753 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m13:14:53.544751 [debug] [MainThread]: On master: COMMIT
[0m13:14:53.545748 [debug] [MainThread]: Using redshift connection "master"
[0m13:14:53.546747 [debug] [MainThread]: On master: COMMIT
[0m13:14:53.627269 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m13:14:53.628528 [debug] [MainThread]: On master: Close
[0m13:14:53.630550 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:14:53.632547 [info ] [MainThread]: 
[0m13:14:53.640539 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m13:14:53.641559 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m13:14:53.641559 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m13:14:53.645539 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m13:14:53.642540 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m13:14:53.643538 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m13:14:53.643538 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m13:14:53.644537 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m13:14:53.644537 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m13:14:53.645539 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m13:14:53.642540 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m13:14:53.645539 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m13:14:53.646538 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m13:14:53.646538 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m13:14:53.647538 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m13:14:53.647538 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m13:14:53.648537 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m13:14:53.648537 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m13:14:53.648537 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m13:14:53.650556 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m13:14:53.650556 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m13:14:53.652546 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m13:14:53.653569 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m13:14:53.653569 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m13:14:53.653569 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m13:14:53.654907 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m13:14:53.654907 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m13:14:53.656416 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m13:14:53.658424 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m13:14:53.658424 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m13:14:53.659841 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m13:14:53.661355 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m13:14:53.662219 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m13:14:53.663242 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m13:14:53.663242 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m13:14:53.664241 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m13:14:53.665240 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m13:14:53.665240 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m13:14:53.666240 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m13:14:53.666240 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m13:14:53.667241 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m13:14:53.667241 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m13:14:53.668245 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m13:14:53.668245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m13:14:53.669245 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m13:14:53.669245 [debug] [Thread-7 (]: Began running node model.redshift.stl_query
[0m13:14:53.669245 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m13:14:53.670246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_sort_dist_keys)
[0m13:14:53.671245 [debug] [Thread-8 (]: Began running node model.redshift.stv_blocklist
[0m13:14:53.671245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_tables)
[0m13:14:53.671245 [debug] [Thread-5 (]: Began running node model.redshift.stv_partitions
[0m13:14:53.672245 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m13:14:53.672245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m13:14:53.673245 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_query)
[0m13:14:53.673245 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m13:14:53.673245 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m13:14:53.674245 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_blocklist)
[0m13:14:53.674245 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m13:14:53.674245 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stv_partitions)
[0m13:14:53.676245 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m13:14:53.676987 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m13:14:53.676987 [debug] [Thread-7 (]: Began compiling node model.redshift.stl_query
[0m13:14:53.676987 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m13:14:53.679009 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m13:14:53.679009 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_blocklist
[0m13:14:53.681032 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m13:14:53.681032 [debug] [Thread-5 (]: Began compiling node model.redshift.stv_partitions
[0m13:14:53.683542 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m13:14:53.684549 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m13:14:53.685549 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m13:14:53.686549 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m13:14:53.687552 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m13:14:53.689830 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m13:14:53.689830 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m13:14:53.690828 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m13:14:53.690828 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m13:14:53.691828 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m13:14:53.691828 [debug] [Thread-7 (]: Finished running node model.redshift.stl_query
[0m13:14:53.692562 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m13:14:53.693584 [debug] [Thread-8 (]: Finished running node model.redshift.stv_blocklist
[0m13:14:53.693584 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m13:14:53.694584 [debug] [Thread-5 (]: Finished running node model.redshift.stv_partitions
[0m13:14:53.694584 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m13:14:53.695583 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m13:14:53.695583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m13:14:53.695583 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:14:53.696583 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m13:14:53.696583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m13:14:53.697583 [info ] [Thread-2 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m13:14:53.698583 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m13:14:53.697583 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m13:14:53.698583 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m13:14:53.698583 [info ] [Thread-7 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m13:14:53.699583 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m13:14:53.699583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m13:14:53.700583 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m13:14:53.700583 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m13:14:53.701583 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m13:14:53.701583 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m13:14:53.702584 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m13:14:53.703584 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m13:14:53.703584 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m13:14:53.709584 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m13:14:53.709584 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m13:14:53.710583 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m13:14:53.715582 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m13:14:53.722342 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:53.722342 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m13:14:53.729441 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:53.730465 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m13:14:53.731437 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_table_stats
[0m13:14:53.732437 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m13:14:53.732437 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m13:14:53.733437 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m13:14:53.733437 [info ] [Thread-8 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m13:14:53.734437 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m13:14:53.756488 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:53.758437 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m13:14:53.759437 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m13:14:53.760437 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m13:14:53.762436 [debug] [Thread-7 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:53.763097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m13:14:53.763097 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m13:14:53.764123 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m13:14:53.777151 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m13:14:53.784001 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m13:14:53.787012 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:53.789010 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:53.791030 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:53.793012 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:14:53.793012 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m13:14:53.793012 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:14:53.793012 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m13:14:53.792029 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:14:53.794012 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:53.796412 [debug] [Thread-8 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m13:14:53.796412 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:14:53.798381 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m13:14:53.799426 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:14:53.799426 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:53.800384 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:53.808421 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:53.808421 [debug] [Thread-7 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:53.812417 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:53.813364 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:53.813364 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:53.813364 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:14:53.814657 [debug] [Thread-7 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:53.814657 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:14:53.815836 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:14:53.817065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:53.819070 [debug] [Thread-8 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:53.821071 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:53.822070 [debug] [Thread-8 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:53.824071 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:54.249986 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.453 seconds
[0m13:14:54.251004 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:54.252004 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m13:14:54.287935 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.488 seconds
[0m13:14:54.288927 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:54.289926 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m13:14:54.307215 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.513 seconds
[0m13:14:54.308213 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:54.309210 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m13:14:54.311208 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.493 seconds
[0m13:14:54.311208 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.495 seconds
[0m13:14:54.312330 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:54.313046 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:54.313765 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m13:14:54.314666 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m13:14:54.451557 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.199 seconds
[0m13:14:54.462490 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:54.463491 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m13:14:54.505313 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.215 seconds
[0m13:14:54.509313 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:54.509313 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:14:54.532157 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.222 seconds
[0m13:14:54.536044 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:54.536044 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m13:14:54.539044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.224 seconds
[0m13:14:54.542043 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:54.542043 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m13:14:54.554545 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.238 seconds
[0m13:14:54.557560 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:54.557560 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m13:14:54.576808 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.113 seconds
[0m13:14:54.582757 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:54.582757 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m13:14:54.621035 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.111 seconds
[0m13:14:54.628068 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:54.629073 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m13:14:54.656042 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m13:14:54.662983 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:54.663984 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.127 seconds
[0m13:14:54.664985 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m13:14:54.669911 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:54.670881 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m13:14:54.677541 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.120 seconds
[0m13:14:54.682133 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:54.683140 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m13:14:54.703697 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.119 seconds
[0m13:14:54.720676 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:14:54.721677 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:54.721677 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:14:54.755533 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.126 seconds
[0m13:14:54.757626 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:14:54.757626 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:54.758553 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:14:54.798819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m13:14:54.802814 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:14:54.803816 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:54.803816 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:14:54.808452 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.125 seconds
[0m13:14:54.810516 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:14:54.810516 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.140 seconds
[0m13:14:54.811728 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:54.813466 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:14:54.813466 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:14:54.814484 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:54.815468 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:14:55.018864 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.297 seconds
[0m13:14:55.019863 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:55.019863 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:14:55.020870 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.262 seconds
[0m13:14:55.020870 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.217 seconds
[0m13:14:55.021912 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.207 seconds
[0m13:14:55.022923 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.207 seconds
[0m13:14:55.101594 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.080 seconds
[0m13:14:55.114404 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m13:14:55.119411 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:55.119411 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m13:14:55.199248 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:14:55.202246 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:14:55.203243 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:55.204239 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:14:55.299894 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.094 seconds
[0m13:14:55.301886 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:14:55.301886 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:14:55.339188 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.036 seconds
[0m13:14:55.344255 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:55.345260 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:14:55.425651 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:14:55.430616 [debug] [Thread-7 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:14:55.432562 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:55.433562 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m13:14:55.520912 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.087 seconds
[0m13:14:55.523868 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:14:55.524874 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:55.524874 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:14:55.656144 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.130 seconds
[0m13:14:55.658164 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:14:55.658164 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:14:55.699299 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.039 seconds
[0m13:14:55.703254 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:55.704249 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:14:55.777673 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m13:14:55.782618 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m13:14:55.784621 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:55.786130 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m13:14:55.867078 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:14:55.868081 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:14:55.868081 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:55.869079 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:14:55.964778 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m13:14:55.966756 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:14:55.967748 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:14:56.002873 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.035 seconds
[0m13:14:56.005895 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:56.006896 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:14:56.089689 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:14:56.095680 [debug] [Thread-8 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m13:14:56.098709 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:56.098709 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m13:14:56.184220 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.084 seconds
[0m13:14:56.186856 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:14:56.187935 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:56.188903 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:14:56.313516 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.123 seconds
[0m13:14:56.314657 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:14:56.315660 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:14:56.353783 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.037 seconds
[0m13:14:56.354781 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:56.355825 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:14:56.440762 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.084 seconds
[0m13:14:56.445760 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m13:14:56.447755 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:56.448758 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m13:14:56.530494 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:14:56.533524 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:14:56.534535 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:56.535489 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:14:56.634770 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.098 seconds
[0m13:14:56.636746 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:14:56.637765 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:14:56.678090 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.039 seconds
[0m13:14:56.681116 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m13:14:56.682087 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m13:14:56.684086 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m13:14:56.685085 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m13:14:56.686153 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m13:14:56.756651 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m13:14:56.757738 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m13:14:56.760691 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF02D9400>]}
[0m13:14:56.762653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF3218170>]}
[0m13:14:56.763646 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.06s]
[0m13:14:56.765666 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.00s]
[0m13:14:56.767651 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m13:14:56.768645 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m13:14:56.769652 [debug] [Thread-7 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m13:14:56.770646 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: Close
[0m13:14:56.771639 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: Close
[0m13:14:56.772523 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF4A88260>]}
[0m13:14:56.773580 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF4B16F60>]}
[0m13:14:56.774552 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd50ef34-bf89-419f-bee6-0f57727c6e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF44FEAE0>]}
[0m13:14:56.775801 [info ] [Thread-7 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.07s]
[0m13:14:56.776820 [info ] [Thread-8 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.01s]
[0m13:14:56.777883 [info ] [Thread-2 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.07s]
[0m13:14:56.778921 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:14:56.779890 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m13:14:56.779890 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m13:14:56.781821 [debug] [MainThread]: Using redshift connection "master"
[0m13:14:56.782865 [debug] [MainThread]: On master: BEGIN
[0m13:14:56.782865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:56.782865 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:14:56.782865 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:14:57.215601 [debug] [MainThread]: SQL status: SUCCESS in 0.432 seconds
[0m13:14:57.216600 [debug] [MainThread]: On master: COMMIT
[0m13:14:57.218601 [debug] [MainThread]: Using redshift connection "master"
[0m13:14:57.219598 [debug] [MainThread]: On master: COMMIT
[0m13:14:57.298855 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m13:14:57.300803 [debug] [MainThread]: On master: Close
[0m13:14:57.301774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:57.303911 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m13:14:57.304839 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m13:14:57.304839 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m13:14:57.305837 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m13:14:57.305837 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m13:14:57.306835 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m13:14:57.307837 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m13:14:57.308869 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m13:14:57.308869 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m13:14:57.309836 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m13:14:57.309836 [info ] [MainThread]: 
[0m13:14:57.310836 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m13:14:57.312833 [debug] [MainThread]: Command end result
[0m13:14:57.354038 [info ] [MainThread]: 
[0m13:14:57.355822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:57.356250 [info ] [MainThread]: 
[0m13:14:57.357279 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:14:57.358278 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:57.358278 after 7.05 seconds
[0m13:14:57.358278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF43D4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF2833830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF441E060>]}
[0m13:14:57.359277 [debug] [MainThread]: Flushing usage events
[0m13:16:14.514559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023702F56060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023705B74E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023706020CE0>]}


============================== 13:16:14.517591 | 5c7a58b6-1749-4ee9-9547-ff2ea25e351f ==============================
[0m13:16:14.517591 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:16:14.517591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:16:14.610512 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:16:14.611529 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:16:14.728172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023705EBBDD0>]}
[0m13:16:14.767173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023703B05100>]}
[0m13:16:14.768691 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:16:14.784718 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:16:14.901003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:14.901003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:14.904937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:16:14.918946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237069ED250>]}
[0m13:16:14.969572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707A82CF0>]}
[0m13:16:14.970577 [info ] [MainThread]: Found 24 models, 615 macros
[0m13:16:14.970577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237068DA660>]}
[0m13:16:14.972039 [info ] [MainThread]: 
[0m13:16:14.973048 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:16:14.976049 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m13:16:14.988083 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m13:16:14.988083 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m13:16:14.988083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:14.991644 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:14.991644 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:15.599460 [debug] [ThreadPool]: SQL status: SUCCESS in 0.611 seconds
[0m13:16:15.604452 [debug] [ThreadPool]: On list_integrity-db: Close
[0m13:16:15.607663 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m13:16:15.616658 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:16:15.617658 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m13:16:15.617658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:15.617658 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:15.618662 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:16.055067 [debug] [ThreadPool]: SQL status: SUCCESS in 0.438 seconds
[0m13:16:16.056179 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:16:16.057149 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m13:16:16.173028 [debug] [ThreadPool]: SQL status: SUCCESS in 0.115 seconds
[0m13:16:16.177000 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m13:16:16.259393 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m13:16:16.275083 [debug] [MainThread]: Using redshift connection "master"
[0m13:16:16.275083 [debug] [MainThread]: On master: BEGIN
[0m13:16:16.275083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:16.276040 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:16.276040 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:16.687694 [debug] [MainThread]: SQL status: SUCCESS in 0.412 seconds
[0m13:16:16.688707 [debug] [MainThread]: Using redshift connection "master"
[0m13:16:16.689707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:16:16.820252 [debug] [MainThread]: SQL status: SUCCESS in 0.130 seconds
[0m13:16:16.823298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707DBD820>]}
[0m13:16:16.824250 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:16.897601 [debug] [MainThread]: Using redshift connection "master"
[0m13:16:16.898580 [debug] [MainThread]: On master: BEGIN
[0m13:16:16.935480 [debug] [MainThread]: SQL status: SUCCESS in 0.035 seconds
[0m13:16:16.936482 [debug] [MainThread]: On master: COMMIT
[0m13:16:16.937477 [debug] [MainThread]: Using redshift connection "master"
[0m13:16:16.938477 [debug] [MainThread]: On master: COMMIT
[0m13:16:17.013038 [debug] [MainThread]: SQL status: SUCCESS in 0.073 seconds
[0m13:16:17.014040 [debug] [MainThread]: On master: Close
[0m13:16:17.015038 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:16:17.017064 [info ] [MainThread]: 
[0m13:16:17.024444 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m13:16:17.025443 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m13:16:17.025443 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m13:16:17.025443 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m13:16:17.026443 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m13:16:17.026443 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m13:16:17.027443 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m13:16:17.027443 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m13:16:17.027443 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m13:16:17.028442 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m13:16:17.028442 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m13:16:17.029442 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m13:16:17.029442 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m13:16:17.029442 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m13:16:17.030442 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m13:16:17.030442 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m13:16:17.031442 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m13:16:17.035755 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m13:16:17.031442 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m13:16:17.031442 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m13:16:17.033754 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m13:16:17.033754 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m13:16:17.033754 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m13:16:17.043754 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m13:16:17.034754 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m13:16:17.037754 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m13:16:17.039754 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m13:16:17.040769 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m13:16:17.041754 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m13:16:17.042754 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m13:16:17.031442 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m13:16:17.044754 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m13:16:17.045754 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m13:16:17.046754 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m13:16:17.046754 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m13:16:17.047754 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m13:16:17.047754 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m13:16:17.049759 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m13:16:17.050754 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m13:16:17.051754 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m13:16:17.051754 [debug] [Thread-6 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m13:16:17.052758 [debug] [Thread-8 (]: Began running node model.redshift.redshift_tables
[0m13:16:17.052758 [debug] [Thread-3 (]: Began running node model.redshift.stl_explain
[0m13:16:17.053754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m13:16:17.053754 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m13:16:17.053754 [debug] [Thread-5 (]: Began running node model.redshift.stl_wlm_query
[0m13:16:17.054755 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m13:16:17.054755 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m13:16:17.055755 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m13:16:17.055755 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_tables)
[0m13:16:17.055755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.stl_explain)
[0m13:16:17.055755 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m13:16:17.057754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m13:16:17.057754 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_wlm_query)
[0m13:16:17.058753 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m13:16:17.058753 [debug] [Thread-2 (]: Began running node model.redshift.stv_partitions
[0m13:16:17.058753 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m13:16:17.059754 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_tables
[0m13:16:17.059754 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_explain
[0m13:16:17.061753 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m13:16:17.061753 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m13:16:17.061753 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_wlm_query
[0m13:16:17.062753 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m13:16:17.062753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.stv_partitions)
[0m13:16:17.064754 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m13:16:17.066389 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m13:16:17.068268 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m13:16:17.068268 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m13:16:17.069268 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m13:16:17.070312 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m13:16:17.071422 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m13:16:17.072443 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_partitions
[0m13:16:17.073444 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m13:16:17.074443 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_tables
[0m13:16:17.074443 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m13:16:17.075447 [debug] [Thread-5 (]: Finished running node model.redshift.stl_wlm_query
[0m13:16:17.076443 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m13:16:17.076443 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m13:16:17.077443 [debug] [Thread-3 (]: Finished running node model.redshift.stl_explain
[0m13:16:17.078444 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m13:16:17.078444 [debug] [Thread-6 (]: Began running node model.redshift.svv_diskusage
[0m13:16:17.079443 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m13:16:17.079443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m13:16:17.079443 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:16:17.080443 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_dependencies
[0m13:16:17.080443 [debug] [Thread-4 (]: Began running node model.redshift.redshift_cost
[0m13:16:17.081443 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m13:16:17.082448 [debug] [Thread-2 (]: Finished running node model.redshift.stv_partitions
[0m13:16:17.081443 [info ] [Thread-8 (]: 1 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m13:16:17.082448 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m13:16:17.083448 [info ] [Thread-5 (]: 2 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m13:16:17.083448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_cost)
[0m13:16:17.083448 [info ] [Thread-7 (]: 3 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m13:16:17.084447 [debug] [Thread-6 (]: Began compiling node model.redshift.svv_diskusage
[0m13:16:17.084447 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_users_schema_privileges)
[0m13:16:17.086471 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m13:16:17.087465 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m13:16:17.087465 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_cost
[0m13:16:17.087465 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m13:16:17.089447 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m13:16:17.089447 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m13:16:17.090447 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m13:16:17.095465 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m13:16:17.095465 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m13:16:17.096448 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m13:16:17.101502 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:17.101502 [debug] [Thread-6 (]: Finished running node model.redshift.svv_diskusage
[0m13:16:17.108520 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:17.114520 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m13:16:17.114520 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_cost
[0m13:16:17.116309 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m13:16:17.116309 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_table_stats
[0m13:16:17.116309 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m13:16:17.138333 [debug] [Thread-8 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:17.139314 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m13:16:17.139314 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m13:16:17.138333 [info ] [Thread-3 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m13:16:17.142317 [debug] [Thread-5 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:17.143316 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m13:16:17.146331 [debug] [Thread-7 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m13:16:17.149318 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:17.149318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_table_stats)
[0m13:16:17.152313 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:17.153482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m13:16:17.155489 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:17.156539 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:16:17.156539 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m13:16:17.157493 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:16:17.157493 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m13:16:17.157493 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:16:17.158487 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:16:17.173251 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m13:16:17.176676 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:16:17.182744 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m13:16:17.182744 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:16:17.183728 [debug] [Thread-8 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:17.183728 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:17.184727 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m13:16:17.184727 [debug] [Thread-7 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:17.185727 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m13:16:17.185727 [debug] [Thread-8 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:17.186728 [debug] [Thread-5 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:17.188729 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m13:16:17.189727 [debug] [Thread-7 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:17.191726 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m13:16:17.244920 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:17.245865 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:16:17.254920 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:17.256865 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:16:17.260865 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:16:17.261867 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:17.261867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:17.262871 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:17.262871 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:17.263874 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:17.677839 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.416 seconds
[0m13:16:17.678887 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:17.678887 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m13:16:17.685375 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.508 seconds
[0m13:16:17.685375 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:17.686374 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m13:16:17.701141 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.543 seconds
[0m13:16:17.701141 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:17.702177 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m13:16:17.725128 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.542 seconds
[0m13:16:17.726146 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:17.727148 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m13:16:17.736150 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.478 seconds
[0m13:16:17.737145 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:17.737145 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m13:16:17.891670 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.212 seconds
[0m13:16:17.900242 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:17.901197 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.215 seconds
[0m13:16:17.902193 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m13:16:17.906167 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:17.906713 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:16:17.928451 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.226 seconds
[0m13:16:17.933508 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:17.933508 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m13:16:17.967156 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.240 seconds
[0m13:16:17.973136 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:17.974156 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m13:16:17.994335 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.256 seconds
[0m13:16:18.000854 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:18.000854 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m13:16:18.015472 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.109 seconds
[0m13:16:18.020470 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:18.021471 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m13:16:18.022470 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.115 seconds
[0m13:16:18.027469 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:18.027469 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m13:16:18.057349 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.123 seconds
[0m13:16:18.063758 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:18.064770 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m13:16:18.093674 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.119 seconds
[0m13:16:18.099202 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:18.100203 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m13:16:18.120898 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.120 seconds
[0m13:16:18.127043 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:18.128008 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m13:16:18.136962 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m13:16:18.153003 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.125 seconds
[0m13:16:18.157000 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:16:18.157000 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:18.157958 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:16:18.158958 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:16:18.159957 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:18.159957 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:16:18.187769 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.123 seconds
[0m13:16:18.190787 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:16:18.190787 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:18.191889 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:16:18.237163 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.136 seconds
[0m13:16:18.239161 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:16:18.240159 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:18.240159 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:16:18.261466 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.133 seconds
[0m13:16:18.263502 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:16:18.264585 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:18.264585 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:16:18.474040 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.313 seconds
[0m13:16:18.475052 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:18.476089 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:16:18.478035 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.286 seconds
[0m13:16:18.479035 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.238 seconds
[0m13:16:18.480036 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.320 seconds
[0m13:16:18.480036 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.215 seconds
[0m13:16:18.555935 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m13:16:18.565933 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m13:16:18.569932 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:18.569932 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m13:16:18.646543 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.075 seconds
[0m13:16:18.649560 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:16:18.650562 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:18.651558 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:16:18.750738 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m13:16:18.752731 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:16:18.753781 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:16:18.789613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.035 seconds
[0m13:16:18.793475 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:18.794533 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:16:18.873662 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:16:18.878710 [debug] [Thread-8 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m13:16:18.880658 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:18.880658 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m13:16:18.967820 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.086 seconds
[0m13:16:18.970815 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:16:18.972818 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:18.972818 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:16:19.090997 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.117 seconds
[0m13:16:19.092929 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:16:19.093977 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:16:19.131289 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.036 seconds
[0m13:16:19.133290 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:19.134283 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:16:19.217685 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.082 seconds
[0m13:16:19.223907 [debug] [Thread-7 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m13:16:19.225927 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:19.225927 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m13:16:19.315143 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.088 seconds
[0m13:16:19.318168 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:16:19.319169 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:19.320167 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:16:19.437049 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.116 seconds
[0m13:16:19.438495 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:16:19.439511 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:16:19.479317 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.039 seconds
[0m13:16:19.482313 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:19.483310 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:16:19.572669 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.088 seconds
[0m13:16:19.577664 [debug] [Thread-5 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:16:19.579665 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:19.580664 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m13:16:19.667014 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.086 seconds
[0m13:16:19.671006 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:16:19.672126 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:19.673144 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:16:19.787771 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.114 seconds
[0m13:16:19.789810 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:16:19.790807 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:16:19.831793 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.039 seconds
[0m13:16:19.833888 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:19.834792 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:16:19.916075 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.080 seconds
[0m13:16:19.924045 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m13:16:19.927090 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:19.928136 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m13:16:20.014802 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.086 seconds
[0m13:16:20.016793 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:16:20.017792 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:20.019224 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:16:20.114072 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.093 seconds
[0m13:16:20.115059 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:16:20.115969 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:16:20.156868 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.039 seconds
[0m13:16:20.159839 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m13:16:20.160837 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m13:16:20.161838 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m13:16:20.163836 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m13:16:20.164833 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m13:16:20.240325 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m13:16:20.241672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237083D8980>]}
[0m13:16:20.242678 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.09s]
[0m13:16:20.243677 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m13:16:20.245044 [debug] [Thread-7 (]: On model.redshift.redshift_admin_dependencies: Close
[0m13:16:20.246057 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237083D8920>]}
[0m13:16:20.247056 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m13:16:20.247056 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237083D8C50>]}
[0m13:16:20.248056 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m13:16:20.248056 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023703BD89B0>]}
[0m13:16:20.249058 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: Close
[0m13:16:20.250057 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c7a58b6-1749-4ee9-9547-ff2ea25e351f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237083D8410>]}
[0m13:16:20.246057 [info ] [Thread-7 (]: 3 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.16s]
[0m13:16:20.251056 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m13:16:20.247056 [info ] [Thread-5 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.16s]
[0m13:16:20.249058 [info ] [Thread-8 (]: 1 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.16s]
[0m13:16:20.253056 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m13:16:20.252057 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:16:20.250057 [info ] [Thread-3 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.10s]
[0m13:16:20.254056 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m13:16:20.255056 [debug] [MainThread]: Using redshift connection "master"
[0m13:16:20.255056 [debug] [MainThread]: On master: BEGIN
[0m13:16:20.256056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:20.256056 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:16:20.257055 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:16:20.671601 [debug] [MainThread]: SQL status: SUCCESS in 0.415 seconds
[0m13:16:20.672600 [debug] [MainThread]: On master: COMMIT
[0m13:16:20.672600 [debug] [MainThread]: Using redshift connection "master"
[0m13:16:20.672600 [debug] [MainThread]: On master: COMMIT
[0m13:16:20.749274 [debug] [MainThread]: SQL status: SUCCESS in 0.076 seconds
[0m13:16:20.750276 [debug] [MainThread]: On master: Close
[0m13:16:20.752277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:20.753273 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m13:16:20.754303 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m13:16:20.755269 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m13:16:20.755269 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m13:16:20.756275 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m13:16:20.756275 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m13:16:20.757270 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m13:16:20.757270 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m13:16:20.758273 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m13:16:20.758273 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m13:16:20.759274 [info ] [MainThread]: 
[0m13:16:20.761275 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m13:16:20.763127 [debug] [MainThread]: Command end result
[0m13:16:20.788723 [info ] [MainThread]: 
[0m13:16:20.788723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:20.789723 [info ] [MainThread]: 
[0m13:16:20.789723 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:16:20.790723 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:20.790723 after 6.40 seconds
[0m13:16:20.790723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023702F56060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023705D78BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023706A04170>]}
[0m13:16:20.791723 [debug] [MainThread]: Flushing usage events
[0m13:21:27.362506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BBCAE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269B9B59550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BC465130>]}


============================== 13:21:27.365264 | 17349739-0b31-4389-95f2-6a2c8ea46962 ==============================
[0m13:21:27.365264 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:21:27.366262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:27.462092 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:21:27.462092 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:21:27.557090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BB604530>]}
[0m13:21:27.590644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCE40200>]}
[0m13:21:27.592630 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:21:27.605622 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:21:27.690607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:27.690607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:27.694607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:21:27.706022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCE40A40>]}
[0m13:21:27.749049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE1CF3B0>]}
[0m13:21:27.750081 [info ] [MainThread]: Found 24 models, 615 macros
[0m13:21:27.750081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCEF9F10>]}
[0m13:21:27.752015 [info ] [MainThread]: 
[0m13:21:27.753014 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:21:27.755044 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m13:21:27.765295 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m13:21:27.766295 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m13:21:27.766295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:27.768776 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:27.769764 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:28.326919 [debug] [ThreadPool]: SQL status: SUCCESS in 0.561 seconds
[0m13:21:28.330907 [debug] [ThreadPool]: On list_integrity-db: Close
[0m13:21:28.334676 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m13:21:28.341686 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:21:28.342685 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m13:21:28.342685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.342685 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:28.342685 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:28.740973 [debug] [ThreadPool]: SQL status: SUCCESS in 0.398 seconds
[0m13:21:28.742024 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:21:28.743000 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m13:21:28.852225 [debug] [ThreadPool]: SQL status: SUCCESS in 0.108 seconds
[0m13:21:28.855274 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m13:21:28.953561 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m13:21:28.966542 [debug] [MainThread]: Using redshift connection "master"
[0m13:21:28.967543 [debug] [MainThread]: On master: BEGIN
[0m13:21:28.967543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:28.967543 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:28.967543 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:29.398474 [debug] [MainThread]: SQL status: SUCCESS in 0.431 seconds
[0m13:21:29.399549 [debug] [MainThread]: Using redshift connection "master"
[0m13:21:29.400075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:21:29.533989 [debug] [MainThread]: SQL status: SUCCESS in 0.133 seconds
[0m13:21:29.536007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE31D6D0>]}
[0m13:21:29.537049 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:29.619452 [debug] [MainThread]: Using redshift connection "master"
[0m13:21:29.620420 [debug] [MainThread]: On master: BEGIN
[0m13:21:29.660348 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m13:21:29.662345 [debug] [MainThread]: On master: COMMIT
[0m13:21:29.663339 [debug] [MainThread]: Using redshift connection "master"
[0m13:21:29.664340 [debug] [MainThread]: On master: COMMIT
[0m13:21:29.741747 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m13:21:29.743758 [debug] [MainThread]: On master: Close
[0m13:21:29.744747 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:21:29.746744 [info ] [MainThread]: 
[0m13:21:29.755336 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m13:21:29.755336 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m13:21:29.756335 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m13:21:29.756335 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m13:21:29.757336 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m13:21:29.757336 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m13:21:29.758360 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m13:21:29.758360 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m13:21:29.759336 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m13:21:29.759336 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m13:21:29.760335 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m13:21:29.760335 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m13:21:29.761359 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m13:21:29.761359 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m13:21:29.763337 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m13:21:29.763337 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m13:21:29.764334 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m13:21:29.764334 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m13:21:29.765334 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m13:21:29.765334 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m13:21:29.765334 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m13:21:29.767338 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m13:21:29.767338 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m13:21:29.767338 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m13:21:29.768338 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m13:21:29.769338 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m13:21:29.770347 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m13:21:29.771338 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m13:21:29.772347 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m13:21:29.773338 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m13:21:29.774428 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m13:21:29.775448 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m13:21:29.777466 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m13:21:29.778477 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m13:21:29.779473 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m13:21:29.780978 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m13:21:29.782005 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m13:21:29.782005 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m13:21:29.782984 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m13:21:29.784983 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m13:21:29.784983 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m13:21:29.785983 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m13:21:29.785983 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m13:21:29.786983 [debug] [Thread-5 (]: Began running node model.redshift.stl_explain
[0m13:21:29.786983 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m13:21:29.786983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m13:21:29.787989 [debug] [Thread-7 (]: Began running node model.redshift.stl_wlm_query
[0m13:21:29.788983 [debug] [Thread-6 (]: Began running node model.redshift.stv_blocklist
[0m13:21:29.788983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m13:21:29.788983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m13:21:29.789984 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m13:21:29.789984 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_explain)
[0m13:21:29.789984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m13:21:29.790983 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m13:21:29.790983 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_wlm_query)
[0m13:21:29.790983 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_blocklist)
[0m13:21:29.791983 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m13:21:29.791983 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m13:21:29.791983 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m13:21:29.792982 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_explain
[0m13:21:29.792982 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m13:21:29.794983 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m13:21:29.794983 [debug] [Thread-7 (]: Began compiling node model.redshift.stl_wlm_query
[0m13:21:29.795983 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_blocklist
[0m13:21:29.797982 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m13:21:29.800009 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m13:21:29.800009 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m13:21:29.800983 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m13:21:29.802983 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m13:21:29.803983 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m13:21:29.805984 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m13:21:29.806983 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m13:21:29.806983 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m13:21:29.807983 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m13:21:29.808983 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m13:21:29.808983 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m13:21:29.809983 [debug] [Thread-5 (]: Finished running node model.redshift.stl_explain
[0m13:21:29.809983 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m13:21:29.810983 [debug] [Thread-6 (]: Finished running node model.redshift.stv_blocklist
[0m13:21:29.810983 [debug] [Thread-7 (]: Finished running node model.redshift.stl_wlm_query
[0m13:21:29.810983 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m13:21:29.811983 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m13:21:29.812982 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m13:21:29.812982 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m13:21:29.812982 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:21:29.813983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m13:21:29.813983 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m13:21:29.814982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m13:21:29.814982 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m13:21:29.814982 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m13:21:29.815982 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m13:21:29.815982 [info ] [Thread-5 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m13:21:29.816983 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_cost)
[0m13:21:29.816983 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m13:21:29.816983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m13:21:29.817983 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_schema_privileges)
[0m13:21:29.818982 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m13:21:29.818982 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_table_view_privileges)
[0m13:21:29.819982 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m13:21:29.821014 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m13:21:29.821014 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m13:21:29.821014 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m13:21:29.821983 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m13:21:29.822983 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m13:21:29.827981 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m13:21:29.833982 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m13:21:29.834983 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m13:21:29.840005 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:29.846987 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:29.848982 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m13:21:29.849982 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m13:21:29.849982 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m13:21:29.850983 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m13:21:29.864982 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m13:21:29.877012 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m13:21:29.877012 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m13:21:29.879988 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:29.877012 [info ] [Thread-7 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m13:21:29.880987 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m13:21:29.884417 [debug] [Thread-5 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:29.887394 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:29.887394 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_table_stats)
[0m13:21:29.889419 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:29.890395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m13:21:29.890395 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:21:29.890395 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m13:21:29.893393 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:29.894394 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:21:29.894394 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m13:21:29.894394 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:29.909393 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m13:21:29.909393 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:21:29.910395 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:21:29.916393 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m13:21:29.916393 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:29.917393 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:21:29.917393 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m13:21:29.918396 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:29.918396 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:29.919394 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m13:21:29.919394 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:29.922394 [debug] [Thread-7 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m13:21:29.922394 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:29.925394 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m13:21:29.926395 [debug] [Thread-5 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:29.975422 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:29.985907 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:29.986907 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:21:29.989908 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:21:29.990908 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:21:29.990908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:29.991908 [debug] [Thread-7 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:29.993907 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:29.995908 [debug] [Thread-7 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:29.996908 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:30.406719 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.511 seconds
[0m13:21:30.406719 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:30.407762 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m13:21:30.442378 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.532 seconds
[0m13:21:30.444367 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:30.445371 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m13:21:30.448361 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.531 seconds
[0m13:21:30.449360 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:30.450357 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m13:21:30.468239 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.478 seconds
[0m13:21:30.470230 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:30.471273 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m13:21:30.485948 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.494 seconds
[0m13:21:30.487253 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:30.488316 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m13:21:30.619104 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.210 seconds
[0m13:21:30.630074 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:30.631078 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m13:21:30.673218 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.226 seconds
[0m13:21:30.678200 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:30.678200 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m13:21:30.679159 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.228 seconds
[0m13:21:30.682848 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:30.682848 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:21:30.709451 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.237 seconds
[0m13:21:30.717634 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:30.718636 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m13:21:30.720648 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.231 seconds
[0m13:21:30.723634 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:30.724634 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m13:21:30.746920 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.115 seconds
[0m13:21:30.752937 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:30.752937 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m13:21:30.795828 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m13:21:30.803902 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:30.804794 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m13:21:30.815606 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.132 seconds
[0m13:21:30.820670 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:30.821683 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m13:21:30.853941 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.134 seconds
[0m13:21:30.854939 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.130 seconds
[0m13:21:30.860973 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:30.865933 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:30.866932 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m13:21:30.867674 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.114 seconds
[0m13:21:30.868698 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m13:21:30.880695 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:21:30.882199 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:30.882199 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:21:30.938315 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.132 seconds
[0m13:21:30.941304 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:21:30.942269 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:30.942269 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:21:30.956578 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.134 seconds
[0m13:21:30.959606 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:21:30.959606 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:30.959606 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:21:31.010948 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.142 seconds
[0m13:21:31.015012 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:21:31.016042 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:31.016972 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:21:31.020739 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.139 seconds
[0m13:21:31.023799 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:21:31.024756 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:31.025800 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:21:31.179643 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.296 seconds
[0m13:21:31.183168 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:31.184186 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:21:31.186191 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.225 seconds
[0m13:21:31.187186 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.161 seconds
[0m13:21:31.188185 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.171 seconds
[0m13:21:31.189183 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.246 seconds
[0m13:21:31.260522 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:21:31.272588 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m13:21:31.277627 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:31.278613 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m13:21:31.357170 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.078 seconds
[0m13:21:31.359165 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:21:31.360159 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:31.361162 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:21:31.472271 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.110 seconds
[0m13:21:31.473265 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:21:31.474267 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:21:31.509595 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.033 seconds
[0m13:21:31.512597 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:31.512597 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:21:31.595104 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:21:31.600113 [debug] [Thread-5 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:21:31.602156 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:31.603141 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m13:21:31.689665 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.085 seconds
[0m13:21:31.692662 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:21:31.693761 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:31.694666 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:21:31.787260 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.092 seconds
[0m13:21:31.790194 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:21:31.791193 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:21:31.829020 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.037 seconds
[0m13:21:31.831056 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:31.832057 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:21:31.918991 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m13:21:31.924003 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m13:21:31.925992 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:31.927029 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m13:21:32.009435 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m13:21:32.012464 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:21:32.013467 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:32.014430 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:21:32.125055 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m13:21:32.127008 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:21:32.128005 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:21:32.166609 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.038 seconds
[0m13:21:32.168590 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:32.169672 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:21:32.251426 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:21:32.253457 [debug] [Thread-7 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m13:21:32.254457 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:32.254457 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m13:21:32.339070 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.083 seconds
[0m13:21:32.342056 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:21:32.343019 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:32.344106 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:21:32.447265 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.102 seconds
[0m13:21:32.448257 [debug] [Thread-7 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:21:32.450214 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:21:32.488238 [debug] [Thread-7 (]: SQL status: SUCCESS in 0.037 seconds
[0m13:21:32.491236 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:32.492275 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:21:32.578635 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.086 seconds
[0m13:21:32.584668 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m13:21:32.586122 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:32.587121 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m13:21:32.671598 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.084 seconds
[0m13:21:32.673596 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:21:32.674598 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:32.674598 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:21:32.795168 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.119 seconds
[0m13:21:32.797174 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:21:32.798119 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:21:32.836580 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.038 seconds
[0m13:21:32.839534 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m13:21:32.840567 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m13:21:32.841610 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m13:21:32.842664 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m13:21:32.843630 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m13:21:32.920022 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m13:21:32.924016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCE9EAE0>]}
[0m13:21:32.926016 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.11s]
[0m13:21:32.928014 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m13:21:32.929014 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m13:21:32.930015 [debug] [Thread-7 (]: On model.redshift.redshift_admin_table_stats: Close
[0m13:21:32.930613 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m13:21:32.931181 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m13:21:32.932219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE938650>]}
[0m13:21:32.932753 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE92BDA0>]}
[0m13:21:32.933501 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE1FD4F0>]}
[0m13:21:32.934511 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17349739-0b31-4389-95f2-6a2c8ea46962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE92A690>]}
[0m13:21:32.934511 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.04s]
[0m13:21:32.935523 [info ] [Thread-7 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.05s]
[0m13:21:32.935523 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.12s]
[0m13:21:32.936507 [info ] [Thread-5 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.12s]
[0m13:21:32.937513 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m13:21:32.937513 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m13:21:32.938510 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m13:21:32.938510 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:21:32.940512 [debug] [MainThread]: Using redshift connection "master"
[0m13:21:32.940512 [debug] [MainThread]: On master: BEGIN
[0m13:21:32.940512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:32.941511 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:21:32.941511 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:21:33.355869 [debug] [MainThread]: SQL status: SUCCESS in 0.415 seconds
[0m13:21:33.356869 [debug] [MainThread]: On master: COMMIT
[0m13:21:33.356869 [debug] [MainThread]: Using redshift connection "master"
[0m13:21:33.356869 [debug] [MainThread]: On master: COMMIT
[0m13:21:33.436327 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m13:21:33.437327 [debug] [MainThread]: On master: Close
[0m13:21:33.438326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:33.438326 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m13:21:33.439342 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m13:21:33.439342 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m13:21:33.440343 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m13:21:33.440343 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m13:21:33.441343 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m13:21:33.441343 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m13:21:33.442327 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m13:21:33.442327 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m13:21:33.443326 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m13:21:33.443326 [info ] [MainThread]: 
[0m13:21:33.444324 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m13:21:33.446741 [debug] [MainThread]: Command end result
[0m13:21:33.477695 [info ] [MainThread]: 
[0m13:21:33.477695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:33.477695 [info ] [MainThread]: 
[0m13:21:33.478693 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:21:33.479694 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:33.479694 after 6.28 seconds
[0m13:21:33.480693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BBB070B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BBC70830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BC162E10>]}
[0m13:21:33.480693 [debug] [MainThread]: Flushing usage events
[0m13:44:26.079146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D850ED9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D86044AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D86044B90>]}


============================== 13:44:26.082146 | cef55c79-321c-4db7-b1e1-9e37dc64caa9 ==============================
[0m13:44:26.082146 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:26.083162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:44:26.161722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cef55c79-321c-4db7-b1e1-9e37dc64caa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D83BAA510>]}
[0m13:44:26.230935 [debug] [MainThread]: Command `dbt clean` succeeded at 13:44:26.230935 after 0.30 seconds
[0m13:44:26.231951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D858C9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D86124470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D83BAA510>]}
[0m13:44:26.231951 [debug] [MainThread]: Flushing usage events
[0m13:44:31.553304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA0C49580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3594D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA35943E0>]}


============================== 13:44:31.556386 | b12fc827-7ab7-4511-bd2c-d083fd8b1a47 ==============================
[0m13:44:31.556386 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:31.557356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:31.625864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b12fc827-7ab7-4511-bd2c-d083fd8b1a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA3377020>]}
[0m13:44:31.646157 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-5h1j45ot'
[0m13:44:31.646157 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:44:31.796391 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:44:31.797405 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:44:31.861095 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:44:31.867709 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m13:44:31.982072 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m13:44:31.985074 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:44:32.315849 [info ] [MainThread]: Installed from version 1.0.0
[0m13:44:32.316851 [info ] [MainThread]: Updated version available: 1.2.0
[0m13:44:32.317851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b12fc827-7ab7-4511-bd2c-d083fd8b1a47', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA375B0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA375B0B0>]}
[0m13:44:32.317851 [info ] [MainThread]: Installing dbt-labs/redshift
[0m13:44:32.498879 [info ] [MainThread]: Installed from version 0.9.0
[0m13:44:32.499878 [info ] [MainThread]: Up to date!
[0m13:44:32.500880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b12fc827-7ab7-4511-bd2c-d083fd8b1a47', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA26F0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA26C3DD0>]}
[0m13:44:32.500880 [info ] [MainThread]: 
[0m13:44:32.501879 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:44:32.502879 [debug] [MainThread]: Command `dbt deps` succeeded at 13:44:32.502879 after 1.04 seconds
[0m13:44:32.503878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA0C49580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA2949610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DA2949E80>]}
[0m13:44:32.503878 [debug] [MainThread]: Flushing usage events
[0m13:44:37.337043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026185CB49E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261842795B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261842CDF10>]}


============================== 13:44:37.342069 | 6b0801e9-a269-44c7-a415-69a61029a2f3 ==============================
[0m13:44:37.342069 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:37.343090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:37.439175 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:44:37.439175 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:44:37.536955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026187499220>]}
[0m13:44:37.570632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026186426DE0>]}
[0m13:44:37.571587 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:44:37.591631 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:44:37.592644 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:44:37.592644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618699D730>]}
[0m13:44:38.552989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:44:38.556985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261887A57F0>]}
[0m13:44:38.604598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261888619A0>]}
[0m13:44:38.604598 [info ] [MainThread]: Found 24 models, 615 macros
[0m13:44:38.605597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188997B60>]}
[0m13:44:38.607597 [info ] [MainThread]: 
[0m13:44:38.607810 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:44:38.610832 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m13:44:38.620882 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m13:44:38.620882 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m13:44:38.620882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:38.624184 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:38.624184 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:39.210067 [debug] [ThreadPool]: SQL status: SUCCESS in 0.589 seconds
[0m13:44:39.215119 [debug] [ThreadPool]: On list_integrity-db: Close
[0m13:44:39.218036 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m13:44:39.228034 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:44:39.229035 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m13:44:39.229035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:39.230036 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:39.230036 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:39.652966 [debug] [ThreadPool]: SQL status: SUCCESS in 0.424 seconds
[0m13:44:39.655064 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:44:39.656070 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m13:44:39.782687 [debug] [ThreadPool]: SQL status: SUCCESS in 0.126 seconds
[0m13:44:39.784739 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m13:44:39.865327 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m13:44:39.875839 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:39.875839 [debug] [MainThread]: On master: BEGIN
[0m13:44:39.875839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:39.875839 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:39.876840 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:40.296439 [debug] [MainThread]: SQL status: SUCCESS in 0.421 seconds
[0m13:44:40.297442 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:40.298442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:44:40.437876 [debug] [MainThread]: SQL status: SUCCESS in 0.138 seconds
[0m13:44:40.440871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261875FB980>]}
[0m13:44:40.441872 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:40.523599 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:40.524548 [debug] [MainThread]: On master: BEGIN
[0m13:44:40.570271 [debug] [MainThread]: SQL status: SUCCESS in 0.045 seconds
[0m13:44:40.572340 [debug] [MainThread]: On master: COMMIT
[0m13:44:40.573295 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:40.573812 [debug] [MainThread]: On master: COMMIT
[0m13:44:40.652308 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m13:44:40.654345 [debug] [MainThread]: On master: Close
[0m13:44:40.657112 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:44:40.659133 [info ] [MainThread]: 
[0m13:44:40.669690 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m13:44:40.670705 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m13:44:40.670705 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m13:44:40.671689 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m13:44:40.672688 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m13:44:40.672688 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m13:44:40.672688 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m13:44:40.673688 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m13:44:40.673688 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m13:44:40.673688 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m13:44:40.674976 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m13:44:40.674976 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m13:44:40.675942 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m13:44:40.675942 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m13:44:40.675942 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m13:44:40.676942 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m13:44:40.676942 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m13:44:40.677941 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m13:44:40.677941 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m13:44:40.677941 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m13:44:40.678940 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m13:44:40.679941 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m13:44:40.679941 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m13:44:40.679941 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m13:44:40.680941 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m13:44:40.682959 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m13:44:40.683941 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m13:44:40.684941 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m13:44:40.686941 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m13:44:40.687942 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m13:44:40.689704 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m13:44:40.690951 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m13:44:40.691919 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m13:44:40.691919 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m13:44:40.693918 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m13:44:40.694046 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m13:44:40.694046 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m13:44:40.695051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m13:44:40.695051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m13:44:40.695051 [debug] [Thread-8 (]: Began running node model.redshift.redshift_tables
[0m13:44:40.696056 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m13:44:40.696056 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m13:44:40.696056 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_tables)
[0m13:44:40.698206 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m13:44:40.700253 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m13:44:40.700253 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_tables
[0m13:44:40.701505 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m13:44:40.703013 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m13:44:40.703013 [debug] [Thread-1 (]: Began running node model.redshift.stl_explain
[0m13:44:40.704019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_explain)
[0m13:44:40.704019 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_tables
[0m13:44:40.705019 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m13:44:40.705019 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m13:44:40.706055 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_explain
[0m13:44:40.706055 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m13:44:40.707021 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m13:44:40.707021 [debug] [Thread-8 (]: Began running node model.redshift.stl_query
[0m13:44:40.708018 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m13:44:40.708018 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m13:44:40.709018 [debug] [Thread-7 (]: Began running node model.redshift.stl_wlm_query
[0m13:44:40.709018 [debug] [Thread-3 (]: Began running node model.redshift.stv_blocklist
[0m13:44:40.711035 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m13:44:40.712020 [debug] [Thread-4 (]: Began running node model.redshift.stv_partitions
[0m13:44:40.712365 [debug] [Thread-2 (]: Began running node model.redshift.stv_tbl_perm
[0m13:44:40.712365 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stl_query)
[0m13:44:40.713372 [debug] [Thread-6 (]: Began running node model.redshift.svv_diskusage
[0m13:44:40.713372 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_dependencies
[0m13:44:40.713372 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_wlm_query)
[0m13:44:40.714372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.stv_blocklist)
[0m13:44:40.714372 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stv_partitions)
[0m13:44:40.714372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stv_tbl_perm)
[0m13:44:40.715371 [debug] [Thread-1 (]: Finished running node model.redshift.stl_explain
[0m13:44:40.715371 [debug] [Thread-8 (]: Began compiling node model.redshift.stl_query
[0m13:44:40.716389 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.svv_diskusage)
[0m13:44:40.717372 [debug] [Thread-7 (]: Began compiling node model.redshift.stl_wlm_query
[0m13:44:40.716389 [info ] [Thread-5 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m13:44:40.717372 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_blocklist
[0m13:44:40.718370 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_partitions
[0m13:44:40.719371 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_tbl_perm
[0m13:44:40.719371 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m13:44:40.721370 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m13:44:40.721370 [debug] [Thread-6 (]: Began compiling node model.redshift.svv_diskusage
[0m13:44:40.722371 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m13:44:40.723370 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_admin_dependencies)
[0m13:44:40.724397 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m13:44:40.725371 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m13:44:40.725937 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m13:44:40.728038 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m13:44:40.727016 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m13:44:40.729068 [debug] [Thread-8 (]: Finished running node model.redshift.stl_query
[0m13:44:40.730039 [debug] [Thread-7 (]: Finished running node model.redshift.stl_wlm_query
[0m13:44:40.733037 [debug] [Thread-7 (]: Began running node model.redshift.redshift_cost
[0m13:44:40.731037 [debug] [Thread-3 (]: Finished running node model.redshift.stv_blocklist
[0m13:44:40.731037 [debug] [Thread-4 (]: Finished running node model.redshift.stv_partitions
[0m13:44:40.732036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m13:44:40.732036 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:44:40.732036 [debug] [Thread-2 (]: Finished running node model.redshift.stv_tbl_perm
[0m13:44:40.730039 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m13:44:40.733037 [debug] [Thread-6 (]: Finished running node model.redshift.svv_diskusage
[0m13:44:40.733037 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m13:44:40.734037 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m13:44:40.735050 [info ] [Thread-8 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m13:44:40.740058 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m13:44:40.741037 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_table_stats
[0m13:44:40.741037 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_cost
[0m13:44:40.746053 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:40.746053 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m13:44:40.754214 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m13:44:40.747207 [info ] [Thread-3 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m13:44:40.754214 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m13:44:40.753229 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m13:44:40.761297 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:40.762258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m13:44:40.762258 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m13:44:40.783950 [debug] [Thread-5 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m13:44:40.784898 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m13:44:40.784898 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_cost
[0m13:44:40.787896 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:40.787896 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m13:44:40.800895 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m13:44:40.803983 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:40.806933 [debug] [Thread-8 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:40.807897 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_queries
[0m13:44:40.807897 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:44:40.807897 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m13:44:40.810895 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:40.810895 [info ] [Thread-2 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m13:44:40.811916 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:40.815896 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:40.817926 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m13:44:40.818897 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:44:40.818897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m13:44:40.818897 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:40.819897 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:44:40.820896 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:44:40.820896 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_queries
[0m13:44:40.827950 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:40.828899 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:40.828899 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:44:40.828899 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:40.833895 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m13:44:40.834896 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:44:40.835898 [debug] [Thread-8 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:40.835898 [debug] [Thread-5 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:40.838897 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:40.839897 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_queries
[0m13:44:40.840924 [debug] [Thread-8 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:40.842898 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:40.844898 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m13:44:40.848849 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:40.853848 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:40.856849 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:44:40.857854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:40.858849 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:40.859855 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:41.264617 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.444 seconds
[0m13:44:41.265613 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:41.266618 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m13:44:41.285287 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.473 seconds
[0m13:44:41.285287 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:41.286303 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m13:44:41.308629 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.470 seconds
[0m13:44:41.309644 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:41.310644 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m13:44:41.333869 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.476 seconds
[0m13:44:41.334867 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.506 seconds
[0m13:44:41.335874 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:41.337202 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:41.338218 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m13:44:41.339659 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m13:44:41.478529 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.211 seconds
[0m13:44:41.491631 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:41.491631 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.206 seconds
[0m13:44:41.492549 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m13:44:41.495796 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:41.496730 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m13:44:41.540520 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.228 seconds
[0m13:44:41.545547 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:41.545547 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m13:44:41.569684 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.228 seconds
[0m13:44:41.571621 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.230 seconds
[0m13:44:41.577214 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:41.583212 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:41.583212 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:44:41.584211 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m13:44:41.621438 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.125 seconds
[0m13:44:41.627433 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:41.628431 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m13:44:41.630430 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.133 seconds
[0m13:44:41.633428 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:41.633428 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m13:44:41.671316 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.124 seconds
[0m13:44:41.676828 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:41.677878 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m13:44:41.719958 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.134 seconds
[0m13:44:41.721987 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.137 seconds
[0m13:44:41.727464 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:41.730462 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:41.731476 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m13:44:41.732469 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m13:44:41.752424 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.122 seconds
[0m13:44:41.771458 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:44:41.772458 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m13:44:41.772458 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:41.774458 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:44:41.774458 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:44:41.775459 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:41.775459 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:44:41.812161 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.133 seconds
[0m13:44:41.817201 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:44:41.818157 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:41.819155 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:44:41.853780 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.120 seconds
[0m13:44:41.855773 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.122 seconds
[0m13:44:41.859774 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:44:41.861952 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:44:41.863657 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:41.864667 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:41.864667 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:44:41.865667 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:44:42.097866 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.322 seconds
[0m13:44:42.100863 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:42.101864 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:44:42.104860 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.329 seconds
[0m13:44:42.105860 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.286 seconds
[0m13:44:42.106859 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.240 seconds
[0m13:44:42.107856 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.242 seconds
[0m13:44:42.187993 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.085 seconds
[0m13:44:42.192994 [debug] [Thread-5 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m13:44:42.195993 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:42.195993 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m13:44:42.274121 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.077 seconds
[0m13:44:42.276709 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:44:42.277778 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:42.278735 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:44:42.371484 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.091 seconds
[0m13:44:42.372502 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:44:42.373476 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:44:42.410193 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.036 seconds
[0m13:44:42.414145 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:42.415172 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:44:42.491464 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:44:42.495481 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m13:44:42.495481 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:42.497012 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m13:44:42.578808 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m13:44:42.587870 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:44:42.589864 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:42.590871 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:44:42.700972 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.109 seconds
[0m13:44:42.702989 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:44:42.704924 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:44:42.743563 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.038 seconds
[0m13:44:42.747574 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:42.747574 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:44:42.829406 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.080 seconds
[0m13:44:42.835396 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m13:44:42.837398 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:42.838407 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m13:44:42.919240 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:44:42.921299 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:44:42.922290 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:42.923293 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:44:43.021466 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.096 seconds
[0m13:44:43.023520 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:44:43.025445 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:44:43.068722 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.042 seconds
[0m13:44:43.073681 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:43.074679 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:44:43.157801 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m13:44:43.163807 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m13:44:43.166960 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:43.167981 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m13:44:43.250719 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m13:44:43.253763 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:44:43.255713 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:43.256712 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:44:43.393857 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.135 seconds
[0m13:44:43.396769 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:44:43.397767 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:44:43.435629 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.037 seconds
[0m13:44:43.437627 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:43.437627 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:44:43.518005 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:44:43.524986 [debug] [Thread-8 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:44:43.526986 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:43.527988 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m13:44:43.611394 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.083 seconds
[0m13:44:43.614425 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:44:43.615386 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:43.616388 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:44:43.709097 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.092 seconds
[0m13:44:43.711097 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:44:43.712094 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:44:43.754362 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.041 seconds
[0m13:44:43.757358 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m13:44:43.758358 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m13:44:43.759370 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m13:44:43.760355 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m13:44:43.761357 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m13:44:43.838045 [debug] [Thread-5 (]: On model.redshift.redshift_admin_dependencies: Close
[0m13:44:43.839074 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: Close
[0m13:44:43.841026 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m13:44:43.842023 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: Close
[0m13:44:43.843024 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m13:44:43.846099 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261847295B0>]}
[0m13:44:43.847870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188FC3B90>]}
[0m13:44:43.849884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026187721D30>]}
[0m13:44:43.851889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188B0E0C0>]}
[0m13:44:43.852883 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b0801e9-a269-44c7-a415-69a61029a2f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188AFDA60>]}
[0m13:44:43.853882 [info ] [Thread-5 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.12s]
[0m13:44:43.854882 [info ] [Thread-2 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.03s]
[0m13:44:43.856882 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.12s]
[0m13:44:43.858883 [info ] [Thread-3 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.09s]
[0m13:44:43.859884 [info ] [Thread-8 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.11s]
[0m13:44:43.861881 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m13:44:43.862896 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_queries
[0m13:44:43.863897 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m13:44:43.864897 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m13:44:43.866209 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:44:43.869273 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:43.869273 [debug] [MainThread]: On master: BEGIN
[0m13:44:43.870275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:43.871394 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:43.871394 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:44.311100 [debug] [MainThread]: SQL status: SUCCESS in 0.440 seconds
[0m13:44:44.312103 [debug] [MainThread]: On master: COMMIT
[0m13:44:44.314100 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:44.314100 [debug] [MainThread]: On master: COMMIT
[0m13:44:44.390289 [debug] [MainThread]: SQL status: SUCCESS in 0.075 seconds
[0m13:44:44.392285 [debug] [MainThread]: On master: Close
[0m13:44:44.394279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:44.395356 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m13:44:44.396307 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m13:44:44.396307 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m13:44:44.397287 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m13:44:44.397287 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m13:44:44.398282 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m13:44:44.398282 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m13:44:44.399311 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m13:44:44.399311 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m13:44:44.400282 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m13:44:44.400282 [info ] [MainThread]: 
[0m13:44:44.401280 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m13:44:44.404275 [debug] [MainThread]: Command end result
[0m13:44:44.440723 [info ] [MainThread]: 
[0m13:44:44.440723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:44.442033 [info ] [MainThread]: 
[0m13:44:44.443011 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:44:44.444134 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:44.444134 after 7.21 seconds
[0m13:44:44.444134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026186A96B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261888523F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618881D9A0>]}
[0m13:44:44.444134 [debug] [MainThread]: Flushing usage events
[0m13:52:17.168425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B626F1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B60C792B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B62DCE750>]}


============================== 13:52:17.171450 | 6b0cafdd-71a5-494b-ba8a-fe9c0cad7b6a ==============================
[0m13:52:17.171450 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:52:17.172426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:17.240611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0cafdd-71a5-494b-ba8a-fe9c0cad7b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B62E654F0>]}
[0m13:52:17.283320 [debug] [MainThread]: Command `dbt clean` succeeded at 13:52:17.283320 after 0.24 seconds
[0m13:52:17.284320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63282180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B637154C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B631F5F10>]}
[0m13:52:17.284320 [debug] [MainThread]: Flushing usage events
[0m13:52:22.666698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225086F8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225086F88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225086F8800>]}


============================== 13:52:22.670710 | 22a0a8f0-24b5-4ac5-ad5b-e23fb982d016 ==============================
[0m13:52:22.670710 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:52:22.671709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:22.740779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a0a8f0-24b5-4ac5-ad5b-e23fb982d016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225062EA510>]}
[0m13:52:22.761790 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-crclvib0'
[0m13:52:22.762789 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:52:22.902759 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:52:22.904758 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:52:22.980461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:52:22.989061 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m13:52:23.109060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m13:52:23.113014 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m13:52:23.203283 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m13:52:23.208276 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:52:23.294819 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:52:23.307729 [info ] [MainThread]: Updating lock file in file path: C:\Development\IntegrityDBT/package-lock.yml
[0m13:52:23.317026 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-v72giyui'
[0m13:52:23.326196 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:52:23.691760 [info ] [MainThread]: Installed from version 1.0.0
[0m13:52:23.691760 [info ] [MainThread]: Updated version available: 1.2.0
[0m13:52:23.692761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22a0a8f0-24b5-4ac5-ad5b-e23fb982d016', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022508890B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022508B1D010>]}
[0m13:52:23.692761 [info ] [MainThread]: Installing dbt-labs/redshift
[0m13:52:23.870748 [info ] [MainThread]: Installed from version 0.9.0
[0m13:52:23.871748 [info ] [MainThread]: Up to date!
[0m13:52:23.871748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22a0a8f0-24b5-4ac5-ad5b-e23fb982d016', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022508946CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225089283E0>]}
[0m13:52:23.872751 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m13:52:24.165220 [info ] [MainThread]: Installed from version 0.8.2
[0m13:52:24.166221 [info ] [MainThread]: Updated version available: 0.9.0
[0m13:52:24.166221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22a0a8f0-24b5-4ac5-ad5b-e23fb982d016', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225089283E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002250892B6E0>]}
[0m13:52:24.167221 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:52:24.335066 [info ] [MainThread]: Installed from version 0.9.0
[0m13:52:24.336067 [info ] [MainThread]: Updated version available: 0.12.1
[0m13:52:24.337067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22a0a8f0-24b5-4ac5-ad5b-e23fb982d016', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002250892A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225089283B0>]}
[0m13:52:24.338066 [info ] [MainThread]: 
[0m13:52:24.338066 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m13:52:24.340066 [debug] [MainThread]: Command `dbt deps` succeeded at 13:52:24.340066 after 1.78 seconds
[0m13:52:24.340066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225083B9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002250840F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022508B1C8C0>]}
[0m13:52:24.341066 [debug] [MainThread]: Flushing usage events
[0m13:52:34.893229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BD622A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BD96B5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BD96B6270>]}


============================== 13:52:34.896234 | dbab52ca-f62a-427c-9785-6efccb39ea63 ==============================
[0m13:52:34.896234 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:52:34.897235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:34.991349 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:52:34.992333 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:52:35.089155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDA7FDA00>]}
[0m13:52:35.123156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BD99DD100>]}
[0m13:52:35.125158 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m13:52:35.163527 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:52:35.163527 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:35.165019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDA9149E0>]}
[0m13:52:36.477172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m13:52:36.482383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBC286B0>]}
[0m13:52:36.532288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBAFE840>]}
[0m13:52:36.533290 [info ] [MainThread]: Found 24 models, 666 macros
[0m13:52:36.533290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBA18530>]}
[0m13:52:36.535389 [info ] [MainThread]: 
[0m13:52:36.536357 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:52:36.538375 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m13:52:36.548370 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m13:52:36.549369 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m13:52:36.549369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:36.552370 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:36.552370 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:37.113129 [debug] [ThreadPool]: SQL status: SUCCESS in 0.563 seconds
[0m13:52:37.114143 [debug] [ThreadPool]: On list_integrity-db: Close
[0m13:52:37.115515 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m13:52:37.120565 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:52:37.121565 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m13:52:37.121565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:37.121565 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:37.121565 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:37.524428 [debug] [ThreadPool]: SQL status: SUCCESS in 0.403 seconds
[0m13:52:37.525374 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m13:52:37.526371 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m13:52:37.636985 [debug] [ThreadPool]: SQL status: SUCCESS in 0.109 seconds
[0m13:52:37.639947 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m13:52:37.717527 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m13:52:37.730559 [debug] [MainThread]: Using redshift connection "master"
[0m13:52:37.730559 [debug] [MainThread]: On master: BEGIN
[0m13:52:37.731558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:37.731558 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:37.732540 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:38.161893 [debug] [MainThread]: SQL status: SUCCESS in 0.430 seconds
[0m13:52:38.162924 [debug] [MainThread]: Using redshift connection "master"
[0m13:52:38.163907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:52:38.304342 [debug] [MainThread]: SQL status: SUCCESS in 0.139 seconds
[0m13:52:38.307328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBAC1D00>]}
[0m13:52:38.308329 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:38.393175 [debug] [MainThread]: Using redshift connection "master"
[0m13:52:38.394137 [debug] [MainThread]: On master: BEGIN
[0m13:52:38.434706 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m13:52:38.435760 [debug] [MainThread]: On master: COMMIT
[0m13:52:38.436754 [debug] [MainThread]: Using redshift connection "master"
[0m13:52:38.436754 [debug] [MainThread]: On master: COMMIT
[0m13:52:38.516996 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m13:52:38.517964 [debug] [MainThread]: On master: Close
[0m13:52:38.517964 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:52:38.518966 [info ] [MainThread]: 
[0m13:52:38.530140 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m13:52:38.531136 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m13:52:38.531136 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m13:52:38.532135 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m13:52:38.533133 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m13:52:38.533133 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m13:52:38.533133 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m13:52:38.534133 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m13:52:38.534133 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m13:52:38.535134 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m13:52:38.535134 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m13:52:38.536134 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m13:52:38.536134 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m13:52:38.537134 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m13:52:38.537134 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m13:52:38.538133 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m13:52:38.538133 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m13:52:38.539134 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m13:52:38.539134 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m13:52:38.541155 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m13:52:38.541155 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m13:52:38.541155 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m13:52:38.542133 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m13:52:38.542133 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m13:52:38.542133 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m13:52:38.543134 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m13:52:38.545132 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m13:52:38.547133 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m13:52:38.548693 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m13:52:38.549692 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m13:52:38.551399 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m13:52:38.552399 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m13:52:38.553398 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m13:52:38.554398 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m13:52:38.555398 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m13:52:38.556399 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m13:52:38.557449 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m13:52:38.557449 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m13:52:38.558399 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m13:52:38.558399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m13:52:38.558399 [debug] [Thread-8 (]: Began running node model.redshift.stl_explain
[0m13:52:38.558399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m13:52:38.559594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m13:52:38.559594 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m13:52:38.559594 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m13:52:38.560598 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m13:52:38.560598 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m13:52:38.562813 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m13:52:38.563316 [debug] [Thread-8 (]: Began compiling node model.redshift.stl_explain
[0m13:52:38.564824 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m13:52:38.566836 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m13:52:38.566836 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m13:52:38.568836 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m13:52:38.568836 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m13:52:38.569836 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m13:52:38.570836 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m13:52:38.570836 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m13:52:38.571841 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m13:52:38.572836 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m13:52:38.572836 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m13:52:38.572836 [debug] [Thread-5 (]: Began running node model.redshift.stl_wlm_query
[0m13:52:38.573836 [debug] [Thread-8 (]: Finished running node model.redshift.stl_explain
[0m13:52:38.573836 [debug] [Thread-6 (]: Began running node model.redshift.stv_blocklist
[0m13:52:38.573836 [debug] [Thread-7 (]: Began running node model.redshift.stv_partitions
[0m13:52:38.574836 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m13:52:38.574836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m13:52:38.574836 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m13:52:38.575836 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m13:52:38.575836 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_wlm_query)
[0m13:52:38.575836 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m13:52:38.575836 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_blocklist)
[0m13:52:38.576837 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_partitions)
[0m13:52:38.576837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m13:52:38.576837 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m13:52:38.577836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.svv_diskusage)
[0m13:52:38.577836 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_wlm_query
[0m13:52:38.577836 [info ] [Thread-2 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m13:52:38.578837 [info ] [Thread-8 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m13:52:38.578837 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_blocklist
[0m13:52:38.578837 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_partitions
[0m13:52:38.578837 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m13:52:38.581397 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m13:52:38.582376 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m13:52:38.584378 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m13:52:38.584959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_admin_dependencies)
[0m13:52:38.584959 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m13:52:38.585984 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m13:52:38.586981 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m13:52:38.588982 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m13:52:38.590210 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m13:52:38.590210 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m13:52:38.590210 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m13:52:38.591209 [debug] [Thread-5 (]: Finished running node model.redshift.stl_wlm_query
[0m13:52:38.592232 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m13:52:38.592232 [debug] [Thread-6 (]: Finished running node model.redshift.stv_blocklist
[0m13:52:38.593209 [debug] [Thread-7 (]: Finished running node model.redshift.stv_partitions
[0m13:52:38.594209 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m13:52:38.594209 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:52:38.600225 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m13:52:38.601211 [debug] [Thread-5 (]: Began running node model.redshift.redshift_cost
[0m13:52:38.601211 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m13:52:38.606207 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:38.608305 [info ] [Thread-4 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m13:52:38.608305 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m13:52:38.609306 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m13:52:38.609306 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_table_stats
[0m13:52:38.610305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m13:52:38.610305 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_cost
[0m13:52:38.610305 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m13:52:38.633305 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m13:52:38.634953 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m13:52:38.634483 [info ] [Thread-6 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m13:52:38.639503 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m13:52:38.641522 [debug] [Thread-8 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:38.648504 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:38.649504 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m13:52:38.652503 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:38.652503 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_cost
[0m13:52:38.653505 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m13:52:38.655503 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:38.655503 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:52:38.669507 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m13:52:38.670652 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m13:52:38.670652 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:52:38.670652 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m13:52:38.671659 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:52:38.671659 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m13:52:38.672659 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:52:38.672659 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m13:52:38.675658 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:38.675658 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:38.676659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m13:52:38.676659 [debug] [Thread-8 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:38.679658 [debug] [Thread-6 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m13:52:38.680660 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:38.680660 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m13:52:38.680660 [debug] [Thread-8 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:38.683925 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:38.689744 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m13:52:38.697554 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:38.700555 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:52:38.702556 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:52:38.703583 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:52:38.703583 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m13:52:38.704556 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:52:38.705555 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:38.708555 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m13:52:38.709018 [debug] [Thread-6 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:38.711071 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:38.712038 [debug] [Thread-6 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:38.716035 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:38.717513 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:52:38.717513 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:38.718513 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:38.718513 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:39.141364 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.469 seconds
[0m13:52:39.142368 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:39.142368 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m13:52:39.150059 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.447 seconds
[0m13:52:39.151059 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:39.151059 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m13:52:39.154133 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.450 seconds
[0m13:52:39.155059 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:39.155059 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m13:52:39.189198 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.517 seconds
[0m13:52:39.190199 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:39.190199 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m13:52:39.201661 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.484 seconds
[0m13:52:39.202579 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:39.204575 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m13:52:39.345335 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.202 seconds
[0m13:52:39.354325 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:39.355325 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m13:52:39.367455 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.216 seconds
[0m13:52:39.373439 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:39.374438 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:52:39.393954 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.238 seconds
[0m13:52:39.396949 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:39.396949 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m13:52:39.397951 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.207 seconds
[0m13:52:39.400950 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:39.400950 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m13:52:39.432761 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.227 seconds
[0m13:52:39.436755 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:39.437754 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m13:52:39.472995 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.117 seconds
[0m13:52:39.479011 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:39.480013 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m13:52:39.492465 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m13:52:39.496452 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:39.496452 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m13:52:39.518284 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.120 seconds
[0m13:52:39.523340 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:39.524343 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m13:52:39.525275 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.124 seconds
[0m13:52:39.528298 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:39.529320 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m13:52:39.561899 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m13:52:39.568955 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:39.568955 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m13:52:39.597613 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.117 seconds
[0m13:52:39.615608 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:52:39.616610 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:39.616610 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:52:39.617583 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.121 seconds
[0m13:52:39.618666 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:52:39.619657 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:39.619657 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:52:39.654595 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.130 seconds
[0m13:52:39.656593 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:52:39.657591 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:39.657591 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.129 seconds
[0m13:52:39.658590 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:52:39.660590 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:52:39.661590 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:39.661590 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:52:39.700704 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.130 seconds
[0m13:52:39.753261 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:52:39.753261 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:39.753261 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:52:39.960033 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.343 seconds
[0m13:52:39.962023 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:39.962983 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.209 seconds
[0m13:52:39.963982 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.303 seconds
[0m13:52:39.965440 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.303 seconds
[0m13:52:39.966457 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:52:39.967106 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.347 seconds
[0m13:52:40.040157 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.071 seconds
[0m13:52:40.051195 [debug] [Thread-8 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m13:52:40.056169 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:40.056169 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m13:52:40.132786 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.075 seconds
[0m13:52:40.134837 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:52:40.136759 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:40.136759 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m13:52:40.233848 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.096 seconds
[0m13:52:40.235817 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m13:52:40.236774 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m13:52:40.276890 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.040 seconds
[0m13:52:40.280936 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:40.280936 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:52:40.361525 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:52:40.369530 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m13:52:40.370529 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:40.371527 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m13:52:40.452336 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:52:40.455293 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:52:40.455801 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:40.456811 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m13:52:40.573406 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.115 seconds
[0m13:52:40.576397 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m13:52:40.577354 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m13:52:40.616946 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m13:52:40.619945 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:40.620984 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:52:40.705951 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.083 seconds
[0m13:52:40.710992 [debug] [Thread-6 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m13:52:40.712977 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:40.713983 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m13:52:40.794355 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.079 seconds
[0m13:52:40.798352 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:52:40.799352 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:40.800352 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m13:52:40.902584 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.101 seconds
[0m13:52:40.903572 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m13:52:40.905571 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m13:52:40.942363 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.036 seconds
[0m13:52:40.944359 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:40.946356 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:52:41.023802 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:52:41.025799 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m13:52:41.026799 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:41.026799 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m13:52:41.105514 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.078 seconds
[0m13:52:41.106952 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:52:41.106952 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:41.107964 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m13:52:41.231035 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.123 seconds
[0m13:52:41.232961 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m13:52:41.232961 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m13:52:41.273047 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.038 seconds
[0m13:52:41.274047 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:41.274047 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:52:41.351596 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.077 seconds
[0m13:52:41.354611 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m13:52:41.355618 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:41.355618 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m13:52:41.431837 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.076 seconds
[0m13:52:41.433792 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:52:41.434838 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:41.435866 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m13:52:41.646928 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.211 seconds
[0m13:52:41.648926 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m13:52:41.649928 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m13:52:41.686406 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.035 seconds
[0m13:52:41.688420 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m13:52:41.689419 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m13:52:41.689820 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m13:52:41.690846 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m13:52:41.690846 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m13:52:41.765163 [debug] [Thread-8 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m13:52:41.766169 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: Close
[0m13:52:41.767169 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BD79792E0>]}
[0m13:52:41.768544 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBA97740>]}
[0m13:52:41.768544 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m13:52:41.769552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBD402C0>]}
[0m13:52:41.768544 [info ] [Thread-8 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.18s]
[0m13:52:41.769552 [info ] [Thread-6 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.12s]
[0m13:52:41.771748 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m13:52:41.771748 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m13:52:41.770743 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.09s]
[0m13:52:41.772748 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m13:52:41.773775 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m13:52:41.773775 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBD408C0>]}
[0m13:52:41.775148 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: Close
[0m13:52:41.773775 [info ] [Thread-4 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.16s]
[0m13:52:41.776190 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m13:52:41.776190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab52ca-f62a-427c-9785-6efccb39ea63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBBA9280>]}
[0m13:52:41.777621 [info ] [Thread-2 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.19s]
[0m13:52:41.777621 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m13:52:41.780626 [debug] [MainThread]: Using redshift connection "master"
[0m13:52:41.780626 [debug] [MainThread]: On master: BEGIN
[0m13:52:41.780626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:41.781627 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:52:41.781627 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:52:42.212318 [debug] [MainThread]: SQL status: SUCCESS in 0.431 seconds
[0m13:52:42.213340 [debug] [MainThread]: On master: COMMIT
[0m13:52:42.214338 [debug] [MainThread]: Using redshift connection "master"
[0m13:52:42.215337 [debug] [MainThread]: On master: COMMIT
[0m13:52:42.300288 [debug] [MainThread]: SQL status: SUCCESS in 0.084 seconds
[0m13:52:42.301286 [debug] [MainThread]: On master: Close
[0m13:52:42.303287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:42.304285 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m13:52:42.305326 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m13:52:42.305326 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m13:52:42.306309 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m13:52:42.306309 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m13:52:42.307447 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m13:52:42.307447 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m13:52:42.307447 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m13:52:42.308460 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m13:52:42.308460 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m13:52:42.309460 [info ] [MainThread]: 
[0m13:52:42.311461 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m13:52:42.313458 [debug] [MainThread]: Command end result
[0m13:52:42.339614 [info ] [MainThread]: 
[0m13:52:42.340620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:42.340620 [info ] [MainThread]: 
[0m13:52:42.340620 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:52:42.341620 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:42.341620 after 7.54 seconds
[0m13:52:42.342647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BD96D8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDA0814F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDBA99FD0>]}
[0m13:52:42.342647 [debug] [MainThread]: Flushing usage events
[0m14:08:27.678856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA479C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA1BB13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA47BBD10>]}


============================== 14:08:27.681893 | 150daeab-c70f-4134-8046-1254bccf4a28 ==============================
[0m14:08:27.681893 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:08:27.682987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:27.694530 [info ] [MainThread]: dbt version: 1.8.3
[0m14:08:27.695799 [info ] [MainThread]: python version: 3.12.4
[0m14:08:27.695799 [info ] [MainThread]: python path: C:\Development\IntegrityDBT\IntegrityDBT\Scripts\python.exe
[0m14:08:27.696856 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m14:08:27.794739 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:08:27.795628 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:08:27.827180 [info ] [MainThread]: Using profiles dir at C:\Users\seanm\.dbt
[0m14:08:27.828503 [info ] [MainThread]: Using profiles.yml file at C:\Users\seanm\.dbt\profiles.yml
[0m14:08:27.828503 [info ] [MainThread]: Using dbt_project.yml file at C:\Development\IntegrityDBT\dbt_project.yml
[0m14:08:27.830044 [info ] [MainThread]: adapter type: redshift
[0m14:08:27.830044 [info ] [MainThread]: adapter version: 1.8.1
[0m14:08:27.893206 [info ] [MainThread]: Configuration:
[0m14:08:27.893206 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:08:27.893206 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:08:27.894893 [info ] [MainThread]: Required dependencies:
[0m14:08:27.894893 [debug] [MainThread]: Executing "git --help"
[0m14:08:27.917975 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:08:27.919001 [debug] [MainThread]: STDERR: "b''"
[0m14:08:27.919001 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:08:27.919001 [info ] [MainThread]: Connection:
[0m14:08:27.920151 [info ] [MainThread]:   host: integrity-energy.cm7f5da54gqs.us-east-1.redshift.amazonaws.com
[0m14:08:27.920151 [info ] [MainThread]:   user: integrityadmin
[0m14:08:27.921162 [info ] [MainThread]:   port: 5439
[0m14:08:27.921162 [info ] [MainThread]:   database: integrity-db
[0m14:08:27.921162 [info ] [MainThread]:   method: database
[0m14:08:27.922163 [info ] [MainThread]:   cluster_id: None
[0m14:08:27.922163 [info ] [MainThread]:   iam_profile: None
[0m14:08:27.922163 [info ] [MainThread]:   schema: dbt
[0m14:08:27.922163 [info ] [MainThread]:   sslmode: prefer
[0m14:08:27.922163 [info ] [MainThread]:   region: None
[0m14:08:27.923492 [info ] [MainThread]:   sslmode: prefer
[0m14:08:27.923492 [info ] [MainThread]:   region: None
[0m14:08:27.924499 [info ] [MainThread]:   iam_profile: None
[0m14:08:27.924499 [info ] [MainThread]:   autocreate: False
[0m14:08:27.924499 [info ] [MainThread]:   db_groups: []
[0m14:08:27.924499 [info ] [MainThread]:   ra3_node: False
[0m14:08:27.925506 [info ] [MainThread]:   connect_timeout: None
[0m14:08:27.925506 [info ] [MainThread]:   role: None
[0m14:08:27.925506 [info ] [MainThread]:   retries: 1
[0m14:08:27.926654 [info ] [MainThread]:   autocommit: True
[0m14:08:27.926654 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:08:27.926654 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m14:08:27.930023 [debug] [MainThread]: Using redshift connection "debug"
[0m14:08:27.931238 [debug] [MainThread]: On debug: select 1 as id
[0m14:08:27.932249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:27.935013 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:08:27.935945 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:08:28.508437 [debug] [MainThread]: SQL status: SUCCESS in 0.577 seconds
[0m14:08:28.512365 [debug] [MainThread]: On debug: Close
[0m14:08:28.513365 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:08:28.515012 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:08:28.517943 [debug] [MainThread]: Command `dbt debug` succeeded at 14:08:28.517943 after 1.01 seconds
[0m14:08:28.518988 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:08:28.519943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA4678BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA479C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9EA0A720>]}
[0m14:08:28.519943 [debug] [MainThread]: Flushing usage events
[0m14:20:53.271866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF808D1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF808D0B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF808D0650>]}


============================== 14:20:53.275164 | f28d2063-b998-494b-b63e-575cf98a71df ==============================
[0m14:20:53.275164 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:20:53.276165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:53.378846 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:20:53.378846 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:20:53.486867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28d2063-b998-494b-b63e-575cf98a71df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF808D0B30>]}
[0m14:20:53.524043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28d2063-b998-494b-b63e-575cf98a71df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8074E300>]}
[0m14:20:53.525004 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:20:53.546641 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:20:53.662177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:53.663181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:53.667165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:20:53.680200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28d2063-b998-494b-b63e-575cf98a71df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8131AF60>]}
[0m14:20:53.726602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28d2063-b998-494b-b63e-575cf98a71df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8237FBF0>]}
[0m14:20:53.726602 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:20:53.727843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28d2063-b998-494b-b63e-575cf98a71df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFFF7C920>]}
[0m14:20:53.728879 [info ] [MainThread]: 
[0m14:20:53.730539 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:20:53.733465 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:20:53.745056 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:20:53.746083 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:20:53.746083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:53.749085 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:20:53.749085 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:20:54.331447 [debug] [ThreadPool]: SQL status: SUCCESS in 0.586 seconds
[0m14:20:54.332456 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:20:54.332456 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:20:54.469747 [debug] [ThreadPool]: SQL status: SUCCESS in 0.136 seconds
[0m14:20:54.474279 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:20:54.547839 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:20:54.560986 [debug] [MainThread]: Using redshift connection "master"
[0m14:20:54.560986 [debug] [MainThread]: On master: BEGIN
[0m14:20:54.561992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:54.561992 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:20:54.562991 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:20:55.026934 [debug] [MainThread]: SQL status: SUCCESS in 0.465 seconds
[0m14:20:55.027956 [debug] [MainThread]: Using redshift connection "master"
[0m14:20:55.027956 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:20:55.211500 [debug] [MainThread]: SQL status: SUCCESS in 0.183 seconds
[0m14:20:55.215500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28d2063-b998-494b-b63e-575cf98a71df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFFD4E480>]}
[0m14:20:55.216610 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:55.297140 [debug] [MainThread]: On master: Close
[0m14:20:55.299164 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:20:55.300677 [info ] [MainThread]: 
[0m14:20:55.308281 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:20:55.308281 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:20:55.308281 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:20:55.309283 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:20:55.309283 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:20:55.309283 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:20:55.310820 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:20:55.310820 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:20:55.311351 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:20:55.311351 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:20:55.311351 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:20:55.312439 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:20:55.312439 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:20:55.312439 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:20:55.313868 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:20:55.313868 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:20:55.313868 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:20:55.313868 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:20:55.313868 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:20:55.315205 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:20:55.315205 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:20:55.315205 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:20:55.316654 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:20:55.317667 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:20:55.318664 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:20:55.318664 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:20:55.320949 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:20:55.321903 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:20:55.322907 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:20:55.323922 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:20:55.327916 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:20:55.328915 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:20:55.334591 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:20:55.331879 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:20:55.331879 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:20:55.333366 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:20:55.333366 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:20:55.330941 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:20:55.335605 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:20:55.335605 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:20:55.336605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:20:55.336605 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:20:55.337606 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:20:55.337606 [debug] [Thread-5 (]: Began running node model.redshift.stl_explain
[0m14:20:55.337606 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:20:55.338603 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:20:55.338603 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:20:55.339604 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:20:55.339604 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:20:55.339604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:20:55.339604 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:20:55.340604 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_explain)
[0m14:20:55.341111 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m14:20:55.341111 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:20:55.341617 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:20:55.341617 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:20:55.344595 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:20:55.344595 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:20:55.344595 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:20:55.344595 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_explain
[0m14:20:55.345571 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:20:55.345571 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:20:55.345571 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:20:55.346579 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:20:55.348597 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:20:55.350590 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:20:55.350590 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:20:55.351949 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:20:55.352947 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:20:55.353968 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:20:55.354983 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:20:55.355968 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:20:55.356947 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:20:55.356947 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:20:55.357957 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:20:55.357957 [debug] [Thread-5 (]: Finished running node model.redshift.stl_explain
[0m14:20:55.358963 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:20:55.360474 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:20:55.360474 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:20:55.361484 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:20:55.361484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:20:55.361484 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:20:55.361484 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:20:55.362849 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:20:55.362849 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:20:55.363861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:20:55.363861 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:20:55.364864 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:20:55.364864 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:20:55.365766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:20:55.365766 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:20:55.365766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:20:55.366789 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:20:55.366789 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:20:55.368788 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:20:55.368788 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:20:55.369789 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:20:55.369789 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:20:55.371291 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:20:55.371291 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:20:55.376321 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:20:55.381810 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:20:55.382817 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:20:55.389831 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:20:55.395882 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:20:55.395882 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:20:55.396866 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:20:55.397866 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:20:55.397866 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:20:55.398866 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:20:55.398866 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:20:55.398866 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:20:55.398866 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:20:55.400400 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:20:55.401417 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:20:55.402418 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:20:55.403418 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:20:55.403418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:20:55.418694 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:20:55.419712 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:20:55.425205 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:20:55.426207 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:20:55.426207 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:20:55.427207 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:20:55.427207 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:20:55.428207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:55.428207 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:20:55.429233 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:20:55.430769 [debug] [MainThread]: Command end result
[0m14:20:55.497518 [debug] [MainThread]: Command `dbt compile` succeeded at 14:20:55.496559 after 2.36 seconds
[0m14:20:55.497518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8040BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF825CBCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF825CBE00>]}
[0m14:20:55.497518 [debug] [MainThread]: Flushing usage events
[0m14:23:42.391039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2826C6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F285BE5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F285DEB680>]}


============================== 14:23:42.394052 | c3ead6bd-5a41-4495-bc09-e4ce2c893375 ==============================
[0m14:23:42.394052 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:23:42.394052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m14:23:42.488991 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:23:42.488991 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:23:42.592889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3ead6bd-5a41-4495-bc09-e4ce2c893375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F286995BE0>]}
[0m14:23:42.630504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3ead6bd-5a41-4495-bc09-e4ce2c893375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28573AB70>]}
[0m14:23:42.631505 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:23:42.649490 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:23:42.742019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:42.743019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:42.746019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:23:42.759002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3ead6bd-5a41-4495-bc09-e4ce2c893375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F286A16FF0>]}
[0m14:23:42.803589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3ead6bd-5a41-4495-bc09-e4ce2c893375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F287A8BFB0>]}
[0m14:23:42.803589 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:23:42.804442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ead6bd-5a41-4495-bc09-e4ce2c893375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28567C950>]}
[0m14:23:42.805697 [info ] [MainThread]: 
[0m14:23:42.806707 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:23:42.809006 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:23:42.820012 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:23:42.821013 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:23:42.821013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:42.823971 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:23:42.824970 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:23:43.403967 [debug] [ThreadPool]: SQL status: SUCCESS in 0.583 seconds
[0m14:23:43.405025 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:23:43.406039 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:23:43.523048 [debug] [ThreadPool]: SQL status: SUCCESS in 0.115 seconds
[0m14:23:43.528033 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:23:43.604799 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:23:43.619785 [debug] [MainThread]: Using redshift connection "master"
[0m14:23:43.619785 [debug] [MainThread]: On master: BEGIN
[0m14:23:43.619785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:43.620784 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:23:43.620784 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:23:44.063828 [debug] [MainThread]: SQL status: SUCCESS in 0.443 seconds
[0m14:23:44.064893 [debug] [MainThread]: Using redshift connection "master"
[0m14:23:44.065913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:23:44.203847 [debug] [MainThread]: SQL status: SUCCESS in 0.137 seconds
[0m14:23:44.207836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ead6bd-5a41-4495-bc09-e4ce2c893375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F287CCFFB0>]}
[0m14:23:44.209840 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:44.292799 [debug] [MainThread]: On master: Close
[0m14:23:44.293852 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:23:44.295816 [info ] [MainThread]: 
[0m14:23:44.304811 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:23:44.305814 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:23:44.305814 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:23:44.305814 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:23:44.306810 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:23:44.306810 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:23:44.307809 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:23:44.307809 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:23:44.307809 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:23:44.308808 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:23:44.308808 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:23:44.309708 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:23:44.309708 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:23:44.310731 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:23:44.310731 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:23:44.310731 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:23:44.311729 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:23:44.311729 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:23:44.311729 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:23:44.312729 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:23:44.312729 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:23:44.312729 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:23:44.313729 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:23:44.314746 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:23:44.314746 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:23:44.315730 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:23:44.317729 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:23:44.318729 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:23:44.320729 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:23:44.321762 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:23:44.323746 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:23:44.325746 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:23:44.326731 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:23:44.327731 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:23:44.328729 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:23:44.328729 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:23:44.329730 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:23:44.330729 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:23:44.330729 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:23:44.331730 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:23:44.331730 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:23:44.331730 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:23:44.332730 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m14:23:44.333730 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:23:44.333730 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:23:44.333730 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:23:44.334731 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:23:44.334731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:23:44.335730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_sort_dist_keys)
[0m14:23:44.335730 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:23:44.335730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_tables)
[0m14:23:44.335730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:23:44.336730 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:23:44.336730 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:23:44.336730 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:23:44.337730 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:23:44.337730 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:23:44.337730 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:23:44.338729 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m14:23:44.338729 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:23:44.338729 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:23:44.338729 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:23:44.339730 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:23:44.341729 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:23:44.343730 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:23:44.344729 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:23:44.346729 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:23:44.347757 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:23:44.349730 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:23:44.350758 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:23:44.351731 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:23:44.353732 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:23:44.354746 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:23:44.355730 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m14:23:44.355730 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:23:44.356731 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:23:44.356731 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:23:44.357730 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:23:44.358730 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:23:44.358730 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:23:44.358730 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:23:44.359730 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:23:44.359730 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:23:44.360729 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:23:44.360729 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:23:44.360729 [debug] [Thread-7 (]: Began running node model.redshift.redshift_cost
[0m14:23:44.361730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:23:44.361730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.svv_diskusage)
[0m14:23:44.362729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_admin_dependencies)
[0m14:23:44.362729 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:23:44.363730 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:23:44.363730 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_cost)
[0m14:23:44.363730 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:23:44.363730 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:23:44.364730 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:23:44.364730 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:23:44.364730 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:23:44.365730 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_cost
[0m14:23:44.367729 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:23:44.369417 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:23:44.373680 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:23:44.378685 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:23:44.384680 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:23:44.389238 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:23:44.390245 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:23:44.391239 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:23:44.391239 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:23:44.392240 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:23:44.393240 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_cost
[0m14:23:44.393240 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:23:44.394240 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:23:44.394240 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:23:44.395239 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:23:44.396239 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:23:44.396239 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_table_stats)
[0m14:23:44.397239 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_queries
[0m14:23:44.397239 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:23:44.397239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_queries)
[0m14:23:44.412267 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:23:44.413256 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:23:44.418238 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:23:44.419241 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:23:44.419241 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:23:44.420240 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:23:44.420240 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:23:44.421407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'model.redshift.stv_tbl_perm' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:23:44.422420 [debug] [MainThread]: Connection 'model.redshift.stl_wlm_query' was properly closed.
[0m14:23:44.423802 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:23:44.423802 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:23:44.423802 [debug] [MainThread]: Command end result
[0m14:23:44.484934 [debug] [MainThread]: Command `dbt compile` succeeded at 14:23:44.484934 after 2.22 seconds
[0m14:23:44.484934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2826C6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2856E24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2856E1BE0>]}
[0m14:23:44.485913 [debug] [MainThread]: Flushing usage events
[0m14:24:50.331552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342ADA9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342B1FDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342B1FEFF0>]}


============================== 14:24:50.334998 | 16b3fddd-8df5-4d16-8d61-5306364f6fa8 ==============================
[0m14:24:50.334998 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:24:50.335557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:50.434013 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:24:50.435517 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:24:50.535560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b3fddd-8df5-4d16-8d61-5306364f6fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342C2D9340>]}
[0m14:24:50.571062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b3fddd-8df5-4d16-8d61-5306364f6fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342B779B80>]}
[0m14:24:50.572811 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:24:50.590926 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:24:50.688268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:50.689272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:50.693271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:24:50.705594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b3fddd-8df5-4d16-8d61-5306364f6fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342C508080>]}
[0m14:24:50.752230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b3fddd-8df5-4d16-8d61-5306364f6fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342D56BFB0>]}
[0m14:24:50.753188 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:24:50.754187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b3fddd-8df5-4d16-8d61-5306364f6fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342B1BCA70>]}
[0m14:24:50.759702 [info ] [MainThread]: 
[0m14:24:50.760700 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:24:50.763691 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:24:50.774498 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:24:50.775498 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:24:50.775498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:50.779041 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:24:50.779041 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:24:51.359625 [debug] [ThreadPool]: SQL status: SUCCESS in 0.583 seconds
[0m14:24:51.360622 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:24:51.361624 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:24:51.474106 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m14:24:51.478620 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:24:51.560417 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:24:51.572185 [debug] [MainThread]: Using redshift connection "master"
[0m14:24:51.573117 [debug] [MainThread]: On master: BEGIN
[0m14:24:51.573117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:51.573117 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:24:51.573117 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:24:52.013175 [debug] [MainThread]: SQL status: SUCCESS in 0.440 seconds
[0m14:24:52.014168 [debug] [MainThread]: Using redshift connection "master"
[0m14:24:52.015169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:24:52.153302 [debug] [MainThread]: SQL status: SUCCESS in 0.137 seconds
[0m14:24:52.155322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b3fddd-8df5-4d16-8d61-5306364f6fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342C5498E0>]}
[0m14:24:52.155322 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:52.235798 [debug] [MainThread]: On master: Close
[0m14:24:52.238483 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:24:52.239475 [info ] [MainThread]: 
[0m14:24:52.246468 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:24:52.246468 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:24:52.247469 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:24:52.247973 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:24:52.248980 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:24:52.248980 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:24:52.248980 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:24:52.249978 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:24:52.249978 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:24:52.250979 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:24:52.250979 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:24:52.251979 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:24:52.251979 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:24:52.251979 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:24:52.252985 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:24:52.252985 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:24:52.252985 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:24:52.253978 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:24:52.253978 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:24:52.255250 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:24:52.255250 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:24:52.256254 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:24:52.256254 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:24:52.257255 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:24:52.257255 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:24:52.258408 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:24:52.259407 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:24:52.260408 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:24:52.261255 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:24:52.262304 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:24:52.263300 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:24:52.264272 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:24:52.266272 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:24:52.269436 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:24:52.270436 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:24:52.270436 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:24:52.271438 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:24:52.272436 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:24:52.272436 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:24:52.272436 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:24:52.273437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:24:52.274436 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:24:52.274436 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:24:52.274436 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:24:52.275436 [debug] [Thread-5 (]: Began running node model.redshift.stl_explain
[0m14:24:52.275436 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:24:52.275436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:24:52.276436 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:24:52.276436 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:24:52.276436 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:24:52.277436 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:24:52.277436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:24:52.277436 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_explain)
[0m14:24:52.277436 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m14:24:52.278686 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:24:52.278686 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:24:52.281686 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:24:52.281686 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:24:52.282686 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:24:52.282686 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:24:52.282686 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_explain
[0m14:24:52.282686 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:24:52.284686 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:24:52.285686 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:24:52.285686 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:24:52.285686 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:24:52.285686 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:24:52.289195 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:24:52.290196 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:24:52.291196 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:24:52.292860 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:24:52.293858 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:24:52.294129 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:24:52.295181 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:24:52.295181 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:24:52.296152 [debug] [Thread-5 (]: Finished running node model.redshift.stl_explain
[0m14:24:52.297152 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:24:52.297655 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:24:52.298659 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:24:52.299661 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:24:52.299661 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:24:52.300659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:24:52.300659 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:24:52.301660 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:24:52.301660 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:24:52.301660 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:24:52.302660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:24:52.302660 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:24:52.302660 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:24:52.303660 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_dependencies)
[0m14:24:52.303660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:24:52.303660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:24:52.304660 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:24:52.304660 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:24:52.307163 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:24:52.307163 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:24:52.307163 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:24:52.308167 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:24:52.309167 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:24:52.309167 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:24:52.314184 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:24:52.319695 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:24:52.320675 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:24:52.325723 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:24:52.332332 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:24:52.332332 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:24:52.333334 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:24:52.334334 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:24:52.335334 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:24:52.335334 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:24:52.336333 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:24:52.336333 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:24:52.337334 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:24:52.337334 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:24:52.337334 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:24:52.338635 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:24:52.339634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:24:52.339634 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:24:52.339634 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:24:52.356211 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:24:52.361712 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:24:52.362733 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:24:52.362733 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:24:52.363738 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:24:52.364738 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:24:52.365894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:52.365894 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:24:52.365894 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:24:52.365894 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:24:52.365894 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:24:52.365894 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:24:52.367403 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:24:52.367403 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:24:52.367403 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:24:52.367403 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:24:52.368412 [debug] [MainThread]: Command end result
[0m14:24:52.425849 [debug] [MainThread]: Command `dbt compile` succeeded at 14:24:52.425849 after 2.23 seconds
[0m14:24:52.427394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342ADA9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342B625EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001342B624C80>]}
[0m14:24:52.427394 [debug] [MainThread]: Flushing usage events
[0m14:25:02.050009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711ACE9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711D3B9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711CD47CB0>]}


============================== 14:25:02.054496 | ad038f60-a71c-46d0-aafa-d251a0772f5c ==============================
[0m14:25:02.054496 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:25:02.055756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:02.149755 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:25:02.149755 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:25:02.246138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad038f60-a71c-46d0-aafa-d251a0772f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711E07DBE0>]}
[0m14:25:02.279588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad038f60-a71c-46d0-aafa-d251a0772f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711D948E30>]}
[0m14:25:02.281041 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:25:02.298655 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:25:02.389223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:02.390224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:02.393223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:25:02.406223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad038f60-a71c-46d0-aafa-d251a0772f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711F107B00>]}
[0m14:25:02.452986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad038f60-a71c-46d0-aafa-d251a0772f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711F3EC0B0>]}
[0m14:25:02.452986 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:25:02.454429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad038f60-a71c-46d0-aafa-d251a0772f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711E07C530>]}
[0m14:25:02.457434 [info ] [MainThread]: 
[0m14:25:02.457434 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:25:02.460453 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:25:02.474144 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:25:02.475159 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:25:02.475159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:02.478152 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:25:02.479132 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:25:03.012587 [debug] [ThreadPool]: SQL status: SUCCESS in 0.537 seconds
[0m14:25:03.013587 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:25:03.013587 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:25:03.131203 [debug] [ThreadPool]: SQL status: SUCCESS in 0.117 seconds
[0m14:25:03.136262 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:25:03.215038 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:25:03.227027 [debug] [MainThread]: Using redshift connection "master"
[0m14:25:03.228027 [debug] [MainThread]: On master: BEGIN
[0m14:25:03.228027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:03.229029 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:25:03.229029 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:25:03.688129 [debug] [MainThread]: SQL status: SUCCESS in 0.459 seconds
[0m14:25:03.689121 [debug] [MainThread]: Using redshift connection "master"
[0m14:25:03.691120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:25:03.827153 [debug] [MainThread]: SQL status: SUCCESS in 0.136 seconds
[0m14:25:03.828188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad038f60-a71c-46d0-aafa-d251a0772f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711E07D370>]}
[0m14:25:03.829185 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:03.912996 [debug] [MainThread]: On master: Close
[0m14:25:03.914995 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:25:03.916988 [info ] [MainThread]: 
[0m14:25:03.925269 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:25:03.926268 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:25:03.926268 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:25:03.927268 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:25:03.927268 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:25:03.928267 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:25:03.928267 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:25:03.928267 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:25:03.929267 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:25:03.929267 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:25:03.930268 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:25:03.931268 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:25:03.932267 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:25:03.932267 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:25:03.933267 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:25:03.933267 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:25:03.933267 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:25:03.934267 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:25:03.934267 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:25:03.934267 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:25:03.935266 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:25:03.936291 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:25:03.936291 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:25:03.937266 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:25:03.937266 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:25:03.938266 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:25:03.939267 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:25:03.940270 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:25:03.942296 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:25:03.943272 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:25:03.945271 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:25:03.945271 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:25:03.948273 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:25:03.949271 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:25:03.950271 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:25:03.951271 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:25:03.951271 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:25:03.951271 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:25:03.952273 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:25:03.952273 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:25:03.953301 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:25:03.953301 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:25:03.953301 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:25:03.954814 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:25:03.954814 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:25:03.954814 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:25:03.955819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:25:03.955819 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:25:03.955819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:25:03.956819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:25:03.956819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:25:03.956819 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:25:03.957819 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:25:03.957819 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:25:03.958819 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:25:03.958819 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:25:03.958819 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:25:03.959819 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:25:03.959819 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:25:03.959819 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:25:03.959819 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:25:03.960819 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:25:03.962837 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:25:03.962837 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:25:03.965498 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:25:03.966498 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:25:03.968543 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:25:03.968543 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:25:03.969452 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:25:03.970467 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:25:03.971465 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:25:03.972455 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:25:03.973452 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:25:03.974464 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:25:03.975451 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:25:03.975451 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:25:03.976451 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:25:03.976451 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:25:03.976451 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:25:03.977456 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:25:03.978451 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:25:03.978451 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:25:03.978451 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:03.979454 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:25:03.979454 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:03.979454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:25:03.980457 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:25:03.980457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:25:03.981452 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_dependencies)
[0m14:25:03.981452 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:25:03.981452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:25:03.982450 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:25:03.982450 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:25:03.982450 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:25:03.983450 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:25:03.983450 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:03.983450 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:03.985474 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:25:03.986469 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:25:03.987480 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:25:03.992473 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:25:03.997467 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:25:04.003800 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:25:04.008817 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:25:04.009765 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:25:04.009765 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:25:04.010765 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:25:04.011766 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:04.011766 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:04.012765 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:25:04.012765 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:25:04.013765 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:25:04.013765 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:04.014765 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:04.014765 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:25:04.014765 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:25:04.015764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:25:04.015764 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:25:04.016765 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:25:04.030763 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:25:04.035803 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:25:04.038091 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:25:04.038091 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:25:04.039363 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:25:04.039817 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:25:04.041776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:04.041776 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:25:04.042776 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:25:04.042776 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:25:04.042776 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:25:04.042776 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:25:04.042776 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:25:04.042776 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:25:04.043776 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:25:04.043776 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:25:04.043776 [debug] [MainThread]: Command end result
[0m14:25:04.105502 [debug] [MainThread]: Command `dbt compile` succeeded at 14:25:04.105502 after 2.16 seconds
[0m14:25:04.105502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711D7E2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711D2F2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711D2F2DB0>]}
[0m14:25:04.106502 [debug] [MainThread]: Flushing usage events
[0m14:25:52.852246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C36ECE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C36ECEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C36ECFE30>]}


============================== 14:25:52.855255 | 0ff91527-44a9-4c28-9714-8045b3f87e8a ==============================
[0m14:25:52.855255 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:25:52.856256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m14:25:52.951034 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:25:52.951034 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:25:53.048608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ff91527-44a9-4c28-9714-8045b3f87e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C3811EC90>]}
[0m14:25:53.084592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ff91527-44a9-4c28-9714-8045b3f87e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C352854F0>]}
[0m14:25:53.085599 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:25:53.103597 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:25:53.196280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:53.197308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:53.200311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:25:53.212865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ff91527-44a9-4c28-9714-8045b3f87e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C3813C170>]}
[0m14:25:53.258947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ff91527-44a9-4c28-9714-8045b3f87e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C3944C170>]}
[0m14:25:53.258947 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:25:53.259947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ff91527-44a9-4c28-9714-8045b3f87e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C36E8C8C0>]}
[0m14:25:53.260953 [info ] [MainThread]: 
[0m14:25:53.261952 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:25:53.264947 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:25:53.274946 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:25:53.275947 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:25:53.275947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:53.278947 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:25:53.279947 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:25:54.007855 [debug] [ThreadPool]: SQL status: SUCCESS in 0.731 seconds
[0m14:25:54.008857 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:25:54.009853 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:25:54.123424 [debug] [ThreadPool]: SQL status: SUCCESS in 0.113 seconds
[0m14:25:54.127409 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:25:54.269869 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:25:54.282851 [debug] [MainThread]: Using redshift connection "master"
[0m14:25:54.283853 [debug] [MainThread]: On master: BEGIN
[0m14:25:54.283853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:54.283853 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:25:54.284852 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:25:54.990213 [debug] [MainThread]: SQL status: SUCCESS in 0.706 seconds
[0m14:25:54.991208 [debug] [MainThread]: Using redshift connection "master"
[0m14:25:54.993212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:25:55.136290 [debug] [MainThread]: SQL status: SUCCESS in 0.142 seconds
[0m14:25:55.138288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ff91527-44a9-4c28-9714-8045b3f87e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C3813F350>]}
[0m14:25:55.138288 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:55.251784 [debug] [MainThread]: On master: Close
[0m14:25:55.253788 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:25:55.255782 [info ] [MainThread]: 
[0m14:25:55.268315 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:25:55.269330 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:25:55.270315 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:25:55.270315 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:25:55.271321 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:25:55.272346 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:25:55.272346 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:25:55.273343 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:25:55.273343 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:25:55.274315 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:25:55.274315 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:25:55.275813 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:25:55.275813 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:25:55.277122 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:25:55.277122 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:25:55.277876 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:25:55.277876 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:25:55.278883 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:25:55.278883 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:25:55.278883 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:25:55.281882 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:25:55.282882 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:25:55.282882 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:25:55.282882 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:25:55.283882 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:25:55.284941 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:25:55.285885 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:25:55.286882 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:25:55.288837 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:25:55.289868 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:25:55.289868 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:25:55.292853 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:25:55.294853 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:25:55.295837 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:25:55.295837 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:25:55.296836 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:25:55.297836 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:25:55.298836 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:25:55.298836 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:25:55.299841 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:25:55.299841 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:25:55.300840 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:25:55.300840 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:25:55.301841 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:25:55.302306 [debug] [Thread-6 (]: Began running node model.redshift.stl_query
[0m14:25:55.302811 [debug] [Thread-5 (]: Began running node model.redshift.stl_wlm_query
[0m14:25:55.302811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:25:55.302811 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:25:55.303817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:25:55.303817 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:25:55.303817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:25:55.304817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:25:55.304817 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_query)
[0m14:25:55.304817 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_wlm_query)
[0m14:25:55.304817 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:25:55.305816 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:25:55.305816 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:25:55.305816 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:25:55.306816 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:25:55.306816 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:25:55.306816 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_query
[0m14:25:55.306816 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:25:55.309816 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:25:55.309816 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:25:55.311815 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:25:55.311815 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:25:55.314321 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:25:55.315328 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:25:55.316326 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:25:55.317034 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:25:55.319056 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:25:55.319056 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:25:55.320055 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:25:55.321083 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:25:55.321083 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:25:55.322056 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:25:55.323055 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:25:55.323055 [debug] [Thread-5 (]: Finished running node model.redshift.stl_wlm_query
[0m14:25:55.324056 [debug] [Thread-6 (]: Finished running node model.redshift.stl_query
[0m14:25:55.324056 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:25:55.324056 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:25:55.325054 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:25:55.325054 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:25:55.326054 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:55.326054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:25:55.326054 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:55.327055 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:25:55.327055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:25:55.328055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:25:55.328055 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:25:55.328055 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:25:55.328055 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:25:55.329055 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_cost)
[0m14:25:55.329055 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:25:55.329055 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:25:55.330055 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:55.332056 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:25:55.332056 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:55.333056 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:25:55.334082 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:25:55.339053 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:25:55.344077 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:25:55.345068 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:25:55.351078 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:25:55.356053 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:25:55.357055 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:25:55.357055 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:25:55.358054 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:55.359081 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:55.359081 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:25:55.360056 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:25:55.360056 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:25:55.361055 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:25:55.362055 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:25:55.362055 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:25:55.363055 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:25:55.364055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:25:55.364055 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:25:55.364638 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:25:55.379660 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:25:55.385660 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:25:55.385660 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:25:55.386646 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:25:55.386646 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:25:55.387645 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:25:55.388644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:55.389643 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:25:55.389643 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:25:55.389643 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:25:55.389643 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:25:55.389643 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:25:55.390644 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:25:55.390644 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:25:55.390644 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:25:55.391643 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:25:55.391643 [debug] [MainThread]: Command end result
[0m14:25:55.456855 [debug] [MainThread]: Command `dbt compile` succeeded at 14:25:55.455855 after 2.72 seconds
[0m14:25:55.456855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C37597890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C375977D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C37F58DD0>]}
[0m14:25:55.456855 [debug] [MainThread]: Flushing usage events
[0m14:26:53.648740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E495C74B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4958A71A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4958A45C0>]}


============================== 14:26:53.651792 | 378a1bc6-d56d-4fee-a86a-0073fb0e314b ==============================
[0m14:26:53.651792 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:53.652793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:53.721409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '378a1bc6-d56d-4fee-a86a-0073fb0e314b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E49395B3B0>]}
[0m14:26:53.779857 [debug] [MainThread]: Command `dbt clean` succeeded at 14:26:53.779857 after 0.27 seconds
[0m14:26:53.779857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E495DC5AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4952F0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4952F2DE0>]}
[0m14:26:53.780858 [debug] [MainThread]: Flushing usage events
[0m14:26:57.692581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874650F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018749927E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018749926660>]}


============================== 14:26:57.698586 | 68ff7ef2-d2a4-42f2-bf24-06e2d1be8228 ==============================
[0m14:26:57.698586 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:57.699562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:57.768654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68ff7ef2-d2a4-42f2-bf24-06e2d1be8228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A2F0E90>]}
[0m14:26:57.790432 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-dsj42b5v'
[0m14:26:57.790432 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:26:57.945162 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:26:57.947115 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:26:58.015843 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:26:58.021461 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m14:26:58.135911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m14:26:58.138914 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m14:26:58.207819 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m14:26:58.210788 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m14:26:58.282296 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m14:26:58.285286 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:26:58.604861 [info ] [MainThread]: Installed from version 1.0.0
[0m14:26:58.604861 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:26:58.605861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68ff7ef2-d2a4-42f2-bf24-06e2d1be8228', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A54C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A352E10>]}
[0m14:26:58.605861 [info ] [MainThread]: Installing dbt-labs/redshift
[0m14:26:58.887466 [info ] [MainThread]: Installed from version 0.9.0
[0m14:26:58.888465 [info ] [MainThread]: Up to date!
[0m14:26:58.888465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68ff7ef2-d2a4-42f2-bf24-06e2d1be8228', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A5F5B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A5F57F0>]}
[0m14:26:58.889466 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m14:26:59.298193 [info ] [MainThread]: Installed from version 0.8.2
[0m14:26:59.299199 [info ] [MainThread]: Updated version available: 0.9.0
[0m14:26:59.299199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68ff7ef2-d2a4-42f2-bf24-06e2d1be8228', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018749343B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018749343E90>]}
[0m14:26:59.300194 [info ] [MainThread]: Installing dbt-labs/codegen
[0m14:26:59.486382 [info ] [MainThread]: Installed from version 0.9.0
[0m14:26:59.487383 [info ] [MainThread]: Updated version available: 0.12.1
[0m14:26:59.487383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68ff7ef2-d2a4-42f2-bf24-06e2d1be8228', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A5F5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874A5F5820>]}
[0m14:26:59.487383 [info ] [MainThread]: 
[0m14:26:59.488382 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m14:26:59.490383 [debug] [MainThread]: Command `dbt deps` succeeded at 14:26:59.489383 after 1.91 seconds
[0m14:26:59.490383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874650F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187498A5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018749E2EA20>]}
[0m14:26:59.490383 [debug] [MainThread]: Flushing usage events
[0m14:27:14.716978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA9C81940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA8209250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAAAAE9F0>]}


============================== 14:27:14.720998 | 27babf55-fff5-4275-8df5-2cc60089c199 ==============================
[0m14:27:14.720998 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:27:14.721958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:14.843744 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:27:14.844730 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:27:14.959667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAA84DCD0>]}
[0m14:27:14.993199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAADC6300>]}
[0m14:27:14.994204 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:27:15.030047 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:27:15.030047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:27:15.031048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAB5AD5B0>]}
[0m14:27:16.225163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:27:16.230240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAC709B80>]}
[0m14:27:16.285432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAC82F050>]}
[0m14:27:16.285432 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:27:16.286433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAA3208C0>]}
[0m14:27:16.288486 [info ] [MainThread]: 
[0m14:27:16.289450 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:27:16.292495 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:27:16.304009 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:27:16.305074 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:27:16.305074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:16.307050 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:16.308046 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:16.895912 [debug] [ThreadPool]: SQL status: SUCCESS in 0.589 seconds
[0m14:27:16.896903 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:27:16.897906 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:27:17.010045 [debug] [ThreadPool]: SQL status: SUCCESS in 0.111 seconds
[0m14:27:17.014093 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:27:17.096958 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:27:17.102974 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:17.102974 [debug] [MainThread]: On master: BEGIN
[0m14:27:17.102974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:17.103911 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:17.103911 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:17.545639 [debug] [MainThread]: SQL status: SUCCESS in 0.442 seconds
[0m14:27:17.546653 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:17.546653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:27:17.692383 [debug] [MainThread]: SQL status: SUCCESS in 0.145 seconds
[0m14:27:17.693382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27babf55-fff5-4275-8df5-2cc60089c199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAC7890D0>]}
[0m14:27:17.694382 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:17.776004 [debug] [MainThread]: On master: Close
[0m14:27:17.778984 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:27:17.779947 [info ] [MainThread]: 
[0m14:27:17.792994 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:27:17.793995 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:27:17.793995 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:27:17.794996 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:27:17.794996 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:27:17.795995 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:27:17.797085 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:27:17.797085 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:27:17.798074 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:27:17.798074 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:27:17.799094 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:27:17.800075 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:27:17.800075 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:27:17.801074 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:27:17.802072 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:27:17.802072 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:27:17.803074 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:27:17.803074 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:27:17.804073 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:27:17.804073 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:27:17.805072 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:27:17.806072 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:27:17.807071 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:27:17.807071 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:27:17.807071 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:27:17.808071 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:27:17.810097 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:27:17.811071 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:27:17.812402 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:27:17.816055 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:27:17.817055 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:27:17.819176 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:27:17.820165 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:27:17.821167 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:27:17.821167 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:27:17.822173 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:27:17.822852 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:27:17.823182 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:27:17.823182 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:27:17.823182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:27:17.824182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:27:17.824689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:27:17.824689 [debug] [Thread-8 (]: Began running node model.redshift.stl_explain
[0m14:27:17.825199 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:27:17.825199 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:27:17.825709 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:27:17.825709 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m14:27:17.827370 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:27:17.828930 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:27:17.831026 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:27:17.831026 [debug] [Thread-8 (]: Began compiling node model.redshift.stl_explain
[0m14:27:17.832401 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:27:17.833411 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:27:17.833411 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:27:17.834414 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:27:17.834414 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:27:17.834414 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:27:17.836803 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:27:17.836803 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:27:17.836803 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:27:17.837729 [debug] [Thread-5 (]: Began running node model.redshift.stl_wlm_query
[0m14:27:17.837729 [debug] [Thread-6 (]: Began running node model.redshift.stv_blocklist
[0m14:27:17.837729 [debug] [Thread-7 (]: Began running node model.redshift.stv_partitions
[0m14:27:17.838856 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:27:17.838856 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:27:17.838856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m14:27:17.838856 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:27:17.840126 [debug] [Thread-8 (]: Finished running node model.redshift.stl_explain
[0m14:27:17.840126 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_wlm_query)
[0m14:27:17.840126 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_blocklist)
[0m14:27:17.840126 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_partitions)
[0m14:27:17.840126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:27:17.841568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:27:17.841568 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:27:17.841568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:27:17.842623 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:17.842623 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:27:17.842623 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_blocklist
[0m14:27:17.842623 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_partitions
[0m14:27:17.842623 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:27:17.844033 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:27:17.845077 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:27:17.845077 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:27:17.845077 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:27:17.846543 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:27:17.848558 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:27:17.849558 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:27:17.850563 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:27:17.852595 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:27:17.856878 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:27:17.857866 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:17.858193 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:27:17.858193 [debug] [Thread-5 (]: Finished running node model.redshift.stl_wlm_query
[0m14:27:17.859199 [debug] [Thread-6 (]: Finished running node model.redshift.stv_blocklist
[0m14:27:17.860200 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:27:17.860200 [debug] [Thread-7 (]: Finished running node model.redshift.stv_partitions
[0m14:27:17.865197 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:17.866106 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:27:17.866106 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:17.867129 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:27:17.867129 [debug] [Thread-5 (]: Began running node model.redshift.redshift_cost
[0m14:27:17.868084 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:27:17.869091 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:17.869091 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:27:17.869091 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:27:17.870090 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:27:17.870090 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:17.870090 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:17.871090 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:27:17.871090 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_cost
[0m14:27:17.877090 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:17.878093 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:27:17.882238 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:27:17.896761 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:27:17.897775 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:17.898776 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_cost
[0m14:27:17.898776 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:27:17.898776 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:17.899775 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_queries
[0m14:27:17.899775 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:27:17.900810 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_queries)
[0m14:27:17.900810 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:27:17.906835 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:27:17.906835 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:27:17.907836 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:27:17.908836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:17.908836 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:27:17.909861 [debug] [MainThread]: Connection 'model.redshift.stv_tbl_perm' was properly closed.
[0m14:27:17.909861 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:27:17.909861 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:27:17.909861 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:27:17.910836 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:27:17.910836 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:27:17.910836 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:27:17.910836 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:27:17.911834 [debug] [MainThread]: Command end result
[0m14:27:17.934835 [debug] [MainThread]: Command `dbt compile` succeeded at 14:27:17.934835 after 3.32 seconds
[0m14:27:17.934835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAA0EE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAAC34890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAAC34380>]}
[0m14:27:17.935836 [debug] [MainThread]: Flushing usage events
[0m14:27:22.147625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200157BE8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200157BE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200157BD490>]}


============================== 14:27:22.151659 | 911d3ec3-e40d-4812-8cc8-04ff853458b9 ==============================
[0m14:27:22.151659 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:27:22.151659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:22.246099 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:27:22.246099 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:27:22.341489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001684EC90>]}
[0m14:27:22.376510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020015526300>]}
[0m14:27:22.377490 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:27:22.395939 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:27:22.511645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:22.512646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:22.515643 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:27:22.528627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017A7F290>]}
[0m14:27:22.573246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017A9AB70>]}
[0m14:27:22.574246 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:27:22.574246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020015F2FEC0>]}
[0m14:27:22.576266 [info ] [MainThread]: 
[0m14:27:22.576266 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:27:22.579275 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m14:27:22.591252 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m14:27:22.591252 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m14:27:22.591252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:22.594253 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:22.595252 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:23.097275 [debug] [ThreadPool]: SQL status: SUCCESS in 0.506 seconds
[0m14:27:23.101261 [debug] [ThreadPool]: On list_integrity-db: Close
[0m14:27:23.105260 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:27:23.111429 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:27:23.112428 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:27:23.112428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:23.113429 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:23.113429 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:23.620542 [debug] [ThreadPool]: SQL status: SUCCESS in 0.507 seconds
[0m14:27:23.621631 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:27:23.622687 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:27:23.789941 [debug] [ThreadPool]: SQL status: SUCCESS in 0.167 seconds
[0m14:27:23.791944 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:27:23.902832 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:27:23.917207 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:23.918226 [debug] [MainThread]: On master: BEGIN
[0m14:27:23.919233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:23.920157 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:23.920157 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:24.545641 [debug] [MainThread]: SQL status: SUCCESS in 0.627 seconds
[0m14:27:24.546638 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:24.547634 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:27:24.841179 [debug] [MainThread]: SQL status: SUCCESS in 0.292 seconds
[0m14:27:24.844173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017A7F1D0>]}
[0m14:27:24.845176 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:24.925948 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:24.927941 [debug] [MainThread]: On master: BEGIN
[0m14:27:24.967285 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m14:27:24.969307 [debug] [MainThread]: On master: COMMIT
[0m14:27:24.970304 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:24.971305 [debug] [MainThread]: On master: COMMIT
[0m14:27:25.050890 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m14:27:25.051874 [debug] [MainThread]: On master: Close
[0m14:27:25.053872 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:27:25.055875 [info ] [MainThread]: 
[0m14:27:25.067871 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:27:25.067871 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:27:25.068869 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:27:25.068869 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:27:25.069868 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:27:25.069868 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:27:25.070868 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:27:25.070868 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:27:25.070868 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:27:25.071869 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:27:25.072869 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:27:25.072869 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:27:25.073871 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:27:25.073871 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:27:25.074911 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:27:25.074911 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:27:25.075868 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:27:25.075868 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:27:25.076869 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:27:25.076869 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:27:25.078868 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:27:25.079868 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:27:25.079868 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:27:25.080867 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:27:25.080867 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:27:25.081867 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:27:25.082602 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:27:25.083794 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:27:25.085472 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:27:25.087495 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:27:25.088479 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:27:25.089513 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:27:25.092480 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:27:25.093489 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:27:25.093489 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:27:25.094488 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:27:25.095488 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:27:25.095488 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:27:25.096488 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:27:25.097487 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:27:25.097487 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:27:25.097487 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:27:25.098487 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:27:25.098487 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:27:25.099488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:27:25.099488 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:27:25.100484 [debug] [Thread-7 (]: Began running node model.redshift.stl_wlm_query
[0m14:27:25.100484 [debug] [Thread-6 (]: Began running node model.redshift.stv_blocklist
[0m14:27:25.100484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:27:25.101487 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:27:25.101487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:27:25.101487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:27:25.102488 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:27:25.102488 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:27:25.102488 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_wlm_query)
[0m14:27:25.103487 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_blocklist)
[0m14:27:25.103487 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:27:25.103487 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:27:25.103487 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:27:25.104487 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:27:25.106496 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:27:25.106496 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:27:25.106496 [debug] [Thread-7 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:27:25.106496 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_blocklist
[0m14:27:25.110031 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:27:25.110031 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:27:25.112013 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:27:25.113016 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:27:25.113634 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:27:25.115656 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:27:25.115916 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:27:25.117953 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:27:25.118937 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:27:25.119936 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:27:25.120936 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:27:25.120936 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:27:25.121936 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:27:25.121936 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:27:25.121936 [debug] [Thread-7 (]: Finished running node model.redshift.stl_wlm_query
[0m14:27:25.122936 [debug] [Thread-6 (]: Finished running node model.redshift.stv_blocklist
[0m14:27:25.122936 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:27:25.123936 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:27:25.123936 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:27:25.123936 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:25.124936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:27:25.124936 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:25.124936 [debug] [Thread-7 (]: Began running node model.redshift.redshift_cost
[0m14:27:25.125937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:27:25.125937 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m14:27:25.126936 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m14:27:25.126936 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:27:25.127936 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:27:25.127936 [info ] [Thread-5 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m14:27:25.128936 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:27:25.128936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:27:25.129937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:27:25.130964 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:27:25.130964 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_cost
[0m14:27:25.131937 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:27:25.132936 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:27:25.132936 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:27:25.133936 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:25.138960 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:27:25.138960 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:25.139937 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:27:25.144953 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:27:25.145937 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:27:25.150935 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:25.157935 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:25.158419 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_cost
[0m14:27:25.159443 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:27:25.159443 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:27:25.160441 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:25.160441 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:27:25.183459 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m14:27:25.183459 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:25.187442 [debug] [Thread-5 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:25.184444 [info ] [Thread-6 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m14:27:25.188444 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m14:27:25.190465 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:25.191441 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:27:25.191441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:27:25.194687 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:25.195701 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:27:25.195701 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:27:25.196985 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:27:25.212186 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:27:25.215186 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:25.221186 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:27:25.260626 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:25.261642 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:27:25.262626 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:27:25.262626 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:27:25.262626 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:27:25.263625 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:27:25.263625 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:25.264624 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:25.266624 [debug] [Thread-6 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m14:27:25.266624 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:27:25.268645 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m14:27:25.269641 [debug] [Thread-5 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:25.269641 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:25.270625 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:25.277623 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:25.278624 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:25.282647 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:25.282647 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:25.282647 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:27:25.284624 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:27:25.286625 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:27:25.288624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:25.289624 [debug] [Thread-6 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:25.290624 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:25.293628 [debug] [Thread-6 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:25.295629 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:25.752297 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.488 seconds
[0m14:27:25.753297 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:25.754301 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m14:27:25.769297 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.482 seconds
[0m14:27:25.769297 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:25.770297 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m14:27:25.791312 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.503 seconds
[0m14:27:25.792313 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:25.793299 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m14:27:25.794330 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.528 seconds
[0m14:27:25.795342 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.534 seconds
[0m14:27:25.796356 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:25.797357 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:25.798341 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m14:27:25.799355 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m14:27:25.962773 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.208 seconds
[0m14:27:25.967819 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:25.967819 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m14:27:25.991805 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.220 seconds
[0m14:27:25.995841 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:25.995841 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m14:27:26.001851 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.208 seconds
[0m14:27:26.005775 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:26.005775 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m14:27:26.009798 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.209 seconds
[0m14:27:26.011452 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:26.011452 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m14:27:26.027523 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.227 seconds
[0m14:27:26.031460 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:26.031460 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m14:27:26.082420 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.114 seconds
[0m14:27:26.085441 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:26.085441 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m14:27:26.110686 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.114 seconds
[0m14:27:26.117422 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:26.117933 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m14:27:26.120026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m14:27:26.128016 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:26.129026 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m14:27:26.136026 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.124 seconds
[0m14:27:26.140026 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:26.140026 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m14:27:26.156017 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.123 seconds
[0m14:27:26.159014 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:26.160013 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m14:27:26.204224 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.118 seconds
[0m14:27:26.218768 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:27:26.218768 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:26.218768 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:27:26.257230 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.138 seconds
[0m14:27:26.260287 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:27:26.261260 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:26.261260 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:27:26.262289 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.133 seconds
[0m14:27:26.263240 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.122 seconds
[0m14:27:26.264638 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:27:26.266201 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:27:26.267203 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:26.267203 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:26.268201 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:27:26.268201 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:27:26.281262 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.121 seconds
[0m14:27:26.284303 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:27:26.285288 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:26.285288 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:27:26.454776 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.234 seconds
[0m14:27:26.455792 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:26.456749 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:27:26.458737 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.190 seconds
[0m14:27:26.459740 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.174 seconds
[0m14:27:26.460736 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.198 seconds
[0m14:27:26.461737 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.192 seconds
[0m14:27:26.536149 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.078 seconds
[0m14:27:26.549241 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m14:27:26.553203 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:26.554178 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m14:27:26.633344 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.078 seconds
[0m14:27:26.635345 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:27:26.637242 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:26.637242 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:27:26.750170 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.111 seconds
[0m14:27:26.752164 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:27:26.754166 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:27:26.789166 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.034 seconds
[0m14:27:26.792160 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:26.793160 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:27:26.869006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.075 seconds
[0m14:27:26.875093 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m14:27:26.875999 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:26.877081 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m14:27:26.956693 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m14:27:26.959675 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:27:26.960677 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:26.961680 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:27:27.056704 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.093 seconds
[0m14:27:27.057718 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:27:27.058675 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:27:27.096539 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.036 seconds
[0m14:27:27.099553 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:27.101555 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:27:27.185387 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.082 seconds
[0m14:27:27.193501 [debug] [Thread-5 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m14:27:27.195501 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:27.196612 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m14:27:27.280748 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.083 seconds
[0m14:27:27.283745 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:27:27.284812 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:27.285787 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:27:27.403034 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.116 seconds
[0m14:27:27.405030 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:27:27.406033 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:27:27.450655 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.043 seconds
[0m14:27:27.453704 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:27.454678 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:27:27.538509 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.083 seconds
[0m14:27:27.543565 [debug] [Thread-6 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m14:27:27.545501 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:27.546584 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m14:27:27.633545 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.075 seconds
[0m14:27:27.636574 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:27:27.637509 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:27.638472 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:27:27.737034 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.099 seconds
[0m14:27:27.739053 [debug] [Thread-6 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:27:27.740053 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:27:27.777750 [debug] [Thread-6 (]: SQL status: SUCCESS in 0.036 seconds
[0m14:27:27.780743 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:27.781739 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:27:27.859773 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.077 seconds
[0m14:27:27.861830 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m14:27:27.862829 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:27.863829 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m14:27:27.946548 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.083 seconds
[0m14:27:27.949583 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:27:27.950593 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:27.951544 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:27:28.069992 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m14:27:28.070985 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:27:28.072986 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:27:28.116973 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.044 seconds
[0m14:27:28.117976 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m14:27:28.118975 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m14:27:28.118975 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m14:27:28.119975 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m14:27:28.119975 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m14:27:28.197946 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m14:27:28.199961 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m14:27:28.201011 [debug] [Thread-6 (]: On model.redshift.redshift_admin_table_stats: Close
[0m14:27:28.203957 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200182C3D10>]}
[0m14:27:28.204963 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m14:27:28.205958 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m14:27:28.206956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017B02A50>]}
[0m14:27:28.207958 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017C68950>]}
[0m14:27:28.210959 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017E5A870>]}
[0m14:27:28.208959 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.07s]
[0m14:27:28.211971 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911d3ec3-e40d-4812-8cc8-04ff853458b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020017DADCA0>]}
[0m14:27:28.212957 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.02s]
[0m14:27:28.214465 [info ] [Thread-6 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.02s]
[0m14:27:28.214888 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.08s]
[0m14:27:28.215898 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:27:28.216895 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:27:28.215898 [info ] [Thread-5 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.08s]
[0m14:27:28.217419 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:27:28.218431 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:27:28.218431 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:27:28.220741 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:28.220741 [debug] [MainThread]: On master: BEGIN
[0m14:27:28.220741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:28.221742 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:28.221742 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:28.662978 [debug] [MainThread]: SQL status: SUCCESS in 0.442 seconds
[0m14:27:28.663984 [debug] [MainThread]: On master: COMMIT
[0m14:27:28.665977 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:28.665977 [debug] [MainThread]: On master: COMMIT
[0m14:27:28.747008 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m14:27:28.748104 [debug] [MainThread]: On master: Close
[0m14:27:28.750004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:28.751040 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m14:27:28.752028 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:27:28.752028 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:27:28.753048 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:27:28.753048 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:27:28.754049 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:27:28.754049 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:27:28.755037 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:27:28.755037 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:27:28.756112 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:27:28.756112 [info ] [MainThread]: 
[0m14:27:28.757425 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m14:27:28.760939 [debug] [MainThread]: Command end result
[0m14:27:28.786239 [info ] [MainThread]: 
[0m14:27:28.786239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:28.787237 [info ] [MainThread]: 
[0m14:27:28.787237 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:27:28.788237 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:28.788237 after 6.74 seconds
[0m14:27:28.788237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020015F0FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020015DE8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200150E1790>]}
[0m14:27:28.789237 [debug] [MainThread]: Flushing usage events
[0m14:35:52.574891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DFDD0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DFDD2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DFDD1E20>]}


============================== 14:35:52.578905 | d996ecbe-dcda-4063-99d4-ac89a2eea9a5 ==============================
[0m14:35:52.578905 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:35:52.578905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m14:35:52.677080 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:35:52.677080 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:35:52.775955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd996ecbe-dcda-4063-99d4-ac89a2eea9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DFE322D0>]}
[0m14:35:52.809584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd996ecbe-dcda-4063-99d4-ac89a2eea9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DD8B19A0>]}
[0m14:35:52.810547 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:35:52.829550 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:35:52.920517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:52.921463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:52.924984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:35:52.938959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd996ecbe-dcda-4063-99d4-ac89a2eea9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E08683E0>]}
[0m14:35:52.983256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd996ecbe-dcda-4063-99d4-ac89a2eea9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E1B0F020>]}
[0m14:35:52.983256 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:35:52.984259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd996ecbe-dcda-4063-99d4-ac89a2eea9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E00214F0>]}
[0m14:35:52.986257 [info ] [MainThread]: 
[0m14:35:52.986257 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:35:52.989256 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:35:52.999299 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:35:53.000338 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:35:53.000338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:53.003300 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:35:53.003300 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:35:53.589986 [debug] [ThreadPool]: SQL status: SUCCESS in 0.590 seconds
[0m14:35:53.592164 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:35:53.594104 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:35:53.705609 [debug] [ThreadPool]: SQL status: SUCCESS in 0.110 seconds
[0m14:35:53.710128 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:35:53.788072 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:35:53.801414 [debug] [MainThread]: Using redshift connection "master"
[0m14:35:53.802415 [debug] [MainThread]: On master: BEGIN
[0m14:35:53.802415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:53.802415 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:35:53.803414 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:35:54.243454 [debug] [MainThread]: SQL status: SUCCESS in 0.441 seconds
[0m14:35:54.244446 [debug] [MainThread]: Using redshift connection "master"
[0m14:35:54.246446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:35:54.388768 [debug] [MainThread]: SQL status: SUCCESS in 0.141 seconds
[0m14:35:54.391765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd996ecbe-dcda-4063-99d4-ac89a2eea9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E079DFD0>]}
[0m14:35:54.392764 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:54.472760 [debug] [MainThread]: On master: Close
[0m14:35:54.476103 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:35:54.478101 [info ] [MainThread]: 
[0m14:35:54.487089 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:35:54.488091 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:35:54.488091 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:35:54.489090 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:35:54.490089 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:35:54.490089 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:35:54.490848 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:35:54.490848 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:35:54.490848 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:35:54.491926 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:35:54.492546 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:35:54.493190 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:35:54.493746 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:35:54.493746 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:35:54.494766 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:35:54.494766 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:35:54.495765 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:35:54.495765 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:35:54.495765 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:35:54.496766 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:35:54.497765 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:35:54.497765 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:35:54.498765 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:35:54.498765 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:35:54.499766 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:35:54.500778 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:35:54.501766 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:35:54.502765 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:35:54.504766 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:35:54.505765 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:35:54.506766 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:35:54.509274 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:35:54.513338 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:35:54.514275 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:35:54.516275 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:35:54.517274 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:35:54.517274 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:35:54.517274 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:35:54.518274 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:35:54.519274 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:35:54.519274 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:35:54.520273 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:35:54.520273 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:35:54.521274 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:35:54.521274 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:35:54.522274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:35:54.522274 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:35:54.522274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:35:54.523274 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:35:54.523274 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:35:54.523274 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:35:54.523274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:35:54.524274 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:35:54.524274 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:35:54.524274 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:35:54.525273 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:35:54.525273 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:35:54.525273 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:35:54.526273 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:35:54.526273 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:35:54.526273 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:35:54.528290 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:35:54.529273 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:35:54.531273 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:35:54.532431 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:35:54.533824 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:35:54.534798 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:35:54.536149 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:35:54.537193 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:35:54.538149 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:35:54.539152 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:35:54.540153 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:35:54.541149 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:35:54.542149 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:35:54.546150 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:35:54.544149 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:35:54.544149 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:35:54.545149 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:35:54.545149 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:35:54.546150 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:35:54.543149 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:35:54.547149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:35:54.547149 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:35:54.547149 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:35:54.548149 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:35:54.548149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:35:54.548149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:35:54.549149 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:35:54.549149 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:35:54.549149 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:35:54.550150 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:35:54.551149 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:35:54.551149 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:35:54.551149 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:35:54.551149 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:35:54.558166 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:35:54.558166 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:35:54.559149 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:35:54.560149 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:35:54.562149 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:35:54.562569 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:35:54.567573 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:35:54.574257 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:35:54.574257 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:35:54.575241 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:35:54.581239 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:35:54.582240 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:35:54.582240 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:35:54.583240 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:35:54.583240 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:35:54.584240 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:35:54.585240 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:35:54.585688 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:35:54.586332 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:35:54.586332 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:35:54.587310 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:35:54.593361 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:35:54.603345 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:35:54.603832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:35:54.603832 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:35:54.604838 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:35:54.611002 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:35:54.612005 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:35:54.612473 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:35:54.613508 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:35:54.614217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:54.615223 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:35:54.615223 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:35:54.615223 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:35:54.616223 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:35:54.616223 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:35:54.616223 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:35:54.616223 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:35:54.616223 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:35:54.616223 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:35:54.617223 [debug] [MainThread]: Command end result
[0m14:35:54.682837 [debug] [MainThread]: Command `dbt compile` succeeded at 14:35:54.682837 after 2.24 seconds
[0m14:35:54.682837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DF0A9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DF0A9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6DF9B2DB0>]}
[0m14:35:54.683841 [debug] [MainThread]: Flushing usage events
[0m14:37:12.030736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028452B89520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028455108A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284555B08C0>]}


============================== 14:37:12.034740 | fed77137-67f6-4976-af4c-4aa23a012e8a ==============================
[0m14:37:12.034740 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:37:12.035741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:12.139015 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:37:12.139015 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:37:12.236350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed77137-67f6-4976-af4c-4aa23a012e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284555E0410>]}
[0m14:37:12.269924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed77137-67f6-4976-af4c-4aa23a012e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028455EA1A60>]}
[0m14:37:12.270927 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:37:12.288912 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:37:12.384887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:12.385887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:12.388888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:37:12.401896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed77137-67f6-4976-af4c-4aa23a012e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028455DAE9F0>]}
[0m14:37:12.445123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed77137-67f6-4976-af4c-4aa23a012e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845728C170>]}
[0m14:37:12.446127 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:37:12.446127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed77137-67f6-4976-af4c-4aa23a012e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028455E71490>]}
[0m14:37:12.447636 [info ] [MainThread]: 
[0m14:37:12.448644 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:37:12.450665 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:37:12.461668 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:37:12.461668 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:37:12.461668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:12.464665 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:37:12.465663 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:37:13.065363 [debug] [ThreadPool]: SQL status: SUCCESS in 0.603 seconds
[0m14:37:13.066421 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:37:13.067385 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:37:13.205799 [debug] [ThreadPool]: SQL status: SUCCESS in 0.138 seconds
[0m14:37:13.208838 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:37:13.291034 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:37:13.304274 [debug] [MainThread]: Using redshift connection "master"
[0m14:37:13.305366 [debug] [MainThread]: On master: BEGIN
[0m14:37:13.305366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:13.306268 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:37:13.306268 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:37:13.740926 [debug] [MainThread]: SQL status: SUCCESS in 0.435 seconds
[0m14:37:13.741994 [debug] [MainThread]: Using redshift connection "master"
[0m14:37:13.742920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:37:13.917901 [debug] [MainThread]: SQL status: SUCCESS in 0.174 seconds
[0m14:37:13.921891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed77137-67f6-4976-af4c-4aa23a012e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028453091970>]}
[0m14:37:13.922894 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:14.005466 [debug] [MainThread]: On master: Close
[0m14:37:14.007516 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:37:14.009470 [info ] [MainThread]: 
[0m14:37:14.021637 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:37:14.021637 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:37:14.022639 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:37:14.022639 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:37:14.023636 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:37:14.023636 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:37:14.024637 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:37:14.024637 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:37:14.025637 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:37:14.026637 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:37:14.026637 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:37:14.027641 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:37:14.027641 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:37:14.028637 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:37:14.029659 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:37:14.030644 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:37:14.030644 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:37:14.031636 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:37:14.031636 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:37:14.031636 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:37:14.032635 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:37:14.032635 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:37:14.033635 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:37:14.034643 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:37:14.034643 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:37:14.036640 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:37:14.037640 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:37:14.038639 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:37:14.039639 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:37:14.040640 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:37:14.043658 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:37:14.045640 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:37:14.046640 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:37:14.047640 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:37:14.048640 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:37:14.048640 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:37:14.049640 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:37:14.049640 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:37:14.050767 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:37:14.050767 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:37:14.051769 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:37:14.051769 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:37:14.052767 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:37:14.052767 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:37:14.053767 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:37:14.053767 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:37:14.054767 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:37:14.054767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:37:14.055770 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:37:14.055770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:37:14.055770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:37:14.056768 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:37:14.056768 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:37:14.056768 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:37:14.057768 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:37:14.057768 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:37:14.057768 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:37:14.058768 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:37:14.058768 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:37:14.059768 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:37:14.059768 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:37:14.059768 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:37:14.059768 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:37:14.062768 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:37:14.062995 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:37:14.065032 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:37:14.067017 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:37:14.068368 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:37:14.069573 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:37:14.070573 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:37:14.071572 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:37:14.073598 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:37:14.073598 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:37:14.074572 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:37:14.075572 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:37:14.075572 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:37:14.076572 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:37:14.077572 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:37:14.077572 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:37:14.077572 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:37:14.078572 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:37:14.078572 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:37:14.078572 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:37:14.079572 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:37:14.079572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:37:14.079572 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:37:14.080573 [debug] [Thread-5 (]: Began running node model.redshift.redshift_cost
[0m14:37:14.080573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:37:14.081602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:37:14.081602 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:37:14.081602 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:37:14.082573 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:37:14.082573 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_cost)
[0m14:37:14.083572 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:37:14.083572 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:37:14.084572 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:37:14.086576 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:37:14.086576 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:37:14.086576 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_cost
[0m14:37:14.087573 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:37:14.093588 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:37:14.097571 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:37:14.104571 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:37:14.109969 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:37:14.111161 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:37:14.112189 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:37:14.112189 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:37:14.113188 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:37:14.113188 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:37:14.114188 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_cost
[0m14:37:14.115225 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:37:14.116188 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:37:14.116188 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:37:14.117188 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:37:14.117188 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:37:14.118188 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:37:14.119188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:37:14.119188 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:37:14.120188 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:37:14.135305 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:37:14.141264 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:37:14.141916 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:37:14.142946 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:37:14.142946 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:37:14.143945 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:37:14.144951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:14.145976 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:37:14.145976 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:37:14.145976 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:37:14.145976 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:37:14.146944 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:37:14.146944 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:37:14.146944 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:37:14.146944 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:37:14.147958 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:37:14.147958 [debug] [MainThread]: Command end result
[0m14:37:14.211466 [debug] [MainThread]: Command `dbt compile` succeeded at 14:37:14.211466 after 2.42 seconds
[0m14:37:14.211466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284577F8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284577FB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284577F91C0>]}
[0m14:37:14.212539 [debug] [MainThread]: Flushing usage events
[0m14:38:24.988834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42518A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42565370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42518980>]}


============================== 14:38:24.991913 | 18b54d4c-e9c9-4668-85d0-5eca0db27caf ==============================
[0m14:38:24.991913 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:38:24.992874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:25.095467 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:38:25.096415 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:38:25.197335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18b54d4c-e9c9-4668-85d0-5eca0db27caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4010A3F0>]}
[0m14:38:25.229335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18b54d4c-e9c9-4668-85d0-5eca0db27caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42680800>]}
[0m14:38:25.231065 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:38:25.248089 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:38:25.338529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:25.338529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:25.342529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:38:25.355038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18b54d4c-e9c9-4668-85d0-5eca0db27caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F430FDDF0>]}
[0m14:38:25.401818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18b54d4c-e9c9-4668-85d0-5eca0db27caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F430A4590>]}
[0m14:38:25.401818 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:38:25.402834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18b54d4c-e9c9-4668-85d0-5eca0db27caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42F8F650>]}
[0m14:38:25.404858 [info ] [MainThread]: 
[0m14:38:25.405819 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:38:25.408836 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:38:25.418819 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:38:25.419823 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:38:25.419823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:25.422855 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:25.423819 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:25.995831 [debug] [ThreadPool]: SQL status: SUCCESS in 0.575 seconds
[0m14:38:25.996832 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:38:25.996832 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:38:26.105203 [debug] [ThreadPool]: SQL status: SUCCESS in 0.107 seconds
[0m14:38:26.107160 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:38:26.179706 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:38:26.189701 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:26.190702 [debug] [MainThread]: On master: BEGIN
[0m14:38:26.190702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:26.190702 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:26.190702 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:26.586334 [debug] [MainThread]: SQL status: SUCCESS in 0.396 seconds
[0m14:38:26.587396 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:26.588377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:38:26.712308 [debug] [MainThread]: SQL status: SUCCESS in 0.125 seconds
[0m14:38:26.714268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18b54d4c-e9c9-4668-85d0-5eca0db27caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42680560>]}
[0m14:38:26.714268 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:26.787579 [debug] [MainThread]: On master: Close
[0m14:38:26.789576 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:38:26.791571 [info ] [MainThread]: 
[0m14:38:26.799047 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:38:26.800049 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:38:26.800049 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:38:26.803058 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:38:26.803058 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:38:26.804046 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:38:26.805046 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:38:26.806046 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:38:26.807045 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:38:26.807045 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:38:26.804046 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:38:26.809046 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:38:26.809046 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:38:26.810045 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:38:26.811045 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:38:26.804046 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:38:26.811045 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:38:26.808047 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:38:26.811045 [debug] [Thread-4 (]: Began running node model.redshift.redshift_constraints
[0m14:38:26.812045 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_constraints)
[0m14:38:26.807045 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:38:26.808047 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:38:26.805046 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:38:26.814045 [debug] [Thread-1 (]: Began running node model.redshift.redshift_tables
[0m14:38:26.815046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_tables)
[0m14:38:26.815046 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_tables
[0m14:38:26.807045 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:38:26.813045 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_constraints
[0m14:38:26.813045 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:38:26.814045 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:38:26.812045 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:38:26.812045 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:38:26.808047 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:38:26.817123 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:38:26.818104 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:38:26.820045 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:38:26.821315 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:38:26.821745 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:38:26.821745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:38:26.824750 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:38:26.825688 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:38:26.825688 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:38:26.826717 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_constraints
[0m14:38:26.827715 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_tables
[0m14:38:26.828818 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:38:26.828818 [debug] [Thread-5 (]: Began running node model.redshift.stl_explain
[0m14:38:26.833721 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_explain)
[0m14:38:26.834720 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_explain
[0m14:38:26.830716 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:38:26.831715 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:38:26.832715 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:38:26.832715 [debug] [Thread-1 (]: Began running node model.redshift.stl_wlm_query
[0m14:38:26.829720 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:38:26.834720 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:38:26.830716 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:38:26.836722 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:38:26.836722 [debug] [Thread-3 (]: Began running node model.redshift.stv_blocklist
[0m14:38:26.837378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m14:38:26.838435 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:38:26.839383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stl_wlm_query)
[0m14:38:26.841384 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:38:26.842384 [debug] [Thread-7 (]: Began running node model.redshift.stv_partitions
[0m14:38:26.844421 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:38:26.844421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.stv_blocklist)
[0m14:38:26.845393 [debug] [Thread-5 (]: Finished running node model.redshift.stl_explain
[0m14:38:26.845393 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:38:26.846388 [debug] [Thread-6 (]: Began running node model.redshift.stv_tbl_perm
[0m14:38:26.846388 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:38:26.847893 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:38:26.847893 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_partitions)
[0m14:38:26.848898 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_blocklist
[0m14:38:26.848898 [debug] [Thread-5 (]: Began running node model.redshift.svv_diskusage
[0m14:38:26.849898 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:38:26.850898 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:38:26.850898 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_tbl_perm)
[0m14:38:26.851897 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:38:26.852930 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:38:26.852930 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_partitions
[0m14:38:26.853898 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:38:26.854788 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.svv_diskusage)
[0m14:38:26.854788 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:38:26.855811 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:38:26.855811 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:38:26.856810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_admin_dependencies)
[0m14:38:26.857811 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:38:26.857811 [debug] [Thread-1 (]: Finished running node model.redshift.stl_wlm_query
[0m14:38:26.858809 [debug] [Thread-5 (]: Began compiling node model.redshift.svv_diskusage
[0m14:38:26.858809 [debug] [Thread-3 (]: Finished running node model.redshift.stv_blocklist
[0m14:38:26.859810 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:38:26.861834 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:38:26.861834 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:38:26.861834 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:38:26.862810 [debug] [Thread-7 (]: Finished running node model.redshift.stv_partitions
[0m14:38:26.862810 [debug] [Thread-1 (]: Began running node model.redshift.redshift_cost
[0m14:38:26.864809 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:38:26.864809 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:38:26.865809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:38:26.866809 [debug] [Thread-6 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:38:26.871808 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:38:26.872933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:38:26.877954 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:38:26.878513 [debug] [Thread-5 (]: Finished running node model.redshift.svv_diskusage
[0m14:38:26.878513 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:38:26.879520 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_cost
[0m14:38:26.880543 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:38:26.880543 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:38:26.881519 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:38:26.889614 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:38:26.894517 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:38:26.895205 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:38:26.895205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:38:26.896237 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:38:26.897232 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:38:26.898233 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:38:26.899234 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_cost
[0m14:38:26.900253 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:38:26.915594 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:38:26.916578 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_queries
[0m14:38:26.917087 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:38:26.917087 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:38:26.923163 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:38:26.923163 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:38:26.924095 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:38:26.924095 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:38:26.925094 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:38:26.926092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:26.926092 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:38:26.926092 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:38:26.926092 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:38:26.927093 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:38:26.927093 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:38:26.927093 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:38:26.927093 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:38:26.927093 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:38:26.928092 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:38:26.928092 [debug] [MainThread]: Command end result
[0m14:38:26.995172 [debug] [MainThread]: Command `dbt compile` succeeded at 14:38:26.995172 after 2.13 seconds
[0m14:38:26.995172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F42329BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F448C3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F448C15B0>]}
[0m14:38:26.996172 [debug] [MainThread]: Flushing usage events
[0m14:39:31.110029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387BE8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387BEAF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027387F40770>]}


============================== 14:39:31.113046 | 1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1 ==============================
[0m14:39:31.113046 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:39:31.114026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:31.208808 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:39:31.208808 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:39:31.305110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273887F65D0>]}
[0m14:39:31.338697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027388839670>]}
[0m14:39:31.339698 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:39:31.358447 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:39:31.453718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:31.454716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:31.457716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:39:31.470176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002738885E270>]}
[0m14:39:31.515157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002738998BAA0>]}
[0m14:39:31.515157 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:39:31.516152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002738762C890>]}
[0m14:39:31.518129 [info ] [MainThread]: 
[0m14:39:31.518129 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:39:31.520550 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:39:31.531654 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:39:31.531654 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:39:31.531654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:31.534812 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:31.535841 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:32.128465 [debug] [ThreadPool]: SQL status: SUCCESS in 0.597 seconds
[0m14:39:32.129463 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:39:32.130462 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:39:32.249992 [debug] [ThreadPool]: SQL status: SUCCESS in 0.119 seconds
[0m14:39:32.254012 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:39:32.334749 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:39:32.349286 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:32.349286 [debug] [MainThread]: On master: BEGIN
[0m14:39:32.349286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:32.350288 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:32.350288 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:32.798533 [debug] [MainThread]: SQL status: SUCCESS in 0.449 seconds
[0m14:39:32.800538 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:32.801567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:39:32.936928 [debug] [MainThread]: SQL status: SUCCESS in 0.134 seconds
[0m14:39:32.939452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbf741d-b9c5-4b4a-9a48-abe7bd2ed7b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027388969430>]}
[0m14:39:32.940567 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:33.025708 [debug] [MainThread]: On master: Close
[0m14:39:33.026710 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:39:33.027147 [info ] [MainThread]: 
[0m14:39:33.031948 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:39:33.031948 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:39:33.031948 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:39:33.031948 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:39:33.032947 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:39:33.032947 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:39:33.032947 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:39:33.032947 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:39:33.033948 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:39:33.034948 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:39:33.034948 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:39:33.035948 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:39:33.035948 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:39:33.035948 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:39:33.036947 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:39:33.036947 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:39:33.036947 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:39:33.037948 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:39:33.037948 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:39:33.037948 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:39:33.038948 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:39:33.040241 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:39:33.040241 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:39:33.040241 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:39:33.042272 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:39:33.042272 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:39:33.043443 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:39:33.044447 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:39:33.045448 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:39:33.046448 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:39:33.047356 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:39:33.049378 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:39:33.053377 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:39:33.054378 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:39:33.055377 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:39:33.055377 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:39:33.056377 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:39:33.057378 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:39:33.057378 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:39:33.058377 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:39:33.059377 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:39:33.059377 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:39:33.060377 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m14:39:33.060377 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:39:33.061378 [debug] [Thread-6 (]: Began running node model.redshift.stl_query
[0m14:39:33.061378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:39:33.062378 [debug] [Thread-5 (]: Began running node model.redshift.stl_wlm_query
[0m14:39:33.062378 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_sort_dist_keys)
[0m14:39:33.063377 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:39:33.063377 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:39:33.063377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_tables)
[0m14:39:33.064378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:39:33.064378 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_query)
[0m14:39:33.066377 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_query
[0m14:39:33.064378 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_wlm_query)
[0m14:39:33.065377 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:39:33.065377 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:39:33.066377 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:39:33.066377 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m14:39:33.066377 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:39:33.064378 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:39:33.068378 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:39:33.068378 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:39:33.070378 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:39:33.071379 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:39:33.071379 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:39:33.073394 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:39:33.074378 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:39:33.076394 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:39:33.077378 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:39:33.078376 [debug] [Thread-6 (]: Finished running node model.redshift.stl_query
[0m14:39:33.079408 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:39:33.079408 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:39:33.081399 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:39:33.082378 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m14:39:33.083378 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:39:33.083378 [debug] [Thread-6 (]: Began running node model.redshift.stv_tbl_perm
[0m14:39:33.084377 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:39:33.085377 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m14:39:33.085377 [debug] [Thread-5 (]: Finished running node model.redshift.stl_wlm_query
[0m14:39:33.085377 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:39:33.086377 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:39:33.086377 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:39:33.086377 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:39:33.087377 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m14:39:33.087377 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:39:33.088378 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:39:33.088378 [debug] [Thread-5 (]: Began running node model.redshift.redshift_cost
[0m14:39:33.089377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:39:33.089377 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:39:33.090383 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:39:33.090383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:39:33.091380 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m14:39:33.091380 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:39:33.092377 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:39:33.092377 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:39:33.094394 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:39:33.094394 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:39:33.096378 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:39:33.097726 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_cost
[0m14:39:33.103773 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:39:33.108730 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:39:33.115773 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:39:33.120730 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:39:33.120730 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m14:39:33.121749 [debug] [Thread-6 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:39:33.121749 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:39:33.122732 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:39:33.123732 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:39:33.123732 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_cost
[0m14:39:33.125766 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:39:33.125766 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:39:33.126736 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:39:33.126736 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:39:33.127736 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_queries
[0m14:39:33.127736 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:39:33.128780 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_admin_queries)
[0m14:39:33.128780 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:39:33.128780 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:39:33.143473 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:39:33.148455 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:39:33.149436 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:39:33.150426 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:39:33.150426 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:39:33.151450 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:39:33.154018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:33.154018 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:39:33.154018 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:39:33.154018 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:39:33.154018 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:39:33.155016 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:39:33.155016 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:39:33.155016 [debug] [MainThread]: Connection 'model.redshift.stv_tbl_perm' was properly closed.
[0m14:39:33.155016 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:39:33.155016 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:39:33.156016 [debug] [MainThread]: Command end result
[0m14:39:33.214021 [debug] [MainThread]: Command `dbt compile` succeeded at 14:39:33.214021 after 2.23 seconds
[0m14:39:33.214021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027389D6BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027389D6B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027389D6BE30>]}
[0m14:39:33.214021 [debug] [MainThread]: Flushing usage events
[0m14:41:26.355200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FBB2FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FBB2D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FBB2E660>]}


============================== 14:41:26.359218 | 5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a ==============================
[0m14:41:26.359218 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:41:26.360172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:26.457066 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:41:26.457066 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:41:26.562456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FC8D86B0>]}
[0m14:41:26.598027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FCD87EC0>]}
[0m14:41:26.599086 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:41:26.617137 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:41:26.709604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:26.709604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:26.713605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:41:26.724986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FDDD7740>]}
[0m14:41:26.772396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FE0BC0B0>]}
[0m14:41:26.772396 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:41:26.773396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FB3F9DC0>]}
[0m14:41:26.775399 [info ] [MainThread]: 
[0m14:41:26.775399 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:41:26.778399 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:41:26.788902 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:41:26.788902 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:41:26.789906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:26.791906 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:26.792907 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:27.370948 [debug] [ThreadPool]: SQL status: SUCCESS in 0.581 seconds
[0m14:41:27.372952 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:41:27.373947 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:41:27.517375 [debug] [ThreadPool]: SQL status: SUCCESS in 0.142 seconds
[0m14:41:27.521356 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:41:27.606542 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:41:27.619535 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:27.619535 [debug] [MainThread]: On master: BEGIN
[0m14:41:27.619535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:27.620537 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:27.620537 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:28.058896 [debug] [MainThread]: SQL status: SUCCESS in 0.438 seconds
[0m14:41:28.059928 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:28.061884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:41:28.259556 [debug] [MainThread]: SQL status: SUCCESS in 0.197 seconds
[0m14:41:28.263570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd8fc47-b2bf-45f7-a5be-f5e18d720d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179F9EE1A00>]}
[0m14:41:28.264552 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:28.346724 [debug] [MainThread]: On master: Close
[0m14:41:28.348717 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:41:28.351715 [info ] [MainThread]: 
[0m14:41:28.360736 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:41:28.361737 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:41:28.361737 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:41:28.362735 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:41:28.362735 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:41:28.363735 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:41:28.363735 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:41:28.363735 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:41:28.364734 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:41:28.364734 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:41:28.365736 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:41:28.365736 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:41:28.366734 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:41:28.366734 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:41:28.367734 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:41:28.367734 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:41:28.367734 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:41:28.368734 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:41:28.368734 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:41:28.368734 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:41:28.369735 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:41:28.370750 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:41:28.370750 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:41:28.370750 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:41:28.371837 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:41:28.372872 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:41:28.373877 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:41:28.374843 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:41:28.376663 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:41:28.377667 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:41:28.377667 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:41:28.380667 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:41:28.383669 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:41:28.387667 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:41:28.385667 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:41:28.385667 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:41:28.386668 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:41:28.386668 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:41:28.387667 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:41:28.384668 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:41:28.388669 [debug] [Thread-8 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:41:28.388669 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:41:28.389668 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:41:28.389668 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:41:28.389668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:41:28.389668 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:41:28.390668 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:41:28.390668 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m14:41:28.390668 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_sort_dist_keys)
[0m14:41:28.391668 [debug] [Thread-7 (]: Began running node model.redshift.stv_partitions
[0m14:41:28.391668 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:41:28.391668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:41:28.392715 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:41:28.392715 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:41:28.392715 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:41:28.393715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.stv_blocklist)
[0m14:41:28.393715 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:41:28.393715 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_partitions)
[0m14:41:28.394714 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:41:28.394714 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:41:28.396713 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:41:28.396713 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:41:28.397713 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:41:28.397713 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m14:41:28.400743 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:41:28.400743 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_partitions
[0m14:41:28.402714 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:41:28.404484 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:41:28.405486 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:41:28.406484 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:41:28.408268 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:41:28.408268 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:41:28.409269 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:41:28.410269 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:41:28.410269 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:41:28.411268 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:41:28.412268 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:41:28.412268 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:41:28.413268 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:41:28.413268 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m14:41:28.414268 [debug] [Thread-7 (]: Finished running node model.redshift.stv_partitions
[0m14:41:28.414268 [debug] [Thread-8 (]: Began running node model.redshift.svv_diskusage
[0m14:41:28.415269 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:41:28.415269 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:41:28.415269 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:41:28.416269 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:41:28.416269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:41:28.417268 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:41:28.417268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:41:28.417268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:41:28.418269 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:41:28.418269 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:41:28.418269 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:41:28.418269 [debug] [Thread-8 (]: Began compiling node model.redshift.svv_diskusage
[0m14:41:28.419269 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:41:28.419269 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:41:28.419269 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:41:28.420268 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:41:28.422268 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:41:28.423294 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:41:28.428267 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:41:28.433309 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:41:28.439267 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:41:28.444397 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:41:28.445398 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:41:28.445398 [debug] [Thread-8 (]: Finished running node model.redshift.svv_diskusage
[0m14:41:28.447398 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:41:28.447398 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:41:28.448398 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:41:28.448398 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:41:28.448398 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:41:28.449399 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:41:28.449399 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:41:28.450431 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:41:28.450431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:41:28.451399 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:41:28.451399 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:41:28.452398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:41:28.467398 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:41:28.468400 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:41:28.473492 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:41:28.474497 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:41:28.474497 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:41:28.475402 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:41:28.476398 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:41:28.477387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:28.477387 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:41:28.478443 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:41:28.478443 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:41:28.478443 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:41:28.478443 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:41:28.479394 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:41:28.479394 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:41:28.479394 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:41:28.479394 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:41:28.480393 [debug] [MainThread]: Command end result
[0m14:41:28.541665 [debug] [MainThread]: Command `dbt compile` succeeded at 14:41:28.541665 after 2.33 seconds
[0m14:41:28.542638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FB8F1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FBFE2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FBFE2C90>]}
[0m14:41:28.542638 [debug] [MainThread]: Flushing usage events
[0m14:43:37.586136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2DCC6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2DCFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2DCFB30>]}


============================== 14:43:37.589067 | 7bb00706-7c3a-4399-8229-2d89eb73dbfa ==============================
[0m14:43:37.589067 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:43:37.590084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:43:37.683735 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:43:37.683735 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:43:37.784609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bb00706-7c3a-4399-8229-2d89eb73dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D3000530>]}
[0m14:43:37.820609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bb00706-7c3a-4399-8229-2d89eb73dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2E55730>]}
[0m14:43:37.821610 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:43:37.839571 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:43:37.933892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:37.934892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:37.937893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:43:37.950893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bb00706-7c3a-4399-8229-2d89eb73dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D38DD190>]}
[0m14:43:37.995474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bb00706-7c3a-4399-8229-2d89eb73dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D4A0BFB0>]}
[0m14:43:37.995474 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:43:37.996474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bb00706-7c3a-4399-8229-2d89eb73dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D30FDCA0>]}
[0m14:43:37.997475 [info ] [MainThread]: 
[0m14:43:37.998491 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:43:38.001474 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:43:38.011496 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:43:38.012497 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:43:38.012497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:38.015542 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:43:38.016541 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:43:38.563267 [debug] [ThreadPool]: SQL status: SUCCESS in 0.551 seconds
[0m14:43:38.565259 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:43:38.566255 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:43:38.711674 [debug] [ThreadPool]: SQL status: SUCCESS in 0.145 seconds
[0m14:43:38.712681 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:43:38.788802 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:43:38.802300 [debug] [MainThread]: Using redshift connection "master"
[0m14:43:38.802300 [debug] [MainThread]: On master: BEGIN
[0m14:43:38.802300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:38.803257 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:43:38.803257 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:43:39.215668 [debug] [MainThread]: SQL status: SUCCESS in 0.412 seconds
[0m14:43:39.216752 [debug] [MainThread]: Using redshift connection "master"
[0m14:43:39.217659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:43:39.393581 [debug] [MainThread]: SQL status: SUCCESS in 0.175 seconds
[0m14:43:39.395596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bb00706-7c3a-4399-8229-2d89eb73dbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D4C4C200>]}
[0m14:43:39.395596 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:39.470214 [debug] [MainThread]: On master: Close
[0m14:43:39.472207 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:43:39.472909 [info ] [MainThread]: 
[0m14:43:39.485198 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:43:39.486198 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:43:39.486198 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:43:39.486198 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:43:39.487196 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:43:39.487196 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:43:39.488196 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:43:39.488196 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:43:39.488196 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:43:39.489196 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:43:39.490197 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:43:39.490197 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:43:39.491197 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:43:39.491197 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:43:39.492195 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:43:39.492195 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:43:39.493008 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:43:39.493008 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:43:39.493008 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:43:39.494104 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:43:39.495151 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:43:39.495151 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:43:39.496160 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:43:39.496160 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:43:39.497162 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:43:39.498161 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:43:39.500164 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:43:39.501191 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:43:39.502172 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:43:39.503161 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:43:39.504167 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:43:39.506196 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:43:39.508160 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:43:39.509161 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:43:39.510160 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:43:39.510160 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:43:39.511160 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:43:39.512161 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:43:39.513162 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:43:39.514161 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:43:39.515162 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:43:39.516161 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:43:39.516161 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:43:39.516161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:43:39.517162 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:43:39.517162 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:43:39.518183 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:43:39.518183 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:43:39.521505 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:43:39.519161 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:43:39.519161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:43:39.520161 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:43:39.520161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:43:39.520161 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:43:39.521161 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:43:39.519161 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:43:39.521505 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:43:39.521505 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:43:39.522527 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:43:39.524651 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:43:39.530561 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:43:39.524651 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:43:39.525550 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:43:39.525550 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:43:39.526559 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:43:39.526559 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:43:39.529560 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:43:39.524651 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:43:39.530561 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:43:39.532560 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:43:39.533726 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:43:39.535730 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:43:39.537238 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:43:39.538237 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:43:39.540320 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:43:39.541239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:43:39.541239 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:43:39.542237 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:43:39.543239 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:43:39.543239 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:43:39.544239 [debug] [Thread-7 (]: Began running node model.redshift.svv_diskusage
[0m14:43:39.544239 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:43:39.545237 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:43:39.545237 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:43:39.545237 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:43:39.546237 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:43:39.546237 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:43:39.546237 [debug] [Thread-2 (]: Began running node model.redshift.redshift_cost
[0m14:43:39.547238 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.svv_diskusage)
[0m14:43:39.549256 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:43:39.550237 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:43:39.550237 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:43:39.550237 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:43:39.551237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_cost)
[0m14:43:39.551237 [debug] [Thread-7 (]: Began compiling node model.redshift.svv_diskusage
[0m14:43:39.551237 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:43:39.552239 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:43:39.552239 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:43:39.552239 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:43:39.553238 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_cost
[0m14:43:39.554255 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:43:39.559236 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:43:39.564275 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:43:39.571429 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:43:39.575971 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:43:39.577005 [debug] [Thread-7 (]: Finished running node model.redshift.svv_diskusage
[0m14:43:39.577965 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:43:39.577965 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:43:39.578932 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_cost
[0m14:43:39.579928 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:43:39.580927 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:43:39.580927 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:43:39.581974 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:43:39.581974 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:43:39.582964 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:43:39.583932 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_table_stats)
[0m14:43:39.583932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:43:39.584927 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:43:39.584927 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:43:39.615937 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:43:39.625969 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:43:39.626935 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:43:39.626935 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:43:39.626935 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:43:39.628252 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:43:39.629060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:39.630068 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:43:39.630068 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:43:39.630068 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:43:39.630068 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:43:39.630068 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:43:39.631074 [debug] [MainThread]: Connection 'model.redshift.stl_query' was properly closed.
[0m14:43:39.631074 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:43:39.631074 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:43:39.631074 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:43:39.632134 [debug] [MainThread]: Command end result
[0m14:43:39.693876 [debug] [MainThread]: Command `dbt compile` succeeded at 14:43:39.693876 after 2.25 seconds
[0m14:43:39.695021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2C07F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2B12F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159D2B12CF0>]}
[0m14:43:39.695021 [debug] [MainThread]: Flushing usage events
[0m14:46:38.824280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE4114A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE4114470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE3899AF0>]}


============================== 14:46:38.827301 | b34fa16e-1457-496a-a813-39873b7d09bd ==============================
[0m14:46:38.827301 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:46:38.827301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:38.921990 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:46:38.921990 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:46:39.027822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b34fa16e-1457-496a-a813-39873b7d09bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE3DB04A0>]}
[0m14:46:39.064805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b34fa16e-1457-496a-a813-39873b7d09bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE40AEEA0>]}
[0m14:46:39.066037 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:46:39.083958 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:46:39.178664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:39.178664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:39.182615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m14:46:39.196810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b34fa16e-1457-496a-a813-39873b7d09bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE4F4A3C0>]}
[0m14:46:39.241158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b34fa16e-1457-496a-a813-39873b7d09bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE62D4110>]}
[0m14:46:39.241158 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:46:39.242154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b34fa16e-1457-496a-a813-39873b7d09bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE4F0C650>]}
[0m14:46:39.244151 [info ] [MainThread]: 
[0m14:46:39.244151 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:46:39.247513 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:46:39.256817 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:46:39.257819 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:46:39.257819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:39.261816 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:46:39.261816 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:46:39.801785 [debug] [ThreadPool]: SQL status: SUCCESS in 0.544 seconds
[0m14:46:39.804187 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:46:39.805186 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:46:39.939628 [debug] [ThreadPool]: SQL status: SUCCESS in 0.133 seconds
[0m14:46:39.943623 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:46:40.019943 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:46:40.029970 [debug] [MainThread]: Using redshift connection "master"
[0m14:46:40.030970 [debug] [MainThread]: On master: BEGIN
[0m14:46:40.030970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:40.030970 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:46:40.031954 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:46:40.461034 [debug] [MainThread]: SQL status: SUCCESS in 0.430 seconds
[0m14:46:40.463021 [debug] [MainThread]: Using redshift connection "master"
[0m14:46:40.464026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:46:40.638698 [debug] [MainThread]: SQL status: SUCCESS in 0.173 seconds
[0m14:46:40.641809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b34fa16e-1457-496a-a813-39873b7d09bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE609BD10>]}
[0m14:46:40.642761 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:40.715614 [debug] [MainThread]: On master: Close
[0m14:46:40.717641 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:46:40.718634 [info ] [MainThread]: 
[0m14:46:40.730201 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:46:40.731199 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:46:40.731199 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:46:40.732199 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:46:40.732199 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:46:40.733199 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:46:40.733199 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:46:40.733199 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:46:40.734197 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:46:40.734197 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:46:40.735198 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:46:40.735198 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:46:40.736199 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:46:40.736199 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:46:40.737198 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:46:40.737198 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:46:40.737198 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:46:40.738198 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:46:40.738198 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:46:40.738198 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:46:40.740215 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:46:40.740215 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:46:40.741200 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:46:40.741200 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:46:40.741200 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:46:40.742198 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:46:40.743017 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:46:40.745040 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:46:40.746040 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:46:40.747072 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:46:40.748040 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:46:40.750039 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:46:40.752085 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:46:40.753041 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:46:40.754040 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:46:40.754040 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:46:40.755039 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:46:40.755039 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:46:40.756072 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:46:40.757040 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:46:40.760040 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:46:40.758041 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:46:40.758041 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:46:40.759039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:46:40.759039 [debug] [Thread-5 (]: Began running node model.redshift.stl_explain
[0m14:46:40.759039 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:46:40.760040 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:46:40.757040 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:46:40.761040 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:46:40.761040 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:46:40.761040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:46:40.762040 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:46:40.762040 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_explain)
[0m14:46:40.762040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_query)
[0m14:46:40.763039 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:46:40.763039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:46:40.763039 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:46:40.763039 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:46:40.764039 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:46:40.766057 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:46:40.766057 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_explain
[0m14:46:40.767040 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:46:40.767040 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:46:40.767040 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:46:40.769063 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:46:40.769063 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:46:40.771039 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:46:40.772039 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:46:40.773044 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:46:40.774018 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:46:40.775070 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:46:40.777038 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:46:40.778039 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:46:40.779040 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:46:40.779040 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:46:40.780039 [debug] [Thread-5 (]: Finished running node model.redshift.stl_explain
[0m14:46:40.780039 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:46:40.780039 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:46:40.781038 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:46:40.782040 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:46:40.783072 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:46:40.783072 [debug] [Thread-7 (]: Began running node model.redshift.svv_diskusage
[0m14:46:40.784040 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:46:40.784040 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:46:40.786038 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:46:40.785039 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:46:40.785039 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:46:40.785039 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.svv_diskusage)
[0m14:46:40.786038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:46:40.784040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:46:40.786038 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:46:40.787039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:46:40.787039 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:46:40.787039 [debug] [Thread-7 (]: Began compiling node model.redshift.svv_diskusage
[0m14:46:40.788039 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:46:40.788039 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:46:40.793037 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:46:40.793414 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:46:40.793414 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:46:40.794437 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:46:40.799360 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:46:40.800362 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:46:40.807403 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:46:40.808362 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:46:40.812865 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:46:40.813136 [debug] [Thread-7 (]: Finished running node model.redshift.svv_diskusage
[0m14:46:40.814142 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:46:40.815142 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:46:40.815142 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:46:40.816141 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:46:40.817190 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:46:40.817190 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:46:40.818142 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:46:40.818142 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:46:40.819141 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_queries
[0m14:46:40.819141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_admin_table_stats)
[0m14:46:40.820141 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_admin_queries)
[0m14:46:40.820141 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:46:40.820141 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:46:40.835205 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:46:40.840139 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:46:40.841135 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:46:40.841135 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:46:40.842167 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:46:40.843163 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:46:40.844173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:40.845179 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:46:40.845179 [debug] [MainThread]: Connection 'model.redshift.stv_tbl_perm' was properly closed.
[0m14:46:40.846324 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:46:40.846324 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:46:40.846324 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:46:40.846324 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:46:40.847331 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:46:40.847331 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:46:40.847331 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:46:40.848330 [debug] [MainThread]: Command end result
[0m14:46:40.906428 [debug] [MainThread]: Command `dbt compile` succeeded at 14:46:40.906428 after 2.21 seconds
[0m14:46:40.907402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE3C76E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE3C75640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE68047A0>]}
[0m14:46:40.907402 [debug] [MainThread]: Flushing usage events
[0m14:47:31.943118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22E4E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22E4E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22E4EA50>]}


============================== 14:47:31.949112 | 698a1401-a9fa-4822-b36a-66dcbe0f3a3a ==============================
[0m14:47:31.949112 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:47:31.950117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:32.046208 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:47:32.046208 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:47:32.142192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD237248F0>]}
[0m14:47:32.178198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD23DBA4E0>]}
[0m14:47:32.180131 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:47:32.198439 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:47:32.236720 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:47:32.237709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD252E8110>]}
[0m14:47:33.144507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.customer
[0m14:47:33.149507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD25440CE0>]}
[0m14:47:33.193463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD25482C00>]}
[0m14:47:33.193463 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:47:33.195396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22E108C0>]}
[0m14:47:33.197400 [info ] [MainThread]: 
[0m14:47:33.206989 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:47:33.209987 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:47:33.219986 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:47:33.219986 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:47:33.221285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:33.223294 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:33.224291 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:33.756036 [debug] [ThreadPool]: SQL status: SUCCESS in 0.535 seconds
[0m14:47:33.757034 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:47:33.758037 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:47:33.899540 [debug] [ThreadPool]: SQL status: SUCCESS in 0.141 seconds
[0m14:47:33.903536 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:47:33.990514 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:47:34.008584 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:34.009512 [debug] [MainThread]: On master: BEGIN
[0m14:47:34.009512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:34.010499 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:34.010499 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:34.426729 [debug] [MainThread]: SQL status: SUCCESS in 0.417 seconds
[0m14:47:34.428737 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:34.429728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:47:34.606858 [debug] [MainThread]: SQL status: SUCCESS in 0.176 seconds
[0m14:47:34.609848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698a1401-a9fa-4822-b36a-66dcbe0f3a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD24019730>]}
[0m14:47:34.610849 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:34.691579 [debug] [MainThread]: On master: Close
[0m14:47:34.692519 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:47:34.693556 [info ] [MainThread]: 
[0m14:47:34.697379 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:47:34.698685 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:47:34.698685 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:47:34.699692 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:47:34.700710 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:47:34.700710 [debug] [Thread-1 (]: Began running node model.redshift.pg_class
[0m14:47:34.701701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_class)
[0m14:47:34.701701 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:47:34.702725 [debug] [Thread-2 (]: Began running node model.redshift.pg_namespace
[0m14:47:34.702725 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_class
[0m14:47:34.702725 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:47:34.703709 [debug] [Thread-4 (]: Began running node model.redshift.pg_user
[0m14:47:34.703709 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:47:34.704729 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:47:34.704729 [debug] [Thread-6 (]: Began running node model.redshift.redshift_columns
[0m14:47:34.704729 [debug] [Thread-8 (]: Began running node model.redshift.redshift_constraints
[0m14:47:34.704729 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:47:34.706734 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:47:34.706734 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:47:34.707692 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:47:34.710690 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_user
[0m14:47:34.707692 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:47:34.708690 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:47:34.714197 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_columns
[0m14:47:34.708690 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_constraints'
[0m14:47:34.710690 [debug] [Thread-1 (]: Finished running node model.redshift.pg_class
[0m14:47:34.710690 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:47:34.708690 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:47:34.712690 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:47:34.713193 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:47:34.709703 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_namespace
[0m14:47:34.716198 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:47:34.722571 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_columns
[0m14:47:34.722571 [debug] [Thread-6 (]: Began running node model.redshift.redshift_tables
[0m14:47:34.718565 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:47:34.719598 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:47:34.720570 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:47:34.721570 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:47:34.721570 [debug] [Thread-4 (]: Finished running node model.redshift.pg_user
[0m14:47:34.717198 [debug] [Thread-1 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:47:34.717198 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_constraints
[0m14:47:34.723570 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_tables)
[0m14:47:34.724570 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:47:34.725571 [debug] [Thread-3 (]: Began running node model.redshift.stl_explain
[0m14:47:34.730423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.stl_explain)
[0m14:47:34.727333 [debug] [Thread-2 (]: Finished running node model.redshift.pg_namespace
[0m14:47:34.727333 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:47:34.727333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:47:34.729332 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:47:34.730423 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_tables
[0m14:47:34.725571 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:47:34.731333 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_explain
[0m14:47:34.731333 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:47:34.732336 [debug] [Thread-2 (]: Began running node model.redshift.stl_wlm_query
[0m14:47:34.732336 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_query)
[0m14:47:34.733331 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:47:34.733331 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_constraints
[0m14:47:34.735330 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:47:34.736331 [debug] [Thread-5 (]: Began running node model.redshift.stv_blocklist
[0m14:47:34.737366 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:47:34.737366 [debug] [Thread-7 (]: Began running node model.redshift.stv_partitions
[0m14:47:34.738332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_wlm_query)
[0m14:47:34.738332 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:47:34.740357 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:47:34.741331 [debug] [Thread-8 (]: Began running node model.redshift.stv_tbl_perm
[0m14:47:34.741528 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stv_blocklist)
[0m14:47:34.741528 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_tables
[0m14:47:34.742535 [debug] [Thread-3 (]: Finished running node model.redshift.stl_explain
[0m14:47:34.743535 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_partitions)
[0m14:47:34.743535 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:47:34.744534 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:47:34.745533 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:47:34.749535 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:47:34.746534 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:47:34.746534 [debug] [Thread-6 (]: Began running node model.redshift.svv_diskusage
[0m14:47:34.746534 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:47:34.747538 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_partitions
[0m14:47:34.748539 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:47:34.745533 [debug] [Thread-5 (]: Began compiling node model.redshift.stv_blocklist
[0m14:47:34.751590 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:47:34.751590 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:47:34.755688 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:34.752535 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:34.752535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_dependencies)
[0m14:47:34.753535 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:47:34.754634 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:47:34.757652 [debug] [Thread-5 (]: Finished running node model.redshift.stv_blocklist
[0m14:47:34.752535 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.svv_diskusage)
[0m14:47:34.756653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:47:34.756653 [debug] [Thread-8 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:47:34.756653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:47:34.757652 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:47:34.755688 [debug] [Thread-2 (]: Finished running node model.redshift.stl_wlm_query
[0m14:47:34.758653 [debug] [Thread-5 (]: Began running node model.redshift.redshift_cost
[0m14:47:34.758653 [debug] [Thread-7 (]: Finished running node model.redshift.stv_partitions
[0m14:47:34.758653 [debug] [Thread-6 (]: Began compiling node model.redshift.svv_diskusage
[0m14:47:34.759653 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:34.759653 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:34.764669 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:47:34.765652 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_cost)
[0m14:47:34.767116 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:47:34.774178 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:34.779278 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:34.780275 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_cost
[0m14:47:34.780275 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:47:34.781181 [debug] [Thread-6 (]: Finished running node model.redshift.svv_diskusage
[0m14:47:34.781181 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:34.786687 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:47:34.787124 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:34.787124 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:47:34.788130 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:34.789211 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:47:34.789211 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:34.790135 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_cost
[0m14:47:34.791130 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_table_stats)
[0m14:47:34.791130 [debug] [Thread-7 (]: Began running node model.redshift.redshift_admin_queries
[0m14:47:34.792070 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:47:34.792070 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_queries)
[0m14:47:34.806075 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:47:34.806607 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:47:34.811611 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:47:34.811611 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:47:34.812613 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:47:34.812613 [debug] [Thread-7 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:47:34.813613 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:47:34.814613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:34.814613 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:47:34.814613 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:47:34.814613 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:47:34.815613 [debug] [MainThread]: Connection 'model.redshift.stl_wlm_query' was properly closed.
[0m14:47:34.815613 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:47:34.815613 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:47:34.815613 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:47:34.815613 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:47:34.816617 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:47:34.816617 [debug] [MainThread]: Command end result
[0m14:47:34.838613 [debug] [MainThread]: Command `dbt compile` succeeded at 14:47:34.838613 after 3.04 seconds
[0m14:47:34.838613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22900920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD251CC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD25440AD0>]}
[0m14:47:34.839613 [debug] [MainThread]: Flushing usage events
[0m14:47:42.092915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED115B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED1158830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED11E4B60>]}


============================== 14:47:42.095926 | e0ca0150-ef13-4995-89d2-23c76ae586b8 ==============================
[0m14:47:42.095926 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:47:42.096923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:47:42.194302 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:47:42.194302 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:47:42.291964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED1C0DBE0>]}
[0m14:47:42.324924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED0E15730>]}
[0m14:47:42.325924 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:47:42.344940 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:47:42.448482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:47:42.448482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:47:42.452559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.customer
[0m14:47:42.464481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED1322690>]}
[0m14:47:42.509588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED1CDB0B0>]}
[0m14:47:42.510588 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:47:42.510588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED1A5F5F0>]}
[0m14:47:42.512618 [info ] [MainThread]: 
[0m14:47:42.513587 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:47:42.516588 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m14:47:42.526588 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m14:47:42.527587 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m14:47:42.527587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:42.529589 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:42.530588 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:43.129679 [debug] [ThreadPool]: SQL status: SUCCESS in 0.602 seconds
[0m14:47:43.133672 [debug] [ThreadPool]: On list_integrity-db: Close
[0m14:47:43.137672 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:47:43.144715 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:47:43.145786 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:47:43.145786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:43.146670 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:43.146670 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:43.587552 [debug] [ThreadPool]: SQL status: SUCCESS in 0.441 seconds
[0m14:47:43.589554 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:47:43.590552 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:47:43.726996 [debug] [ThreadPool]: SQL status: SUCCESS in 0.135 seconds
[0m14:47:43.731988 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:47:43.811809 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:47:43.826314 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:43.827311 [debug] [MainThread]: On master: BEGIN
[0m14:47:43.827311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:43.828314 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:43.828314 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:44.282051 [debug] [MainThread]: SQL status: SUCCESS in 0.455 seconds
[0m14:47:44.284111 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:44.285084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:47:44.502197 [debug] [MainThread]: SQL status: SUCCESS in 0.215 seconds
[0m14:47:44.504197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED115BC20>]}
[0m14:47:44.505197 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:44.589507 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:44.590504 [debug] [MainThread]: On master: BEGIN
[0m14:47:44.634507 [debug] [MainThread]: SQL status: SUCCESS in 0.044 seconds
[0m14:47:44.636547 [debug] [MainThread]: On master: COMMIT
[0m14:47:44.637582 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:44.638518 [debug] [MainThread]: On master: COMMIT
[0m14:47:44.717108 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m14:47:44.717108 [debug] [MainThread]: On master: Close
[0m14:47:44.718191 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:47:44.720490 [info ] [MainThread]: 
[0m14:47:44.724146 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:47:44.725195 [debug] [Thread-3 (]: Began running node model.redshift.pg_class
[0m14:47:44.725195 [debug] [Thread-2 (]: Began running node model.redshift.pg_depend
[0m14:47:44.726145 [debug] [Thread-5 (]: Began running node model.redshift.pg_namespace
[0m14:47:44.726145 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:47:44.727144 [debug] [Thread-4 (]: Began running node model.redshift.pg_tables
[0m14:47:44.727144 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:47:44.727144 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:47:44.728143 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:47:44.728143 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:47:44.728143 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:47:44.729146 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:47:44.729146 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:47:44.730144 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:47:44.730144 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:47:44.730144 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:47:44.731143 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_class
[0m14:47:44.731143 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:47:44.732183 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_depend
[0m14:47:44.732183 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_namespace
[0m14:47:44.733145 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:47:44.734143 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_tables
[0m14:47:44.734143 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:47:44.735143 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:47:44.736142 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:47:44.736142 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:47:44.737143 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:47:44.738143 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:47:44.740143 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:47:44.740143 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:47:44.743145 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:47:44.744144 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:47:44.751995 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:47:44.751995 [debug] [Thread-7 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:47:44.749017 [debug] [Thread-5 (]: Finished running node model.redshift.pg_namespace
[0m14:47:44.752995 [debug] [Thread-5 (]: Began running node model.redshift.redshift_tables
[0m14:47:44.752995 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_tables)
[0m14:47:44.750989 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:47:44.753995 [debug] [Thread-6 (]: Began running node model.redshift.stl_explain
[0m14:47:44.750989 [debug] [Thread-4 (]: Finished running node model.redshift.pg_tables
[0m14:47:44.748011 [debug] [Thread-3 (]: Finished running node model.redshift.pg_class
[0m14:47:44.755994 [debug] [Thread-3 (]: Began running node model.redshift.stl_wlm_query
[0m14:47:44.750033 [debug] [Thread-2 (]: Finished running node model.redshift.pg_depend
[0m14:47:44.750033 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:47:44.753995 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_tables
[0m14:47:44.753995 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_explain)
[0m14:47:44.747143 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:47:44.754995 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m14:47:44.759994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:47:44.755994 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.stl_wlm_query)
[0m14:47:44.756995 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m14:47:44.756995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:47:44.759994 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:47:44.759994 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_explain
[0m14:47:44.752995 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_sort_dist_keys)
[0m14:47:44.760994 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m14:47:44.760994 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:47:44.761995 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:47:44.761995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.stv_blocklist)
[0m14:47:44.761995 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:47:44.763994 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:47:44.764744 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_tables
[0m14:47:44.764744 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:47:44.765773 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:47:44.766773 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:47:44.767868 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:47:44.767868 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m14:47:44.769814 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:47:44.770872 [debug] [Thread-5 (]: Began running node model.redshift.stv_tbl_perm
[0m14:47:44.771773 [debug] [Thread-6 (]: Finished running node model.redshift.stl_explain
[0m14:47:44.773812 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:47:44.773812 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:47:44.774773 [debug] [Thread-3 (]: Finished running node model.redshift.stl_wlm_query
[0m14:47:44.774773 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m14:47:44.776776 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:47:44.777800 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_tbl_perm)
[0m14:47:44.780804 [debug] [Thread-5 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:47:44.778804 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:47:44.779805 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:47:44.779805 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:47:44.779805 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:44.780804 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:44.777800 [debug] [Thread-6 (]: Began running node model.redshift.svv_diskusage
[0m14:47:44.782804 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:47:44.782804 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m14:47:44.783805 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:47:44.783805 [debug] [Thread-7 (]: Began running node model.redshift.redshift_cost
[0m14:47:44.785803 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:47:44.786516 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.svv_diskusage)
[0m14:47:44.786099 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m14:47:44.786516 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m14:47:44.787492 [debug] [Thread-5 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:47:44.788694 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.redshift_cost)
[0m14:47:44.790704 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_cost
[0m14:47:44.789712 [debug] [Thread-6 (]: Began compiling node model.redshift.svv_diskusage
[0m14:47:44.789712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:47:44.789712 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:47:44.790704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:47:44.788694 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m14:47:44.796521 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:47:44.797942 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:47:44.797942 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:44.799028 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:44.799028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.redshift_admin_dependencies)
[0m14:47:44.804056 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:44.805148 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_cost
[0m14:47:44.812174 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:44.812722 [debug] [Thread-6 (]: Finished running node model.redshift.svv_diskusage
[0m14:47:44.813754 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:47:44.813754 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:44.814753 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_queries
[0m14:47:44.814753 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:47:44.815753 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:44.820818 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:47:44.843757 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:44.840820 [info ] [Thread-2 (]: 4 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m14:47:44.846753 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:44.844754 [info ] [Thread-5 (]: 5 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m14:47:44.847753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_queries)
[0m14:47:44.847753 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:47:44.850752 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:44.850999 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_table_stats)
[0m14:47:44.850999 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:47:44.854035 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:44.856019 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m14:47:44.856889 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:47:44.856889 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:47:44.862931 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:47:44.863249 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:47:44.863249 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:47:44.876276 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:44.920864 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:47:44.921893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:47:44.922517 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:47:44.922517 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:44.922517 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:47:44.923524 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:44.923524 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:47:44.926524 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m14:47:44.926524 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:44.927525 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:44.927525 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:44.930599 [debug] [Thread-5 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m14:47:44.931528 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:44.934624 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:44.937608 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:44.938608 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:47:44.946608 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:44.948952 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:47:44.951952 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:47:44.952953 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:44.954860 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:47:44.956858 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:44.957858 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:44.958858 [debug] [Thread-5 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:45.462830 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.508 seconds
[0m14:47:45.470596 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.521 seconds
[0m14:47:45.474590 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:45.472593 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.551 seconds
[0m14:47:45.471591 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:45.475591 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m14:47:45.476587 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:45.476587 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.550 seconds
[0m14:47:45.479602 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:45.478591 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.615 seconds
[0m14:47:45.480596 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:45.477588 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m14:47:45.479602 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m14:47:45.479602 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m14:47:45.481596 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m14:47:45.775831 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.294 seconds
[0m14:47:45.784001 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:45.784001 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.302 seconds
[0m14:47:45.785065 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m14:47:45.787043 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:45.788007 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m14:47:45.799422 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.321 seconds
[0m14:47:45.800441 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.318 seconds
[0m14:47:45.804447 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:45.804447 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.323 seconds
[0m14:47:45.807440 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:45.810414 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m14:47:45.809441 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:45.807440 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m14:47:45.810414 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m14:47:45.900918 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.113 seconds
[0m14:47:45.907886 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:45.908983 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.120 seconds
[0m14:47:45.909921 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m14:47:45.913926 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:45.914887 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m14:47:45.925554 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.114 seconds
[0m14:47:45.930630 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:45.931594 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m14:47:45.932551 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.121 seconds
[0m14:47:45.934625 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:45.935561 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.124 seconds
[0m14:47:45.935561 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m14:47:45.937630 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:45.938572 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m14:47:46.027036 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.112 seconds
[0m14:47:46.046071 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:47:46.047117 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:46.047117 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.132 seconds
[0m14:47:46.047117 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:47:46.047990 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:47:46.050310 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:46.050310 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:47:46.052624 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.114 seconds
[0m14:47:46.053652 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:47:46.053652 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:46.053652 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:47:46.054638 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m14:47:46.055637 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:47:46.055637 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:46.056636 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:47:46.061385 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.123 seconds
[0m14:47:46.063327 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:47:46.063327 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:46.063327 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:47:46.349732 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.300 seconds
[0m14:47:46.350734 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.296 seconds
[0m14:47:46.351759 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:46.352730 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.289 seconds
[0m14:47:46.353738 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:47:46.356735 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.306 seconds
[0m14:47:46.357734 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.301 seconds
[0m14:47:46.439035 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.081 seconds
[0m14:47:46.449044 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m14:47:46.453042 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:46.453042 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m14:47:46.539865 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.086 seconds
[0m14:47:46.542903 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:47:46.544861 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:46.544861 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:47:46.659719 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.113 seconds
[0m14:47:46.661712 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:47:46.662713 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:47:46.701048 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.038 seconds
[0m14:47:46.704990 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:46.705971 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:47:46.784806 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.078 seconds
[0m14:47:46.790959 [debug] [Thread-5 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m14:47:46.792959 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:46.793956 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m14:47:46.873228 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.079 seconds
[0m14:47:46.876252 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:47:46.877249 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:46.878250 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:47:47.024597 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.145 seconds
[0m14:47:47.025634 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:47:47.026597 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:47:47.065993 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.039 seconds
[0m14:47:47.068995 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:47.068995 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:47:47.152986 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m14:47:47.157945 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m14:47:47.159907 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:47.159907 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m14:47:47.241848 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.081 seconds
[0m14:47:47.244846 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:47:47.245844 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:47.246880 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:47:47.363088 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.116 seconds
[0m14:47:47.365088 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:47:47.365088 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:47:47.403346 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.037 seconds
[0m14:47:47.407375 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:47.408370 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:47:47.496022 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.087 seconds
[0m14:47:47.499720 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m14:47:47.501646 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:47.502615 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m14:47:47.592333 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.089 seconds
[0m14:47:47.596303 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:47:47.597315 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:47.598813 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:47:47.751492 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.152 seconds
[0m14:47:47.751492 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:47:47.752495 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:47:47.791064 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.038 seconds
[0m14:47:47.794069 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:47.795131 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:47:47.875758 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m14:47:47.877759 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m14:47:47.879759 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:47.879759 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m14:47:47.960289 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.080 seconds
[0m14:47:47.962306 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:47:47.963313 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:47.964318 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:47:48.073496 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.108 seconds
[0m14:47:48.074492 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:47:48.075492 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:47:48.115661 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.038 seconds
[0m14:47:48.118660 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m14:47:48.119701 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m14:47:48.121040 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m14:47:48.122091 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m14:47:48.123068 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m14:47:48.200011 [debug] [Thread-5 (]: On model.redshift.redshift_admin_table_stats: Close
[0m14:47:48.204030 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED34B1E50>]}
[0m14:47:48.206026 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m14:47:48.205027 [info ] [Thread-5 (]: 5 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.35s]
[0m14:47:48.209025 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EECED496A0>]}
[0m14:47:48.210051 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: Close
[0m14:47:48.211026 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m14:47:48.211414 [debug] [Thread-1 (]: On model.redshift.redshift_admin_dependencies: Close
[0m14:47:48.212440 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:47:48.212440 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.42s]
[0m14:47:48.214438 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED34C1730>]}
[0m14:47:48.214438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED306B020>]}
[0m14:47:48.215444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca0150-ef13-4995-89d2-23c76ae586b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED1CBFB90>]}
[0m14:47:48.216438 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:47:48.217438 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.42s]
[0m14:47:48.217438 [info ] [Thread-2 (]: 4 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.37s]
[0m14:47:48.218442 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.42s]
[0m14:47:48.219437 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:47:48.219437 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:47:48.220446 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:47:48.221858 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:48.221858 [debug] [MainThread]: On master: BEGIN
[0m14:47:48.221858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:48.222863 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:47:48.222863 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:47:48.667542 [debug] [MainThread]: SQL status: SUCCESS in 0.445 seconds
[0m14:47:48.669536 [debug] [MainThread]: On master: COMMIT
[0m14:47:48.670527 [debug] [MainThread]: Using redshift connection "master"
[0m14:47:48.671532 [debug] [MainThread]: On master: COMMIT
[0m14:47:48.761056 [debug] [MainThread]: SQL status: SUCCESS in 0.088 seconds
[0m14:47:48.762119 [debug] [MainThread]: On master: Close
[0m14:47:48.764049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:48.764049 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m14:47:48.765070 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:47:48.766052 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:47:48.766052 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:47:48.767049 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:47:48.767049 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:47:48.768049 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:47:48.768049 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:47:48.769048 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:47:48.769048 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:47:48.769048 [info ] [MainThread]: 
[0m14:47:48.771507 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m14:47:48.775509 [debug] [MainThread]: Command end result
[0m14:47:48.800517 [info ] [MainThread]: 
[0m14:47:48.801021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:48.801692 [info ] [MainThread]: 
[0m14:47:48.801692 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:47:48.802492 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:48.802492 after 6.79 seconds
[0m14:47:48.802492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED0EA2F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED0EA31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EED2E52C30>]}
[0m14:47:48.803497 [debug] [MainThread]: Flushing usage events
[0m14:48:13.638739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA12496A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3A936B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3A90830>]}


============================== 14:48:13.642718 | 399d11f8-da11-4942-b119-b87be3ba488d ==============================
[0m14:48:13.642718 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:48:13.643697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:13.712202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '399d11f8-da11-4942-b119-b87be3ba488d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3B0BC20>]}
[0m14:48:13.769471 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-q8ptto_5'
[0m14:48:13.770652 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:48:13.922037 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:48:13.924037 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:48:13.993429 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:48:13.998423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m14:48:14.131683 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m14:48:14.133684 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m14:48:14.198376 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m14:48:14.201366 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m14:48:14.271433 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m14:48:14.275427 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:48:14.618799 [info ] [MainThread]: Installed from version 1.0.0
[0m14:48:14.619804 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:48:14.619804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '399d11f8-da11-4942-b119-b87be3ba488d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3F329F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3F81D30>]}
[0m14:48:14.620801 [info ] [MainThread]: Installing dbt-labs/redshift
[0m14:48:14.799421 [info ] [MainThread]: Installed from version 0.9.0
[0m14:48:14.800421 [info ] [MainThread]: Up to date!
[0m14:48:14.800421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '399d11f8-da11-4942-b119-b87be3ba488d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3D3BA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3D3AAB0>]}
[0m14:48:14.800421 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m14:48:15.109510 [info ] [MainThread]: Installed from version 0.8.2
[0m14:48:15.109510 [info ] [MainThread]: Updated version available: 0.9.0
[0m14:48:15.110511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '399d11f8-da11-4942-b119-b87be3ba488d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA2CC34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA2CC32C0>]}
[0m14:48:15.110511 [info ] [MainThread]: Installing dbt-labs/codegen
[0m14:48:15.383950 [info ] [MainThread]: Installed from version 0.9.0
[0m14:48:15.384949 [info ] [MainThread]: Updated version available: 0.12.1
[0m14:48:15.384949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '399d11f8-da11-4942-b119-b87be3ba488d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3D3B800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3D3BA40>]}
[0m14:48:15.385949 [info ] [MainThread]: 
[0m14:48:15.385949 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m14:48:15.387949 [debug] [MainThread]: Command `dbt deps` succeeded at 14:48:15.387949 after 1.85 seconds
[0m14:48:15.387949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA31F7BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3792FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3EFE3F0>]}
[0m14:48:15.388949 [debug] [MainThread]: Flushing usage events
[0m14:48:25.621439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3E86C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3EF62360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3E3F3A40>]}


============================== 14:48:25.629449 | 4ec68bdd-a663-44f5-853b-fe067627779b ==============================
[0m14:48:25.629449 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:48:25.630450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:25.761012 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:48:25.762010 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:48:25.900488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3FAF4920>]}
[0m14:48:25.948008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3FA18980>]}
[0m14:48:25.950009 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:48:25.997025 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:48:26.048501 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:48:26.049546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A40D68800>]}
[0m14:48:27.584854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.customer
[0m14:48:27.588901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A40EAE1E0>]}
[0m14:48:27.632054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A40D69130>]}
[0m14:48:27.633053 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:48:27.633053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3E834590>]}
[0m14:48:27.635077 [info ] [MainThread]: 
[0m14:48:27.636053 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:48:27.639056 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:48:27.648557 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:48:27.649558 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:48:27.649558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:27.652559 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:48:27.653559 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:48:28.170040 [debug] [ThreadPool]: SQL status: SUCCESS in 0.520 seconds
[0m14:48:28.171039 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:48:28.172039 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:48:28.307810 [debug] [ThreadPool]: SQL status: SUCCESS in 0.134 seconds
[0m14:48:28.311505 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:48:28.395638 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:48:28.408621 [debug] [MainThread]: Using redshift connection "master"
[0m14:48:28.408621 [debug] [MainThread]: On master: BEGIN
[0m14:48:28.408621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:28.409623 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:48:28.409623 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:48:28.845847 [debug] [MainThread]: SQL status: SUCCESS in 0.436 seconds
[0m14:48:28.846874 [debug] [MainThread]: Using redshift connection "master"
[0m14:48:28.848332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:48:29.011280 [debug] [MainThread]: SQL status: SUCCESS in 0.161 seconds
[0m14:48:29.014015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ec68bdd-a663-44f5-853b-fe067627779b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A40C36AE0>]}
[0m14:48:29.014015 [debug] [MainThread]: On master: ROLLBACK
[0m14:48:29.094353 [debug] [MainThread]: On master: Close
[0m14:48:29.096424 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:48:29.099352 [info ] [MainThread]: 
[0m14:48:29.108719 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:48:29.108719 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:48:29.109722 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:48:29.109722 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:48:29.110718 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:48:29.110718 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:48:29.111758 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:48:29.111758 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:48:29.111758 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:48:29.112718 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:48:29.113274 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:48:29.113274 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:48:29.114295 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:48:29.114295 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:48:29.115294 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:48:29.115294 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:48:29.118312 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:48:29.118312 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:48:29.119294 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:48:29.119294 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:48:29.120694 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:48:29.121703 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:48:29.121703 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:48:29.121703 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:48:29.121703 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:48:29.123001 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:48:29.125008 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:48:29.127006 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:48:29.128006 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:48:29.129007 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:48:29.131023 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:48:29.132008 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:48:29.134028 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:48:29.139012 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:48:29.136011 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:48:29.136011 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:48:29.137012 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:48:29.137012 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:48:29.138011 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:48:29.135011 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:48:29.139012 [debug] [Thread-8 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:48:29.139012 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:48:29.140012 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:48:29.140012 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:48:29.140012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:48:29.141011 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:48:29.141011 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:48:29.142010 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m14:48:29.142010 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_sort_dist_keys)
[0m14:48:29.143011 [debug] [Thread-7 (]: Began running node model.redshift.stv_partitions
[0m14:48:29.143011 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:48:29.143011 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:48:29.144012 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:48:29.144012 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:48:29.144012 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:48:29.145011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.stv_blocklist)
[0m14:48:29.145011 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:48:29.145011 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_partitions)
[0m14:48:29.145011 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:48:29.146011 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:48:29.147010 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:48:29.148011 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:48:29.148011 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:48:29.149151 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m14:48:29.151169 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:48:29.151169 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_partitions
[0m14:48:29.152151 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:48:29.154152 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:48:29.154152 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:48:29.155152 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:48:29.157152 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:48:29.159169 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:48:29.160185 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:48:29.161152 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:48:29.161152 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:48:29.161152 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:48:29.162174 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:48:29.163153 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:48:29.163153 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:48:29.164151 [debug] [Thread-8 (]: Began running node model.redshift.svv_diskusage
[0m14:48:29.164151 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m14:48:29.165152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:48:29.165152 [debug] [Thread-7 (]: Finished running node model.redshift.stv_partitions
[0m14:48:29.166151 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:48:29.166151 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:48:29.166151 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:48:29.167151 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:48:29.167151 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:48:29.167151 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:48:29.168131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:48:29.168131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:48:29.168131 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:48:29.168131 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:48:29.169492 [debug] [Thread-8 (]: Began compiling node model.redshift.svv_diskusage
[0m14:48:29.170541 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:48:29.170541 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:48:29.170541 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:48:29.171519 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:48:29.171519 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:48:29.172606 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:48:29.177629 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:48:29.182631 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:48:29.183615 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:48:29.189660 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:48:29.194288 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:48:29.195266 [debug] [Thread-8 (]: Finished running node model.redshift.svv_diskusage
[0m14:48:29.195266 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:48:29.195266 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:48:29.196678 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:48:29.196678 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:48:29.197701 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:48:29.197701 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:48:29.198772 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:48:29.198772 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:48:29.199687 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:48:29.200222 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:48:29.201229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:48:29.201229 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:48:29.201229 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:48:29.216276 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:48:29.221226 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:48:29.221640 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:48:29.222663 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:48:29.222663 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:48:29.223663 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:48:29.225196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:29.226205 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:48:29.226205 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:48:29.226205 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:48:29.226205 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:48:29.226205 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:48:29.227202 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:48:29.227202 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:48:29.227202 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:48:29.227202 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:48:29.228202 [debug] [MainThread]: Command end result
[0m14:48:29.249879 [debug] [MainThread]: Command `dbt compile` succeeded at 14:48:29.249879 after 3.75 seconds
[0m14:48:29.249879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3EF62360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A40BF6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A40EE0530>]}
[0m14:48:29.250852 [debug] [MainThread]: Flushing usage events
[0m14:48:57.589392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018213D0BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018212EC19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018213D0A2A0>]}


============================== 14:48:57.592526 | c1c4f959-3c17-4e47-a7ac-c00072e7a1b3 ==============================
[0m14:48:57.592526 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:48:57.593525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:57.688975 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:48:57.688975 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:48:57.791629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018213EA6C90>]}
[0m14:48:57.826629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018213CEF110>]}
[0m14:48:57.827655 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:48:57.846734 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:48:57.901273 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:48:57.901933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018215AA7C20>]}
[0m14:48:58.802157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018212E6A060>]}
[0m14:48:58.844474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018215A63740>]}
[0m14:48:58.845473 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:48:58.846474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182135646B0>]}
[0m14:48:58.848474 [info ] [MainThread]: 
[0m14:48:58.848474 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:48:58.851478 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:48:58.862489 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:48:58.862489 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:48:58.863475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:58.865544 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:48:58.866544 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:48:59.456922 [debug] [ThreadPool]: SQL status: SUCCESS in 0.593 seconds
[0m14:48:59.458914 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:48:59.460917 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:48:59.597337 [debug] [ThreadPool]: SQL status: SUCCESS in 0.136 seconds
[0m14:48:59.601384 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:48:59.688178 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:48:59.701727 [debug] [MainThread]: Using redshift connection "master"
[0m14:48:59.701727 [debug] [MainThread]: On master: BEGIN
[0m14:48:59.702726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:59.702726 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:48:59.702726 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:00.140326 [debug] [MainThread]: SQL status: SUCCESS in 0.437 seconds
[0m14:49:00.141376 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:00.142324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:49:00.320760 [debug] [MainThread]: SQL status: SUCCESS in 0.177 seconds
[0m14:49:00.322755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1c4f959-3c17-4e47-a7ac-c00072e7a1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182159BDD30>]}
[0m14:49:00.323758 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:00.404958 [debug] [MainThread]: On master: Close
[0m14:49:00.407003 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:49:00.408914 [info ] [MainThread]: 
[0m14:49:00.421835 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:49:00.421835 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:49:00.422835 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:49:00.423833 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:49:00.423833 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:49:00.424873 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:49:00.425833 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:49:00.425833 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:49:00.426833 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:49:00.426833 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:49:00.427833 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:49:00.427833 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:49:00.428831 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:49:00.428831 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:49:00.429831 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:49:00.429831 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:49:00.429831 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:49:00.430831 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:49:00.431831 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:49:00.432831 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:49:00.432831 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:49:00.433831 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:49:00.433831 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:49:00.433831 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:49:00.435831 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:49:00.435831 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:49:00.437831 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:49:00.439831 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:49:00.440831 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:49:00.441831 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:49:00.444831 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:49:00.446163 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:49:00.447164 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:49:00.448163 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:49:00.449164 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:49:00.449164 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:49:00.449164 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:49:00.450162 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:49:00.451164 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:49:00.451164 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:49:00.452191 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:49:00.453164 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:49:00.453164 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:49:00.453164 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:49:00.454162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:49:00.454162 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:49:00.454162 [debug] [Thread-7 (]: Began running node model.redshift.stl_wlm_query
[0m14:49:00.455162 [debug] [Thread-6 (]: Began running node model.redshift.stv_blocklist
[0m14:49:00.455162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:49:00.456167 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:49:00.456167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:49:00.456167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:49:00.457163 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:49:00.457163 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:49:00.457163 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_wlm_query)
[0m14:49:00.457163 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stv_blocklist)
[0m14:49:00.458163 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:49:00.458163 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:49:00.458163 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:49:00.459163 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:49:00.461162 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:49:00.461392 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:49:00.461392 [debug] [Thread-7 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:49:00.461392 [debug] [Thread-6 (]: Began compiling node model.redshift.stv_blocklist
[0m14:49:00.463434 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:49:00.463434 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:49:00.465382 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:49:00.466359 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:49:00.467342 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:49:00.476572 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:49:00.477583 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:49:00.479579 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:49:00.481578 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:49:00.481578 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:49:00.483578 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:49:00.483578 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:49:00.483578 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:49:00.484581 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:49:00.484581 [debug] [Thread-7 (]: Finished running node model.redshift.stl_wlm_query
[0m14:49:00.485578 [debug] [Thread-6 (]: Finished running node model.redshift.stv_blocklist
[0m14:49:00.485578 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:49:00.486578 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:49:00.486578 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:49:00.487578 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:00.487578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:49:00.487578 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:00.488578 [debug] [Thread-7 (]: Began running node model.redshift.redshift_cost
[0m14:49:00.488578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:49:00.489578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:49:00.489578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:49:00.489578 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:49:00.489578 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:49:00.490578 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:49:00.490578 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:49:00.490578 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:49:00.490578 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:00.492082 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:49:00.493087 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:00.493087 [debug] [Thread-7 (]: Began compiling node model.redshift.redshift_cost
[0m14:49:00.494086 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:49:00.500086 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:49:00.505086 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:00.512085 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:00.517088 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:49:00.519087 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:49:00.519087 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:49:00.520086 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:49:00.520086 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:00.521086 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:00.521086 [debug] [Thread-7 (]: Finished running node model.redshift.redshift_cost
[0m14:49:00.522086 [debug] [Thread-6 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:49:00.522086 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:49:00.523087 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:00.523087 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:00.524086 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:49:00.524086 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_table_stats)
[0m14:49:00.525086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:49:00.526087 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:49:00.526087 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:49:00.540085 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:49:00.546086 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:49:00.546604 [debug] [Thread-6 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:49:00.546604 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:49:00.547636 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:49:00.548635 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:49:00.550206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:00.550206 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:49:00.550206 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:49:00.550206 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:49:00.551212 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:49:00.551212 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:49:00.551212 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:49:00.551212 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:49:00.551212 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:49:00.552212 [debug] [MainThread]: Connection 'model.redshift.stv_partitions' was properly closed.
[0m14:49:00.553247 [debug] [MainThread]: Command end result
[0m14:49:00.575211 [debug] [MainThread]: Command `dbt compile` succeeded at 14:49:00.575211 after 3.10 seconds
[0m14:49:00.575211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018212EC19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018212F1B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018213A53E30>]}
[0m14:49:00.576257 [debug] [MainThread]: Flushing usage events
[0m14:49:04.747904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A2909430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A498FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A498DEE0>]}


============================== 14:49:04.751925 | c44c6885-8cf7-4943-a841-1d21b77caedd ==============================
[0m14:49:04.751925 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:49:04.752925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:04.847345 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:49:04.847345 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:49:04.945490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A5CA6C90>]}
[0m14:49:04.978491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A53A5640>]}
[0m14:49:04.980494 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:49:04.999859 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:49:05.095817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:05.096817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:05.111480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A5D5FDD0>]}
[0m14:49:05.156305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A6D975F0>]}
[0m14:49:05.156305 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:49:05.157781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A4F3A120>]}
[0m14:49:05.158789 [info ] [MainThread]: 
[0m14:49:05.159790 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:49:05.162789 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m14:49:05.172826 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m14:49:05.173838 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m14:49:05.173838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:05.176153 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:05.177113 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:05.721747 [debug] [ThreadPool]: SQL status: SUCCESS in 0.548 seconds
[0m14:49:05.724785 [debug] [ThreadPool]: On list_integrity-db: Close
[0m14:49:05.728744 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m14:49:05.735735 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:49:05.736735 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m14:49:05.736735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:05.736735 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:05.737734 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:06.156642 [debug] [ThreadPool]: SQL status: SUCCESS in 0.419 seconds
[0m14:49:06.158638 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m14:49:06.159631 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m14:49:06.294276 [debug] [ThreadPool]: SQL status: SUCCESS in 0.134 seconds
[0m14:49:06.298267 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m14:49:06.374819 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m14:49:06.388852 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:06.388852 [debug] [MainThread]: On master: BEGIN
[0m14:49:06.388852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:06.390222 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:06.390222 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:06.825485 [debug] [MainThread]: SQL status: SUCCESS in 0.436 seconds
[0m14:49:06.826513 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:06.827576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:49:07.007399 [debug] [MainThread]: SQL status: SUCCESS in 0.178 seconds
[0m14:49:07.010353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A5CA68A0>]}
[0m14:49:07.011304 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:07.090348 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:07.092432 [debug] [MainThread]: On master: BEGIN
[0m14:49:07.131253 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m14:49:07.133247 [debug] [MainThread]: On master: COMMIT
[0m14:49:07.135246 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:07.136243 [debug] [MainThread]: On master: COMMIT
[0m14:49:07.215498 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m14:49:07.216523 [debug] [MainThread]: On master: Close
[0m14:49:07.217504 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:49:07.219466 [info ] [MainThread]: 
[0m14:49:07.229586 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m14:49:07.229586 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m14:49:07.230586 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m14:49:07.230586 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m14:49:07.231585 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m14:49:07.232585 [debug] [Thread-5 (]: Began running node model.redshift.pg_tables
[0m14:49:07.232585 [debug] [Thread-6 (]: Began running node model.redshift.pg_user
[0m14:49:07.232585 [debug] [Thread-7 (]: Began running node model.redshift.pg_views
[0m14:49:07.233585 [debug] [Thread-8 (]: Began running node model.redshift.redshift_columns
[0m14:49:07.233585 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m14:49:07.234594 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m14:49:07.234594 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m14:49:07.235586 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m14:49:07.236586 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m14:49:07.236586 [debug] [Thread-6 (]: Acquiring new redshift connection 'model.redshift.pg_user'
[0m14:49:07.237585 [debug] [Thread-7 (]: Acquiring new redshift connection 'model.redshift.pg_views'
[0m14:49:07.237585 [debug] [Thread-8 (]: Acquiring new redshift connection 'model.redshift.redshift_columns'
[0m14:49:07.237585 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m14:49:07.238585 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m14:49:07.238585 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m14:49:07.240601 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m14:49:07.240601 [debug] [Thread-5 (]: Began compiling node model.redshift.pg_tables
[0m14:49:07.241584 [debug] [Thread-6 (]: Began compiling node model.redshift.pg_user
[0m14:49:07.241584 [debug] [Thread-7 (]: Began compiling node model.redshift.pg_views
[0m14:49:07.241584 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_columns
[0m14:49:07.243584 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m14:49:07.245143 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m14:49:07.245371 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m14:49:07.247504 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m14:49:07.249502 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m14:49:07.249786 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m14:49:07.250834 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m14:49:07.252806 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m14:49:07.253806 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m14:49:07.253806 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m14:49:07.254806 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m14:49:07.254806 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m14:49:07.255806 [debug] [Thread-5 (]: Finished running node model.redshift.pg_tables
[0m14:49:07.256807 [debug] [Thread-6 (]: Finished running node model.redshift.pg_user
[0m14:49:07.256807 [debug] [Thread-7 (]: Finished running node model.redshift.pg_views
[0m14:49:07.257805 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m14:49:07.257805 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_columns
[0m14:49:07.257805 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m14:49:07.258806 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m14:49:07.259805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_constraints)
[0m14:49:07.259805 [debug] [Thread-5 (]: Began running node model.redshift.stl_query
[0m14:49:07.260806 [debug] [Thread-6 (]: Began running node model.redshift.stl_wlm_query
[0m14:49:07.260806 [debug] [Thread-7 (]: Began running node model.redshift.stv_blocklist
[0m14:49:07.260806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_sort_dist_keys)
[0m14:49:07.261806 [debug] [Thread-8 (]: Began running node model.redshift.stv_partitions
[0m14:49:07.261806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_tables)
[0m14:49:07.261806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.stl_explain)
[0m14:49:07.262806 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m14:49:07.262806 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.stl_query)
[0m14:49:07.262806 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.stl_wlm_query)
[0m14:49:07.263806 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stv_blocklist)
[0m14:49:07.263806 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m14:49:07.263806 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stv_partitions)
[0m14:49:07.264805 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m14:49:07.264805 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m14:49:07.266805 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m14:49:07.267468 [debug] [Thread-5 (]: Began compiling node model.redshift.stl_query
[0m14:49:07.267468 [debug] [Thread-6 (]: Began compiling node model.redshift.stl_wlm_query
[0m14:49:07.267468 [debug] [Thread-7 (]: Began compiling node model.redshift.stv_blocklist
[0m14:49:07.269507 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m14:49:07.270489 [debug] [Thread-8 (]: Began compiling node model.redshift.stv_partitions
[0m14:49:07.271516 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m14:49:07.273488 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m14:49:07.284847 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m14:49:07.284847 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m14:49:07.285849 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m14:49:07.287855 [debug] [Thread-7 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m14:49:07.289855 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m14:49:07.289855 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m14:49:07.290855 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m14:49:07.291854 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m14:49:07.291854 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m14:49:07.292855 [debug] [Thread-5 (]: Finished running node model.redshift.stl_query
[0m14:49:07.293854 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m14:49:07.294855 [debug] [Thread-6 (]: Finished running node model.redshift.stl_wlm_query
[0m14:49:07.294855 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m14:49:07.295854 [debug] [Thread-8 (]: Finished running node model.redshift.stv_partitions
[0m14:49:07.295854 [debug] [Thread-7 (]: Finished running node model.redshift.stv_blocklist
[0m14:49:07.296886 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:07.296886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stv_tbl_perm)
[0m14:49:07.297855 [debug] [Thread-5 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:07.297855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.svv_diskusage)
[0m14:49:07.297855 [debug] [Thread-6 (]: Began running node model.redshift.redshift_cost
[0m14:49:07.298853 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m14:49:07.298853 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m14:49:07.299854 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m14:49:07.299854 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m14:49:07.299854 [info ] [Thread-5 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m14:49:07.299854 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_cost)
[0m14:49:07.301357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.redshift_admin_dependencies)
[0m14:49:07.301357 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.redshift_admin_users_schema_privileges)
[0m14:49:07.302362 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m14:49:07.304362 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m14:49:07.304362 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_users_table_view_privileges)
[0m14:49:07.304362 [debug] [Thread-6 (]: Began compiling node model.redshift.redshift_cost
[0m14:49:07.304362 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m14:49:07.305363 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:07.305363 [debug] [Thread-5 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:07.306408 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m14:49:07.311422 [debug] [Thread-6 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m14:49:07.312132 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m14:49:07.321822 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m14:49:07.330794 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:07.346920 [debug] [Thread-5 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:07.347921 [debug] [Thread-6 (]: Finished running node model.redshift.redshift_cost
[0m14:49:07.348928 [debug] [Thread-8 (]: Began running node model.redshift.redshift_admin_table_stats
[0m14:49:07.349921 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:07.350956 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m14:49:07.352920 [debug] [Thread-5 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:07.352920 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m14:49:07.351921 [info ] [Thread-8 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m14:49:07.380920 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:07.383943 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m14:49:07.385921 [debug] [Thread-5 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:07.386962 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_table_stats)
[0m14:49:07.386503 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m14:49:07.397977 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:07.410413 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:07.411464 [debug] [Thread-8 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m14:49:07.424853 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:07.425492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_queries)
[0m14:49:07.425492 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:49:07.426498 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:49:07.445568 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:49:07.456496 [debug] [Thread-8 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m14:49:07.457497 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m14:49:07.457497 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:49:07.511014 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:07.458497 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:07.509076 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m14:49:07.510121 [debug] [Thread-8 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m14:49:07.458497 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:49:07.511014 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:07.511014 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:07.512048 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m14:49:07.515113 [debug] [Thread-8 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m14:49:07.515113 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:07.516013 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:07.519238 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m14:49:07.523221 [debug] [Thread-5 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:07.561649 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:07.586631 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:07.587636 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:49:07.589637 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:49:07.593634 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:49:07.593634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:07.594636 [debug] [Thread-8 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:07.594636 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:07.595635 [debug] [Thread-8 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:07.596635 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:07.995543 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.538 seconds
[0m14:49:07.996461 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:07.997460 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m14:49:08.057664 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.599 seconds
[0m14:49:08.059666 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:08.060665 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m14:49:08.071668 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.477 seconds
[0m14:49:08.072665 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:08.073663 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m14:49:08.089420 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.631 seconds
[0m14:49:08.091417 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:08.092415 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m14:49:08.094826 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.501 seconds
[0m14:49:08.094826 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:08.095915 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m14:49:08.232239 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.234 seconds
[0m14:49:08.245253 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:08.245253 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m14:49:08.300065 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.238 seconds
[0m14:49:08.305586 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:08.305586 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m14:49:08.312599 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.239 seconds
[0m14:49:08.317488 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:08.318486 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m14:49:08.322491 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.229 seconds
[0m14:49:08.325493 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:08.325493 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m14:49:08.356837 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.111 seconds
[0m14:49:08.363849 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:08.363849 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.267 seconds
[0m14:49:08.364850 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m14:49:08.367888 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:08.368890 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m14:49:08.418710 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.112 seconds
[0m14:49:08.426646 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:08.427649 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.108 seconds
[0m14:49:08.428651 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m14:49:08.432694 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:08.433705 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.108 seconds
[0m14:49:08.434711 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m14:49:08.437704 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:08.438653 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m14:49:08.480235 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.112 seconds
[0m14:49:08.501315 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:49:08.501315 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:08.501315 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:49:08.502820 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.133 seconds
[0m14:49:08.506384 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:08.506384 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m14:49:08.548690 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.115 seconds
[0m14:49:08.552747 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:49:08.553785 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:08.554750 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:49:08.555941 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.117 seconds
[0m14:49:08.558057 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:49:08.559054 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:08.559054 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:49:08.560004 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m14:49:08.560950 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:49:08.562007 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:08.562007 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:49:08.622068 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.115 seconds
[0m14:49:08.626029 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:49:08.627064 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:08.628024 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:49:08.732411 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.230 seconds
[0m14:49:08.735405 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:08.737410 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:49:08.796442 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.236 seconds
[0m14:49:08.799440 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.244 seconds
[0m14:49:08.801458 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.239 seconds
[0m14:49:08.801458 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.174 seconds
[0m14:49:08.809772 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.071 seconds
[0m14:49:08.819756 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m14:49:08.823755 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:08.823755 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m14:49:08.901979 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.077 seconds
[0m14:49:08.905507 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:49:08.906510 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:08.907507 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m14:49:09.021772 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.113 seconds
[0m14:49:09.023812 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m14:49:09.024782 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m14:49:09.065825 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.040 seconds
[0m14:49:09.070870 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:09.071772 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:49:09.147245 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.075 seconds
[0m14:49:09.152240 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m14:49:09.154237 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:09.155240 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m14:49:09.232164 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.076 seconds
[0m14:49:09.234173 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:49:09.236138 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:09.236138 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m14:49:09.331178 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.094 seconds
[0m14:49:09.333150 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m14:49:09.334183 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m14:49:09.371718 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.036 seconds
[0m14:49:09.374721 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:09.375717 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:49:09.456607 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.079 seconds
[0m14:49:09.462602 [debug] [Thread-5 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m14:49:09.464651 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:09.465627 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m14:49:09.555203 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.088 seconds
[0m14:49:09.558171 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:49:09.559169 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:09.559169 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m14:49:09.689969 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.129 seconds
[0m14:49:09.691965 [debug] [Thread-5 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m14:49:09.693968 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m14:49:09.734557 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.039 seconds
[0m14:49:09.738560 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:09.740626 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:49:09.818272 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m14:49:09.824232 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m14:49:09.827233 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:09.828271 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m14:49:09.907819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m14:49:09.910883 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:49:09.911822 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:09.912816 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m14:49:10.012786 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.098 seconds
[0m14:49:10.020741 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m14:49:10.021739 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m14:49:10.060243 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.037 seconds
[0m14:49:10.063240 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:10.064237 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:49:10.142291 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.077 seconds
[0m14:49:10.147281 [debug] [Thread-8 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m14:49:10.150280 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:10.150280 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m14:49:10.235506 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.084 seconds
[0m14:49:10.238498 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:49:10.239494 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:10.240512 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m14:49:10.362426 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.121 seconds
[0m14:49:10.363425 [debug] [Thread-8 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m14:49:10.364429 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m14:49:10.411343 [debug] [Thread-8 (]: SQL status: SUCCESS in 0.046 seconds
[0m14:49:10.414713 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m14:49:10.415735 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m14:49:10.416773 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m14:49:10.417790 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m14:49:10.419734 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m14:49:10.499598 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m14:49:10.503523 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A710EF00>]}
[0m14:49:10.503523 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m14:49:10.506067 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m14:49:10.508082 [debug] [Thread-5 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m14:49:10.510083 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A2DB9370>]}
[0m14:49:10.507082 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 3.20s]
[0m14:49:10.511182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A5CCEA20>]}
[0m14:49:10.512541 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A710DDC0>]}
[0m14:49:10.513621 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 3.21s]
[0m14:49:10.514632 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m14:49:10.516629 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 3.09s]
[0m14:49:10.517630 [info ] [Thread-5 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 3.21s]
[0m14:49:10.517630 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m14:49:10.519635 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m14:49:10.519635 [debug] [Thread-5 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m14:49:10.536330 [debug] [Thread-8 (]: On model.redshift.redshift_admin_table_stats: Close
[0m14:49:10.537330 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44c6885-8cf7-4943-a841-1d21b77caedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A6F1C050>]}
[0m14:49:10.538438 [info ] [Thread-8 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 3.15s]
[0m14:49:10.539450 [debug] [Thread-8 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m14:49:10.542447 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:10.543446 [debug] [MainThread]: On master: BEGIN
[0m14:49:10.543446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:10.543446 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:49:10.544447 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:49:10.992560 [debug] [MainThread]: SQL status: SUCCESS in 0.449 seconds
[0m14:49:10.993608 [debug] [MainThread]: On master: COMMIT
[0m14:49:10.993608 [debug] [MainThread]: Using redshift connection "master"
[0m14:49:10.994540 [debug] [MainThread]: On master: COMMIT
[0m14:49:11.075261 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m14:49:11.076259 [debug] [MainThread]: On master: Close
[0m14:49:11.078259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:11.078259 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m14:49:11.079258 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m14:49:11.080257 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m14:49:11.080257 [debug] [MainThread]: Connection 'model.redshift.svv_diskusage' was properly closed.
[0m14:49:11.081257 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m14:49:11.081257 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m14:49:11.082255 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m14:49:11.082255 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m14:49:11.083255 [debug] [MainThread]: Connection 'model.redshift.stv_blocklist' was properly closed.
[0m14:49:11.083255 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m14:49:11.083255 [info ] [MainThread]: 
[0m14:49:11.085252 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m14:49:11.087250 [debug] [MainThread]: Command end result
[0m14:49:11.110872 [info ] [MainThread]: 
[0m14:49:11.111918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:11.112686 [info ] [MainThread]: 
[0m14:49:11.112686 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:49:11.113695 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:11.113695 after 6.48 seconds
[0m14:49:11.113695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A2909430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A4609D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261A6D97080>]}
[0m14:49:11.114733 [debug] [MainThread]: Flushing usage events
[0m14:50:53.710065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284561D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228455A65D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228455A6BD0>]}


============================== 14:50:53.713067 | 80c7491f-ff70-496b-a1a6-033af1cdcdbb ==============================
[0m14:50:53.713067 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:50:53.714079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select integrity_energy_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:53.818069 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:50:53.818069 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:50:53.921646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80c7491f-ff70-496b-a1a6-033af1cdcdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022845F51010>]}
[0m14:50:53.956159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80c7491f-ff70-496b-a1a6-033af1cdcdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022845D6F200>]}
[0m14:50:53.957160 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:50:53.979159 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:50:54.080672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:54.080672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:54.097671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80c7491f-ff70-496b-a1a6-033af1cdcdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284688C4A0>]}
[0m14:50:54.144941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80c7491f-ff70-496b-a1a6-033af1cdcdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022847957440>]}
[0m14:50:54.144941 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:50:54.145941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c7491f-ff70-496b-a1a6-033af1cdcdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022847B97050>]}
[0m14:50:54.145941 [warn ] [MainThread]: The selection criterion 'integrity_energy_dbt' does not match any enabled nodes
[0m14:50:54.147967 [info ] [MainThread]: 
[0m14:50:54.147967 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:50:54.149962 [debug] [MainThread]: Command end result
[0m14:50:54.169236 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:54.169236 after 0.60 seconds
[0m14:50:54.169236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022845476CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228459E1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228453AD4F0>]}
[0m14:50:54.170291 [debug] [MainThread]: Flushing usage events
[0m14:51:41.533078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103BC8CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104163E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104163FD70>]}


============================== 14:51:41.537121 | 5e320ff9-9116-473c-8468-3a0831c4c1dc ==============================
[0m14:51:41.537121 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:51:41.538081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select customer', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:41.634694 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:51:41.634694 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:51:41.732451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e320ff9-9116-473c-8468-3a0831c4c1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104202BE60>]}
[0m14:51:41.768980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e320ff9-9116-473c-8468-3a0831c4c1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021042800710>]}
[0m14:51:41.770651 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:51:41.790656 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:51:41.881280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:41.881280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:41.896313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e320ff9-9116-473c-8468-3a0831c4c1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210438D9430>]}
[0m14:51:41.944548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e320ff9-9116-473c-8468-3a0831c4c1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210439D7FE0>]}
[0m14:51:41.945548 [info ] [MainThread]: Found 24 models, 666 macros
[0m14:51:41.945548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e320ff9-9116-473c-8468-3a0831c4c1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210415FC860>]}
[0m14:51:41.946548 [warn ] [MainThread]: The selection criterion 'customer' does not match any enabled nodes
[0m14:51:41.947579 [info ] [MainThread]: 
[0m14:51:41.948549 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:51:41.949548 [debug] [MainThread]: Command end result
[0m14:51:41.970548 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:41.970548 after 0.56 seconds
[0m14:51:41.970548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104130ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021041D8EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021041C41F10>]}
[0m14:51:41.970548 [debug] [MainThread]: Flushing usage events
[0m14:54:04.972492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A86E1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A86E2B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A8BC4C50>]}


============================== 14:54:04.975127 | 4b1fa298-9620-4b4a-8d0c-a76a6c84e30a ==============================
[0m14:54:04.975127 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:54:04.976150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --config-dir', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:04.988148 [info ] [MainThread]: To view your profiles.yml file, run:

start C:\Users\seanm\.dbt
[0m14:54:04.989137 [debug] [MainThread]: Command `dbt debug` succeeded at 14:54:04.989137 after 0.14 seconds
[0m14:54:04.990118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A89E0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A891A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A8AA4050>]}
[0m14:54:04.990118 [debug] [MainThread]: Flushing usage events
[0m15:04:56.981487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0DDC6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0DDC61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0DE3D4F0>]}


============================== 15:04:56.984480 | c608b348-a39b-438d-bca8-748db7f15368 ==============================
[0m15:04:56.984480 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:04:56.985514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m15:04:57.077289 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:04:57.077289 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:04:57.172564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c608b348-a39b-438d-bca8-748db7f15368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0F045D30>]}
[0m15:04:57.204700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c608b348-a39b-438d-bca8-748db7f15368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0D762090>]}
[0m15:04:57.205707 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:04:57.224743 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:04:57.315845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:57.315845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:57.332842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c608b348-a39b-438d-bca8-748db7f15368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0F1222D0>]}
[0m15:04:57.376804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c608b348-a39b-438d-bca8-748db7f15368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1019B3B0>]}
[0m15:04:57.377809 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:04:57.377809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c608b348-a39b-438d-bca8-748db7f15368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0DDFC8C0>]}
[0m15:04:57.379927 [info ] [MainThread]: 
[0m15:04:57.380927 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:04:57.383964 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:04:57.393927 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:04:57.394927 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:04:57.394927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:57.398053 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:04:57.399026 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:04:57.980881 [debug] [ThreadPool]: SQL status: SUCCESS in 0.585 seconds
[0m15:04:57.981962 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:04:57.983865 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:04:58.100717 [debug] [ThreadPool]: SQL status: SUCCESS in 0.117 seconds
[0m15:04:58.105115 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:04:58.187906 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:04:58.201895 [debug] [MainThread]: Using redshift connection "master"
[0m15:04:58.201895 [debug] [MainThread]: On master: BEGIN
[0m15:04:58.201895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:58.202896 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:04:58.202896 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:04:58.650782 [debug] [MainThread]: SQL status: SUCCESS in 0.449 seconds
[0m15:04:58.652770 [debug] [MainThread]: Using redshift connection "master"
[0m15:04:58.653749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:04:58.791156 [debug] [MainThread]: SQL status: SUCCESS in 0.136 seconds
[0m15:04:58.793155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c608b348-a39b-438d-bca8-748db7f15368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0EFC02F0>]}
[0m15:04:58.793155 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:58.876557 [debug] [MainThread]: On master: Close
[0m15:04:58.879552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:58.880541 [info ] [MainThread]: 
[0m15:04:58.891080 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:04:58.892081 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:04:58.893081 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:04:58.894095 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:04:58.895102 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:04:58.895102 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:04:58.896080 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:04:58.897077 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:04:58.898077 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:04:58.898077 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:04:58.899078 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:04:58.901538 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:04:58.901538 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:04:58.903537 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:04:58.905537 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:04:58.906933 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:04:58.906933 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:04:58.907902 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:04:58.908901 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:04:58.908901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:04:58.908901 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:04:58.909901 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:04:58.910902 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:04:58.910902 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:04:58.911902 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:04:58.911902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:04:58.912616 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m15:04:58.914120 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:04:58.914120 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m15:04:58.914120 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:04:58.915130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m15:04:58.915130 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:04:58.916125 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:04:58.917158 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:04:58.917158 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m15:04:58.920143 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:04:58.920143 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:04:58.922124 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:04:58.923126 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:04:58.924126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:04:58.925125 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:04:58.924126 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:04:58.926130 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m15:04:58.926130 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:04:58.929126 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:04:58.929126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:04:58.930125 [debug] [Thread-4 (]: Began running node model.redshift.redshift_tables
[0m15:04:58.930125 [debug] [Thread-3 (]: Began running node model.redshift.stl_explain
[0m15:04:58.931125 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:04:58.931125 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:04:58.932125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.redshift_tables)
[0m15:04:58.932125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.stl_explain)
[0m15:04:58.934143 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:04:58.934143 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m15:04:58.935282 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_tables
[0m15:04:58.935282 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_explain
[0m15:04:58.935282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:04:58.938289 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:04:58.938289 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:04:58.939292 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:04:58.940295 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m15:04:58.940295 [debug] [Thread-2 (]: Began running node model.redshift.stl_wlm_query
[0m15:04:58.941288 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_tables
[0m15:04:58.942363 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:04:58.942363 [debug] [Thread-3 (]: Finished running node model.redshift.stl_explain
[0m15:04:58.943293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:04:58.943293 [debug] [Thread-4 (]: Began running node model.redshift.stv_blocklist
[0m15:04:58.944288 [debug] [Thread-3 (]: Began running node model.redshift.stv_partitions
[0m15:04:58.944288 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:04:58.945288 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m15:04:58.945288 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:04:58.945288 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:04:58.946288 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:04:58.947287 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m15:04:58.947287 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_blocklist
[0m15:04:58.947287 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_partitions
[0m15:04:58.948288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:04:58.948288 [debug] [Thread-2 (]: Finished running node model.redshift.stl_wlm_query
[0m15:04:58.949288 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:04:58.950288 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:04:58.951289 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:04:58.951289 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m15:04:58.952288 [debug] [Thread-4 (]: Finished running node model.redshift.stv_blocklist
[0m15:04:58.954287 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:04:58.954287 [debug] [Thread-3 (]: Finished running node model.redshift.stv_partitions
[0m15:04:58.955288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:04:58.955288 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:04:58.955288 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:04:58.956288 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m15:04:58.956288 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:04:58.956288 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:04:58.957288 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:04:58.958288 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:04:58.958676 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:04:58.959115 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:04:58.959115 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:04:58.959115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:04:58.964182 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:04:58.965129 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m15:04:58.969180 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:04:58.970212 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:04:58.970212 [debug] [Thread-2 (]: Began running node model.redshift.redshift_cost
[0m15:04:58.971134 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:04:58.977251 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:04:58.978251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:04:58.978251 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:04:58.979323 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:04:58.979972 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_cost
[0m15:04:58.979972 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:04:58.980983 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:04:58.981978 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:04:58.986001 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:04:58.987017 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:04:58.987983 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_table_stats)
[0m15:04:58.988979 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:04:58.988979 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_cost
[0m15:04:59.003997 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:04:59.004699 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_queries
[0m15:04:59.004699 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:04:59.005709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_schema_privileges, now model.redshift.redshift_admin_queries)
[0m15:04:59.005709 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:04:59.006705 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:04:59.011704 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:04:59.011704 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:04:59.012705 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:04:59.012705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:59.014234 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:04:59.014234 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:04:59.014234 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m15:04:59.014234 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:04:59.014234 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:04:59.015239 [debug] [MainThread]: Command end result
[0m15:04:59.075239 [debug] [MainThread]: Command `dbt compile` succeeded at 15:04:59.075239 after 2.26 seconds
[0m15:04:59.076238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0DDC61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0E443D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0E441F70>]}
[0m15:04:59.076238 [debug] [MainThread]: Flushing usage events
[0m15:05:09.301673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C403F41940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C403F416A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C403F417C0>]}


============================== 15:05:09.304673 | 4f30c35a-b96b-442b-9ad8-402bf885a120 ==============================
[0m15:05:09.304673 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:05:09.305510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:05:09.373042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f30c35a-b96b-442b-9ad8-402bf885a120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C403F41940>]}
[0m15:05:09.429217 [debug] [MainThread]: Command `dbt clean` succeeded at 15:05:09.429217 after 0.24 seconds
[0m15:05:09.429217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C404CE6C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4046B45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C404F51D30>]}
[0m15:05:09.429217 [debug] [MainThread]: Flushing usage events
[0m15:05:15.768909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAEA9DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAFB54EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAFB54440>]}


============================== 15:05:15.771907 | 0e8dc285-d6b3-4716-a354-a58144d96b79 ==============================
[0m15:05:15.771907 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:05:15.772915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:05:15.862741 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:05:15.862741 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:05:15.959986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e8dc285-d6b3-4716-a354-a58144d96b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAF7DEF00>]}
[0m15:05:15.994036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e8dc285-d6b3-4716-a354-a58144d96b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB0584530>]}
[0m15:05:15.994993 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:05:15.995993 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 4 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:05:15.996995 [debug] [MainThread]: Command `dbt run` failed at 15:05:15.996995 after 0.31 seconds
[0m15:05:15.996995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAF7DF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB05147A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB06E4410>]}
[0m15:05:15.997994 [debug] [MainThread]: Flushing usage events
[0m15:05:21.491108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610E4493D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611059EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611059E9F0>]}


============================== 15:05:21.494137 | 2a5be599-0c1f-424d-a95d-7964fabf3603 ==============================
[0m15:05:21.494137 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:05:21.495119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:05:21.563729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a5be599-0c1f-424d-a95d-7964fabf3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016110ED1850>]}
[0m15:05:21.583222 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-0tit6y7s'
[0m15:05:21.584221 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:05:21.714672 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:05:21.716673 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:05:21.781393 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:05:21.787381 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m15:05:21.911595 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m15:05:21.915557 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m15:05:21.987329 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m15:05:21.992295 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m15:05:22.054960 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m15:05:22.058015 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:05:22.401738 [info ] [MainThread]: Installed from version 1.0.0
[0m15:05:22.401738 [info ] [MainThread]: Updated version available: 1.2.0
[0m15:05:22.402739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a5be599-0c1f-424d-a95d-7964fabf3603', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016111095640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161110B50D0>]}
[0m15:05:22.402739 [info ] [MainThread]: Installing dbt-labs/redshift
[0m15:05:22.589217 [info ] [MainThread]: Installed from version 0.9.0
[0m15:05:22.590218 [info ] [MainThread]: Up to date!
[0m15:05:22.590218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a5be599-0c1f-424d-a95d-7964fabf3603', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161110B5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161110B5160>]}
[0m15:05:22.591219 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m15:05:22.915231 [info ] [MainThread]: Installed from version 0.8.2
[0m15:05:22.916231 [info ] [MainThread]: Updated version available: 0.9.0
[0m15:05:22.917232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a5be599-0c1f-424d-a95d-7964fabf3603', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610FEC3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610FEC3410>]}
[0m15:05:22.917232 [info ] [MainThread]: Installing dbt-labs/codegen
[0m15:05:23.097161 [info ] [MainThread]: Installed from version 0.9.0
[0m15:05:23.098161 [info ] [MainThread]: Updated version available: 0.12.1
[0m15:05:23.098161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a5be599-0c1f-424d-a95d-7964fabf3603', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016110F50D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161110B7CB0>]}
[0m15:05:23.098161 [info ] [MainThread]: 
[0m15:05:23.099160 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m15:05:23.100162 [debug] [MainThread]: Command `dbt deps` succeeded at 15:05:23.100162 after 1.69 seconds
[0m15:05:23.100162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016110B1AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016110D0FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016110D0FBF0>]}
[0m15:05:23.101161 [debug] [MainThread]: Flushing usage events
[0m15:05:27.633365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB5A33440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB7E6EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB8664410>]}


============================== 15:05:27.636373 | 4c5c4bf2-d83d-403d-97a6-00db1680ff73 ==============================
[0m15:05:27.636373 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:05:27.637372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:05:27.731658 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:05:27.731658 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:05:27.828237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB90244A0>]}
[0m15:05:27.861775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB87715B0>]}
[0m15:05:27.862776 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:05:27.895965 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:05:27.896970 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:05:27.896970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB8FD38F0>]}
[0m15:05:29.051899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA07DEB0>]}
[0m15:05:29.107626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA31A9C0>]}
[0m15:05:29.107626 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:05:29.108638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA435E20>]}
[0m15:05:29.110631 [info ] [MainThread]: 
[0m15:05:29.110631 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:05:29.113630 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m15:05:29.123708 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m15:05:29.123708 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m15:05:29.124633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:29.127632 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:29.128640 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:29.624791 [debug] [ThreadPool]: SQL status: SUCCESS in 0.501 seconds
[0m15:05:29.628785 [debug] [ThreadPool]: On list_integrity-db: Close
[0m15:05:29.632786 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:05:29.642782 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:05:29.642782 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:05:29.643782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:29.643782 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:29.643782 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:30.036980 [debug] [ThreadPool]: SQL status: SUCCESS in 0.393 seconds
[0m15:05:30.037977 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:05:30.038985 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:05:30.152346 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m15:05:30.156340 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:05:30.237420 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:05:30.252482 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:30.252482 [debug] [MainThread]: On master: BEGIN
[0m15:05:30.253476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:30.254474 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:30.254474 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:30.697735 [debug] [MainThread]: SQL status: SUCCESS in 0.444 seconds
[0m15:05:30.698888 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:30.699892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:05:30.835385 [debug] [MainThread]: SQL status: SUCCESS in 0.134 seconds
[0m15:05:30.836377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB6221430>]}
[0m15:05:30.836377 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:30.921750 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:30.922746 [debug] [MainThread]: On master: BEGIN
[0m15:05:30.962995 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m15:05:30.964986 [debug] [MainThread]: On master: COMMIT
[0m15:05:30.966990 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:30.968987 [debug] [MainThread]: On master: COMMIT
[0m15:05:31.047919 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m15:05:31.048914 [debug] [MainThread]: On master: Close
[0m15:05:31.050911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:31.052907 [info ] [MainThread]: 
[0m15:05:31.062491 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:05:31.062491 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:05:31.063509 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:05:31.063509 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:05:31.064504 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:05:31.065278 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:05:31.065940 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:05:31.066550 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:05:31.066550 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:05:31.067571 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:05:31.067571 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:05:31.068570 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:05:31.070570 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:05:31.071569 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:05:31.072569 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:05:31.075569 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:05:31.077572 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:05:31.077572 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:05:31.078500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:05:31.078500 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:05:31.079526 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:05:31.087572 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:05:31.088577 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:05:31.088577 [debug] [Thread-4 (]: Began running node model.redshift.pg_user
[0m15:05:31.089577 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.pg_user)
[0m15:05:31.090577 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_user
[0m15:05:31.088577 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:05:31.089577 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:05:31.091638 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:05:31.091638 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:05:31.092577 [debug] [Thread-2 (]: Began running node model.redshift.redshift_columns
[0m15:05:31.093577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m15:05:31.093577 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:05:31.093577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.redshift_columns)
[0m15:05:31.094576 [debug] [Thread-4 (]: Finished running node model.redshift.pg_user
[0m15:05:31.094576 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:05:31.095577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:05:31.095577 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_columns
[0m15:05:31.095577 [debug] [Thread-4 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:05:31.097594 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:05:31.097594 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:05:31.099595 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:05:31.099595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:05:31.101580 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:05:31.102094 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:05:31.102094 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:05:31.103117 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m15:05:31.103117 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_columns
[0m15:05:31.104117 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:05:31.105144 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:05:31.106117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m15:05:31.106117 [debug] [Thread-2 (]: Began running node model.redshift.stl_explain
[0m15:05:31.107116 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m15:05:31.107116 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m15:05:31.108117 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:05:31.108117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:05:31.108117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:05:31.110141 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:05:31.111118 [debug] [Thread-4 (]: Began running node model.redshift.stl_wlm_query
[0m15:05:31.111118 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_explain
[0m15:05:31.111118 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m15:05:31.111920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:05:31.113391 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:05:31.114413 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:05:31.115411 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m15:05:31.115411 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:05:31.116412 [debug] [Thread-3 (]: Began running node model.redshift.stv_blocklist
[0m15:05:31.116412 [debug] [Thread-2 (]: Finished running node model.redshift.stl_explain
[0m15:05:31.117412 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m15:05:31.119430 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:05:31.119430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:05:31.119430 [debug] [Thread-2 (]: Began running node model.redshift.stv_partitions
[0m15:05:31.120412 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m15:05:31.120412 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_blocklist
[0m15:05:31.120412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:05:31.121411 [debug] [Thread-4 (]: Finished running node model.redshift.stl_wlm_query
[0m15:05:31.121411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:05:31.122414 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:05:31.122414 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_partitions
[0m15:05:31.123412 [debug] [Thread-4 (]: Began running node model.redshift.svv_diskusage
[0m15:05:31.123412 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:05:31.125412 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:05:31.125412 [debug] [Thread-3 (]: Finished running node model.redshift.stv_blocklist
[0m15:05:31.126412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:05:31.127411 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:05:31.127411 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:05:31.128412 [debug] [Thread-4 (]: Began compiling node model.redshift.svv_diskusage
[0m15:05:31.128412 [debug] [Thread-2 (]: Finished running node model.redshift.stv_partitions
[0m15:05:31.130412 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:05:31.131413 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:05:31.131413 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:05:31.129412 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m15:05:31.132412 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:05:31.132412 [debug] [Thread-4 (]: Finished running node model.redshift.svv_diskusage
[0m15:05:31.133413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:05:31.133413 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m15:05:31.134411 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m15:05:31.134411 [debug] [Thread-4 (]: Began running node model.redshift.redshift_cost
[0m15:05:31.135411 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:05:31.135411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:05:31.135411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:05:31.135411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:05:31.141429 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:05:31.141429 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:05:31.141429 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:05:31.142592 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_cost
[0m15:05:31.147782 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:31.153809 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:31.159731 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:05:31.159731 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:05:31.161286 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:05:31.182631 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m15:05:31.183584 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_cost
[0m15:05:31.183584 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:05:31.185678 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:31.186623 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:05:31.188784 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:31.188784 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m15:05:31.190237 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m15:05:31.190237 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:05:31.204350 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:31.207374 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:31.210394 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:05:31.213413 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:31.213413 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:05:31.214352 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:05:31.214352 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:05:31.214352 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:31.215352 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:05:31.215352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:31.215352 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:31.216352 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:31.218379 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m15:05:31.218379 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:31.219353 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:31.219353 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:31.220352 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:31.220352 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:31.228351 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:31.229352 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:05:31.230352 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:31.230352 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:31.231351 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:31.662568 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.447 seconds
[0m15:05:31.664154 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.449 seconds
[0m15:05:31.665154 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:31.666156 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:31.667155 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m15:05:31.669155 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m15:05:31.701064 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.470 seconds
[0m15:05:31.702046 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:31.704042 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m15:05:31.707045 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.491 seconds
[0m15:05:31.708038 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:31.709120 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m15:05:31.898021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.229 seconds
[0m15:05:31.905092 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:31.905092 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:05:31.906018 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.236 seconds
[0m15:05:31.909116 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:31.909116 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m15:05:31.914910 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.205 seconds
[0m15:05:31.916910 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:31.916910 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m15:05:31.962375 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.257 seconds
[0m15:05:31.969525 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:31.970541 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m15:05:32.018935 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.113 seconds
[0m15:05:32.020939 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.111 seconds
[0m15:05:32.028926 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:32.033237 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:32.034316 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m15:05:32.034927 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m15:05:32.038514 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.121 seconds
[0m15:05:32.041562 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:32.041562 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m15:05:32.083657 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.112 seconds
[0m15:05:32.090638 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:32.090638 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m15:05:32.179715 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.144 seconds
[0m15:05:32.180712 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.145 seconds
[0m15:05:32.198784 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:05:32.199705 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:05:32.200775 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:32.201262 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:32.201663 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:05:32.201663 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:05:32.216342 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.174 seconds
[0m15:05:32.218219 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:05:32.218219 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:32.218219 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:05:32.267163 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.175 seconds
[0m15:05:32.271092 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:05:32.272066 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:32.272066 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:05:32.494491 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.292 seconds
[0m15:05:32.496640 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.293 seconds
[0m15:05:32.497949 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.278 seconds
[0m15:05:32.498970 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.225 seconds
[0m15:05:32.499968 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:32.503050 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:05:32.576575 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.073 seconds
[0m15:05:32.585549 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:05:32.591551 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:32.591551 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m15:05:32.671597 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:05:32.674639 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:05:32.676593 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:32.677637 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:05:32.769407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.091 seconds
[0m15:05:32.771408 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:05:32.772432 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:05:32.808483 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.035 seconds
[0m15:05:32.812539 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:32.813504 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:05:32.894739 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:05:32.897739 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m15:05:32.898738 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:32.899738 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m15:05:32.976339 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:05:32.979336 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:05:32.980352 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:32.981327 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:05:33.092568 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.110 seconds
[0m15:05:33.094563 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:05:33.095560 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:05:33.131042 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.035 seconds
[0m15:05:33.134084 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:33.135060 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:05:33.219931 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:05:33.225939 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m15:05:33.227890 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:33.228887 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m15:05:33.319677 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.090 seconds
[0m15:05:33.320683 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:05:33.320683 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:33.320683 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:05:33.414707 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.093 seconds
[0m15:05:33.415704 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:05:33.416705 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:05:33.458925 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.040 seconds
[0m15:05:33.461302 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:33.462466 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:05:33.540219 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:05:33.545239 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m15:05:33.546192 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:33.546192 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m15:05:33.632391 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.085 seconds
[0m15:05:33.636384 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:05:33.638386 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:33.639452 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:05:33.754967 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:05:33.756919 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:05:33.758923 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:05:33.797968 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.039 seconds
[0m15:05:33.801029 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m15:05:33.802031 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m15:05:33.803155 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m15:05:33.804175 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m15:05:33.884540 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m15:05:33.885514 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m15:05:33.886529 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: Close
[0m15:05:33.887511 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m15:05:33.891507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB61C9790>]}
[0m15:05:33.892508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB62F8BC0>]}
[0m15:05:33.893507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA5C8380>]}
[0m15:05:33.894507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA662D50>]}
[0m15:05:33.895508 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.75s]
[0m15:05:33.896506 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.76s]
[0m15:05:33.897505 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.70s]
[0m15:05:33.900506 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:05:33.898504 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.76s]
[0m15:05:33.901543 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:05:33.901543 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:05:33.902504 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m15:05:33.902504 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:05:33.903503 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m15:05:33.904521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_table_view_privileges, now model.redshift.redshift_admin_queries)
[0m15:05:33.904521 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:05:33.910540 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:05:33.911546 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:05:33.914502 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m15:05:33.918540 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:33.918540 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:05:33.918540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:33.918540 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:33.919689 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:34.359575 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.440 seconds
[0m15:05:34.360613 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:34.361623 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m15:05:34.578024 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.215 seconds
[0m15:05:34.585020 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:34.586018 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m15:05:34.712576 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m15:05:34.717617 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:34.717617 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m15:05:34.840907 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.122 seconds
[0m15:05:34.846900 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:05:34.847953 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:34.848901 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:05:35.002968 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.153 seconds
[0m15:05:35.003974 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:35.005926 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:05:35.087441 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:05:35.092429 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m15:05:35.095436 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:35.095436 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m15:05:35.182554 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:05:35.185482 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:05:35.186497 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:35.187867 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:05:35.315881 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.128 seconds
[0m15:05:35.317873 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:05:35.318870 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:05:35.357649 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.038 seconds
[0m15:05:35.360701 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m15:05:35.440026 [debug] [Thread-1 (]: On model.redshift.redshift_admin_queries: Close
[0m15:05:35.442028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c5c4bf2-d83d-403d-97a6-00db1680ff73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA5C8A10>]}
[0m15:05:35.444021 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.54s]
[0m15:05:35.445761 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:05:35.449758 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:35.450756 [debug] [MainThread]: On master: BEGIN
[0m15:05:35.451843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:35.451843 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:35.452908 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:35.899889 [debug] [MainThread]: SQL status: SUCCESS in 0.448 seconds
[0m15:05:35.900906 [debug] [MainThread]: On master: COMMIT
[0m15:05:35.901909 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:35.902908 [debug] [MainThread]: On master: COMMIT
[0m15:05:35.982363 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m15:05:35.983364 [debug] [MainThread]: On master: Close
[0m15:05:35.985359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:35.985359 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m15:05:35.986363 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:05:35.987358 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:05:35.987358 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m15:05:35.988355 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m15:05:35.988355 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:05:35.989355 [info ] [MainThread]: 
[0m15:05:35.991355 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m15:05:35.993353 [debug] [MainThread]: Command end result
[0m15:05:36.080094 [info ] [MainThread]: 
[0m15:05:36.081100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:36.081522 [info ] [MainThread]: 
[0m15:05:36.081522 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:05:36.083592 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:36.083592 after 8.53 seconds
[0m15:05:36.083592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB5A33440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB5D9A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB8E63740>]}
[0m15:05:36.083592 [debug] [MainThread]: Flushing usage events
[0m15:07:26.468598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635BB878C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635E9043E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635E904B90>]}


============================== 15:07:26.471596 | d1e24479-9f8d-44de-a852-11702d49e92f ==============================
[0m15:07:26.471596 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:07:26.472596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:26.567625 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:07:26.567625 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:07:26.663591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e24479-9f8d-44de-a852-11702d49e92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635E8C51C0>]}
[0m15:07:26.697498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e24479-9f8d-44de-a852-11702d49e92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635DA8BFE0>]}
[0m15:07:26.699233 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:07:26.717265 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:07:26.821427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:26.821427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:26.837883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e24479-9f8d-44de-a852-11702d49e92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635F2FF200>]}
[0m15:07:26.884280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e24479-9f8d-44de-a852-11702d49e92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636066FCB0>]}
[0m15:07:26.885280 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:07:26.885280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e24479-9f8d-44de-a852-11702d49e92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635E0D0950>]}
[0m15:07:26.887289 [info ] [MainThread]: 
[0m15:07:26.888299 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:07:26.890282 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:07:26.902278 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:07:26.902278 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:07:26.903285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:26.906457 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:26.906457 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:27.513660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.610 seconds
[0m15:07:27.514657 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:07:27.515657 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:07:27.629538 [debug] [ThreadPool]: SQL status: SUCCESS in 0.114 seconds
[0m15:07:27.633764 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:07:27.719288 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:07:27.731747 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:27.732748 [debug] [MainThread]: On master: BEGIN
[0m15:07:27.732748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:27.733747 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:27.733747 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:28.178476 [debug] [MainThread]: SQL status: SUCCESS in 0.446 seconds
[0m15:07:28.180540 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:28.181495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:07:28.317190 [debug] [MainThread]: SQL status: SUCCESS in 0.135 seconds
[0m15:07:28.319189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e24479-9f8d-44de-a852-11702d49e92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635F40FDD0>]}
[0m15:07:28.320188 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:28.405597 [debug] [MainThread]: On master: Close
[0m15:07:28.408594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:28.410592 [info ] [MainThread]: 
[0m15:07:28.420539 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:07:28.421537 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:07:28.421537 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:07:28.422535 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:07:28.423534 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:07:28.423534 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:07:28.424542 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:07:28.425533 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:07:28.425533 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:07:28.425533 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:07:28.429533 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:07:28.430531 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:07:28.428533 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:07:28.426533 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:07:28.426533 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:07:28.431539 [debug] [Thread-2 (]: Began running node model.redshift.pg_tables
[0m15:07:28.432685 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:07:28.434690 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:07:28.434690 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:07:28.435685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_tables)
[0m15:07:28.435685 [debug] [Thread-1 (]: Began running node model.redshift.pg_user
[0m15:07:28.436685 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:07:28.436685 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_tables
[0m15:07:28.437685 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:07:28.437685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_user)
[0m15:07:28.438685 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:07:28.440685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m15:07:28.441686 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:07:28.440685 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_user
[0m15:07:28.440685 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m15:07:28.439686 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:07:28.442686 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:07:28.444686 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:07:28.445738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m15:07:28.446687 [debug] [Thread-2 (]: Finished running node model.redshift.pg_tables
[0m15:07:28.446687 [debug] [Thread-1 (]: Finished running node model.redshift.pg_user
[0m15:07:28.447720 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:07:28.447720 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m15:07:28.448717 [debug] [Thread-2 (]: Began running node model.redshift.redshift_constraints
[0m15:07:28.448717 [debug] [Thread-1 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:07:28.449686 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m15:07:28.451702 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:07:28.451702 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:07:28.451702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:07:28.452685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m15:07:28.452685 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_constraints
[0m15:07:28.453686 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m15:07:28.453686 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:07:28.454685 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m15:07:28.456685 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:07:28.457686 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m15:07:28.459685 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:07:28.461721 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:07:28.462772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:07:28.462772 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_constraints
[0m15:07:28.463791 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m15:07:28.463791 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m15:07:28.464790 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:07:28.464790 [debug] [Thread-2 (]: Began running node model.redshift.stl_query
[0m15:07:28.466812 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:07:28.466812 [debug] [Thread-3 (]: Began running node model.redshift.stl_wlm_query
[0m15:07:28.466812 [debug] [Thread-1 (]: Began running node model.redshift.stv_blocklist
[0m15:07:28.467791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:07:28.467791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stl_wlm_query)
[0m15:07:28.468790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stv_blocklist)
[0m15:07:28.468790 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m15:07:28.468790 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_query
[0m15:07:28.469792 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:07:28.469792 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_blocklist
[0m15:07:28.470377 [debug] [Thread-4 (]: Began running node model.redshift.stv_partitions
[0m15:07:28.471411 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:07:28.472387 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:07:28.473383 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:07:28.474516 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:07:28.475537 [debug] [Thread-2 (]: Finished running node model.redshift.stl_query
[0m15:07:28.476536 [debug] [Thread-3 (]: Finished running node model.redshift.stl_wlm_query
[0m15:07:28.476536 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_partitions
[0m15:07:28.476536 [debug] [Thread-2 (]: Began running node model.redshift.stv_tbl_perm
[0m15:07:28.476536 [debug] [Thread-1 (]: Finished running node model.redshift.stv_blocklist
[0m15:07:28.477536 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m15:07:28.478565 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:07:28.478565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:07:28.479537 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:07:28.479537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:07:28.479537 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:07:28.480536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:07:28.480536 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m15:07:28.480536 [debug] [Thread-4 (]: Finished running node model.redshift.stv_partitions
[0m15:07:28.482564 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:07:28.483536 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:07:28.484560 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:07:28.484560 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:07:28.489537 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:07:28.490537 [debug] [Thread-2 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:07:28.490537 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:07:28.491536 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m15:07:28.491536 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:07:28.492536 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:07:28.492536 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:07:28.492536 [debug] [Thread-3 (]: Began running node model.redshift.redshift_cost
[0m15:07:28.493537 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:07:28.497553 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:07:28.498553 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:07:28.499291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:07:28.499291 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:07:28.499291 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:07:28.500297 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_cost
[0m15:07:28.500297 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:07:28.507313 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:07:28.507313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_table_stats)
[0m15:07:28.512313 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:07:28.513296 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:07:28.513887 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:07:28.513887 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:07:28.529015 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:07:28.529935 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:07:28.529935 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_cost
[0m15:07:28.531439 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:07:28.531439 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_queries
[0m15:07:28.532444 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:07:28.532444 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_schema_privileges, now model.redshift.redshift_admin_queries)
[0m15:07:28.533444 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:07:28.538443 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:07:28.538443 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:07:28.539445 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:07:28.540444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:28.540444 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:07:28.541445 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:07:28.541445 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:07:28.542510 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m15:07:28.542510 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:07:28.543445 [debug] [MainThread]: Command end result
[0m15:07:28.601445 [debug] [MainThread]: Command `dbt compile` succeeded at 15:07:28.601445 after 2.26 seconds
[0m15:07:28.601445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636080D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636080DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001636080D7F0>]}
[0m15:07:28.601445 [debug] [MainThread]: Flushing usage events
[0m15:08:17.049400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFE139BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFEFBC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFE86E510>]}


============================== 15:08:17.053398 | 21df9f3f-9155-41db-a867-7f306fd3ebd8 ==============================
[0m15:08:17.053398 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:08:17.054399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:17.178822 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:08:17.179821 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:08:17.300756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21df9f3f-9155-41db-a867-7f306fd3ebd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFFA5B0E0>]}
[0m15:08:17.345693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21df9f3f-9155-41db-a867-7f306fd3ebd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFEE3C6B0>]}
[0m15:08:17.346694 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:08:17.369981 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:08:17.485994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:17.487014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:17.504605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21df9f3f-9155-41db-a867-7f306fd3ebd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFFB35520>]}
[0m15:08:17.560071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21df9f3f-9155-41db-a867-7f306fd3ebd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFFBD7650>]}
[0m15:08:17.560071 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:08:17.561421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21df9f3f-9155-41db-a867-7f306fd3ebd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFE3533E0>]}
[0m15:08:17.562751 [warn ] [MainThread]: The selection criterion 'customers' does not match any enabled nodes
[0m15:08:17.564585 [info ] [MainThread]: 
[0m15:08:17.565952 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:08:17.566960 [debug] [MainThread]: Command end result
[0m15:08:17.592025 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:17.592025 after 0.66 seconds
[0m15:08:17.593065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF8EECBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFEC2D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFEC2EC60>]}
[0m15:08:17.593065 [debug] [MainThread]: Flushing usage events
[0m15:08:23.332331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E8243E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E7E7B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E637800>]}


============================== 15:08:23.335398 | d94c4392-22be-4a7a-944b-9db07cb03852 ==============================
[0m15:08:23.335398 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:08:23.336398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select customer', 'send_anonymous_usage_stats': 'True'}
[0m15:08:23.428915 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:08:23.428915 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:08:23.524576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd94c4392-22be-4a7a-944b-9db07cb03852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E77DEB0>]}
[0m15:08:23.557632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd94c4392-22be-4a7a-944b-9db07cb03852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7C3E53D0>]}
[0m15:08:23.558578 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:08:23.576577 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:08:23.666240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:23.667240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:23.683223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd94c4392-22be-4a7a-944b-9db07cb03852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7F284380>]}
[0m15:08:23.728711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd94c4392-22be-4a7a-944b-9db07cb03852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7F39C650>]}
[0m15:08:23.728711 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:08:23.730048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd94c4392-22be-4a7a-944b-9db07cb03852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E824AD0>]}
[0m15:08:23.731056 [warn ] [MainThread]: The selection criterion 'customer' does not match any enabled nodes
[0m15:08:23.732057 [info ] [MainThread]: 
[0m15:08:23.732057 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:08:23.734056 [debug] [MainThread]: Command end result
[0m15:08:23.753452 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:23.752559 after 0.51 seconds
[0m15:08:23.753452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7863C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E9315E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7E4E2CC0>]}
[0m15:08:23.753452 [debug] [MainThread]: Flushing usage events
[0m15:11:09.268188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3AF7DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3C480C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3C483950>]}


============================== 15:11:09.272011 | 5f5e729b-9fe2-47d4-a04b-d2fbbee63f4e ==============================
[0m15:11:09.272011 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:11:09.272985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select customer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:09.369918 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:11:09.370914 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:11:09.472366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f5e729b-9fe2-47d4-a04b-d2fbbee63f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3DD78080>]}
[0m15:11:09.505876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f5e729b-9fe2-47d4-a04b-d2fbbee63f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3D2DF0E0>]}
[0m15:11:09.507272 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:11:09.526318 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:11:09.620591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:09.620591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:09.635531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f5e729b-9fe2-47d4-a04b-d2fbbee63f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3D345190>]}
[0m15:11:09.680491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f5e729b-9fe2-47d4-a04b-d2fbbee63f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3EEC7530>]}
[0m15:11:09.680491 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:11:09.681151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f5e729b-9fe2-47d4-a04b-d2fbbee63f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3D532420>]}
[0m15:11:09.681151 [warn ] [MainThread]: The selection criterion 'customer' does not match any enabled nodes
[0m15:11:09.682198 [info ] [MainThread]: 
[0m15:11:09.683160 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:11:09.684251 [debug] [MainThread]: Command end result
[0m15:11:09.702254 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:09.702254 after 0.56 seconds
[0m15:11:09.702254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3725C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3AF7DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3AF7DB20>]}
[0m15:11:09.703222 [debug] [MainThread]: Flushing usage events
[0m15:12:02.871379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56853EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E568BB2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5663E9550>]}


============================== 15:12:02.875908 | 55ef0b7d-56e6-475b-977a-1a8597bd757c ==============================
[0m15:12:02.875908 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:12:02.875908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:12:02.973823 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:12:02.973823 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:12:03.074832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E568E10890>]}
[0m15:12:03.108340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56977AB10>]}
[0m15:12:03.110024 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:12:03.128029 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:12:03.164033 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:12:03.164992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56853DDF0>]}
[0m15:12:04.065418 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt
[0m15:12:04.070389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56AA30FB0>]}
[0m15:12:04.114209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56A9E3530>]}
[0m15:12:04.114209 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:12:04.115209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E568500890>]}
[0m15:12:04.117209 [info ] [MainThread]: 
[0m15:12:04.117209 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:12:04.120212 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:12:04.130208 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:12:04.130208 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:12:04.130208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:04.133209 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:04.135580 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:04.718174 [debug] [ThreadPool]: SQL status: SUCCESS in 0.587 seconds
[0m15:12:04.719166 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:12:04.720163 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:12:04.837424 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m15:12:04.839424 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:12:04.917799 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:12:04.924302 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:04.924302 [debug] [MainThread]: On master: BEGIN
[0m15:12:04.925220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:04.925220 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:12:04.925220 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:12:05.348800 [debug] [MainThread]: SQL status: SUCCESS in 0.423 seconds
[0m15:12:05.349898 [debug] [MainThread]: Using redshift connection "master"
[0m15:12:05.350818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:12:05.484227 [debug] [MainThread]: SQL status: SUCCESS in 0.133 seconds
[0m15:12:05.488358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ef0b7d-56e6-475b-977a-1a8597bd757c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5698C9AF0>]}
[0m15:12:05.490370 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:05.569298 [debug] [MainThread]: On master: Close
[0m15:12:05.571297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:12:05.572345 [info ] [MainThread]: 
[0m15:12:05.582216 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:12:05.582216 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:12:05.583211 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:12:05.584231 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:12:05.587210 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:12:05.585210 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:12:05.586209 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:12:05.584231 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:12:05.587210 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:12:05.588210 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:12:05.589209 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:12:05.589209 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:12:05.591208 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:12:05.593207 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:12:05.594224 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:12:05.595208 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:12:05.597211 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:12:05.597211 [debug] [Thread-4 (]: Began running node model.redshift.pg_tables
[0m15:12:05.598208 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:12:05.598208 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:12:05.599245 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:12:05.599245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.pg_tables)
[0m15:12:05.600208 [debug] [Thread-3 (]: Began running node model.redshift.pg_user
[0m15:12:05.600208 [debug] [Thread-2 (]: Began running node model.redshift.pg_views
[0m15:12:05.600208 [debug] [Thread-1 (]: Began running node model.redshift.redshift_columns
[0m15:12:05.601208 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_tables
[0m15:12:05.601208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_user)
[0m15:12:05.601208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_views)
[0m15:12:05.602213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.redshift_columns)
[0m15:12:05.603208 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:12:05.604208 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_user
[0m15:12:05.604208 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_views
[0m15:12:05.605208 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_columns
[0m15:12:05.607209 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:12:05.608208 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:12:05.609207 [debug] [Thread-4 (]: Finished running node model.redshift.pg_tables
[0m15:12:05.611225 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:12:05.611225 [debug] [Thread-3 (]: Finished running node model.redshift.pg_user
[0m15:12:05.612209 [debug] [Thread-2 (]: Finished running node model.redshift.pg_views
[0m15:12:05.612209 [debug] [Thread-4 (]: Began running node model.redshift.redshift_constraints
[0m15:12:05.613208 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:12:05.613208 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m15:12:05.614208 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_columns
[0m15:12:05.614208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:12:05.614208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:12:05.615209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m15:12:05.615209 [debug] [Thread-1 (]: Began running node model.redshift.stl_explain
[0m15:12:05.616208 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_constraints
[0m15:12:05.616208 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:12:05.616798 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m15:12:05.616798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:12:05.618849 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:12:05.619839 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:12:05.621825 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:12:05.621825 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_explain
[0m15:12:05.622807 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_constraints
[0m15:12:05.623807 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:12:05.624811 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:12:05.625810 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m15:12:05.625810 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m15:12:05.625810 [debug] [Thread-3 (]: Began running node model.redshift.stl_wlm_query
[0m15:12:05.626808 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m15:12:05.626808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:12:05.627810 [debug] [Thread-1 (]: Finished running node model.redshift.stl_explain
[0m15:12:05.627810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:12:05.627810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:12:05.627810 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m15:12:05.628808 [debug] [Thread-1 (]: Began running node model.redshift.stv_partitions
[0m15:12:05.628808 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:12:05.629806 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m15:12:05.630842 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:12:05.630842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:12:05.631807 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:12:05.633835 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:12:05.633835 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_partitions
[0m15:12:05.633835 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m15:12:05.636700 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:12:05.637709 [debug] [Thread-3 (]: Finished running node model.redshift.stl_wlm_query
[0m15:12:05.637709 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m15:12:05.637709 [debug] [Thread-4 (]: Began running node model.redshift.stv_tbl_perm
[0m15:12:05.638715 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m15:12:05.638715 [debug] [Thread-1 (]: Finished running node model.redshift.stv_partitions
[0m15:12:05.638715 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:12:05.639890 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:12:05.639890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:12:05.639890 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:12:05.641001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:12:05.641001 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:12:05.641001 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m15:12:05.641001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:12:05.642008 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:12:05.643036 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:12:05.644028 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:12:05.644028 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:12:05.649025 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:12:05.654025 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:12:05.655025 [debug] [Thread-4 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:12:05.655025 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m15:12:05.656055 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:12:05.656055 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:12:05.657013 [debug] [Thread-3 (]: Began running node model.redshift.redshift_cost
[0m15:12:05.657013 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:12:05.658010 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:12:05.659008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:12:05.659008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:12:05.659008 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:12:05.660492 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:12:05.660492 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:12:05.660492 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_cost
[0m15:12:05.661542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_table_stats)
[0m15:12:05.667601 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:12:05.672618 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:12:05.672845 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:12:05.673208 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:12:05.687845 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:12:05.688851 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:12:05.688851 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_cost
[0m15:12:05.689511 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:12:05.690517 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_queries
[0m15:12:05.690517 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:12:05.691517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_schema_privileges, now model.redshift.redshift_admin_queries)
[0m15:12:05.691517 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:12:05.696515 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:12:05.697522 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:12:05.697522 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:12:05.698522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:05.699517 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:12:05.699517 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:12:05.699517 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:12:05.699517 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m15:12:05.699517 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:12:05.700517 [debug] [MainThread]: Command end result
[0m15:12:05.723518 [debug] [MainThread]: Command `dbt compile` succeeded at 15:12:05.723518 after 2.98 seconds
[0m15:12:05.723518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E568E10AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E568D34470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56853EB40>]}
[0m15:12:05.724517 [debug] [MainThread]: Flushing usage events
[0m15:14:04.809056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E751E9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E77AF5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E771B0440>]}


============================== 15:14:04.811491 | d5a90e0d-eca4-44e6-9455-fa0dc7ad4412 ==============================
[0m15:14:04.811491 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:14:04.812471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:14:04.912434 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:14:04.912434 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:14:05.018026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E77297EF0>]}
[0m15:14:05.056548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E784F6240>]}
[0m15:14:05.057547 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:14:05.080171 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:14:05.134231 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:14:05.135521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7733DCD0>]}
[0m15:14:06.054812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integrity_energy_dbt
- models.integrity_energy_dbt.customer
[0m15:14:06.059809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E796A1AF0>]}
[0m15:14:06.105255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7972E570>]}
[0m15:14:06.106256 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:14:06.106256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E772FC8F0>]}
[0m15:14:06.108255 [info ] [MainThread]: 
[0m15:14:06.109256 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:14:06.112612 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:14:06.124619 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:14:06.124619 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:14:06.124619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:06.127621 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:14:06.128621 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:14:06.705026 [debug] [ThreadPool]: SQL status: SUCCESS in 0.580 seconds
[0m15:14:06.707025 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:14:06.708025 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:14:06.827054 [debug] [ThreadPool]: SQL status: SUCCESS in 0.118 seconds
[0m15:14:06.830050 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:14:06.909811 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:14:06.924844 [debug] [MainThread]: Using redshift connection "master"
[0m15:14:06.925873 [debug] [MainThread]: On master: BEGIN
[0m15:14:06.925873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:06.926881 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:14:06.926881 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:14:07.344901 [debug] [MainThread]: SQL status: SUCCESS in 0.419 seconds
[0m15:14:07.346901 [debug] [MainThread]: Using redshift connection "master"
[0m15:14:07.347898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:14:07.482164 [debug] [MainThread]: SQL status: SUCCESS in 0.133 seconds
[0m15:14:07.485158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a90e0d-eca4-44e6-9455-fa0dc7ad4412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E784782F0>]}
[0m15:14:07.486161 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:07.567334 [debug] [MainThread]: On master: Close
[0m15:14:07.568334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:07.568334 [info ] [MainThread]: 
[0m15:14:07.573189 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:14:07.574207 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:14:07.574207 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:14:07.574207 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:14:07.575189 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:14:07.575189 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:14:07.575189 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:14:07.576189 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:14:07.576189 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:14:07.576189 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:14:07.576189 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:14:07.577189 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:14:07.578214 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:14:07.579189 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:14:07.580189 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:14:07.581211 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:14:07.582190 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:14:07.583189 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:14:07.583189 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:14:07.584190 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:14:07.584190 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:14:07.585188 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:14:07.585188 [debug] [Thread-4 (]: Began running node model.redshift.pg_views
[0m15:14:07.585188 [debug] [Thread-3 (]: Began running node model.redshift.redshift_columns
[0m15:14:07.586189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:14:07.586189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:14:07.586189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.pg_views)
[0m15:14:07.587209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_columns)
[0m15:14:07.587209 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:14:07.588217 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:14:07.588217 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_views
[0m15:14:07.588217 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_columns
[0m15:14:07.590207 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:14:07.592188 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:14:07.592480 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:14:07.594674 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:14:07.595283 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:14:07.596304 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:14:07.596304 [debug] [Thread-4 (]: Finished running node model.redshift.pg_views
[0m15:14:07.597302 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:14:07.597302 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:14:07.597302 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_columns
[0m15:14:07.598302 [debug] [Thread-4 (]: Began running node model.redshift.redshift_tables
[0m15:14:07.598302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:14:07.598302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:14:07.599302 [debug] [Thread-3 (]: Began running node model.redshift.stl_explain
[0m15:14:07.599302 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m15:14:07.600334 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:14:07.600334 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:14:07.600334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:14:07.601303 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_tables
[0m15:14:07.603303 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:14:07.605303 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:14:07.605303 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_explain
[0m15:14:07.606302 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:14:07.608303 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:14:07.609302 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:14:07.609302 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:14:07.610303 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_tables
[0m15:14:07.610303 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m15:14:07.611302 [debug] [Thread-3 (]: Finished running node model.redshift.stl_explain
[0m15:14:07.611302 [debug] [Thread-2 (]: Began running node model.redshift.stl_wlm_query
[0m15:14:07.611302 [debug] [Thread-4 (]: Began running node model.redshift.stv_blocklist
[0m15:14:07.612162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:14:07.612162 [debug] [Thread-3 (]: Began running node model.redshift.stv_partitions
[0m15:14:07.612162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:14:07.613178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:14:07.613178 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m15:14:07.613178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:14:07.613178 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:14:07.614223 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_blocklist
[0m15:14:07.615213 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:14:07.615213 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_partitions
[0m15:14:07.617183 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:14:07.619171 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:14:07.621680 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:14:07.621680 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m15:14:07.622886 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m15:14:07.622886 [debug] [Thread-3 (]: Finished running node model.redshift.stv_partitions
[0m15:14:07.622886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:14:07.623901 [debug] [Thread-2 (]: Finished running node model.redshift.stl_wlm_query
[0m15:14:07.623901 [debug] [Thread-4 (]: Finished running node model.redshift.stv_blocklist
[0m15:14:07.623901 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m15:14:07.625103 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:14:07.625103 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:14:07.625103 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:14:07.625103 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.svv_diskusage)
[0m15:14:07.626579 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:14:07.627588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.redshift_admin_dependencies)
[0m15:14:07.627588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:14:07.627588 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m15:14:07.628588 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:14:07.628588 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:14:07.628588 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:14:07.629593 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:14:07.634607 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:14:07.635587 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:14:07.640301 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:14:07.641267 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m15:14:07.642264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:14:07.642264 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:14:07.643352 [debug] [Thread-3 (]: Began running node model.redshift.redshift_cost
[0m15:14:07.643352 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:14:07.643352 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:14:07.644352 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:14:07.644352 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:14:07.645352 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:14:07.651351 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:14:07.652353 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:14:07.652353 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_cost
[0m15:14:07.653353 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:14:07.653353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_table_stats)
[0m15:14:07.658369 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:14:07.658369 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:14:07.659107 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:14:07.660114 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_cost
[0m15:14:07.673112 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:14:07.673921 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_queries
[0m15:14:07.674927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_schema_privileges, now model.redshift.redshift_admin_queries)
[0m15:14:07.674927 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:14:07.674927 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:14:07.680972 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:14:07.680972 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:14:07.681929 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:14:07.682928 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:14:07.683615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:07.683615 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:14:07.684649 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:14:07.684649 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:14:07.684649 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m15:14:07.684649 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:14:07.684649 [debug] [MainThread]: Command end result
[0m15:14:07.706638 [debug] [MainThread]: Command `dbt compile` succeeded at 15:14:07.706638 after 3.06 seconds
[0m15:14:07.706638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E777C39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E77731DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E778B9A60>]}
[0m15:14:07.706638 [debug] [MainThread]: Flushing usage events
[0m15:41:00.064823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366B6DE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366B6DE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366B6DC140>]}


============================== 15:41:00.071611 | 08cf94f1-5e24-4c67-9f31-5acb9692aae9 ==============================
[0m15:41:00.071611 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:41:00.072608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:41:01.783454 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:41:01.784437 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:41:01.925426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366C950560>]}
[0m15:41:01.959409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366C8F4E60>]}
[0m15:41:01.961190 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:41:02.042923 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:41:04.083832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:04.083832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:04.087833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integrity_energy_dbt
- models.integrity_energy_dbt.customer
[0m15:41:04.099794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366C0C8F20>]}
[0m15:41:04.178088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366CA29A60>]}
[0m15:41:04.178088 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:41:04.181281 [info ] [MainThread]: 
[0m15:41:04.182326 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:41:04.185256 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m15:41:04.196259 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m15:41:04.197268 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m15:41:04.197268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:04.200264 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:04.200264 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:05.062885 [debug] [ThreadPool]: SQL status: SUCCESS in 0.865 seconds
[0m15:41:05.066884 [debug] [ThreadPool]: On list_integrity-db: Close
[0m15:41:05.081054 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:41:05.089154 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:41:05.090166 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:41:05.090166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:05.091073 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:05.091073 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:05.493854 [debug] [ThreadPool]: SQL status: SUCCESS in 0.403 seconds
[0m15:41:05.495849 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:41:05.496844 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:41:05.607466 [debug] [ThreadPool]: SQL status: SUCCESS in 0.110 seconds
[0m15:41:05.611523 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:41:05.688956 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:41:05.703592 [debug] [MainThread]: Using redshift connection "master"
[0m15:41:05.704593 [debug] [MainThread]: On master: BEGIN
[0m15:41:05.704593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:05.705592 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:05.705592 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:06.188823 [debug] [MainThread]: SQL status: SUCCESS in 0.484 seconds
[0m15:41:06.189824 [debug] [MainThread]: Using redshift connection "master"
[0m15:41:06.190908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:41:06.334330 [debug] [MainThread]: SQL status: SUCCESS in 0.142 seconds
[0m15:41:06.338349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023669A91850>]}
[0m15:41:06.339352 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:06.418094 [debug] [MainThread]: Using redshift connection "master"
[0m15:41:06.419088 [debug] [MainThread]: On master: BEGIN
[0m15:41:06.458094 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m15:41:06.458094 [debug] [MainThread]: On master: COMMIT
[0m15:41:06.459132 [debug] [MainThread]: Using redshift connection "master"
[0m15:41:06.460127 [debug] [MainThread]: On master: COMMIT
[0m15:41:06.535150 [debug] [MainThread]: SQL status: SUCCESS in 0.075 seconds
[0m15:41:06.536170 [debug] [MainThread]: On master: Close
[0m15:41:06.538168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:06.540166 [info ] [MainThread]: 
[0m15:41:06.561161 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:41:06.562160 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:41:06.563160 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:41:06.564175 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:41:06.564175 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:41:06.565160 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:41:06.566161 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:41:06.567170 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:41:06.568160 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:41:06.568160 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:41:06.569421 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:41:06.571475 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:41:06.571808 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:41:06.573273 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:41:06.576235 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:41:06.577237 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:41:06.578608 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:41:06.579618 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:41:06.580617 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:41:06.580617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:41:06.581755 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:41:06.581755 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:41:06.581755 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:41:06.582763 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:41:06.582763 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:41:06.583763 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m15:41:06.583763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:41:06.584765 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:41:06.585766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m15:41:06.586777 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:41:06.585766 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:41:06.585766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m15:41:06.586777 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:41:06.587765 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:41:06.589774 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:41:06.590389 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m15:41:06.590800 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:41:06.593926 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:41:06.594834 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:41:06.595814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:41:06.596810 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:41:06.596810 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:41:06.597836 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:41:06.597836 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m15:41:06.599105 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m15:41:06.599105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_sort_dist_keys)
[0m15:41:06.602600 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:41:06.603786 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m15:41:06.604814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_tables)
[0m15:41:06.604814 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:41:06.605852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:41:06.606963 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m15:41:06.610041 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:41:06.611049 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:41:06.611049 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m15:41:06.615046 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:41:06.615553 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m15:41:06.617973 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:41:06.620967 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:41:06.620967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:41:06.622307 [debug] [Thread-3 (]: Began running node model.redshift.stl_wlm_query
[0m15:41:06.622307 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m15:41:06.623317 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m15:41:06.623317 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m15:41:06.624317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:41:06.625371 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m15:41:06.625371 [debug] [Thread-4 (]: Began running node model.redshift.stv_partitions
[0m15:41:06.627643 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:41:06.628643 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:41:06.628643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:41:06.629916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:41:06.630925 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:41:06.631927 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m15:41:06.632924 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m15:41:06.632924 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_partitions
[0m15:41:06.635376 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:41:06.635376 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m15:41:06.636694 [debug] [Thread-3 (]: Finished running node model.redshift.stl_wlm_query
[0m15:41:06.638701 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:41:06.639702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:41:06.639702 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m15:41:06.639702 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m15:41:06.640714 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:41:06.641702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:41:06.641702 [debug] [Thread-4 (]: Finished running node model.redshift.stv_partitions
[0m15:41:06.642701 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:41:06.644860 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:41:06.644860 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m15:41:06.645940 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:41:06.645940 [info ] [Thread-2 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m15:41:06.648284 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:41:06.648284 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:41:06.648284 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m15:41:06.649499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:41:06.650507 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:41:06.650507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:41:06.650507 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m15:41:06.650507 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:41:06.652027 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m15:41:06.652027 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:41:06.653078 [debug] [Thread-3 (]: Began running node model.redshift.redshift_cost
[0m15:41:06.663047 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:41:06.663047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:41:06.673063 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:06.673063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:41:06.674049 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:41:06.675048 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:41:06.675048 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_cost
[0m15:41:06.684071 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:06.703739 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:41:06.720252 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m15:41:06.728290 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:41:06.733280 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:06.734253 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:41:06.741258 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:06.742257 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_cost
[0m15:41:06.746217 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:06.751238 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:06.752219 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:41:06.752219 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:41:06.754219 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:41:06.761217 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:06.761740 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:06.762354 [info ] [Thread-3 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m15:41:06.763361 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:06.763361 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:41:06.764380 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:06.765361 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m15:41:06.765361 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:06.766361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:06.766361 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:06.767363 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:41:06.767363 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:06.768362 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:06.866983 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:41:06.868942 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:06.875344 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:41:06.886815 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m15:41:06.898133 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:06.898133 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:41:06.901164 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:06.902163 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:06.904164 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:07.356038 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.454 seconds
[0m15:41:07.357083 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:07.358989 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m15:41:07.372989 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.610 seconds
[0m15:41:07.374048 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:07.375068 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m15:41:07.377027 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.616 seconds
[0m15:41:07.377027 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:07.378044 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m15:41:07.382565 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.616 seconds
[0m15:41:07.383519 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:07.383519 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m15:41:07.578038 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.218 seconds
[0m15:41:07.590364 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:07.590918 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m15:41:07.602813 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.228 seconds
[0m15:41:07.606790 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:07.606790 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m15:41:07.608790 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.230 seconds
[0m15:41:07.611864 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:07.611864 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m15:41:07.620233 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.236 seconds
[0m15:41:07.624157 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:07.624157 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:41:07.703428 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.111 seconds
[0m15:41:07.710420 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:07.710420 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m15:41:07.730941 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.123 seconds
[0m15:41:07.731931 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.119 seconds
[0m15:41:07.736925 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:07.740935 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m15:41:07.740935 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:07.741938 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m15:41:07.754945 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.130 seconds
[0m15:41:07.758937 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:07.759939 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m15:41:07.831923 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.120 seconds
[0m15:41:07.843963 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:41:07.844930 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:07.844930 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:41:07.857961 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m15:41:07.858918 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:41:07.859975 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:07.859975 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:41:07.867932 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.126 seconds
[0m15:41:07.868918 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:41:07.869945 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:07.869945 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:41:07.883960 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m15:41:07.885917 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:41:07.885917 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:07.885917 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:41:08.063004 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.217 seconds
[0m15:41:08.065030 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:08.066020 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:41:08.067016 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.207 seconds
[0m15:41:08.068017 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.181 seconds
[0m15:41:08.069017 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.198 seconds
[0m15:41:08.140233 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.073 seconds
[0m15:41:08.149229 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m15:41:08.152228 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:08.152228 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m15:41:08.229427 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:41:08.230304 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:41:08.231303 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:08.231303 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:41:08.358680 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.126 seconds
[0m15:41:08.359682 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:41:08.360679 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:41:08.396950 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.035 seconds
[0m15:41:08.401946 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:08.401946 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:41:08.482277 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:41:08.485315 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m15:41:08.486314 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:08.486314 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m15:41:08.567553 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.080 seconds
[0m15:41:08.569541 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:41:08.569541 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:08.569541 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:41:08.674586 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.104 seconds
[0m15:41:08.675911 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:41:08.677121 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:41:08.715178 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.037 seconds
[0m15:41:08.719744 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:08.720745 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:41:08.801732 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:41:08.810848 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:41:08.812841 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:08.813847 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m15:41:08.903828 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.089 seconds
[0m15:41:08.906861 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:41:08.907371 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:08.908427 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:41:09.025247 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:41:09.027239 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:41:09.028238 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:41:09.070319 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.041 seconds
[0m15:41:09.073316 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:09.074341 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:41:09.157423 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:41:09.163438 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m15:41:09.165440 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:09.165440 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m15:41:09.252680 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:41:09.255669 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:41:09.257626 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:09.258772 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:41:09.352112 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.092 seconds
[0m15:41:09.353071 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:41:09.355061 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:41:09.394092 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.039 seconds
[0m15:41:09.397082 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m15:41:09.398155 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m15:41:09.399370 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m15:41:09.400463 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m15:41:09.471968 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: Close
[0m15:41:09.476014 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023669A394F0>]}
[0m15:41:09.476998 [info ] [Thread-3 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.71s]
[0m15:41:09.478959 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:41:09.480015 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_queries
[0m15:41:09.481958 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m15:41:09.481958 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: Close
[0m15:41:09.480958 [info ] [Thread-3 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m15:41:09.483195 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m15:41:09.483866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366E3FA210>]}
[0m15:41:09.484564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023669B689E0>]}
[0m15:41:09.485576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_table_stats, now model.redshift.redshift_admin_queries)
[0m15:41:09.485576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366DF8FF50>]}
[0m15:41:09.486968 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.82s]
[0m15:41:09.486968 [info ] [Thread-2 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.84s]
[0m15:41:09.487976 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:41:09.487976 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.84s]
[0m15:41:09.488977 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:41:09.490015 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:41:09.496411 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:41:09.497420 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:41:09.498427 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:41:09.501741 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m15:41:09.507817 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:09.507817 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:41:09.508818 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:09.508818 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:09.508818 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:09.943153 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.434 seconds
[0m15:41:09.943153 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:09.944153 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m15:41:10.156441 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.211 seconds
[0m15:41:10.162471 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.163470 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m15:41:10.286974 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.122 seconds
[0m15:41:10.294054 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.294054 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m15:41:10.412223 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:41:10.415221 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:41:10.416222 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.417221 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:41:10.577617 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.160 seconds
[0m15:41:10.579653 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.580641 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:41:10.658660 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:41:10.663703 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m15:41:10.665683 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.666648 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m15:41:10.748199 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:41:10.751231 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:41:10.752202 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.753231 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:41:10.848067 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.094 seconds
[0m15:41:10.849112 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:41:10.850106 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:41:10.890096 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.039 seconds
[0m15:41:10.892052 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m15:41:10.969654 [debug] [Thread-3 (]: On model.redshift.redshift_admin_queries: Close
[0m15:41:10.971710 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cf94f1-5e24-4c67-9f31-5acb9692aae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366DF91E80>]}
[0m15:41:10.973653 [info ] [Thread-3 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.49s]
[0m15:41:10.976648 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:41:10.979648 [debug] [MainThread]: Using redshift connection "master"
[0m15:41:10.980648 [debug] [MainThread]: On master: BEGIN
[0m15:41:10.981685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:10.982663 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:41:10.982663 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:41:11.421057 [debug] [MainThread]: SQL status: SUCCESS in 0.439 seconds
[0m15:41:11.422058 [debug] [MainThread]: On master: COMMIT
[0m15:41:11.423573 [debug] [MainThread]: Using redshift connection "master"
[0m15:41:11.423573 [debug] [MainThread]: On master: COMMIT
[0m15:41:11.501655 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m15:41:11.502672 [debug] [MainThread]: On master: Close
[0m15:41:11.504661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:11.505665 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m15:41:11.506655 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:41:11.506655 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:41:11.507682 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m15:41:11.507682 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:41:11.508670 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m15:41:11.509694 [info ] [MainThread]: 
[0m15:41:11.511688 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m15:41:11.516744 [debug] [MainThread]: Command end result
[0m15:41:11.558258 [info ] [MainThread]: 
[0m15:41:11.559211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:11.560229 [info ] [MainThread]: 
[0m15:41:11.561238 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:41:11.562242 [debug] [MainThread]: Command `dbt build` succeeded at 15:41:11.562242 after 11.68 seconds
[0m15:41:11.563255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366B7BC650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366DA53FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366E45C770>]}
[0m15:41:11.563255 [debug] [MainThread]: Flushing usage events
[0m15:44:09.397018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6E7CDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6ED21DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6E7CD850>]}


============================== 15:44:09.400019 | bd8db359-a98e-45e0-981e-4ae4a9c12e6a ==============================
[0m15:44:09.400019 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:44:09.401037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m15:44:09.502662 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:44:09.502662 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:44:09.600879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd8db359-a98e-45e0-981e-4ae4a9c12e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6EFC6CC0>]}
[0m15:44:09.635878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd8db359-a98e-45e0-981e-4ae4a9c12e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6EB8EEA0>]}
[0m15:44:09.636879 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:44:09.655878 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:44:09.751809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:09.751809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:09.755809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integrity_energy_dbt.customer
- models.integrity_energy_dbt
[0m15:44:09.768817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8db359-a98e-45e0-981e-4ae4a9c12e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6F968DD0>]}
[0m15:44:09.834435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8db359-a98e-45e0-981e-4ae4a9c12e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6FB484D0>]}
[0m15:44:09.836155 [debug] [MainThread]: Command `dbt list` succeeded at 15:44:09.836155 after 0.58 seconds
[0m15:44:09.837160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6EF1EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6EF852B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6ED4AFF0>]}
[0m15:44:09.837160 [debug] [MainThread]: Flushing usage events
[0m15:49:52.210210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BEBD8F080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BEBD8FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BEBD8C830>]}


============================== 15:49:52.214231 | eb37d628-fe51-4265-80b9-dd2bdc554bc2 ==============================
[0m15:49:52.214231 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:49:52.214823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:49:52.237820 [info ] [MainThread]: dbt version: 1.8.3
[0m15:49:52.238821 [info ] [MainThread]: python version: 3.12.4
[0m15:49:52.238821 [info ] [MainThread]: python path: C:\Development\IntegrityDBT\IntegrityDBT\Scripts\python.exe
[0m15:49:52.238821 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:49:52.330260 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:49:52.331288 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:49:52.361335 [info ] [MainThread]: Using profiles dir at C:\Development\IntegrityDBT
[0m15:49:52.361335 [info ] [MainThread]: Using profiles.yml file at C:\Development\IntegrityDBT\profiles.yml
[0m15:49:52.362321 [info ] [MainThread]: Using dbt_project.yml file at C:\Development\IntegrityDBT\dbt_project.yml
[0m15:49:52.364361 [info ] [MainThread]: adapter type: redshift
[0m15:49:52.364361 [info ] [MainThread]: adapter version: 1.8.1
[0m15:49:52.420365 [info ] [MainThread]: Configuration:
[0m15:49:52.420365 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:49:52.421331 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:49:52.421331 [info ] [MainThread]: Required dependencies:
[0m15:49:52.422530 [debug] [MainThread]: Executing "git --help"
[0m15:49:52.444651 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:49:52.445685 [debug] [MainThread]: STDERR: "b''"
[0m15:49:52.445685 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:49:52.446413 [info ] [MainThread]: Connection:
[0m15:49:52.446413 [info ] [MainThread]:   host: integrity-energy.cm7f5da54gqs.us-east-1.redshift.amazonaws.com
[0m15:49:52.447420 [info ] [MainThread]:   user: integrityadmin
[0m15:49:52.447420 [info ] [MainThread]:   port: 5439
[0m15:49:52.448419 [info ] [MainThread]:   database: integrity-db
[0m15:49:52.448776 [info ] [MainThread]:   method: database
[0m15:49:52.448776 [info ] [MainThread]:   cluster_id: None
[0m15:49:52.449508 [info ] [MainThread]:   iam_profile: None
[0m15:49:52.449508 [info ] [MainThread]:   schema: dbt
[0m15:49:52.450540 [info ] [MainThread]:   sslmode: prefer
[0m15:49:52.450540 [info ] [MainThread]:   region: None
[0m15:49:52.451533 [info ] [MainThread]:   sslmode: prefer
[0m15:49:52.451533 [info ] [MainThread]:   region: None
[0m15:49:52.451533 [info ] [MainThread]:   iam_profile: None
[0m15:49:52.452538 [info ] [MainThread]:   autocreate: False
[0m15:49:52.452538 [info ] [MainThread]:   db_groups: []
[0m15:49:52.453536 [info ] [MainThread]:   ra3_node: False
[0m15:49:52.453536 [info ] [MainThread]:   connect_timeout: None
[0m15:49:52.453536 [info ] [MainThread]:   role: None
[0m15:49:52.454844 [info ] [MainThread]:   retries: 1
[0m15:49:52.454844 [info ] [MainThread]:   autocommit: True
[0m15:49:52.455869 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:49:52.455869 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m15:49:52.458888 [debug] [MainThread]: Using redshift connection "debug"
[0m15:49:52.458888 [debug] [MainThread]: On debug: select 1 as id
[0m15:49:52.459883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:52.461891 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:49:52.462868 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:49:53.047904 [debug] [MainThread]: SQL status: SUCCESS in 0.588 seconds
[0m15:49:53.049904 [debug] [MainThread]: On debug: Close
[0m15:49:53.050903 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:49:53.051904 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:49:53.052927 [debug] [MainThread]: Command `dbt debug` succeeded at 15:49:53.052927 after 0.96 seconds
[0m15:49:53.054251 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:49:53.054251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BEBD12360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BEC7E4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BEC707710>]}
[0m15:49:53.055267 [debug] [MainThread]: Flushing usage events
[0m15:51:13.188476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9104A6E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D912B85D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D90F66C9E0>]}


============================== 15:51:13.192160 | 1a3dce4a-456a-4f3c-92be-73f4998597c9 ==============================
[0m15:51:13.192160 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:51:13.192597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:13.263133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a3dce4a-456a-4f3c-92be-73f4998597c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D91098A3C0>]}
[0m15:51:13.327013 [debug] [MainThread]: Command `dbt clean` succeeded at 15:51:13.327013 after 0.27 seconds
[0m15:51:13.328013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D912A83CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D90CCD4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D912D9FAA0>]}
[0m15:51:13.328013 [debug] [MainThread]: Flushing usage events
[0m15:51:19.374727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250760F51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250765D9D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250764DD820>]}


============================== 15:51:19.377801 | b2cb7554-a248-45cc-9089-0126b7c25982 ==============================
[0m15:51:19.377801 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:51:19.378737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:19.447421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2cb7554-a248-45cc-9089-0126b7c25982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250768152B0>]}
[0m15:51:19.480718 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-i87o5yjn'
[0m15:51:19.481739 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:51:19.639299 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:51:19.641294 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:51:19.715349 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:51:19.721918 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m15:51:19.858259 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m15:51:19.861255 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m15:51:19.927748 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m15:51:19.930803 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m15:51:20.009016 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m15:51:20.010017 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:51:20.349506 [info ] [MainThread]: Installed from version 1.0.0
[0m15:51:20.349506 [info ] [MainThread]: Updated version available: 1.2.0
[0m15:51:20.350506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2cb7554-a248-45cc-9089-0126b7c25982', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025076992930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025076992240>]}
[0m15:51:20.350506 [info ] [MainThread]: Installing dbt-labs/redshift
[0m15:51:20.613773 [info ] [MainThread]: Installed from version 0.9.0
[0m15:51:20.614772 [info ] [MainThread]: Up to date!
[0m15:51:20.614772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2cb7554-a248-45cc-9089-0126b7c25982', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025075953110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025076A0E1E0>]}
[0m15:51:20.615773 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m15:51:20.925742 [info ] [MainThread]: Installed from version 0.8.2
[0m15:51:20.926743 [info ] [MainThread]: Updated version available: 0.9.0
[0m15:51:20.927742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2cb7554-a248-45cc-9089-0126b7c25982', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025076A0ED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025076A0E1E0>]}
[0m15:51:20.927742 [info ] [MainThread]: Installing dbt-labs/codegen
[0m15:51:21.107233 [info ] [MainThread]: Installed from version 0.9.0
[0m15:51:21.108234 [info ] [MainThread]: Updated version available: 0.12.1
[0m15:51:21.108234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2cb7554-a248-45cc-9089-0126b7c25982', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025075983B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025075983E60>]}
[0m15:51:21.109234 [info ] [MainThread]: 
[0m15:51:21.109234 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m15:51:21.111234 [debug] [MainThread]: Command `dbt deps` succeeded at 15:51:21.111234 after 1.82 seconds
[0m15:51:21.111234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250760F51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250758D26C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250769A4EF0>]}
[0m15:51:21.112233 [debug] [MainThread]: Flushing usage events
[0m15:51:35.775522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198326F6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198350AF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198350ADD30>]}


============================== 15:51:35.779181 | c4beed11-16e6-40fc-a592-00b03196b76e ==============================
[0m15:51:35.779181 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:51:35.780158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:51:35.874305 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:51:35.874305 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:51:35.972889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019832FDA7B0>]}
[0m15:51:36.006932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019835E04A10>]}
[0m15:51:36.007891 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:51:36.043004 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:51:36.044004 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:51:36.045239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019835F7E000>]}
[0m15:51:37.222973 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integrity_energy_dbt
- models.integrity_energy_dbt.customer
[0m15:51:37.226974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198371554C0>]}
[0m15:51:37.284965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019837307D10>]}
[0m15:51:37.284965 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:51:37.285964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019837118380>]}
[0m15:51:37.286991 [info ] [MainThread]: 
[0m15:51:37.287966 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:51:37.289964 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m15:51:37.300980 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m15:51:37.301968 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m15:51:37.301968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:37.305028 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:37.305028 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:37.897548 [debug] [ThreadPool]: SQL status: SUCCESS in 0.595 seconds
[0m15:51:37.901566 [debug] [ThreadPool]: On list_integrity-db: Close
[0m15:51:37.905567 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:51:37.912560 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:51:37.912560 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:51:37.912560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:37.913562 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:37.913562 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:38.342566 [debug] [ThreadPool]: SQL status: SUCCESS in 0.429 seconds
[0m15:51:38.344093 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:51:38.345122 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:51:38.462443 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m15:51:38.465418 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:51:38.545302 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:51:38.558305 [debug] [MainThread]: Using redshift connection "master"
[0m15:51:38.559287 [debug] [MainThread]: On master: BEGIN
[0m15:51:38.559287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:38.559287 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:38.560305 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:38.987605 [debug] [MainThread]: SQL status: SUCCESS in 0.428 seconds
[0m15:51:38.988927 [debug] [MainThread]: Using redshift connection "master"
[0m15:51:38.990203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:51:39.123855 [debug] [MainThread]: SQL status: SUCCESS in 0.132 seconds
[0m15:51:39.125850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001983719D3A0>]}
[0m15:51:39.126848 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:39.206915 [debug] [MainThread]: Using redshift connection "master"
[0m15:51:39.207994 [debug] [MainThread]: On master: BEGIN
[0m15:51:39.247982 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m15:51:39.249022 [debug] [MainThread]: On master: COMMIT
[0m15:51:39.250969 [debug] [MainThread]: Using redshift connection "master"
[0m15:51:39.250969 [debug] [MainThread]: On master: COMMIT
[0m15:51:39.327266 [debug] [MainThread]: SQL status: SUCCESS in 0.075 seconds
[0m15:51:39.328283 [debug] [MainThread]: On master: Close
[0m15:51:39.329281 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:39.331730 [info ] [MainThread]: 
[0m15:51:39.336726 [debug] [Thread-2 (]: Began running node model.redshift.pg_attribute
[0m15:51:39.337726 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:51:39.337726 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_attribute
[0m15:51:39.339723 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:51:39.340724 [debug] [Thread-2 (]: Finished running node model.redshift.pg_attribute
[0m15:51:39.340724 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:51:39.340724 [debug] [Thread-1 (]: Began running node model.redshift.pg_depend
[0m15:51:39.340724 [debug] [Thread-3 (]: Began running node model.redshift.pg_namespace
[0m15:51:39.342725 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:51:39.343724 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_namespace
[0m15:51:39.341724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_class)
[0m15:51:39.345229 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:51:39.346233 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:51:39.341724 [debug] [Thread-4 (]: Began running node model.redshift.pg_tables
[0m15:51:39.342725 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:51:39.343724 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:51:39.346233 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:51:39.346233 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_tables'
[0m15:51:39.347703 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_depend
[0m15:51:39.347703 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:51:39.352684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:51:39.350208 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:51:39.351207 [debug] [Thread-3 (]: Finished running node model.redshift.pg_namespace
[0m15:51:39.347703 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_tables
[0m15:51:39.352684 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:51:39.353689 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:51:39.355334 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:51:39.355994 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:51:39.357107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.pg_views)
[0m15:51:39.358111 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:51:39.359620 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:51:39.361082 [debug] [Thread-1 (]: Finished running node model.redshift.pg_depend
[0m15:51:39.362090 [debug] [Thread-1 (]: Began running node model.redshift.redshift_columns
[0m15:51:39.362090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_columns)
[0m15:51:39.362090 [debug] [Thread-4 (]: Finished running node model.redshift.pg_tables
[0m15:51:39.363385 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:51:39.363385 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_columns
[0m15:51:39.363385 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:51:39.364448 [debug] [Thread-4 (]: Began running node model.redshift.redshift_constraints
[0m15:51:39.364448 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:51:39.365904 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:51:39.366951 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m15:51:39.367912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:51:39.367912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_sort_dist_keys)
[0m15:51:39.367912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_tables)
[0m15:51:39.369363 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_constraints
[0m15:51:39.369363 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:51:39.369363 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m15:51:39.371407 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:51:39.372377 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_columns
[0m15:51:39.373383 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:51:39.375407 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:51:39.375407 [debug] [Thread-1 (]: Began running node model.redshift.stl_explain
[0m15:51:39.376777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:51:39.375407 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_constraints
[0m15:51:39.376777 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:51:39.376777 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_explain
[0m15:51:39.378234 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m15:51:39.378234 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m15:51:39.378234 [debug] [Thread-3 (]: Began running node model.redshift.stl_wlm_query
[0m15:51:39.379620 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:51:39.380669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:51:39.380669 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m15:51:39.381696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:51:39.381696 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m15:51:39.381696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:51:39.382694 [debug] [Thread-1 (]: Finished running node model.redshift.stl_explain
[0m15:51:39.382694 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:51:39.383694 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:51:39.384694 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m15:51:39.384694 [debug] [Thread-1 (]: Began running node model.redshift.stv_partitions
[0m15:51:39.388711 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:51:39.390695 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:51:39.391065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:51:39.391065 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m15:51:39.392194 [debug] [Thread-3 (]: Finished running node model.redshift.stl_wlm_query
[0m15:51:39.392194 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_partitions
[0m15:51:39.393220 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m15:51:39.394045 [debug] [Thread-4 (]: Began running node model.redshift.stv_tbl_perm
[0m15:51:39.394045 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m15:51:39.395072 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:51:39.396071 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:51:39.396071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:51:39.396071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:51:39.397070 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:51:39.397070 [info ] [Thread-2 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m15:51:39.398070 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m15:51:39.398070 [debug] [Thread-1 (]: Finished running node model.redshift.stv_partitions
[0m15:51:39.400071 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:51:39.400071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:51:39.402079 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:51:39.402079 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:51:39.403071 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:51:39.403071 [debug] [Thread-4 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:51:39.404071 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m15:51:39.409069 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:51:39.409069 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m15:51:39.410147 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:51:39.410147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:51:39.411072 [debug] [Thread-3 (]: Began running node model.redshift.redshift_cost
[0m15:51:39.411072 [info ] [Thread-4 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m15:51:39.412070 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:51:39.412070 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:51:39.412070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:51:39.413071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:51:39.434139 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m15:51:39.440213 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:39.441125 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_cost
[0m15:51:39.441125 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:51:39.447770 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:51:39.453736 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:39.454868 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:51:39.457890 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:39.459922 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:39.460891 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:51:39.462889 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:39.463618 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_cost
[0m15:51:39.464093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:39.464093 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:51:39.465145 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:51:39.465145 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:51:39.465884 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:39.467927 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:39.467927 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:51:39.468891 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:39.468891 [info ] [Thread-3 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m15:51:39.469890 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:39.470890 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m15:51:39.470890 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:39.471890 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:51:39.475938 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:39.491965 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:51:39.494954 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:51:39.497889 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:51:39.497889 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:39.498890 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:39.498890 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:51:39.502907 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m15:51:39.511926 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:39.511926 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:51:39.512889 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:51:39.515888 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:39.515888 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:39.968250 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.499 seconds
[0m15:51:39.970252 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.457 seconds
[0m15:51:39.971251 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:39.972214 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:39.973240 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m15:51:39.975360 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m15:51:39.977933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.514 seconds
[0m15:51:39.978989 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:39.978989 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m15:51:39.983018 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.485 seconds
[0m15:51:39.983990 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:39.983990 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m15:51:40.194683 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.218 seconds
[0m15:51:40.195674 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.216 seconds
[0m15:51:40.205104 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:40.208242 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:40.208242 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m15:51:40.209242 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m15:51:40.223683 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.239 seconds
[0m15:51:40.224773 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.248 seconds
[0m15:51:40.228750 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:40.232670 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:40.233902 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:51:40.234540 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m15:51:40.341231 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.131 seconds
[0m15:51:40.345249 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:40.345249 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m15:51:40.346755 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.137 seconds
[0m15:51:40.348863 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:40.349806 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m15:51:40.360257 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.125 seconds
[0m15:51:40.363268 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:40.363268 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.128 seconds
[0m15:51:40.364179 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m15:51:40.366177 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:40.367242 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m15:51:40.463966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.117 seconds
[0m15:51:40.473954 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.124 seconds
[0m15:51:40.482984 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:51:40.484952 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:51:40.485431 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:40.485975 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:40.486479 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:51:40.486882 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:51:40.486882 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.120 seconds
[0m15:51:40.487903 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.121 seconds
[0m15:51:40.488893 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:51:40.489893 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:51:40.490893 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:40.491893 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:40.491893 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:51:40.491893 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:51:40.723401 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.235 seconds
[0m15:51:40.725380 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:40.725380 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.238 seconds
[0m15:51:40.726380 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.234 seconds
[0m15:51:40.727413 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.235 seconds
[0m15:51:40.728378 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:51:40.812312 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.083 seconds
[0m15:51:40.820323 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m15:51:40.824322 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:40.824322 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m15:51:40.908296 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.083 seconds
[0m15:51:40.911300 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:51:40.912260 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:40.913258 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:51:41.071944 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.158 seconds
[0m15:51:41.074943 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:51:41.075944 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:51:41.117672 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.041 seconds
[0m15:51:41.123664 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:41.124663 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:51:41.200775 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m15:51:41.207275 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m15:51:41.209218 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:41.210199 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m15:51:41.292784 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:51:41.295852 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:51:41.296871 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:41.296871 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:51:41.416539 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m15:51:41.417539 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:51:41.418539 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:51:41.460515 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.041 seconds
[0m15:51:41.461524 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:41.462506 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:51:41.544588 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:51:41.551067 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m15:51:41.553179 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:41.553179 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m15:51:41.640198 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:51:41.644216 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:51:41.645214 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:41.646222 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:51:41.763333 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:51:41.765332 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:51:41.766398 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:51:41.810059 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.042 seconds
[0m15:51:41.813092 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:41.814091 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:51:41.895775 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:51:41.901792 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:51:41.903792 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:41.903792 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m15:51:41.991025 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:51:41.994098 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:51:41.996011 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:41.996011 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:51:42.091066 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.094 seconds
[0m15:51:42.092100 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:51:42.092100 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:51:42.132665 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.039 seconds
[0m15:51:42.136688 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m15:51:42.137685 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m15:51:42.138683 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m15:51:42.138683 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m15:51:42.217161 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: Close
[0m15:51:42.221158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198378D5A00>]}
[0m15:51:42.222199 [info ] [Thread-2 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.82s]
[0m15:51:42.224132 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: Close
[0m15:51:42.225180 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:51:42.227128 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m15:51:42.227128 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m15:51:42.229133 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_queries
[0m15:51:42.229133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198370DAAE0>]}
[0m15:51:42.230862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019837408DD0>]}
[0m15:51:42.231638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198370DAE10>]}
[0m15:51:42.232647 [info ] [Thread-2 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m15:51:42.233652 [info ] [Thread-3 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.76s]
[0m15:51:42.235651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_queries)
[0m15:51:42.234653 [info ] [Thread-4 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.82s]
[0m15:51:42.235651 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:51:42.234653 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.82s]
[0m15:51:42.236652 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:51:42.237651 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:51:42.237651 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:51:42.243668 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:51:42.244651 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:51:42.247682 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m15:51:42.252731 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:42.252731 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:51:42.253727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:51:42.253727 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:42.253727 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:42.690272 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.437 seconds
[0m15:51:42.692335 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:42.693295 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m15:51:42.912016 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.217 seconds
[0m15:51:42.919519 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:42.920539 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m15:51:43.041334 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.120 seconds
[0m15:51:43.048727 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:43.049234 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m15:51:43.172827 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.122 seconds
[0m15:51:43.175823 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:51:43.176824 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:43.177824 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:51:43.331902 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.154 seconds
[0m15:51:43.333889 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:43.334884 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:51:43.417179 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:51:43.422209 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m15:51:43.424198 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:43.425207 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m15:51:43.510448 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:51:43.512405 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:51:43.513413 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:43.514368 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:51:43.641300 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.126 seconds
[0m15:51:43.643393 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:51:43.645300 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:51:43.683976 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.038 seconds
[0m15:51:43.686970 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m15:51:43.774429 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: Close
[0m15:51:43.776426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4beed11-16e6-40fc-a592-00b03196b76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019837408EF0>]}
[0m15:51:43.777431 [info ] [Thread-2 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.54s]
[0m15:51:43.779549 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:51:43.782550 [debug] [MainThread]: Using redshift connection "master"
[0m15:51:43.783664 [debug] [MainThread]: On master: BEGIN
[0m15:51:43.784683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:43.784683 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:51:43.785682 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:51:44.219319 [debug] [MainThread]: SQL status: SUCCESS in 0.435 seconds
[0m15:51:44.221419 [debug] [MainThread]: On master: COMMIT
[0m15:51:44.222388 [debug] [MainThread]: Using redshift connection "master"
[0m15:51:44.223345 [debug] [MainThread]: On master: COMMIT
[0m15:51:44.306134 [debug] [MainThread]: SQL status: SUCCESS in 0.082 seconds
[0m15:51:44.307153 [debug] [MainThread]: On master: Close
[0m15:51:44.309086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:44.310280 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m15:51:44.310280 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:51:44.311297 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:51:44.312343 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m15:51:44.312343 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:51:44.313359 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:51:44.313359 [info ] [MainThread]: 
[0m15:51:44.315298 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m15:51:44.317292 [debug] [MainThread]: Command end result
[0m15:51:44.394096 [info ] [MainThread]: 
[0m15:51:44.395392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:44.396401 [info ] [MainThread]: 
[0m15:51:44.397012 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:51:44.398219 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:44.398219 after 8.71 seconds
[0m15:51:44.398219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019835283CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198353A6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019835E049E0>]}
[0m15:51:44.398219 [debug] [MainThread]: Flushing usage events
[0m15:53:07.576198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A045F773B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04601A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0428F0A10>]}


============================== 15:53:07.579232 | 90c27ce8-efab-4bde-a594-1a65791deaeb ==============================
[0m15:53:07.579232 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:53:07.580196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:53:07.676929 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:53:07.676929 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:53:07.776444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A043C0A540>]}
[0m15:53:07.810462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A046A77BF0>]}
[0m15:53:07.812452 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:53:07.830537 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:53:07.889857 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:53:07.891083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0458ADD90>]}
[0m15:53:08.797203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integrity_energy_dbt
- models.integrity_energy_dbt.customer
[0m15:53:08.802202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047EA1850>]}
[0m15:53:08.850970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047DBEBD0>]}
[0m15:53:08.850970 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:53:08.851969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A046AFDAC0>]}
[0m15:53:08.852999 [info ] [MainThread]: 
[0m15:53:08.853987 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:53:08.855969 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m15:53:08.866526 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m15:53:08.867582 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m15:53:08.867582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:08.870600 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:08.871600 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:09.451403 [debug] [ThreadPool]: SQL status: SUCCESS in 0.583 seconds
[0m15:53:09.454401 [debug] [ThreadPool]: On list_integrity-db: Close
[0m15:53:09.457398 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:53:09.463398 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:53:09.464398 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:53:09.464398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:09.464902 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:09.464902 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:09.903672 [debug] [ThreadPool]: SQL status: SUCCESS in 0.439 seconds
[0m15:53:09.905712 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:53:09.906662 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:53:10.020449 [debug] [ThreadPool]: SQL status: SUCCESS in 0.113 seconds
[0m15:53:10.023435 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:53:10.102019 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:53:10.116055 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:10.116055 [debug] [MainThread]: On master: BEGIN
[0m15:53:10.117085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:10.117085 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:10.118028 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:10.557307 [debug] [MainThread]: SQL status: SUCCESS in 0.440 seconds
[0m15:53:10.559292 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:10.560307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:53:10.724930 [debug] [MainThread]: SQL status: SUCCESS in 0.164 seconds
[0m15:53:10.728985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047EA10D0>]}
[0m15:53:10.730000 [debug] [MainThread]: On master: ROLLBACK
[0m15:53:10.809361 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:10.810359 [debug] [MainThread]: On master: BEGIN
[0m15:53:10.850934 [debug] [MainThread]: SQL status: SUCCESS in 0.039 seconds
[0m15:53:10.851955 [debug] [MainThread]: On master: COMMIT
[0m15:53:10.852954 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:10.853951 [debug] [MainThread]: On master: COMMIT
[0m15:53:10.942113 [debug] [MainThread]: SQL status: SUCCESS in 0.087 seconds
[0m15:53:10.943111 [debug] [MainThread]: On master: Close
[0m15:53:10.945111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:10.945744 [info ] [MainThread]: 
[0m15:53:10.954169 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:53:10.955170 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:53:10.955170 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:53:10.956171 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:53:10.956171 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:53:10.957169 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:53:10.958169 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:53:10.958169 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:53:10.959198 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:53:10.959198 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:53:10.960168 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:53:10.960168 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:53:10.961167 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:53:10.963167 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:53:10.965166 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:53:10.968677 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:53:10.969675 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:53:10.970675 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:53:10.971675 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:53:10.971675 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:53:10.972714 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:53:10.973676 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:53:10.973676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:53:10.974676 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:53:10.974676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:53:10.975676 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m15:53:10.975676 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:53:10.975676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m15:53:10.976607 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:53:10.976607 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m15:53:10.978643 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:53:10.979555 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:53:10.980576 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:53:10.980576 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m15:53:10.982576 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:53:10.983575 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:53:10.985575 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:53:10.985575 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:53:10.986575 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:53:10.986575 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:53:10.987576 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:53:10.987576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:53:10.987576 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m15:53:10.988576 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m15:53:10.988576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:53:10.988576 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:53:10.989575 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m15:53:10.989575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m15:53:10.989575 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:53:10.991595 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:53:10.992594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:53:10.992594 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m15:53:10.995277 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:53:10.995277 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m15:53:10.998268 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:53:10.998268 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:53:11.000055 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:53:11.001061 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:53:11.001061 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m15:53:11.002061 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m15:53:11.002061 [debug] [Thread-2 (]: Began running node model.redshift.stl_wlm_query
[0m15:53:11.003061 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m15:53:11.003061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:53:11.003061 [debug] [Thread-3 (]: Began running node model.redshift.stv_blocklist
[0m15:53:11.003061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:53:11.004065 [debug] [Thread-4 (]: Began running node model.redshift.stv_partitions
[0m15:53:11.004065 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m15:53:11.005061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:53:11.005061 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:53:11.005061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:53:11.007060 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:53:11.007060 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_blocklist
[0m15:53:11.011061 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:53:11.011061 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_partitions
[0m15:53:11.012291 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:53:11.013297 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m15:53:11.014336 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:53:11.015298 [debug] [Thread-2 (]: Finished running node model.redshift.stl_wlm_query
[0m15:53:11.015298 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m15:53:11.015298 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m15:53:11.015298 [debug] [Thread-3 (]: Finished running node model.redshift.stv_blocklist
[0m15:53:11.016640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:53:11.016640 [debug] [Thread-4 (]: Finished running node model.redshift.stv_partitions
[0m15:53:11.016640 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:53:11.017667 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:53:11.017667 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:53:11.017667 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:11.017667 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m15:53:11.019999 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:53:11.018988 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m15:53:11.020998 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m15:53:11.021998 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:53:11.021998 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:53:11.023432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:53:11.023432 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:53:11.023432 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:53:11.024440 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:11.024440 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m15:53:11.025441 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:11.031478 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:53:11.037541 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:11.037541 [debug] [Thread-2 (]: Began running node model.redshift.redshift_cost
[0m15:53:11.038446 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m15:53:11.039439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:53:11.039439 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:53:11.040348 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:11.040348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:53:11.040348 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_cost
[0m15:53:11.065421 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m15:53:11.068697 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:11.069044 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:11.073096 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:53:11.080098 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:11.083071 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:11.085012 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:11.086011 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_cost
[0m15:53:11.087010 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:53:11.087010 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:53:11.087010 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:11.088011 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:53:11.089092 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:53:11.089092 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:53:11.092055 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:11.093012 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:11.092055 [info ] [Thread-2 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m15:53:11.093012 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:11.093929 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:11.096934 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:11.096934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m15:53:11.097935 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:11.098423 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:53:11.099429 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:53:11.100429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:11.108430 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:11.116428 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:53:11.118433 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:11.123429 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:53:11.126446 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m15:53:11.134428 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:11.135429 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:53:11.135429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:53:11.136429 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:11.136429 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:11.567283 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.477 seconds
[0m15:53:11.567283 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:11.568295 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m15:53:11.574473 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.474 seconds
[0m15:53:11.575472 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:11.576474 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.487 seconds
[0m15:53:11.576474 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m15:53:11.577575 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:11.578472 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m15:53:11.594228 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.458 seconds
[0m15:53:11.595222 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:11.596224 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m15:53:11.774222 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.205 seconds
[0m15:53:11.785222 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:11.786172 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m15:53:11.786172 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.209 seconds
[0m15:53:11.789169 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:11.790169 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:53:11.790169 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.212 seconds
[0m15:53:11.793169 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:11.793169 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m15:53:11.830291 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.233 seconds
[0m15:53:11.836286 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:11.837284 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m15:53:11.905939 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.119 seconds
[0m15:53:11.914973 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:11.915937 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m15:53:11.916881 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.126 seconds
[0m15:53:11.916881 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.123 seconds
[0m15:53:11.965708 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:11.969213 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:11.970000 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m15:53:11.970000 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m15:53:12.009836 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.172 seconds
[0m15:53:12.013398 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:12.014337 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m15:53:12.046419 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.127 seconds
[0m15:53:12.063414 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:12.063414 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:12.064416 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:12.080926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.110 seconds
[0m15:53:12.082860 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:12.083861 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:12.083861 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:12.094321 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.123 seconds
[0m15:53:12.096407 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:12.097400 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:12.098337 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:12.147671 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.133 seconds
[0m15:53:12.152662 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:12.153674 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:12.153674 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:12.356147 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.291 seconds
[0m15:53:12.358131 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:12.360126 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.261 seconds
[0m15:53:12.360806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.276 seconds
[0m15:53:12.361863 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.207 seconds
[0m15:53:12.362883 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:53:12.442548 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:53:12.454919 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m15:53:12.460843 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:12.460843 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m15:53:12.546948 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.085 seconds
[0m15:53:12.548996 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:12.549948 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:12.549948 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:12.652558 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.101 seconds
[0m15:53:12.654613 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:12.655618 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:53:12.694115 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.037 seconds
[0m15:53:12.698133 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:12.698133 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:53:12.778807 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.079 seconds
[0m15:53:12.783802 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m15:53:12.784802 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:12.785803 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m15:53:12.868611 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:53:12.870643 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:12.872639 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:12.873643 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:12.989368 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.114 seconds
[0m15:53:12.991356 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:12.993354 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:53:13.030141 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.036 seconds
[0m15:53:13.033126 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:13.035126 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:53:13.107639 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.072 seconds
[0m15:53:13.110606 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:53:13.111605 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:13.111605 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m15:53:13.186578 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.074 seconds
[0m15:53:13.187578 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:13.188578 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:13.188578 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:13.280683 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.091 seconds
[0m15:53:13.281685 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:13.282685 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:53:13.324086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m15:53:13.327082 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:13.327082 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:53:13.405192 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:53:13.418216 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m15:53:13.419658 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:13.420741 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m15:53:13.503176 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:53:13.506267 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:13.507176 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:13.507176 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:13.640306 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.132 seconds
[0m15:53:13.643302 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:13.644297 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:53:13.683819 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.038 seconds
[0m15:53:13.687790 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m15:53:13.688771 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m15:53:13.689771 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m15:53:13.690799 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m15:53:13.769044 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m15:53:13.771612 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m15:53:13.773022 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m15:53:13.777040 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0458AF0B0>]}
[0m15:53:13.778039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04807E750>]}
[0m15:53:13.780040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A043D38D40>]}
[0m15:53:13.782040 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: Close
[0m15:53:13.781039 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.75s]
[0m15:53:13.783214 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.74s]
[0m15:53:13.784224 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.76s]
[0m15:53:13.785225 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:13.786243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0485BEC30>]}
[0m15:53:13.787224 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:13.787224 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:53:13.788222 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_queries
[0m15:53:13.788222 [info ] [Thread-2 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.69s]
[0m15:53:13.790235 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:53:13.789223 [info ] [Thread-4 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m15:53:13.791223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_schema_privileges, now model.redshift.redshift_admin_queries)
[0m15:53:13.791223 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:53:13.797663 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:53:13.798701 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:53:13.801707 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m15:53:13.806827 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:13.806827 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:53:13.807775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:13.807775 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:13.807775 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:14.236348 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.429 seconds
[0m15:53:14.238427 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:14.240342 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m15:53:14.450962 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.209 seconds
[0m15:53:14.455957 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:14.456964 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m15:53:14.575579 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.118 seconds
[0m15:53:14.582563 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:14.584151 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m15:53:14.702375 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m15:53:14.706881 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:14.707877 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:14.708876 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:15.082129 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.373 seconds
[0m15:53:15.084108 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:15.085125 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:53:15.168058 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:53:15.173760 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m15:53:15.174715 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:15.175755 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m15:53:15.262679 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:53:15.265621 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:15.266620 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:15.267625 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:15.384440 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:53:15.386420 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:15.387431 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:53:15.425510 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.037 seconds
[0m15:53:15.427500 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m15:53:15.508689 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: Close
[0m15:53:15.510685 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c27ce8-efab-4bde-a594-1a65791deaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04807F860>]}
[0m15:53:15.513233 [info ] [Thread-4 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.72s]
[0m15:53:15.515219 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:53:15.520218 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:15.520218 [debug] [MainThread]: On master: BEGIN
[0m15:53:15.521216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:15.522216 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:15.522216 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:15.960762 [debug] [MainThread]: SQL status: SUCCESS in 0.439 seconds
[0m15:53:15.961804 [debug] [MainThread]: On master: COMMIT
[0m15:53:15.962830 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:15.963733 [debug] [MainThread]: On master: COMMIT
[0m15:53:16.044658 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m15:53:16.045682 [debug] [MainThread]: On master: Close
[0m15:53:16.047637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:16.048599 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m15:53:16.049595 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:53:16.049595 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:53:16.050594 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:53:16.050594 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m15:53:16.051593 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:53:16.051593 [info ] [MainThread]: 
[0m15:53:16.054094 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m15:53:16.058074 [debug] [MainThread]: Command end result
[0m15:53:16.086201 [info ] [MainThread]: 
[0m15:53:16.086201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:16.087203 [info ] [MainThread]: 
[0m15:53:16.087203 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:53:16.088201 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:16.088201 after 8.64 seconds
[0m15:53:16.088201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A045F773B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0455CF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0455CDA30>]}
[0m15:53:16.089200 [debug] [MainThread]: Flushing usage events
[0m15:53:22.018931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289172EC050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289172ED310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289172EE5A0>]}


============================== 15:53:22.023140 | ea4c90fc-9b47-469d-aac9-62a14874fab1 ==============================
[0m15:53:22.023140 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:53:22.024125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:53:22.091676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea4c90fc-9b47-469d-aac9-62a14874fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002891564A630>]}
[0m15:53:22.146011 [debug] [MainThread]: Command `dbt clean` succeeded at 15:53:22.146011 after 0.25 seconds
[0m15:53:22.146011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917BC0B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917D3DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917AE4BC0>]}
[0m15:53:22.146011 [debug] [MainThread]: Flushing usage events
[0m15:53:30.064580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9FA9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EC0898E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EC08A600>]}


============================== 15:53:30.068586 | 3cc64f00-dc7b-4b41-b28c-b2b19d6b5242 ==============================
[0m15:53:30.068586 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:53:30.069310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:30.166818 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:53:30.166818 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:53:30.267522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cc64f00-dc7b-4b41-b28c-b2b19d6b5242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ED2DB110>]}
[0m15:53:30.302091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cc64f00-dc7b-4b41-b28c-b2b19d6b5242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EB972630>]}
[0m15:53:30.303092 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:53:30.304099 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 4 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:53:30.305092 [debug] [MainThread]: Command `dbt run` failed at 15:53:30.305092 after 0.34 seconds
[0m15:53:30.305092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EBA7FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EC0898E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EC035F70>]}
[0m15:53:30.305092 [debug] [MainThread]: Flushing usage events
[0m15:53:34.120060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF4246B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF424EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF4244D0>]}


============================== 15:53:34.123967 | 5ec6fc19-a700-40d4-97b6-86936ae25aad ==============================
[0m15:53:34.123967 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:53:34.125874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:34.192870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec6fc19-a700-40d4-97b6-86936ae25aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFEF40A40>]}
[0m15:53:34.217537 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-xghi7ud0'
[0m15:53:34.217537 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:53:34.342172 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:53:34.343162 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:53:34.413698 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:53:34.419693 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m15:53:34.533649 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m15:53:34.537624 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m15:53:34.608935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m15:53:34.612901 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m15:53:34.699001 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m15:53:34.702995 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:53:35.056136 [info ] [MainThread]: Installed from version 1.0.0
[0m15:53:35.056136 [info ] [MainThread]: Updated version available: 1.2.0
[0m15:53:35.057137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ec6fc19-a700-40d4-97b6-86936ae25aad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF4E8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF4EA7E0>]}
[0m15:53:35.057137 [info ] [MainThread]: Installing dbt-labs/redshift
[0m15:53:35.251849 [info ] [MainThread]: Installed from version 0.9.0
[0m15:53:35.252850 [info ] [MainThread]: Up to date!
[0m15:53:35.252850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ec6fc19-a700-40d4-97b6-86936ae25aad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF506AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF506DE0>]}
[0m15:53:35.253850 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m15:53:35.660720 [info ] [MainThread]: Installed from version 0.8.2
[0m15:53:35.661721 [info ] [MainThread]: Updated version available: 0.9.0
[0m15:53:35.661721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ec6fc19-a700-40d4-97b6-86936ae25aad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFE473380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFE4733B0>]}
[0m15:53:35.662721 [info ] [MainThread]: Installing dbt-labs/codegen
[0m15:53:35.845913 [info ] [MainThread]: Installed from version 0.9.0
[0m15:53:35.846913 [info ] [MainThread]: Updated version available: 0.12.1
[0m15:53:35.847914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ec6fc19-a700-40d4-97b6-86936ae25aad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFE4737A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFE473380>]}
[0m15:53:35.847914 [info ] [MainThread]: 
[0m15:53:35.847914 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m15:53:35.850912 [debug] [MainThread]: Command `dbt deps` succeeded at 15:53:35.849914 after 1.84 seconds
[0m15:53:35.850912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFEBE45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF63AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFF344AD0>]}
[0m15:53:35.850912 [debug] [MainThread]: Flushing usage events
[0m15:53:45.284360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A83CC6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A83CF6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A7C5EB10>]}


============================== 15:53:45.287378 | 2235d816-9589-437a-9da9-6f47e3bf9e42 ==============================
[0m15:53:45.287378 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:53:45.288360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:45.381890 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:53:45.381890 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:53:45.477527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A8F4EE10>]}
[0m15:53:45.514046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A797C470>]}
[0m15:53:45.516134 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:53:45.545791 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:53:45.546792 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:53:45.546792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A8FE2720>]}
[0m15:53:46.685250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integrity_energy_dbt
- models.integrity_energy_dbt.customer
[0m15:53:46.690254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA2BC200>]}
[0m15:53:46.744648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA192870>]}
[0m15:53:46.745976 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:53:46.745976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA2D7140>]}
[0m15:53:46.748457 [info ] [MainThread]: 
[0m15:53:46.748457 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:53:46.751953 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m15:53:46.761532 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m15:53:46.761532 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m15:53:46.762478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:46.765021 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:46.766022 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:47.297861 [debug] [ThreadPool]: SQL status: SUCCESS in 0.536 seconds
[0m15:53:47.298857 [debug] [ThreadPool]: On list_integrity-db: Close
[0m15:53:47.300856 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:53:47.306857 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:53:47.306857 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:53:47.307859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:47.307859 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:47.307859 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:47.708779 [debug] [ThreadPool]: SQL status: SUCCESS in 0.401 seconds
[0m15:53:47.710305 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:53:47.711327 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:53:47.818438 [debug] [ThreadPool]: SQL status: SUCCESS in 0.106 seconds
[0m15:53:47.821440 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:53:47.899193 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:53:47.913843 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:47.913843 [debug] [MainThread]: On master: BEGIN
[0m15:53:47.914803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:47.914803 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:47.914803 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:48.348754 [debug] [MainThread]: SQL status: SUCCESS in 0.434 seconds
[0m15:53:48.349746 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:48.350744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:53:48.492276 [debug] [MainThread]: SQL status: SUCCESS in 0.140 seconds
[0m15:53:48.495197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA1DEC00>]}
[0m15:53:48.496213 [debug] [MainThread]: On master: ROLLBACK
[0m15:53:48.580249 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:48.581246 [debug] [MainThread]: On master: BEGIN
[0m15:53:48.621713 [debug] [MainThread]: SQL status: SUCCESS in 0.040 seconds
[0m15:53:48.623709 [debug] [MainThread]: On master: COMMIT
[0m15:53:48.625714 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:48.626703 [debug] [MainThread]: On master: COMMIT
[0m15:53:48.706838 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m15:53:48.707840 [debug] [MainThread]: On master: Close
[0m15:53:48.708837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:48.709844 [info ] [MainThread]: 
[0m15:53:48.717130 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:53:48.717130 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:53:48.718128 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:53:48.718128 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:53:48.719128 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:53:48.720133 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:53:48.720133 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:53:48.721128 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:53:48.722128 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:53:48.722128 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:53:48.724126 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:53:48.725204 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:53:48.725204 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:53:48.727146 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:53:48.728464 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:53:48.730517 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:53:48.731492 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:53:48.732470 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:53:48.733470 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:53:48.733470 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:53:48.734905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:53:48.734905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:53:48.734905 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:53:48.735963 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:53:48.737008 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:53:48.738521 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:53:48.743833 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:53:48.744869 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m15:53:48.744869 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:53:48.744869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m15:53:48.746091 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m15:53:48.746091 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:53:48.746091 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:53:48.746091 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m15:53:48.747562 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m15:53:48.747562 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:53:48.748568 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:53:48.749652 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:53:48.750660 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m15:53:48.750660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:53:48.750660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m15:53:48.752982 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:53:48.753999 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m15:53:48.753999 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:53:48.753999 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:53:48.753999 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m15:53:48.757019 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:53:48.758062 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m15:53:48.759420 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:53:48.760430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m15:53:48.760430 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m15:53:48.761690 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:53:48.761690 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m15:53:48.761690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:53:48.761690 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:53:48.763619 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m15:53:48.764908 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:53:48.765950 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m15:53:48.765950 [debug] [Thread-2 (]: Began running node model.redshift.stl_wlm_query
[0m15:53:48.765950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m15:53:48.767998 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:53:48.768695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m15:53:48.768695 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m15:53:48.769652 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m15:53:48.770056 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:53:48.770056 [debug] [Thread-3 (]: Began running node model.redshift.stv_blocklist
[0m15:53:48.771071 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m15:53:48.772063 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:53:48.773809 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:53:48.774808 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:53:48.774808 [debug] [Thread-4 (]: Began running node model.redshift.stv_partitions
[0m15:53:48.775818 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m15:53:48.776809 [debug] [Thread-2 (]: Finished running node model.redshift.stl_wlm_query
[0m15:53:48.776809 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_blocklist
[0m15:53:48.776809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:53:48.777808 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m15:53:48.777808 [debug] [Thread-2 (]: Began running node model.redshift.svv_diskusage
[0m15:53:48.779823 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:53:48.779823 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_partitions
[0m15:53:48.779823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m15:53:48.780809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:53:48.781809 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:53:48.782808 [debug] [Thread-3 (]: Finished running node model.redshift.stv_blocklist
[0m15:53:48.782808 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:53:48.782808 [debug] [Thread-2 (]: Began compiling node model.redshift.svv_diskusage
[0m15:53:48.783807 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:53:48.785807 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:53:48.786808 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:53:48.787809 [debug] [Thread-4 (]: Finished running node model.redshift.stv_partitions
[0m15:53:48.787809 [info ] [Thread-3 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m15:53:48.788809 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:48.789730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m15:53:48.790736 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:53:48.790736 [debug] [Thread-2 (]: Finished running node model.redshift.svv_diskusage
[0m15:53:48.791736 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:53:48.790736 [info ] [Thread-4 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m15:53:48.791736 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:48.791736 [debug] [Thread-2 (]: Began running node model.redshift.redshift_cost
[0m15:53:48.796737 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:53:48.797740 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:53:48.798418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:53:48.799425 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_cost
[0m15:53:48.798418 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:48.797740 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m15:53:48.804423 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:53:48.809322 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:48.810324 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:53:48.810324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:53:48.833835 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m15:53:48.834836 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:48.835834 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_cost
[0m15:53:48.835834 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:48.842833 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:48.843177 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:53:48.845258 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:48.850183 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:48.850183 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:53:48.850183 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:53:48.851184 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:48.851184 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:48.846184 [info ] [Thread-2 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m15:53:48.855183 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:48.855456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m15:53:48.857469 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:48.857469 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:53:48.858319 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:53:48.861391 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:48.862325 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:53:48.877323 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:53:48.878325 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:48.883360 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:48.884324 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:48.884324 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:53:48.885343 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:53:48.886325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:48.888324 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m15:53:48.888811 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:48.891835 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:48.898854 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:48.899837 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:53:48.900837 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:53:48.901837 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:48.901837 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:49.303130 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.452 seconds
[0m15:53:49.304157 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:49.305072 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m15:53:49.330808 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.469 seconds
[0m15:53:49.331807 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:49.331807 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m15:53:49.331807 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.431 seconds
[0m15:53:49.332807 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:49.333807 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m15:53:49.343806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.458 seconds
[0m15:53:49.343806 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:49.344807 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m15:53:49.510808 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.205 seconds
[0m15:53:49.527331 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:49.527331 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m15:53:49.544419 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.212 seconds
[0m15:53:49.552384 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:49.553384 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m15:53:49.569453 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.224 seconds
[0m15:53:49.577450 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:49.577450 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.244 seconds
[0m15:53:49.578452 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:53:49.582450 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:49.583449 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m15:53:49.651831 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.123 seconds
[0m15:53:49.659822 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:49.660824 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m15:53:49.673912 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.120 seconds
[0m15:53:49.681922 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:49.682912 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m15:53:49.712515 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.128 seconds
[0m15:53:49.720046 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:49.721044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.137 seconds
[0m15:53:49.722044 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m15:53:49.726045 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:49.727101 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m15:53:49.779004 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m15:53:49.798691 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:49.799649 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:49.799649 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:49.803768 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.121 seconds
[0m15:53:49.805751 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:49.805751 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:49.805751 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:49.842175 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.115 seconds
[0m15:53:49.847177 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:49.848175 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:49.849173 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.121 seconds
[0m15:53:49.850185 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:49.853193 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:49.853978 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:49.855005 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:50.066309 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.266 seconds
[0m15:53:50.067324 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:50.068392 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:53:50.071308 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.217 seconds
[0m15:53:50.072390 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.266 seconds
[0m15:53:50.073344 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.218 seconds
[0m15:53:50.147305 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.077 seconds
[0m15:53:50.160320 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m15:53:50.166318 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:50.167325 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m15:53:50.248546 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.081 seconds
[0m15:53:50.250588 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:50.251622 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:50.252572 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m15:53:50.349878 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.097 seconds
[0m15:53:50.351870 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m15:53:50.354872 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m15:53:50.391649 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.036 seconds
[0m15:53:50.395641 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:50.396640 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:53:50.473034 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.075 seconds
[0m15:53:50.479126 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m15:53:50.481026 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:50.482029 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m15:53:50.565201 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:53:50.568233 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:50.569189 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:50.570231 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m15:53:50.684875 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.114 seconds
[0m15:53:50.686910 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m15:53:50.687941 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m15:53:50.726558 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.037 seconds
[0m15:53:50.729562 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:50.731931 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:53:50.808585 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.076 seconds
[0m15:53:50.816248 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m15:53:50.817253 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:50.818290 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m15:53:50.903043 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:53:50.906099 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:50.907016 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:50.908111 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m15:53:51.015867 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.107 seconds
[0m15:53:51.017927 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m15:53:51.019862 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m15:53:51.061558 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.041 seconds
[0m15:53:51.065673 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:51.066694 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:53:51.145054 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.078 seconds
[0m15:53:51.151048 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m15:53:51.153134 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:51.153134 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m15:53:51.240347 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.086 seconds
[0m15:53:51.243343 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:51.244347 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:51.245345 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m15:53:51.355460 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.109 seconds
[0m15:53:51.357453 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:53:51.358452 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m15:53:51.398021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.038 seconds
[0m15:53:51.401049 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m15:53:51.402076 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m15:53:51.402076 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m15:53:51.403130 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m15:53:51.487363 [debug] [Thread-2 (]: On model.redshift.redshift_admin_table_stats: Close
[0m15:53:51.488360 [debug] [Thread-4 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m15:53:51.489401 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m15:53:51.490364 [debug] [Thread-3 (]: On model.redshift.redshift_admin_dependencies: Close
[0m15:53:51.493358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA16D6A0>]}
[0m15:53:51.494359 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A5FB9700>]}
[0m15:53:51.495390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA468140>]}
[0m15:53:51.496358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A60E8CB0>]}
[0m15:53:51.497411 [info ] [Thread-2 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.64s]
[0m15:53:51.498400 [info ] [Thread-4 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.70s]
[0m15:53:51.499363 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.69s]
[0m15:53:51.500367 [info ] [Thread-3 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.71s]
[0m15:53:51.501368 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:53:51.501368 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:53:51.501368 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:53:51.502368 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:53:51.502368 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_queries
[0m15:53:51.504367 [info ] [Thread-2 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m15:53:51.505368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_table_stats, now model.redshift.redshift_admin_queries)
[0m15:53:51.506387 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:53:51.514889 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:53:51.515902 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:53:51.518902 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m15:53:51.522905 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:51.522905 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:53:51.523918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:51.523918 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:51.524903 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:51.946774 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.423 seconds
[0m15:53:51.948771 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:51.950771 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m15:53:52.161107 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.209 seconds
[0m15:53:52.168109 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.169045 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m15:53:52.288648 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.119 seconds
[0m15:53:52.294687 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.295721 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m15:53:52.416143 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.120 seconds
[0m15:53:52.420162 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:52.421173 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.422203 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:52.561635 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.138 seconds
[0m15:53:52.562633 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.562633 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:53:52.647640 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.084 seconds
[0m15:53:52.653658 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m15:53:52.655656 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.656738 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m15:53:52.740399 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.082 seconds
[0m15:53:52.743319 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:52.745302 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.746301 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m15:53:52.863314 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.116 seconds
[0m15:53:52.865267 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m15:53:52.866264 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m15:53:52.906486 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.040 seconds
[0m15:53:52.908489 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m15:53:52.987327 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: Close
[0m15:53:52.989351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2235d816-9589-437a-9da9-6f47e3bf9e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3AA468380>]}
[0m15:53:52.991349 [info ] [Thread-2 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.48s]
[0m15:53:52.993346 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:53:52.996347 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:52.997343 [debug] [MainThread]: On master: BEGIN
[0m15:53:52.998342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:52.999341 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:53:52.999341 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:53:53.423735 [debug] [MainThread]: SQL status: SUCCESS in 0.425 seconds
[0m15:53:53.424763 [debug] [MainThread]: On master: COMMIT
[0m15:53:53.425769 [debug] [MainThread]: Using redshift connection "master"
[0m15:53:53.426729 [debug] [MainThread]: On master: COMMIT
[0m15:53:53.508133 [debug] [MainThread]: SQL status: SUCCESS in 0.081 seconds
[0m15:53:53.510071 [debug] [MainThread]: On master: Close
[0m15:53:53.512017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:53.512017 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m15:53:53.513108 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:53:53.514032 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:53:53.514032 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:53:53.515016 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_dependencies' was properly closed.
[0m15:53:53.515016 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m15:53:53.516016 [info ] [MainThread]: 
[0m15:53:53.517521 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m15:53:53.519529 [debug] [MainThread]: Command end result
[0m15:53:53.595329 [info ] [MainThread]: 
[0m15:53:53.596330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:53.596330 [info ] [MainThread]: 
[0m15:53:53.597331 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:53:53.598330 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:53.598330 after 8.40 seconds
[0m15:53:53.599330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A806FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A8D972F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A8D037D0>]}
[0m15:53:53.599330 [debug] [MainThread]: Flushing usage events
[0m15:55:37.562915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D450EC4B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D450EC4D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D450EC4D40>]}


============================== 15:55:37.565916 | cc6ecb2f-6dbe-4dae-8fd5-a0952309085d ==============================
[0m15:55:37.565916 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:55:37.566932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:55:37.670672 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:55:37.671771 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:55:37.779065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44EA2A570>]}
[0m15:55:37.815121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D450C26BA0>]}
[0m15:55:37.816083 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:55:37.834083 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:55:37.895679 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:55:37.896663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4506CDE20>]}
[0m15:55:38.798298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m15:55:38.802288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D452D6E840>]}
[0m15:55:38.846024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D452A9F3B0>]}
[0m15:55:38.846024 [info ] [MainThread]: Found 24 models, 666 macros
[0m15:55:38.847027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D452B9E840>]}
[0m15:55:38.849027 [info ] [MainThread]: 
[0m15:55:38.849027 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:55:38.852027 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m15:55:38.862533 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:55:38.863535 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m15:55:38.863535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:38.866550 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:55:38.867535 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:55:39.445848 [debug] [ThreadPool]: SQL status: SUCCESS in 0.582 seconds
[0m15:55:39.446917 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m15:55:39.447955 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m15:55:39.561359 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m15:55:39.564371 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m15:55:39.645392 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m15:55:39.661327 [debug] [MainThread]: Using redshift connection "master"
[0m15:55:39.661836 [debug] [MainThread]: On master: BEGIN
[0m15:55:39.661836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:39.662847 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:55:39.662847 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:55:40.103851 [debug] [MainThread]: SQL status: SUCCESS in 0.441 seconds
[0m15:55:40.104881 [debug] [MainThread]: Using redshift connection "master"
[0m15:55:40.105902 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:55:40.242805 [debug] [MainThread]: SQL status: SUCCESS in 0.136 seconds
[0m15:55:40.246796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6ecb2f-6dbe-4dae-8fd5-a0952309085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D451A2EE70>]}
[0m15:55:40.247809 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:40.332857 [debug] [MainThread]: On master: Close
[0m15:55:40.334924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:40.336879 [info ] [MainThread]: 
[0m15:55:40.345000 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m15:55:40.345975 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m15:55:40.345975 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m15:55:40.346974 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m15:55:40.347983 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m15:55:40.348981 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m15:55:40.348981 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m15:55:40.349981 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m15:55:40.349981 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m15:55:40.350980 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m15:55:40.350980 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m15:55:40.351979 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m15:55:40.353006 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m15:55:40.354979 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m15:55:40.355979 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m15:55:40.357978 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m15:55:40.358985 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m15:55:40.358985 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m15:55:40.359991 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m15:55:40.359991 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m15:55:40.359991 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m15:55:40.360991 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m15:55:40.360991 [debug] [Thread-4 (]: Began running node model.redshift.pg_views
[0m15:55:40.360991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m15:55:40.362496 [debug] [Thread-3 (]: Began running node model.redshift.redshift_columns
[0m15:55:40.362496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m15:55:40.362496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.pg_views)
[0m15:55:40.363501 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m15:55:40.363501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.redshift_columns)
[0m15:55:40.364501 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m15:55:40.364501 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_views
[0m15:55:40.365502 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m15:55:40.366500 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_columns
[0m15:55:40.368519 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m15:55:40.369502 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m15:55:40.371494 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m15:55:40.372466 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m15:55:40.373466 [debug] [Thread-4 (]: Finished running node model.redshift.pg_views
[0m15:55:40.373466 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m15:55:40.374465 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_columns
[0m15:55:40.374465 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m15:55:40.374465 [debug] [Thread-4 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m15:55:40.375466 [debug] [Thread-2 (]: Began running node model.redshift.redshift_tables
[0m15:55:40.375466 [debug] [Thread-3 (]: Began running node model.redshift.stl_explain
[0m15:55:40.375466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m15:55:40.376466 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_sort_dist_keys)
[0m15:55:40.376466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_tables)
[0m15:55:40.376466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m15:55:40.377466 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m15:55:40.377466 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m15:55:40.377466 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_tables
[0m15:55:40.377466 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_explain
[0m15:55:40.379491 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m15:55:40.381465 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m15:55:40.383465 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m15:55:40.384493 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m15:55:40.385466 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m15:55:40.385466 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m15:55:40.386465 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_tables
[0m15:55:40.387465 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m15:55:40.387465 [debug] [Thread-3 (]: Finished running node model.redshift.stl_explain
[0m15:55:40.387465 [debug] [Thread-1 (]: Began running node model.redshift.stl_wlm_query
[0m15:55:40.386465 [debug] [Thread-4 (]: Began running node model.redshift.stl_query
[0m15:55:40.388467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_blocklist)
[0m15:55:40.388467 [debug] [Thread-3 (]: Began running node model.redshift.stv_partitions
[0m15:55:40.388467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_wlm_query)
[0m15:55:40.389466 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_query)
[0m15:55:40.389466 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m15:55:40.389466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_partitions)
[0m15:55:40.390466 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_wlm_query
[0m15:55:40.390466 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_query
[0m15:55:40.391467 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m15:55:40.392302 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_partitions
[0m15:55:40.393354 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m15:55:40.394323 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m15:55:40.395961 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m15:55:40.396992 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m15:55:40.397961 [debug] [Thread-1 (]: Finished running node model.redshift.stl_wlm_query
[0m15:55:40.397961 [debug] [Thread-4 (]: Finished running node model.redshift.stl_query
[0m15:55:40.397961 [debug] [Thread-2 (]: Began running node model.redshift.stv_tbl_perm
[0m15:55:40.398962 [debug] [Thread-3 (]: Finished running node model.redshift.stv_partitions
[0m15:55:40.398962 [debug] [Thread-1 (]: Began running node model.redshift.svv_diskusage
[0m15:55:40.398962 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_dependencies
[0m15:55:40.399961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.stv_tbl_perm)
[0m15:55:40.399961 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m15:55:40.399961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m15:55:40.400960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.redshift_admin_dependencies)
[0m15:55:40.400960 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_tbl_perm
[0m15:55:40.400960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m15:55:40.401960 [debug] [Thread-1 (]: Began compiling node model.redshift.svv_diskusage
[0m15:55:40.401960 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m15:55:40.402960 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m15:55:40.402960 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m15:55:40.403960 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m15:55:40.409077 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m15:55:40.414184 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m15:55:40.415184 [debug] [Thread-2 (]: Finished running node model.redshift.stv_tbl_perm
[0m15:55:40.416185 [debug] [Thread-1 (]: Finished running node model.redshift.svv_diskusage
[0m15:55:40.416185 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m15:55:40.416185 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:55:40.417185 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m15:55:40.417185 [debug] [Thread-1 (]: Began running node model.redshift.redshift_cost
[0m15:55:40.418186 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m15:55:40.418186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m15:55:40.419185 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m15:55:40.419185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m15:55:40.420186 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_table_stats
[0m15:55:40.420186 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m15:55:40.420186 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_cost
[0m15:55:40.421185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_table_stats)
[0m15:55:40.428201 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m15:55:40.432183 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m15:55:40.433186 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m15:55:40.447183 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m15:55:40.447183 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m15:55:40.448187 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_cost
[0m15:55:40.449188 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m15:55:40.449188 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m15:55:40.450187 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_queries
[0m15:55:40.450636 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m15:55:40.451233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_users_schema_privileges, now model.redshift.redshift_admin_queries)
[0m15:55:40.451773 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_queries
[0m15:55:40.456824 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m15:55:40.457782 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_queries
[0m15:55:40.457782 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_queries
[0m15:55:40.458691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:40.458691 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m15:55:40.459745 [debug] [MainThread]: Connection 'model.redshift.redshift_cost' was properly closed.
[0m15:55:40.459745 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m15:55:40.459745 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m15:55:40.459745 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m15:55:40.460697 [debug] [MainThread]: Command end result
[0m15:55:40.482838 [debug] [MainThread]: Command `dbt compile` succeeded at 15:55:40.482838 after 3.09 seconds
[0m15:55:40.482838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D450C49A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D451A60110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D450FA7710>]}
[0m15:55:40.483809 [debug] [MainThread]: Flushing usage events
[0m15:59:04.222992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAC869220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAF10F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAF10ED50>]}


============================== 15:59:04.227017 | 0a0365d2-398c-466d-b134-2fc4e86dae95 ==============================
[0m15:59:04.227017 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:59:04.227998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:04.341339 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:59:04.342324 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:59:04.463385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a0365d2-398c-466d-b134-2fc4e86dae95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EACD1A510>]}
[0m15:59:04.511166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a0365d2-398c-466d-b134-2fc4e86dae95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAEF151C0>]}
[0m15:59:04.513307 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:59:04.537272 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:59:04.599068 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:59:04.600148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a0365d2-398c-466d-b134-2fc4e86dae95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB0E58290>]}
[0m15:59:05.738551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m15:59:05.742532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a0365d2-398c-466d-b134-2fc4e86dae95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB0FE3740>]}
[0m15:59:05.797166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0365d2-398c-466d-b134-2fc4e86dae95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EB0FE3C20>]}
[0m15:59:05.799166 [debug] [MainThread]: Command `dbt list` succeeded at 15:59:05.799166 after 1.71 seconds
[0m15:59:05.799166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAEF3B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAEF386B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EAEF39E80>]}
[0m15:59:05.800168 [debug] [MainThread]: Flushing usage events
[0m16:00:13.478481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464B099D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464B28B350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464B28BE30>]}


============================== 16:00:13.481496 | 5c131e90-84d0-4b2f-bdc2-9c9d3e6ce53a ==============================
[0m16:00:13.481496 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:13.482821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m16:00:13.576879 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:00:13.577880 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:00:13.675025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c131e90-84d0-4b2f-bdc2-9c9d3e6ce53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464AF2BE30>]}
[0m16:00:13.708043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c131e90-84d0-4b2f-bdc2-9c9d3e6ce53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464BCFD5B0>]}
[0m16:00:13.708995 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:00:13.727824 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:00:13.781023 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:00:13.782036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c131e90-84d0-4b2f-bdc2-9c9d3e6ce53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464AB1DCA0>]}
[0m16:00:14.671615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m16:00:14.677858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c131e90-84d0-4b2f-bdc2-9c9d3e6ce53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464BD78E60>]}
[0m16:00:14.733325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c131e90-84d0-4b2f-bdc2-9c9d3e6ce53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464D0A9130>]}
[0m16:00:14.736326 [debug] [MainThread]: Command `dbt list` succeeded at 16:00:14.736326 after 1.41 seconds
[0m16:00:14.737327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464B099D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464AB1E900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002464B26EC00>]}
[0m16:00:14.737327 [debug] [MainThread]: Flushing usage events
[0m16:00:56.730900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645DA54BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645DA15130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645DA17620>]}


============================== 16:00:56.735306 | 8cba23e1-fd79-401b-9e14-395c044f83e4 ==============================
[0m16:00:56.735306 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:56.736205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:56.803768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cba23e1-fd79-401b-9e14-395c044f83e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645B5BA570>]}
[0m16:00:56.859170 [debug] [MainThread]: Command `dbt clean` succeeded at 16:00:56.859170 after 0.21 seconds
[0m16:00:56.859170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645D25C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645D888A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645D88A180>]}
[0m16:00:56.859170 [debug] [MainThread]: Flushing usage events
[0m16:01:02.009170 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:01:07.088603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7518D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF74D11400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7518E6F0>]}


============================== 16:01:07.091602 | 00201ae5-cb20-4be5-b89e-74d7925f6ce6 ==============================
[0m16:01:07.091602 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:01:07.092195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:07.159299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00201ae5-cb20-4be5-b89e-74d7925f6ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7520B2F0>]}
[0m16:01:07.178123 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-92ukfnuv'
[0m16:01:07.179614 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:01:07.339296 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:01:07.341299 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:01:07.425209 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:01:07.432250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m16:01:07.614636 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m16:01:07.618627 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:01:07.687080 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:01:07.692592 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m16:01:07.778188 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m16:01:07.781185 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:01:08.147051 [info ] [MainThread]: Installed from version 1.0.0
[0m16:01:08.148052 [info ] [MainThread]: Updated version available: 1.2.0
[0m16:01:08.148052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '00201ae5-cb20-4be5-b89e-74d7925f6ce6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF75C95760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF75C95370>]}
[0m16:01:08.149052 [info ] [MainThread]: Installing dbt-labs/redshift
[0m16:01:08.324572 [info ] [MainThread]: Installed from version 0.9.0
[0m16:01:08.325573 [info ] [MainThread]: Up to date!
[0m16:01:08.325573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '00201ae5-cb20-4be5-b89e-74d7925f6ce6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF75C979E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF75C95640>]}
[0m16:01:08.326573 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:01:08.605067 [info ] [MainThread]: Installed from version 0.8.2
[0m16:01:08.605067 [info ] [MainThread]: Updated version available: 0.9.0
[0m16:01:08.606017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '00201ae5-cb20-4be5-b89e-74d7925f6ce6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF74AB34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF74AB1C10>]}
[0m16:01:08.606017 [info ] [MainThread]: Installing dbt-labs/codegen
[0m16:01:08.774829 [info ] [MainThread]: Installed from version 0.9.0
[0m16:01:08.775829 [info ] [MainThread]: Updated version available: 0.12.1
[0m16:01:08.775829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '00201ae5-cb20-4be5-b89e-74d7925f6ce6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF75C97E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF75C97B90>]}
[0m16:01:08.775829 [info ] [MainThread]: 
[0m16:01:08.776829 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m16:01:08.777831 [debug] [MainThread]: Command `dbt deps` succeeded at 16:01:08.777831 after 1.77 seconds
[0m16:01:08.778830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF74D11400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7518E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF7518C2F0>]}
[0m16:01:08.778830 [debug] [MainThread]: Flushing usage events
[0m16:01:13.909025 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:01:20.854563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C4A996D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C735F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C735C7D0>]}


============================== 16:01:20.857320 | 526a0050-592a-4e49-aa58-728724cfe516 ==============================
[0m16:01:20.857320 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:01:20.858320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:20.955468 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:01:20.956469 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:01:21.055024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C74C0BC0>]}
[0m16:01:21.089024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C73E4C20>]}
[0m16:01:21.089941 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:01:21.144782 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:01:21.146688 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:01:21.147696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C6BEE7E0>]}
[0m16:01:22.328941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m16:01:22.333978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C91C8FE0>]}
[0m16:01:22.389753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C90F1970>]}
[0m16:01:22.389753 [info ] [MainThread]: Found 24 models, 666 macros
[0m16:01:22.390751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C8F2AB70>]}
[0m16:01:22.391751 [info ] [MainThread]: 
[0m16:01:22.393751 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:01:22.395773 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m16:01:22.405759 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m16:01:22.405759 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m16:01:22.406757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:22.409759 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:22.410758 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:22.991237 [debug] [ThreadPool]: SQL status: SUCCESS in 0.584 seconds
[0m16:01:22.995247 [debug] [ThreadPool]: On list_integrity-db: Close
[0m16:01:22.998206 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m16:01:23.005267 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m16:01:23.005267 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m16:01:23.006200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:23.006200 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:23.007425 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:23.428110 [debug] [ThreadPool]: SQL status: SUCCESS in 0.421 seconds
[0m16:01:23.429107 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m16:01:23.430102 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m16:01:23.546825 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m16:01:23.549824 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m16:01:23.632450 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m16:01:23.646471 [debug] [MainThread]: Using redshift connection "master"
[0m16:01:23.647470 [debug] [MainThread]: On master: BEGIN
[0m16:01:23.647470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:23.648470 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:23.648470 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:24.048824 [debug] [MainThread]: SQL status: SUCCESS in 0.401 seconds
[0m16:01:24.050819 [debug] [MainThread]: Using redshift connection "master"
[0m16:01:24.051817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:01:24.188461 [debug] [MainThread]: SQL status: SUCCESS in 0.136 seconds
[0m16:01:24.190395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C4FA1850>]}
[0m16:01:24.191393 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:24.268561 [debug] [MainThread]: Using redshift connection "master"
[0m16:01:24.269559 [debug] [MainThread]: On master: BEGIN
[0m16:01:24.305080 [debug] [MainThread]: SQL status: SUCCESS in 0.035 seconds
[0m16:01:24.307084 [debug] [MainThread]: On master: COMMIT
[0m16:01:24.308077 [debug] [MainThread]: Using redshift connection "master"
[0m16:01:24.309077 [debug] [MainThread]: On master: COMMIT
[0m16:01:24.379337 [debug] [MainThread]: SQL status: SUCCESS in 0.070 seconds
[0m16:01:24.381333 [debug] [MainThread]: On master: Close
[0m16:01:24.382331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:24.384916 [info ] [MainThread]: 
[0m16:01:24.393244 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m16:01:24.394245 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m16:01:24.394245 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m16:01:24.395289 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m16:01:24.395289 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m16:01:24.396244 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m16:01:24.397241 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m16:01:24.397241 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m16:01:24.398243 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m16:01:24.399242 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m16:01:24.400285 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m16:01:24.401284 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m16:01:24.401284 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m16:01:24.403246 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m16:01:24.404382 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m16:01:24.405402 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m16:01:24.407386 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m16:01:24.409554 [debug] [Thread-1 (]: Began running node model.redshift.pg_tables
[0m16:01:24.411262 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m16:01:24.411262 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m16:01:24.411262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_tables)
[0m16:01:24.412263 [debug] [Thread-2 (]: Began running node model.redshift.pg_user
[0m16:01:24.412263 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m16:01:24.412263 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_tables
[0m16:01:24.413262 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m16:01:24.413262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_user)
[0m16:01:24.414262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m16:01:24.415806 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m16:01:24.415806 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m16:01:24.417774 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m16:01:24.416774 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_user
[0m16:01:24.416774 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m16:01:24.417774 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m16:01:24.418775 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m16:01:24.419818 [debug] [Thread-1 (]: Finished running node model.redshift.pg_tables
[0m16:01:24.420812 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m16:01:24.422773 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m16:01:24.423776 [debug] [Thread-1 (]: Began running node model.redshift.redshift_constraints
[0m16:01:24.424773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m16:01:24.425774 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_constraints
[0m16:01:24.423776 [debug] [Thread-2 (]: Finished running node model.redshift.pg_user
[0m16:01:24.424773 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m16:01:24.427773 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m16:01:24.427773 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m16:01:24.429774 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m16:01:24.428773 [debug] [Thread-2 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m16:01:24.428773 [debug] [Thread-3 (]: Began running node model.redshift.redshift_tables
[0m16:01:24.429774 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m16:01:24.430773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_sort_dist_keys)
[0m16:01:24.430773 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_constraints
[0m16:01:24.431774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_tables)
[0m16:01:24.431774 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m16:01:24.431774 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m16:01:24.432777 [debug] [Thread-1 (]: Began running node model.redshift.stl_query
[0m16:01:24.432777 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_tables
[0m16:01:24.433774 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m16:01:24.435774 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m16:01:24.436774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m16:01:24.437774 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m16:01:24.438643 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m16:01:24.439651 [debug] [Thread-1 (]: Began compiling node model.redshift.stl_query
[0m16:01:24.439651 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m16:01:24.440649 [debug] [Thread-4 (]: Began running node model.redshift.stl_wlm_query
[0m16:01:24.442649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stl_wlm_query)
[0m16:01:24.442649 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_tables
[0m16:01:24.442649 [debug] [Thread-2 (]: Began running node model.redshift.stv_blocklist
[0m16:01:24.441681 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m16:01:24.443650 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_wlm_query
[0m16:01:24.443650 [debug] [Thread-3 (]: Began running node model.redshift.stv_partitions
[0m16:01:24.444649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stv_blocklist)
[0m16:01:24.446650 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m16:01:24.446650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_partitions)
[0m16:01:24.447653 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_blocklist
[0m16:01:24.447653 [debug] [Thread-1 (]: Finished running node model.redshift.stl_query
[0m16:01:24.448649 [debug] [Thread-3 (]: Began compiling node model.redshift.stv_partitions
[0m16:01:24.449649 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m16:01:24.450174 [debug] [Thread-1 (]: Began running node model.redshift.stv_tbl_perm
[0m16:01:24.450174 [debug] [Thread-4 (]: Finished running node model.redshift.stl_wlm_query
[0m16:01:24.451198 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m16:01:24.452213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m16:01:24.453198 [debug] [Thread-2 (]: Finished running node model.redshift.stv_blocklist
[0m16:01:24.453198 [debug] [Thread-4 (]: Began running node model.redshift.svv_diskusage
[0m16:01:24.453198 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_tbl_perm
[0m16:01:24.454196 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_dependencies
[0m16:01:24.454196 [debug] [Thread-3 (]: Finished running node model.redshift.stv_partitions
[0m16:01:24.454196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m16:01:24.456196 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m16:01:24.456364 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m16:01:24.456364 [info ] [Thread-2 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m16:01:24.456364 [debug] [Thread-4 (]: Began compiling node model.redshift.svv_diskusage
[0m16:01:24.457387 [info ] [Thread-3 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m16:01:24.457387 [debug] [Thread-1 (]: Finished running node model.redshift.stv_tbl_perm
[0m16:01:24.458389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m16:01:24.460387 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m16:01:24.460991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m16:01:24.460991 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m16:01:24.460991 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m16:01:24.462014 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m16:01:24.463013 [debug] [Thread-4 (]: Finished running node model.redshift.svv_diskusage
[0m16:01:24.462014 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m16:01:24.468014 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m16:01:24.473011 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:24.473011 [debug] [Thread-4 (]: Began running node model.redshift.redshift_cost
[0m16:01:24.474014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m16:01:24.475013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m16:01:24.476014 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m16:01:24.476014 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m16:01:24.477013 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m16:01:24.477013 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_cost
[0m16:01:24.499012 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m16:01:24.507091 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:24.510016 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:24.514969 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m16:01:24.518381 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:24.518381 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m16:01:24.519384 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_cost
[0m16:01:24.521430 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:24.522608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:24.522608 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m16:01:24.522608 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_table_stats
[0m16:01:24.523774 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m16:01:24.524779 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:24.528796 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:24.529779 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:01:24.529779 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m16:01:24.530782 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:24.530782 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:24.531780 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m16:01:24.534778 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:24.535779 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:24.537780 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m16:01:24.537780 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m16:01:24.556778 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m16:01:24.557904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:01:24.560098 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m16:01:24.560869 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:24.566941 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m16:01:24.567939 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:24.576883 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:24.576883 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m16:01:24.577882 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:01:24.577882 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:24.578885 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:24.992969 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.463 seconds
[0m16:01:24.993972 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:24.994984 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m16:01:25.012491 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.434 seconds
[0m16:01:25.013492 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.491 seconds
[0m16:01:25.014492 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.456 seconds
[0m16:01:25.015537 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:25.016092 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:25.017106 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:25.018115 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m16:01:25.019151 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m16:01:25.020126 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m16:01:25.199244 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.203 seconds
[0m16:01:25.210301 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.211308 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m16:01:25.255451 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.233 seconds
[0m16:01:25.256421 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.235 seconds
[0m16:01:25.261496 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:25.267414 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:25.267414 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.247 seconds
[0m16:01:25.268417 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m16:01:25.269485 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m16:01:25.273459 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:25.274414 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m16:01:25.332150 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.120 seconds
[0m16:01:25.338093 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.339097 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m16:01:25.395071 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.120 seconds
[0m16:01:25.397074 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.122 seconds
[0m16:01:25.398061 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.124 seconds
[0m16:01:25.406076 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:25.410076 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:25.412071 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:25.413071 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m16:01:25.413071 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m16:01:25.414074 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m16:01:25.452142 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.112 seconds
[0m16:01:25.467667 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:01:25.468668 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.468668 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:01:25.552085 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.138 seconds
[0m16:01:25.553085 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.138 seconds
[0m16:01:25.554086 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:01:25.555083 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:01:25.556113 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:25.556113 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:25.557084 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:01:25.557084 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:01:25.561083 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.147 seconds
[0m16:01:25.563085 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:01:25.565097 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:25.565097 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:01:25.617515 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.148 seconds
[0m16:01:25.618517 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.619518 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m16:01:25.696139 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.076 seconds
[0m16:01:25.708631 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m16:01:25.713631 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.713631 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m16:01:25.768326 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.211 seconds
[0m16:01:25.769326 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.211 seconds
[0m16:01:25.769326 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.204 seconds
[0m16:01:25.794328 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.080 seconds
[0m16:01:25.795338 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:01:25.796342 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.796342 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:01:25.916946 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.121 seconds
[0m16:01:25.917954 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:01:25.917954 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m16:01:25.957028 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.038 seconds
[0m16:01:25.959955 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:25.959955 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m16:01:26.037710 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.077 seconds
[0m16:01:26.043702 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m16:01:26.045701 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:26.046704 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m16:01:26.125462 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.077 seconds
[0m16:01:26.126520 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:01:26.127458 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:26.127458 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:01:26.222071 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.094 seconds
[0m16:01:26.223085 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:01:26.224085 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m16:01:26.261938 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.037 seconds
[0m16:01:26.263976 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:26.264986 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m16:01:26.349652 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.084 seconds
[0m16:01:26.354641 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m16:01:26.356643 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:26.356643 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m16:01:26.442741 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.084 seconds
[0m16:01:26.444735 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:01:26.445735 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:26.446734 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:01:26.577868 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.130 seconds
[0m16:01:26.578870 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:01:26.579869 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m16:01:26.619446 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m16:01:26.621450 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:26.622442 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m16:01:26.700258 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.078 seconds
[0m16:01:26.703014 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m16:01:26.704016 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:26.704016 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m16:01:26.787091 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.082 seconds
[0m16:01:26.789188 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:01:26.790092 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:26.790092 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:01:26.886838 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.096 seconds
[0m16:01:26.887903 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:01:26.888880 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m16:01:26.931173 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.042 seconds
[0m16:01:26.932166 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m16:01:26.933169 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m16:01:26.934167 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m16:01:26.934652 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m16:01:27.006715 [debug] [Thread-2 (]: On model.redshift.redshift_admin_dependencies: Close
[0m16:01:27.008718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C9821340>]}
[0m16:01:27.009724 [info ] [Thread-2 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.55s]
[0m16:01:27.011678 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m16:01:27.011678 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_queries
[0m16:01:27.012740 [info ] [Thread-2 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m16:01:27.013752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_queries)
[0m16:01:27.014676 [debug] [Thread-3 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m16:01:27.014676 [debug] [Thread-4 (]: On model.redshift.redshift_admin_table_stats: Close
[0m16:01:27.015676 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_queries
[0m16:01:27.015676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C93C7980>]}
[0m16:01:27.016683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C946F410>]}
[0m16:01:27.016683 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m16:01:27.028194 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m16:01:27.029263 [info ] [Thread-3 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.55s]
[0m16:01:27.030193 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.48s]
[0m16:01:27.031193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C999FEC0>]}
[0m16:01:27.031193 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m16:01:27.032193 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m16:01:27.033213 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_queries
[0m16:01:27.033213 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.56s]
[0m16:01:27.038209 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m16:01:27.039192 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m16:01:27.044192 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:27.045192 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m16:01:27.045192 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:27.045192 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:27.046192 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:27.475544 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.430 seconds
[0m16:01:27.476574 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:27.476574 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m16:01:27.686532 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.209 seconds
[0m16:01:27.691517 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:27.692519 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m16:01:27.812534 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.119 seconds
[0m16:01:27.819535 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:27.821056 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m16:01:27.940537 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.118 seconds
[0m16:01:27.941986 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:01:27.941986 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:27.942996 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:01:28.114487 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.171 seconds
[0m16:01:28.115488 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:28.115488 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m16:01:28.196792 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.081 seconds
[0m16:01:28.198812 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m16:01:28.199803 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:28.199803 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m16:01:28.281117 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.081 seconds
[0m16:01:28.284122 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:01:28.285122 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:28.285122 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:01:28.379713 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.094 seconds
[0m16:01:28.380713 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:01:28.380713 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m16:01:28.421974 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.041 seconds
[0m16:01:28.421974 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m16:01:28.502736 [debug] [Thread-2 (]: On model.redshift.redshift_admin_queries: Close
[0m16:01:28.503738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526a0050-592a-4e49-aa58-728724cfe516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C99B2F30>]}
[0m16:01:28.504953 [info ] [Thread-2 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.49s]
[0m16:01:28.505960 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_queries
[0m16:01:28.507961 [debug] [MainThread]: Using redshift connection "master"
[0m16:01:28.507961 [debug] [MainThread]: On master: BEGIN
[0m16:01:28.507961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:28.509014 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:01:28.509014 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:01:28.935498 [debug] [MainThread]: SQL status: SUCCESS in 0.427 seconds
[0m16:01:28.936528 [debug] [MainThread]: On master: COMMIT
[0m16:01:28.937498 [debug] [MainThread]: Using redshift connection "master"
[0m16:01:28.937498 [debug] [MainThread]: On master: COMMIT
[0m16:01:29.015654 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m16:01:29.017653 [debug] [MainThread]: On master: Close
[0m16:01:29.019651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:29.020167 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m16:01:29.020728 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m16:01:29.021756 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m16:01:29.021756 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m16:01:29.021756 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m16:01:29.023294 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m16:01:29.023294 [info ] [MainThread]: 
[0m16:01:29.025312 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.63 seconds (6.63s).
[0m16:01:29.029303 [debug] [MainThread]: Command end result
[0m16:01:29.102452 [info ] [MainThread]: 
[0m16:01:29.103430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:29.104296 [info ] [MainThread]: 
[0m16:01:29.105093 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:01:29.106099 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:29.106099 after 8.35 seconds
[0m16:01:29.106099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C706C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C7D03B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C70A3140>]}
[0m16:01:29.106099 [debug] [MainThread]: Flushing usage events
[0m16:03:11.599761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB48293A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB70EBCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB70EBF20>]}


============================== 16:03:11.602761 | b7439993-ea3a-4e76-bf61-5018aa2fd2b1 ==============================
[0m16:03:11.602761 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:03:11.603777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:11.698443 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:03:11.698443 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:03:11.798625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7439993-ea3a-4e76-bf61-5018aa2fd2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB727D100>]}
[0m16:03:11.831597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7439993-ea3a-4e76-bf61-5018aa2fd2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB693CEC0>]}
[0m16:03:11.832779 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:03:11.850791 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:03:11.980854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:11.980854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:11.983854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m16:03:11.996926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7439993-ea3a-4e76-bf61-5018aa2fd2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB7B79FA0>]}
[0m16:03:12.049809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7439993-ea3a-4e76-bf61-5018aa2fd2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB7BDD160>]}
[0m16:03:12.053809 [debug] [MainThread]: Command `dbt list` succeeded at 16:03:12.052809 after 0.60 seconds
[0m16:03:12.053809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB48293A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB7254E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB7255880>]}
[0m16:03:12.054814 [debug] [MainThread]: Flushing usage events
[0m16:09:03.845521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017886A9D1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178871EC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178871EE660>]}


============================== 16:09:03.848842 | fc6366f6-23de-4182-ad61-9d5892931d72 ==============================
[0m16:09:03.848842 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:09:03.849823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:03.943760 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:09:03.944761 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:09:04.038638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc6366f6-23de-4182-ad61-9d5892931d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178873707D0>]}
[0m16:09:04.073716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc6366f6-23de-4182-ad61-9d5892931d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017887C0D250>]}
[0m16:09:04.074833 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:09:04.093350 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:09:04.186844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:04.187844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:04.190844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt.customer
[0m16:09:04.202770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc6366f6-23de-4182-ad61-9d5892931d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017887DCF980>]}
[0m16:09:04.257928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc6366f6-23de-4182-ad61-9d5892931d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017887DCF620>]}
[0m16:09:04.260437 [debug] [MainThread]: Command `dbt list` succeeded at 16:09:04.260437 after 0.54 seconds
[0m16:09:04.260946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017886F53D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017887370EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178870A3CE0>]}
[0m16:09:04.260946 [debug] [MainThread]: Flushing usage events
[0m16:09:45.063212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8A67E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8A2500E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8A252CC0>]}


============================== 16:09:45.066159 | a51d5b4c-6e40-4c38-b9e0-f7ad2a2a15f8 ==============================
[0m16:09:45.066159 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:09:45.067157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt list', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:09:45.168284 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:09:45.168284 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:09:45.267772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a51d5b4c-6e40-4c38-b9e0-f7ad2a2a15f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8B7F3140>]}
[0m16:09:45.301743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a51d5b4c-6e40-4c38-b9e0-f7ad2a2a15f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8AB6D7F0>]}
[0m16:09:45.303743 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:09:45.321299 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:09:45.364883 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:09:45.365839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a51d5b4c-6e40-4c38-b9e0-f7ad2a2a15f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8CBEB470>]}
[0m16:09:46.270175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt
[0m16:09:46.275174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a51d5b4c-6e40-4c38-b9e0-f7ad2a2a15f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8BA4EF60>]}
[0m16:09:46.328034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a51d5b4c-6e40-4c38-b9e0-f7ad2a2a15f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8CAC3080>]}
[0m16:09:46.330069 [debug] [MainThread]: Command `dbt list` succeeded at 16:09:46.330069 after 1.40 seconds
[0m16:09:46.330069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8AE354F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8ADEE6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB8ADEC8C0>]}
[0m16:09:46.331038 [debug] [MainThread]: Flushing usage events
[0m16:10:02.238045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F78CBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F78CA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F78C8890>]}


============================== 16:10:02.241510 | 07a8096d-92f6-4336-9105-bb23540a964d ==============================
[0m16:10:02.241510 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:10:02.242545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:10:02.328165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07a8096d-92f6-4336-9105-bb23540a964d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F7954E30>]}
[0m16:10:02.400425 [debug] [MainThread]: Command `dbt clean` succeeded at 16:10:02.400425 after 0.26 seconds
[0m16:10:02.400425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F7763F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F7AA51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F7954E30>]}
[0m16:10:02.401424 [debug] [MainThread]: Flushing usage events
[0m16:10:08.464184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D66B9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8680440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D880EB40>]}


============================== 16:10:08.468227 | b4271f1c-6043-4adc-a5c6-b2e9a2f5dd79 ==============================
[0m16:10:08.468227 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:10:08.469185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:08.536418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4271f1c-6043-4adc-a5c6-b2e9a2f5dd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6B6A3F0>]}
[0m16:10:08.556929 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-_qnxn0pf'
[0m16:10:08.557906 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:10:08.695996 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:10:08.697996 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:10:08.777327 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:10:08.784315 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json
[0m16:10:08.851239 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/redshift.json 200
[0m16:10:08.854236 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:10:08.928616 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:10:08.930708 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m16:10:08.995332 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m16:10:08.999352 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:10:09.361261 [info ] [MainThread]: Installed from version 1.0.0
[0m16:10:09.362261 [info ] [MainThread]: Updated version available: 1.2.0
[0m16:10:09.362261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4271f1c-6043-4adc-a5c6-b2e9a2f5dd79', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D929FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D92FAE10>]}
[0m16:10:09.363262 [info ] [MainThread]: Installing dbt-labs/redshift
[0m16:10:09.551566 [info ] [MainThread]: Installed from version 0.9.0
[0m16:10:09.552570 [info ] [MainThread]: Up to date!
[0m16:10:09.552570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4271f1c-6043-4adc-a5c6-b2e9a2f5dd79', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D81332C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8133290>]}
[0m16:10:09.553571 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:10:09.848987 [info ] [MainThread]: Installed from version 0.8.2
[0m16:10:09.848987 [info ] [MainThread]: Updated version available: 0.9.0
[0m16:10:09.849989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4271f1c-6043-4adc-a5c6-b2e9a2f5dd79', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D81332C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8133B60>]}
[0m16:10:09.849989 [info ] [MainThread]: Installing dbt-labs/codegen
[0m16:10:10.035289 [info ] [MainThread]: Installed from version 0.9.0
[0m16:10:10.036291 [info ] [MainThread]: Updated version available: 0.12.1
[0m16:10:10.037301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4271f1c-6043-4adc-a5c6-b2e9a2f5dd79', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D91AA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D92C0350>]}
[0m16:10:10.037301 [info ] [MainThread]: 
[0m16:10:10.037301 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m16:10:10.039301 [debug] [MainThread]: Command `dbt deps` succeeded at 16:10:10.039301 after 1.69 seconds
[0m16:10:10.039301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8FC7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8CC0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8C1FF20>]}
[0m16:10:10.040301 [debug] [MainThread]: Flushing usage events
[0m16:10:17.392022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB338F0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB338F0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB338F1010>]}


============================== 16:10:17.396230 | 1b08e764-f188-40ec-9f67-a7dcbc469158 ==============================
[0m16:10:17.396230 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:10:17.396666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:10:17.495319 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:10:17.495319 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:10:17.593294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB338F09E0>]}
[0m16:10:17.626312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3426D610>]}
[0m16:10:17.628296 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:10:17.662324 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:10:17.663323 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:10:17.663323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB342C49E0>]}
[0m16:10:18.793448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt
[0m16:10:18.797449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3534EDE0>]}
[0m16:10:18.856910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB329438C0>]}
[0m16:10:18.856910 [info ] [MainThread]: Found 24 models, 666 macros
[0m16:10:18.857908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB3555B2C0>]}
[0m16:10:18.859917 [info ] [MainThread]: 
[0m16:10:18.859917 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:10:18.862907 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db'
[0m16:10:18.873010 [debug] [ThreadPool]: Using redshift connection "list_integrity-db"
[0m16:10:18.874011 [debug] [ThreadPool]: On list_integrity-db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "connection_name": "list_integrity-db"} */

    select distinct nspname from pg_namespace
[0m16:10:18.874011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:18.877012 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:18.878012 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:19.460732 [debug] [ThreadPool]: SQL status: SUCCESS in 0.586 seconds
[0m16:10:19.464387 [debug] [ThreadPool]: On list_integrity-db: Close
[0m16:10:19.468401 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db_dbt'
[0m16:10:19.477397 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m16:10:19.478397 [debug] [ThreadPool]: On list_integrity-db_dbt: BEGIN
[0m16:10:19.478397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:19.479396 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:19.479396 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:19.891669 [debug] [ThreadPool]: SQL status: SUCCESS in 0.413 seconds
[0m16:10:19.893708 [debug] [ThreadPool]: Using redshift connection "list_integrity-db_dbt"
[0m16:10:19.894713 [debug] [ThreadPool]: On list_integrity-db_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "connection_name": "list_integrity-db_dbt"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dbt'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dbt'
[0m16:10:20.005109 [debug] [ThreadPool]: SQL status: SUCCESS in 0.109 seconds
[0m16:10:20.008063 [debug] [ThreadPool]: On list_integrity-db_dbt: ROLLBACK
[0m16:10:20.087779 [debug] [ThreadPool]: On list_integrity-db_dbt: Close
[0m16:10:20.102807 [debug] [MainThread]: Using redshift connection "master"
[0m16:10:20.102807 [debug] [MainThread]: On master: BEGIN
[0m16:10:20.103807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:20.103807 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:20.104799 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:20.539671 [debug] [MainThread]: SQL status: SUCCESS in 0.436 seconds
[0m16:10:20.540780 [debug] [MainThread]: Using redshift connection "master"
[0m16:10:20.541821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:10:20.683521 [debug] [MainThread]: SQL status: SUCCESS in 0.140 seconds
[0m16:10:20.687521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB341E81A0>]}
[0m16:10:20.688521 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:20.781086 [debug] [MainThread]: Using redshift connection "master"
[0m16:10:20.783084 [debug] [MainThread]: On master: BEGIN
[0m16:10:20.822337 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m16:10:20.824331 [debug] [MainThread]: On master: COMMIT
[0m16:10:20.825352 [debug] [MainThread]: Using redshift connection "master"
[0m16:10:20.826370 [debug] [MainThread]: On master: COMMIT
[0m16:10:20.907034 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m16:10:20.908025 [debug] [MainThread]: On master: Close
[0m16:10:20.910025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:20.912027 [info ] [MainThread]: 
[0m16:10:20.922022 [debug] [Thread-1 (]: Began running node model.redshift.pg_attribute
[0m16:10:20.922022 [debug] [Thread-2 (]: Began running node model.redshift.pg_class
[0m16:10:20.923009 [debug] [Thread-3 (]: Began running node model.redshift.pg_depend
[0m16:10:20.923009 [debug] [Thread-4 (]: Began running node model.redshift.pg_namespace
[0m16:10:20.924011 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.redshift.pg_attribute'
[0m16:10:20.925007 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.redshift.pg_class'
[0m16:10:20.925007 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.redshift.pg_depend'
[0m16:10:20.926010 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.redshift.pg_namespace'
[0m16:10:20.927007 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_attribute
[0m16:10:20.927007 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_class
[0m16:10:20.928008 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_depend
[0m16:10:20.928008 [debug] [Thread-4 (]: Began compiling node model.redshift.pg_namespace
[0m16:10:20.930009 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_attribute"
[0m16:10:20.931567 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_class"
[0m16:10:20.932566 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_depend"
[0m16:10:20.935565 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.pg_namespace"
[0m16:10:20.937565 [debug] [Thread-2 (]: Finished running node model.redshift.pg_class
[0m16:10:20.937565 [debug] [Thread-2 (]: Began running node model.redshift.pg_tables
[0m16:10:20.938564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_class, now model.redshift.pg_tables)
[0m16:10:20.938564 [debug] [Thread-2 (]: Began compiling node model.redshift.pg_tables
[0m16:10:20.939768 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.pg_tables"
[0m16:10:20.947412 [debug] [Thread-1 (]: Finished running node model.redshift.pg_attribute
[0m16:10:20.948794 [debug] [Thread-3 (]: Finished running node model.redshift.pg_depend
[0m16:10:20.948794 [debug] [Thread-4 (]: Finished running node model.redshift.pg_namespace
[0m16:10:20.948794 [debug] [Thread-1 (]: Began running node model.redshift.pg_user
[0m16:10:20.949795 [debug] [Thread-3 (]: Began running node model.redshift.pg_views
[0m16:10:20.950480 [debug] [Thread-4 (]: Began running node model.redshift.redshift_columns
[0m16:10:20.950480 [debug] [Thread-2 (]: Finished running node model.redshift.pg_tables
[0m16:10:20.951487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_attribute, now model.redshift.pg_user)
[0m16:10:20.951487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_depend, now model.redshift.pg_views)
[0m16:10:20.952486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.pg_namespace, now model.redshift.redshift_columns)
[0m16:10:20.952486 [debug] [Thread-2 (]: Began running node model.redshift.redshift_constraints
[0m16:10:20.952486 [debug] [Thread-1 (]: Began compiling node model.redshift.pg_user
[0m16:10:20.953487 [debug] [Thread-3 (]: Began compiling node model.redshift.pg_views
[0m16:10:20.953487 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_columns
[0m16:10:20.953487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.pg_tables, now model.redshift.redshift_constraints)
[0m16:10:20.955486 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.pg_user"
[0m16:10:20.956671 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.pg_views"
[0m16:10:20.957701 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_columns"
[0m16:10:20.958671 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_constraints
[0m16:10:20.960670 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_constraints"
[0m16:10:20.961714 [debug] [Thread-3 (]: Finished running node model.redshift.pg_views
[0m16:10:20.962671 [debug] [Thread-1 (]: Finished running node model.redshift.pg_user
[0m16:10:20.962671 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_columns
[0m16:10:20.963669 [debug] [Thread-3 (]: Began running node model.redshift.redshift_sort_dist_keys
[0m16:10:20.963669 [debug] [Thread-1 (]: Began running node model.redshift.redshift_tables
[0m16:10:20.964670 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_constraints
[0m16:10:20.964670 [debug] [Thread-4 (]: Began running node model.redshift.stl_explain
[0m16:10:20.964670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.pg_views, now model.redshift.redshift_sort_dist_keys)
[0m16:10:20.964670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.pg_user, now model.redshift.redshift_tables)
[0m16:10:20.966177 [debug] [Thread-2 (]: Began running node model.redshift.stl_query
[0m16:10:20.966177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_columns, now model.redshift.stl_explain)
[0m16:10:20.966177 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_sort_dist_keys
[0m16:10:20.967182 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_tables
[0m16:10:20.967182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_constraints, now model.redshift.stl_query)
[0m16:10:20.967182 [debug] [Thread-4 (]: Began compiling node model.redshift.stl_explain
[0m16:10:20.969207 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_sort_dist_keys"
[0m16:10:20.971182 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_tables"
[0m16:10:20.971182 [debug] [Thread-2 (]: Began compiling node model.redshift.stl_query
[0m16:10:20.972182 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stl_explain"
[0m16:10:20.974183 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stl_query"
[0m16:10:20.975182 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_sort_dist_keys
[0m16:10:20.975182 [debug] [Thread-4 (]: Finished running node model.redshift.stl_explain
[0m16:10:20.976182 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_tables
[0m16:10:20.976690 [debug] [Thread-3 (]: Began running node model.redshift.stl_wlm_query
[0m16:10:20.976690 [debug] [Thread-4 (]: Began running node model.redshift.stv_blocklist
[0m16:10:20.977696 [debug] [Thread-2 (]: Finished running node model.redshift.stl_query
[0m16:10:20.978002 [debug] [Thread-1 (]: Began running node model.redshift.stv_partitions
[0m16:10:20.978356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_sort_dist_keys, now model.redshift.stl_wlm_query)
[0m16:10:20.978356 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stl_explain, now model.redshift.stv_blocklist)
[0m16:10:20.979369 [debug] [Thread-2 (]: Began running node model.redshift.stv_tbl_perm
[0m16:10:20.979369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_tables, now model.redshift.stv_partitions)
[0m16:10:20.979369 [debug] [Thread-3 (]: Began compiling node model.redshift.stl_wlm_query
[0m16:10:20.980361 [debug] [Thread-4 (]: Began compiling node model.redshift.stv_blocklist
[0m16:10:20.980361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stl_query, now model.redshift.stv_tbl_perm)
[0m16:10:20.980361 [debug] [Thread-1 (]: Began compiling node model.redshift.stv_partitions
[0m16:10:20.983361 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.stl_wlm_query"
[0m16:10:20.983609 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.stv_blocklist"
[0m16:10:20.984630 [debug] [Thread-2 (]: Began compiling node model.redshift.stv_tbl_perm
[0m16:10:20.985630 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.stv_partitions"
[0m16:10:20.986630 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.stv_tbl_perm"
[0m16:10:20.987631 [debug] [Thread-3 (]: Finished running node model.redshift.stl_wlm_query
[0m16:10:20.987631 [debug] [Thread-4 (]: Finished running node model.redshift.stv_blocklist
[0m16:10:20.988631 [debug] [Thread-1 (]: Finished running node model.redshift.stv_partitions
[0m16:10:20.988631 [debug] [Thread-3 (]: Began running node model.redshift.svv_diskusage
[0m16:10:20.989631 [debug] [Thread-2 (]: Finished running node model.redshift.stv_tbl_perm
[0m16:10:20.989631 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_dependencies
[0m16:10:20.990630 [debug] [Thread-1 (]: Began running node model.redshift.redshift_admin_users_schema_privileges
[0m16:10:20.990630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.stl_wlm_query, now model.redshift.svv_diskusage)
[0m16:10:20.990630 [debug] [Thread-2 (]: Began running node model.redshift.redshift_admin_users_table_view_privileges
[0m16:10:20.992630 [debug] [Thread-3 (]: Began compiling node model.redshift.svv_diskusage
[0m16:10:20.991630 [info ] [Thread-4 (]: 1 of 5 START sql view model dbt.redshift_admin_dependencies .................... [RUN]
[0m16:10:20.991630 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt.redshift_admin_users_schema_privileges ......... [RUN]
[0m16:10:20.993630 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.svv_diskusage"
[0m16:10:20.992630 [info ] [Thread-2 (]: 3 of 5 START sql view model dbt.redshift_admin_users_table_view_privileges ..... [RUN]
[0m16:10:20.994631 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.stv_blocklist, now model.redshift.redshift_admin_dependencies)
[0m16:10:20.994631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.redshift.stv_partitions, now model.redshift.redshift_admin_users_schema_privileges)
[0m16:10:20.995630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.redshift.stv_tbl_perm, now model.redshift.redshift_admin_users_table_view_privileges)
[0m16:10:20.995630 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_dependencies
[0m16:10:20.995630 [debug] [Thread-3 (]: Finished running node model.redshift.svv_diskusage
[0m16:10:20.996631 [debug] [Thread-1 (]: Began compiling node model.redshift.redshift_admin_users_schema_privileges
[0m16:10:20.996631 [debug] [Thread-2 (]: Began compiling node model.redshift.redshift_admin_users_table_view_privileges
[0m16:10:21.001631 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_dependencies"
[0m16:10:21.002640 [debug] [Thread-3 (]: Began running node model.redshift.redshift_cost
[0m16:10:21.007095 [debug] [Thread-1 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:21.014077 [debug] [Thread-2 (]: Writing injected SQL for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.014893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.svv_diskusage, now model.redshift.redshift_cost)
[0m16:10:21.015917 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_dependencies
[0m16:10:21.015917 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_cost
[0m16:10:21.038962 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_dependencies"
[0m16:10:21.038962 [debug] [Thread-1 (]: Began executing node model.redshift.redshift_admin_users_schema_privileges
[0m16:10:21.043961 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_cost"
[0m16:10:21.044951 [debug] [Thread-2 (]: Began executing node model.redshift.redshift_admin_users_table_view_privileges
[0m16:10:21.047323 [debug] [Thread-1 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:21.050273 [debug] [Thread-2 (]: Writing runtime sql for node "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.050273 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_cost
[0m16:10:21.053560 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:21.054501 [debug] [Thread-3 (]: Began running node model.redshift.redshift_admin_table_stats
[0m16:10:21.056536 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:21.057504 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m16:10:21.060566 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.060818 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m16:10:21.060818 [info ] [Thread-3 (]: 4 of 5 START sql view model dbt.redshift_admin_table_stats ..................... [RUN]
[0m16:10:21.061824 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:21.061824 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m16:10:21.062824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:21.062824 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_cost, now model.redshift.redshift_admin_table_stats)
[0m16:10:21.063824 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:21.063824 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:10:21.064824 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:21.064824 [debug] [Thread-3 (]: Began compiling node model.redshift.redshift_admin_table_stats
[0m16:10:21.064824 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:21.066329 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:21.066329 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:21.080332 [debug] [Thread-3 (]: Writing injected SQL for node "model.redshift.redshift_admin_table_stats"
[0m16:10:21.081862 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:21.087861 [debug] [Thread-3 (]: Began executing node model.redshift.redshift_admin_table_stats
[0m16:10:21.090862 [debug] [Thread-3 (]: Writing runtime sql for node "model.redshift.redshift_admin_table_stats"
[0m16:10:21.100860 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:21.101862 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m16:10:21.104861 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:10:21.105862 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:21.105862 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:21.512895 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.450 seconds
[0m16:10:21.513949 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:21.514902 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */


  create view "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" as (
    

with __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_depend as (
select
  classid
, objid
, objsubid
, refclassid
, refobjid
, refobjsubid
, deptype
from pg_catalog.pg_depend
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
) select distinct
  srcobj.oid as source_oid
  , srcnsp.nspname as source_schemaname
  , srcobj.relname as source_objectname
  , tgtobj.oid as dependent_oid
  , tgtnsp.nspname as dependent_schemaname
  , tgtobj.relname as dependent_objectname

from

  __dbt__cte__pg_class as srcobj
  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid
  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid
  join __dbt__cte__pg_class as tgtobj
    on tgtdep.refobjid = tgtobj.oid
    and srcobj.oid <> tgtobj.oid
  left join __dbt__cte__pg_namespace as srcnsp
    on srcobj.relnamespace = srcnsp.oid
  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid

where
  tgtdep.deptype = 'i' --dependency_internal
  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence
  ) ;
[0m16:10:21.542955 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.478 seconds
[0m16:10:21.543998 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.544928 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user

), objects as (
  
  select
    schema_name
  , 'table' as object_type
  , table_name as object_name
  , '"' || schema_name || '"."' || table_name || '"' as full_object_name
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
  
  union
  
  select
    schema_name
  , 'view' as object_type
  , view_name as object_name
  , '"' || schema_name || '"."' || view_name || '"' as full_object_name
  from views
  where schema_name not in ('pg_catalog', 'information_schema')
  
)

select 
  objects.schema_name
, objects.object_name
, users.username
, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege
, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege
, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege
, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege
, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege
from objects
cross join users
order by objects.full_object_name, users.username
  ) ;
[0m16:10:21.559038 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.454 seconds
[0m16:10:21.559995 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:21.560994 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */


  create view "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" as (
    with  __dbt__cte__stv_tbl_perm as (
select
  slice
, id -- table id
, name -- table name
, rows
, sorted_rows
, (rows - sorted_rows) as unsorted_rows
, temp
, db_id
, backup
from pg_catalog.stv_tbl_perm
),  __dbt__cte__pg_class as (
select
  oid
, relname
, relnamespace
, reltype
, relowner
, relam
, relfilenode
, reltablespace
, relpages
, reltuples
, reltoastrelid
, reltoastidxid
, relhasindex
, relisshared
, relkind
, relnatts
, relexternid
, relisreplicated
, relispinned
, reldiststyle
, relprojbaseid
, relchecks
, reltriggers
, relukeys
, relfkeys
, relrefs
, relhasoids
, relhaspkey
, relhasrules
, relhassubclass
, relacl
from pg_catalog.pg_class
),  __dbt__cte__pg_namespace as (
select
  oid
, nspname
, nspowner
, nspacl
from pg_catalog.pg_namespace
),  __dbt__cte__stv_blocklist as (
select
  slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.stv_blocklist
),  __dbt__cte__pg_attribute as (
select
  attrelid
, attname
, atttypid
, attstattarget
, attlen
, attnum
, attndims
, attcacheoff
, atttypmod
, attbyval
, attstorage
, attalign
, attnotnull
, atthasdef
, attisdropped
, attislocal
, attinhcount
, attisdistkey
, attispreloaded
, attsortkeyord
, attencodingtype
, attencrypttype
, (case attisdistkey
        when 't' then attname
        else null end) as dist_key
, (case attsortkeyord
        when 1 then attname
        else null end) as sort_key
from pg_catalog.pg_attribute
),  __dbt__cte__svv_diskusage as (
select
  db_id
, name
, slice
, col
, tbl
, blocknum
, num_values
, extended_limits
, minvalue
, maxvalue
, sb_pos
, pinned
, on_disk
, backed_up
, modified
, hdr_modified
, unsorted
, tombstone
, preferred_diskno
, temporary
, newblock
, num_readers
, id
, flags
from pg_catalog.svv_diskusage
),  __dbt__cte__stv_partitions as (
select

  owner
, host
, diskno
, part_begin
, part_end
, used
, tossed
, capacity
, "reads"
, writes
, seek_forward
, seek_back
, is_san
, failed
, mbps
, mount

from pg_catalog.stv_partitions
), unsorted_by_table as (

  select
    db_id
  , id as table_id
  , name as table_name
  , sum(rows) as rows
  , sum(unsorted_rows) as unsorted_rows
  from __dbt__cte__stv_tbl_perm
  group by 1, 2, 3

), pg_class as (

  select * from __dbt__cte__pg_class

), pg_namespace as (

  select * from __dbt__cte__pg_namespace

), table_sizes as (

  select
    tbl as table_id
  , count(*) as size_in_megabytes
  from __dbt__cte__stv_blocklist
  group by 1

), table_attributes as (

  select
    attrelid as table_id
  , min(dist_key) as dist_key
  , min(sort_key) as sort_key
  , max(attsortkeyord) as num_sort_keys
  , (max(attencodingtype) > 0) as is_encoded
  , max(attnum) as num_columns
  from __dbt__cte__pg_attribute
  group by 1

), slice_distribution as (

  select
    tbl as table_id
  , trim(name) as name
  , slice
  , count(*) as size_in_megabytes

  from __dbt__cte__svv_diskusage
  group by 1, 2, 3

), capacity as (

  select
    sum(capacity) as total_megabytes
  from __dbt__cte__stv_partitions
  where part_begin=0

), table_distribution_ratio as (

  select
    table_id
  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)
      as ratio
  from slice_distribution
  group by 1

)

select

  trim(pg_namespace.nspname) as schema
, trim(unsorted_by_table.table_name) as table
, unsorted_by_table.rows
, unsorted_by_table.unsorted_rows
, (case unsorted_by_table.rows
        when 0 then 0
        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)
    as percent_rows_unsorted
, unsorted_by_table.table_id

, decode(pg_class.reldiststyle, 0, 'even',
                              1, table_attributes.dist_key,
                              'all') as dist_style
, table_distribution_ratio.ratio as dist_skew

, (table_attributes.sort_key is not null) as is_sorted
, table_attributes.sort_key
, table_attributes.num_sort_keys
, table_attributes.num_columns

, table_sizes.size_in_megabytes
, (case capacity.total_megabytes
        when 0 then 0
        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)
    as disk_used_percent_of_total
, table_attributes.is_encoded

from unsorted_by_table

left join pg_class
  on pg_class.oid = unsorted_by_table.table_id

left join pg_namespace
  on pg_namespace.oid = pg_class.relnamespace

left join capacity
  on 1=1

left join table_sizes
  on unsorted_by_table.table_id = table_sizes.table_id

left join table_attributes
  on table_attributes.table_id = unsorted_by_table.table_id

left join table_distribution_ratio
  on table_distribution_ratio.table_id = unsorted_by_table.table_id
  ) ;
[0m16:10:21.562997 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.500 seconds
[0m16:10:21.563697 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:21.564730 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */


  create view "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" as (
    with  __dbt__cte__pg_tables as (
select
  schemaname as schema_name
, tablename as table_name
, tableowner as table_owner
, tablespace as table_space
, hasindexes as has_indexes
, hasrules as has_rules
, hastriggers as has_triggers
from pg_catalog.pg_tables
),  __dbt__cte__pg_views as (
select
  schemaname as schema_name
, viewname as view_name
, viewowner as view_owner
from pg_catalog.pg_views
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
), tables as (

  select * from __dbt__cte__pg_tables

), views as (

  select * from __dbt__cte__pg_views

), users as (

  select * from __dbt__cte__pg_user
  
), schemas as (
  
  select
  distinct(schema_name)
  from tables
  where schema_name not in ('pg_catalog', 'information_schema')
        
  union
        
  select
  distinct(schema_name)
  from views
        
  where schema_name not in ('pg_catalog', 'information_schema')
  
)


select 
  schemas.schema_name
, users.username
, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege
, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege
from schemas
cross join users
order by schemas.schema_name, users.username
  ) ;
[0m16:10:21.725729 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.209 seconds
[0m16:10:21.737708 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:21.737708 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies" rename to "redshift_admin_dependencies__dbt_backup"
[0m16:10:21.757188 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.211 seconds
[0m16:10:21.764184 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.764184 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges" rename to "redshift_admin_users_table_view_privileges__dbt_backup"
[0m16:10:21.781677 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.216 seconds
[0m16:10:21.786680 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:21.786680 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges" rename to "redshift_admin_users_schema_privileges__dbt_backup"
[0m16:10:21.790065 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.227 seconds
[0m16:10:21.793131 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:21.794184 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats" rename to "redshift_admin_table_stats__dbt_backup"
[0m16:10:21.852773 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.114 seconds
[0m16:10:21.858784 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:21.858784 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
alter table "integrity-db"."dbt"."redshift_admin_dependencies__dbt_tmp" rename to "redshift_admin_dependencies"
[0m16:10:21.876072 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.111 seconds
[0m16:10:21.881065 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.881065 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_tmp" rename to "redshift_admin_users_table_view_privileges"
[0m16:10:21.910197 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m16:10:21.918188 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:21.919189 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
alter table "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_tmp" rename to "redshift_admin_users_schema_privileges"
[0m16:10:21.920189 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.125 seconds
[0m16:10:21.925188 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:21.926189 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
alter table "integrity-db"."dbt"."redshift_admin_table_stats__dbt_tmp" rename to "redshift_admin_table_stats"
[0m16:10:21.971169 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.112 seconds
[0m16:10:21.989956 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:10:21.989956 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:21.989956 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:10:21.995488 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.113 seconds
[0m16:10:21.996029 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:10:21.997034 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:21.997034 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:10:22.038463 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.112 seconds
[0m16:10:22.043506 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:10:22.044460 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.123 seconds
[0m16:10:22.045196 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:22.048255 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:10:22.048915 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:10:22.049947 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:22.050931 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:10:22.226981 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.236 seconds
[0m16:10:22.228979 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:22.229978 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m16:10:22.231973 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.180 seconds
[0m16:10:22.232977 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.236 seconds
[0m16:10:22.233977 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.183 seconds
[0m16:10:22.303673 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.073 seconds
[0m16:10:22.313689 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup"
[0m16:10:22.317701 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:22.317701 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_dependencies"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_dependencies__dbt_backup" cascade
[0m16:10:22.400331 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.082 seconds
[0m16:10:22.403370 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:10:22.405319 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:22.405319 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: COMMIT
[0m16:10:22.526325 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.119 seconds
[0m16:10:22.527348 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_dependencies"
[0m16:10:22.528328 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: BEGIN
[0m16:10:22.566022 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.036 seconds
[0m16:10:22.571628 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:22.572672 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m16:10:22.654678 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.081 seconds
[0m16:10:22.659056 [debug] [Thread-1 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup"
[0m16:10:22.660053 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:22.661052 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_schema_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_schema_privileges__dbt_backup" cascade
[0m16:10:22.750825 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.089 seconds
[0m16:10:22.753244 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:10:22.754374 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:22.755311 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: COMMIT
[0m16:10:22.850563 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.095 seconds
[0m16:10:22.852564 [debug] [Thread-1 (]: Using redshift connection "model.redshift.redshift_admin_users_schema_privileges"
[0m16:10:22.853636 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: BEGIN
[0m16:10:22.893133 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.039 seconds
[0m16:10:22.895122 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:22.896118 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m16:10:22.972159 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.075 seconds
[0m16:10:22.978209 [debug] [Thread-2 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup"
[0m16:10:22.981116 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:22.982160 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_users_table_view_privileges"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_users_table_view_privileges__dbt_backup" cascade
[0m16:10:23.060592 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.078 seconds
[0m16:10:23.062593 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:10:23.064591 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:23.065592 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: COMMIT
[0m16:10:23.184965 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.118 seconds
[0m16:10:23.187999 [debug] [Thread-2 (]: Using redshift connection "model.redshift.redshift_admin_users_table_view_privileges"
[0m16:10:23.188995 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: BEGIN
[0m16:10:23.226059 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.035 seconds
[0m16:10:23.230028 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:23.231145 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m16:10:23.306101 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.073 seconds
[0m16:10:23.311071 [debug] [Thread-3 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup"
[0m16:10:23.313044 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:23.314082 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_table_stats"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_table_stats__dbt_backup" cascade
[0m16:10:23.396620 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.081 seconds
[0m16:10:23.398612 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:10:23.400580 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:23.400580 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: COMMIT
[0m16:10:23.497609 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.096 seconds
[0m16:10:23.499661 [debug] [Thread-3 (]: Using redshift connection "model.redshift.redshift_admin_table_stats"
[0m16:10:23.500599 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: BEGIN
[0m16:10:23.540540 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.039 seconds
[0m16:10:23.544533 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: ROLLBACK
[0m16:10:23.545617 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: ROLLBACK
[0m16:10:23.546530 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: ROLLBACK
[0m16:10:23.547530 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: ROLLBACK
[0m16:10:23.626918 [debug] [Thread-4 (]: On model.redshift.redshift_admin_dependencies: Close
[0m16:10:23.628918 [debug] [Thread-2 (]: On model.redshift.redshift_admin_users_table_view_privileges: Close
[0m16:10:23.629914 [debug] [Thread-1 (]: On model.redshift.redshift_admin_users_schema_privileges: Close
[0m16:10:23.630914 [debug] [Thread-3 (]: On model.redshift.redshift_admin_table_stats: Close
[0m16:10:23.634105 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB31379670>]}
[0m16:10:23.635122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB35807B90>]}
[0m16:10:23.637191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB34162090>]}
[0m16:10:23.638204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB35770A40>]}
[0m16:10:23.639205 [info ] [Thread-4 (]: 1 of 5 OK created sql view model dbt.redshift_admin_dependencies ............... [[32mSUCCESS[0m in 2.64s]
[0m16:10:23.641204 [info ] [Thread-2 (]: 3 of 5 OK created sql view model dbt.redshift_admin_users_table_view_privileges  [[32mSUCCESS[0m in 2.64s]
[0m16:10:23.642202 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt.redshift_admin_users_schema_privileges .... [[32mSUCCESS[0m in 2.64s]
[0m16:10:23.643202 [info ] [Thread-3 (]: 4 of 5 OK created sql view model dbt.redshift_admin_table_stats ................ [[32mSUCCESS[0m in 2.58s]
[0m16:10:23.644268 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_dependencies
[0m16:10:23.645202 [debug] [Thread-2 (]: Finished running node model.redshift.redshift_admin_users_table_view_privileges
[0m16:10:23.646208 [debug] [Thread-1 (]: Finished running node model.redshift.redshift_admin_users_schema_privileges
[0m16:10:23.646208 [debug] [Thread-3 (]: Finished running node model.redshift.redshift_admin_table_stats
[0m16:10:23.647201 [debug] [Thread-4 (]: Began running node model.redshift.redshift_admin_queries
[0m16:10:23.648200 [info ] [Thread-4 (]: 5 of 5 START sql view model dbt.redshift_admin_queries ......................... [RUN]
[0m16:10:23.648200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.redshift.redshift_admin_dependencies, now model.redshift.redshift_admin_queries)
[0m16:10:23.649296 [debug] [Thread-4 (]: Began compiling node model.redshift.redshift_admin_queries
[0m16:10:23.655323 [debug] [Thread-4 (]: Writing injected SQL for node "model.redshift.redshift_admin_queries"
[0m16:10:23.656399 [debug] [Thread-4 (]: Began executing node model.redshift.redshift_admin_queries
[0m16:10:23.658298 [debug] [Thread-4 (]: Writing runtime sql for node "model.redshift.redshift_admin_queries"
[0m16:10:23.662295 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:23.662295 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m16:10:23.663297 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:23.663297 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:23.663297 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:24.098076 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.435 seconds
[0m16:10:24.099136 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.100131 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */


  create view "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" as (
    with  __dbt__cte__stl_query as (
select

  userid as user_id
, query as query_id
, xid as transaction_id
, label
, pid
, database
, starttime as started_at
, endtime as finished_at
, aborted

from pg_catalog.stl_query
),  __dbt__cte__pg_user as (
select

  usesysid as user_id
, usename as username

from pg_catalog.pg_user
),  __dbt__cte__stl_explain as (
select

  userid as user_id
, query as query_id
, nodeid
, parentid
, plannode
, info

from pg_catalog.stl_explain
),  __dbt__cte__redshift_cost as (
with stl_explain as (

  select query_id, plannode from __dbt__cte__stl_explain
  where nodeid = 1

), parse_step_one as (

  -- plannode (which contains cost) is formatted like:
  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)
  -- we want to rip out the cost part (0.00, 0.03) and make it usable.
  -- cost_string after this step is "0.00..0.03 ..."
  select
    query_id
  , split_part(plannode, 'cost=', 2) as cost_string

  from stl_explain

), parse_step_two as (

  select
    query_id
  , split_part(cost_string, '..', 1) as starting_cost
  , substring(
      split_part(cost_string, '..', 2)
      from 1
      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost

  from parse_step_one

)


select

  query_id
, starting_cost::float as starting_cost
, total_cost::float as total_cost

from parse_step_two
),  __dbt__cte__stl_wlm_query as (
select

  userid as user_id
, query as query_id
, xid
, task
, service_class
, slot_count
, service_class_start_time
, queue_start_time
, queue_end_time
, total_queue_time
, exec_start_time
, exec_end_time
, total_exec_time
, service_class_end_time
, final_state

from pg_catalog.stl_wlm_query
), queries as (

  select * from __dbt__cte__stl_query

), users as (

  select * from __dbt__cte__pg_user

), cost as (

  select * from __dbt__cte__redshift_cost

), timings as (

  select * from __dbt__cte__stl_wlm_query

)



select

  queries.query_id
, queries.transaction_id
, users.username::varchar

, cost.starting_cost
, cost.total_cost

, queries.started_at
, queries.finished_at

, timings.queue_start_time
, timings.queue_end_time
, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds

, timings.exec_start_time
, timings.exec_end_time
, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds

from queries

left join users
  on queries.user_id = users.user_id

left join cost
  on queries.query_id = cost.query_id

left join timings
  on queries.query_id = timings.query_id
  ) ;
[0m16:10:24.318796 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.217 seconds
[0m16:10:24.327913 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.328934 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries" rename to "redshift_admin_queries__dbt_backup"
[0m16:10:24.446587 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.117 seconds
[0m16:10:24.452574 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.453574 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
alter table "integrity-db"."dbt"."redshift_admin_queries__dbt_tmp" rename to "redshift_admin_queries"
[0m16:10:24.567612 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.113 seconds
[0m16:10:24.571085 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:10:24.572124 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.573140 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:10:24.758206 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.184 seconds
[0m16:10:24.759288 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.760191 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m16:10:24.849858 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.089 seconds
[0m16:10:24.853858 [debug] [Thread-4 (]: Applying DROP to: "integrity-db"."dbt"."redshift_admin_queries__dbt_backup"
[0m16:10:24.854860 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.854860 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "integrity_energy", "target_name": "dev", "node_id": "model.redshift.redshift_admin_queries"} */
drop view if exists "integrity-db"."dbt"."redshift_admin_queries__dbt_backup" cascade
[0m16:10:24.939638 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.083 seconds
[0m16:10:24.941637 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:10:24.942638 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:24.943638 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: COMMIT
[0m16:10:25.052397 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.108 seconds
[0m16:10:25.053380 [debug] [Thread-4 (]: Using redshift connection "model.redshift.redshift_admin_queries"
[0m16:10:25.054339 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: BEGIN
[0m16:10:25.095089 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.039 seconds
[0m16:10:25.097067 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: ROLLBACK
[0m16:10:25.177728 [debug] [Thread-4 (]: On model.redshift.redshift_admin_queries: Close
[0m16:10:25.178727 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b08e764-f188-40ec-9f67-a7dcbc469158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB35D88290>]}
[0m16:10:25.179728 [info ] [Thread-4 (]: 5 of 5 OK created sql view model dbt.redshift_admin_queries .................... [[32mSUCCESS[0m in 1.53s]
[0m16:10:25.180728 [debug] [Thread-4 (]: Finished running node model.redshift.redshift_admin_queries
[0m16:10:25.181729 [debug] [MainThread]: Using redshift connection "master"
[0m16:10:25.181729 [debug] [MainThread]: On master: BEGIN
[0m16:10:25.182727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:25.182727 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:10:25.182727 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:10:25.637732 [debug] [MainThread]: SQL status: SUCCESS in 0.455 seconds
[0m16:10:25.637732 [debug] [MainThread]: On master: COMMIT
[0m16:10:25.638728 [debug] [MainThread]: Using redshift connection "master"
[0m16:10:25.638728 [debug] [MainThread]: On master: COMMIT
[0m16:10:25.723786 [debug] [MainThread]: SQL status: SUCCESS in 0.084 seconds
[0m16:10:25.724808 [debug] [MainThread]: On master: Close
[0m16:10:25.725805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:25.727049 [debug] [MainThread]: Connection 'list_integrity-db' was properly closed.
[0m16:10:25.727049 [debug] [MainThread]: Connection 'list_integrity-db_dbt' was properly closed.
[0m16:10:25.728069 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_schema_privileges' was properly closed.
[0m16:10:25.728069 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_users_table_view_privileges' was properly closed.
[0m16:10:25.729224 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_table_stats' was properly closed.
[0m16:10:25.729224 [debug] [MainThread]: Connection 'model.redshift.redshift_admin_queries' was properly closed.
[0m16:10:25.730243 [info ] [MainThread]: 
[0m16:10:25.731706 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m16:10:25.733723 [debug] [MainThread]: Command end result
[0m16:10:25.874617 [info ] [MainThread]: 
[0m16:10:25.875626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:25.875626 [info ] [MainThread]: 
[0m16:10:25.876626 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:10:25.877626 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:25.877626 after 8.59 seconds
[0m16:10:25.878627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB32ED86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB32BC9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB30C4E4E0>]}
[0m16:10:25.878627 [debug] [MainThread]: Flushing usage events
[0m16:12:14.087831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DB76C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DB76E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DB76F0B0>]}


============================== 16:12:14.090843 | 7598ff56-c5b9-4ae8-90ec-a009ffb11db1 ==============================
[0m16:12:14.090843 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:12:14.090843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m16:12:14.157589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7598ff56-c5b9-4ae8-90ec-a009ffb11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DBC5DDF0>]}
[0m16:12:14.220978 [debug] [MainThread]: Command `dbt clean` succeeded at 16:12:14.220978 after 0.27 seconds
[0m16:12:14.220978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DBEBEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252D7A21C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DBC5DDF0>]}
[0m16:12:14.221978 [debug] [MainThread]: Flushing usage events
[0m16:12:32.595913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8064FEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8064FECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806C6BE60>]}


============================== 16:12:32.601653 | 8b0f11fd-7091-4127-8b88-db20806ab1df ==============================
[0m16:12:32.601653 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:12:32.602653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:12:32.669202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b0f11fd-7091-4127-8b88-db20806ab1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D80697F020>]}
[0m16:12:32.688592 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-30rght79'
[0m16:12:32.689846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:12:32.821421 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:12:32.822451 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:12:32.893274 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:12:32.903217 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:12:32.980458 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:12:32.984442 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m16:12:33.048768 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m16:12:33.060759 [info ] [MainThread]: Updating lock file in file path: C:\Development\IntegrityDBT/package-lock.yml
[0m16:12:33.069038 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-u3e09_9r'
[0m16:12:33.072038 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:12:33.409097 [info ] [MainThread]: Installed from version 1.0.0
[0m16:12:33.409097 [info ] [MainThread]: Updated version available: 1.2.0
[0m16:12:33.410097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b0f11fd-7091-4127-8b88-db20806ab1df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806C6BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806E983E0>]}
[0m16:12:33.410097 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:12:33.733794 [info ] [MainThread]: Installed from version 0.8.2
[0m16:12:33.734795 [info ] [MainThread]: Updated version available: 0.9.0
[0m16:12:33.735794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b0f11fd-7091-4127-8b88-db20806ab1df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806E983E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806B07800>]}
[0m16:12:33.735794 [info ] [MainThread]: Installing dbt-labs/codegen
[0m16:12:33.917159 [info ] [MainThread]: Installed from version 0.9.0
[0m16:12:33.918663 [info ] [MainThread]: Updated version available: 0.12.1
[0m16:12:33.918663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b0f11fd-7091-4127-8b88-db20806ab1df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806FB0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806FB1010>]}
[0m16:12:33.919669 [info ] [MainThread]: 
[0m16:12:33.919669 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_external_tables', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m16:12:33.921670 [debug] [MainThread]: Command `dbt deps` succeeded at 16:12:33.920669 after 1.44 seconds
[0m16:12:33.921670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806CB7B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806E45760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D806C2BBC0>]}
[0m16:12:33.921670 [debug] [MainThread]: Flushing usage events
[0m16:12:50.319014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155303AC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552E199280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155308F5D30>]}


============================== 16:12:50.322028 | 1a03015b-4e92-4168-aba8-8a2b5f8388a0 ==============================
[0m16:12:50.322028 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:12:50.323031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:12:50.420336 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:12:50.421321 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:12:50.517548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a03015b-4e92-4168-aba8-8a2b5f8388a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015530C21670>]}
[0m16:12:50.551101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a03015b-4e92-4168-aba8-8a2b5f8388a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155303D04A0>]}
[0m16:12:50.552134 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:12:50.579386 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:12:50.579386 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:12:50.579386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a03015b-4e92-4168-aba8-8a2b5f8388a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155315A49E0>]}
[0m16:12:51.428603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt
[0m16:12:51.432889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a03015b-4e92-4168-aba8-8a2b5f8388a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155327817F0>]}
[0m16:12:51.467921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a03015b-4e92-4168-aba8-8a2b5f8388a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001553277B530>]}
[0m16:12:51.467921 [info ] [MainThread]: Found 644 macros
[0m16:12:51.468921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a03015b-4e92-4168-aba8-8a2b5f8388a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155326731A0>]}
[0m16:12:51.469921 [info ] [MainThread]: 
[0m16:12:51.470791 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:12:51.470791 [debug] [MainThread]: Command end result
[0m16:12:51.487853 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:51.487853 after 1.26 seconds
[0m16:12:51.487853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155303AC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015530AA5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015530AA5FA0>]}
[0m16:12:51.487853 [debug] [MainThread]: Flushing usage events
[0m16:13:38.959472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A426094F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A44D8BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A44D8A060>]}


============================== 16:13:38.963610 | e512edbc-5498-4959-b0d6-b7551b660d8d ==============================
[0m16:13:38.963610 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:13:38.964609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:39.030269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e512edbc-5498-4959-b0d6-b7551b660d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A450344D0>]}
[0m16:13:39.085087 [debug] [MainThread]: Command `dbt clean` succeeded at 16:13:39.085087 after 0.26 seconds
[0m16:13:39.085087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A426094F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A44D34E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A44CDDBE0>]}
[0m16:13:39.085087 [debug] [MainThread]: Flushing usage events
[0m16:13:48.126469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE15092E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE3DC3E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE3DC3020>]}


============================== 16:13:48.129492 | 61de4fd3-1f3a-45ec-8842-614d92e9a134 ==============================
[0m16:13:48.129492 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:13:48.130474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:13:48.196519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61de4fd3-1f3a-45ec-8842-614d92e9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE3F30AA0>]}
[0m16:13:48.216474 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-vlbg1e3g'
[0m16:13:48.216474 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:13:48.343731 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:13:48.345724 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:13:48.417955 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:13:48.428947 [info ] [MainThread]: Updating lock file in file path: C:\Development\IntegrityDBT/package-lock.yml
[0m16:13:48.435948 [debug] [MainThread]: Set downloads directory='C:\Users\seanm\AppData\Local\Temp\dbt-downloads-5r0a70cw'
[0m16:13:48.437947 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:13:48.771952 [info ] [MainThread]: Installed from version 1.0.0
[0m16:13:48.772952 [info ] [MainThread]: Updated version available: 1.2.0
[0m16:13:48.772952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '61de4fd3-1f3a-45ec-8842-614d92e9a134', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE1AEACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE40D3470>]}
[0m16:13:48.773952 [info ] [MainThread]: 
[0m16:13:48.773952 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:13:48.774952 [debug] [MainThread]: Command `dbt deps` succeeded at 16:13:48.774952 after 0.73 seconds
[0m16:13:48.775953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE15092E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE3E54CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE34D2FF0>]}
[0m16:13:48.775953 [debug] [MainThread]: Flushing usage events
[0m16:13:53.293145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E3C59670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E61D6FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E2DF07A0>]}


============================== 16:13:53.296171 | 83aa97b9-6813-4c6a-922f-ca5dc3863dbc ==============================
[0m16:13:53.296171 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:13:53.297150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Development\\IntegrityDBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:13:53.389158 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:13:53.389158 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:13:53.484118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83aa97b9-6813-4c6a-922f-ca5dc3863dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E651C860>]}
[0m16:13:53.517060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83aa97b9-6813-4c6a-922f-ca5dc3863dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E65A49E0>]}
[0m16:13:53.518060 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:13:53.530258 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:13:53.530258 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:13:53.531634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83aa97b9-6813-4c6a-922f-ca5dc3863dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E706F530>]}
[0m16:13:54.123074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integrity_energy_dbt
[0m16:13:54.161081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83aa97b9-6813-4c6a-922f-ca5dc3863dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E6FF5F40>]}
[0m16:13:54.193482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83aa97b9-6813-4c6a-922f-ca5dc3863dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E8131B80>]}
[0m16:13:54.194483 [info ] [MainThread]: Found 593 macros
[0m16:13:54.194483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83aa97b9-6813-4c6a-922f-ca5dc3863dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E8145430>]}
[0m16:13:54.195482 [info ] [MainThread]: 
[0m16:13:54.196481 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:13:54.196481 [debug] [MainThread]: Command end result
[0m16:13:54.212034 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:54.212034 after 1.00 seconds
[0m16:13:54.213040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E6329A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E63B3CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E5958BC0>]}
[0m16:13:54.213040 [debug] [MainThread]: Flushing usage events
[0m16:15:34.936921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511DE3C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511DE1E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511DCA4140>]}


============================== 16:15:34.940967 | 5c273cdd-a542-40aa-9236-f96e6b3f307a ==============================
[0m16:15:34.940967 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:15:34.940967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Development\\IntegrityDBT', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m16:15:34.940967 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Development\IntegrityDBT\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:15:34.942255 [debug] [MainThread]: Command `dbt list` failed at 16:15:34.942255 after 0.16 seconds
[0m16:15:34.942255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511DB53890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511DC24EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002511DE1E9F0>]}
[0m16:15:34.943264 [debug] [MainThread]: Flushing usage events
[0m10:22:52.663930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8CA66960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8C09D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8C09DB80>]}


============================== 10:22:52.673629 | 517e6bca-07a4-461a-ac05-e448cd7050a7 ==============================
[0m10:22:52.673629 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:22:52.675655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:52.675655 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Development\IntegrityDBT\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m10:22:52.676653 [debug] [MainThread]: Command `dbt clean` failed at 10:22:52.676653 after 0.12 seconds
[0m10:22:52.676653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8C32F020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8B9ACB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8CA64E90>]}
[0m10:22:52.677652 [debug] [MainThread]: Flushing usage events
[0m10:24:20.812891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6E8EF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6E8ED340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6E8EC050>]}


============================== 10:24:20.818940 | 3d1b0c4c-4582-4a30-adf1-e009ad503f84 ==============================
[0m10:24:20.818940 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:24:20.819940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:20.819940 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Development\IntegrityDBT\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m10:24:20.820940 [debug] [MainThread]: Command `dbt clean` failed at 10:24:20.820940 after 0.16 seconds
[0m10:24:20.821940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6F03EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6E41D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6E8EF260>]}
[0m10:24:20.821940 [debug] [MainThread]: Flushing usage events
[0m09:59:53.934311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93C4FFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93D247620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93D247380>]}


============================== 09:59:53.940218 | d6853bc3-38c6-425b-a25b-52278ffd7a7b ==============================
[0m09:59:53.940218 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:59:53.941225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:53.941225 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Development\IntegrityDBT\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m09:59:53.942226 [debug] [MainThread]: Command `dbt clean` failed at 09:59:53.942226 after 0.12 seconds
[0m09:59:53.942226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93D3748F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93CA043B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A93D2F1D30>]}
[0m09:59:53.943225 [debug] [MainThread]: Flushing usage events
[0m16:47:01.350405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA483BF8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA44B6CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4AC30440>]}


============================== 16:47:01.353541 | 0e80ba79-1e14-4de5-a7ca-768403ddf451 ==============================
[0m16:47:01.353541 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:47:01.354514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\seanm\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:01.355515 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Development\IntegrityDBT\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:47:01.355515 [debug] [MainThread]: Command `dbt clean` failed at 16:47:01.355515 after 0.15 seconds
[0m16:47:01.356514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4A949640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA483E9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4ACF45F0>]}
[0m16:47:01.356514 [debug] [MainThread]: Flushing usage events
[0m15:58:46.091759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DD8D0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E081D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E07D8350>]}


============================== 15:58:46.094762 | 72fe2aa3-aab1-481c-8809-4412cf86d04a ==============================
[0m15:58:46.094762 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:58:46.095760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:46.096762 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\2ewol\Documents\Clients\Integrity_Energy\integrity-energy-dbt\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:58:46.096762 [debug] [MainThread]: Command `dbt deps` failed at 15:58:46.096762 after 0.08 seconds
[0m15:58:46.097762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E083D890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DA51A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267E07D8750>]}
[0m15:58:46.098762 [debug] [MainThread]: Flushing usage events
[0m15:58:46.295740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:15.213648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445A2BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445A29C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445A2BB10>]}


============================== 16:00:15.213648 | e19b1518-fef9-4b57-a49b-94baaae3dad0 ==============================
[0m16:00:15.213648 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:00:15.213648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:15.314344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e19b1518-fef9-4b57-a49b-94baaae3dad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445AA9A50>]}
[0m16:00:15.409840 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-7f52i7qe'
[0m16:00:15.409840 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:00:15.713071 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:00:15.714080 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:00:15.858425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:00:15.863338 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:00:16.385522 [info ] [MainThread]: Installed from version 1.0.0
[0m16:00:16.385522 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:00:16.386606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e19b1518-fef9-4b57-a49b-94baaae3dad0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445AAA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445B645D0>]}
[0m16:00:16.386606 [info ] [MainThread]: 
[0m16:00:16.387670 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:00:16.389828 [debug] [MainThread]: Command `dbt deps` succeeded at 16:00:16.388821 after 1.24 seconds
[0m16:00:16.389828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43F86A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43F5CFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C445736CD0>]}
[0m16:00:16.389828 [debug] [MainThread]: Flushing usage events
[0m16:00:16.637176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:43.578107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB321DF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB31DB490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB31D9490>]}


============================== 16:05:43.581108 | 49365e2a-4fb2-4aab-a66e-2616029b25cf ==============================
[0m16:05:43.581108 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:05:43.582108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:43.679138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49365e2a-4fb2-4aab-a66e-2616029b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB2EE6D50>]}
[0m16:05:43.733921 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-lejxdwx7'
[0m16:05:43.734921 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:05:44.071109 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:05:44.071614 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:05:44.195547 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:05:44.199545 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:05:44.708494 [info ] [MainThread]: Installed from version 1.0.0
[0m16:05:44.709494 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:05:44.709494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49365e2a-4fb2-4aab-a66e-2616029b25cf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB3314250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB32280D0>]}
[0m16:05:44.710494 [info ] [MainThread]: 
[0m16:05:44.710494 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:05:44.711889 [debug] [MainThread]: Command `dbt deps` succeeded at 16:05:44.711889 after 1.20 seconds
[0m16:05:44.711889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB321F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FACFEA010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB31FAC50>]}
[0m16:05:44.712977 [debug] [MainThread]: Flushing usage events
[0m16:05:44.975329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:05.143051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA53AEBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA53AEAB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA53AEB690>]}


============================== 16:06:05.143051 | 36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad ==============================
[0m16:06:05.143051 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:06:05.143051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select tags:daily --target dev', 'send_anonymous_usage_stats': 'True'}
[0m16:06:05.378002 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:06:05.379012 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:06:05.526691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA543EEC50>]}
[0m16:06:05.568691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA50BF0F50>]}
[0m16:06:05.570946 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:06:05.583842 [debug] [MainThread]: checksum: 28c00772bd96551ae2f98126ebf7713c9e121e5f4a1fdbf780c14a568fdbecdb, vars: {}, profile: , target: dev, version: 1.9.0b2
[0m16:06:05.613997 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:06:05.613997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA53613E90>]}
[0m16:06:06.735823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA55707A10>]}
[0m16:06:06.815663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA544F8850>]}
[0m16:06:06.815663 [info ] [MainThread]: Found 20 models, 20 sources, 602 macros
[0m16:06:06.816663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36b36c0d-0f15-4ed3-8d8d-0a6b39e8e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA556B3250>]}
[0m16:06:06.816663 [error] [MainThread]: Encountered an error:
Runtime Error
  'tags' is not a valid method name
[0m16:06:06.817666 [debug] [MainThread]: Command `dbt run` failed at 16:06:06.817666 after 1.74 seconds
[0m16:06:06.817666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4D84E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA52A40AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA53ADFD90>]}
[0m16:06:06.817666 [debug] [MainThread]: Flushing usage events
[0m16:06:07.072189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:14.501912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214817722D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148172A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214817298D0>]}


============================== 16:06:14.504917 | 319bbfc8-609c-4e54-9962-747e56777b14 ==============================
[0m16:06:14.504917 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:06:14.504917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:daily --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:06:14.629008 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:06:14.629515 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:06:14.753989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FFB6F2D0>]}
[0m16:06:14.795990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FE7CD2D0>]}
[0m16:06:14.796989 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:06:14.810321 [debug] [MainThread]: checksum: 28c00772bd96551ae2f98126ebf7713c9e121e5f4a1fdbf780c14a568fdbecdb, vars: {}, profile: , target: dev, version: 1.9.0b2
[0m16:06:14.959311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:14.959311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:14.984310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214832FCE90>]}
[0m16:06:15.053921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214831B3D50>]}
[0m16:06:15.054984 [info ] [MainThread]: Found 20 models, 20 sources, 602 macros
[0m16:06:15.055827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148214B0D0>]}
[0m16:06:15.057825 [info ] [MainThread]: 
[0m16:06:15.057825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:15.058828 [info ] [MainThread]: 
[0m16:06:15.058828 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:06:15.062825 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:06:15.063832 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:06:15.064826 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:06:15.077828 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:06:15.079829 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:06:15.081826 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:06:15.081826 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:06:15.082830 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:06:15.083836 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:06:15.083836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:15.083836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:15.084830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:15.087830 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:15.087830 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:15.088827 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:15.089830 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:15.090830 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:15.090830 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:16.334232 [debug] [ThreadPool]: SQL status: SUCCESS in 1.250 seconds
[0m16:06:16.335236 [debug] [ThreadPool]: SQL status: SUCCESS in 1.251 seconds
[0m16:06:16.335236 [debug] [ThreadPool]: SQL status: SUCCESS in 1.251 seconds
[0m16:06:16.337224 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:06:16.338231 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:06:16.339226 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:06:16.341229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_integrity-db-dev, now create_integrity-db-dev_prod-dbt-base)
[0m16:06:16.342228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_integrity-db-dev, now create_integrity-db-dev_prod-dbt-intermediate)
[0m16:06:16.342228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_integrity-db-dev, now create_integrity-db-dev_prod-dbt-mart)
[0m16:06:16.343225 [debug] [ThreadPool]: Creating schema "database: "integrity-db-dev"
schema: "prod-dbt-base"
"
[0m16:06:16.343225 [debug] [ThreadPool]: Creating schema "database: "integrity-db-dev"
schema: "prod-dbt-intermediate"
"
[0m16:06:16.344224 [debug] [ThreadPool]: Creating schema "database: "integrity-db-dev"
schema: "prod-dbt-mart"
"
[0m16:06:16.350228 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-base"
[0m16:06:16.352665 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-intermediate"
[0m16:06:16.354186 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-mart"
[0m16:06:16.354186 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-base: BEGIN
[0m16:06:16.355184 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-intermediate: BEGIN
[0m16:06:16.355184 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-mart: BEGIN
[0m16:06:16.355184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:16.356187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:16.356187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:16.357184 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:16.357184 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:16.357184 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:16.358185 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:16.358185 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:16.358185 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:16.876832 [debug] [ThreadPool]: SQL status: SUCCESS in 0.521 seconds
[0m16:06:16.877793 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-base"
[0m16:06:16.877793 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "create_integrity-db-dev_prod-dbt-base"} */
create schema if not exists "prod-dbt-base"
[0m16:06:16.891869 [debug] [ThreadPool]: SQL status: SUCCESS in 0.536 seconds
[0m16:06:16.893308 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-mart"
[0m16:06:16.893308 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-mart: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "create_integrity-db-dev_prod-dbt-mart"} */
create schema if not exists "prod-dbt-mart"
[0m16:06:16.898205 [debug] [ThreadPool]: SQL status: SUCCESS in 0.542 seconds
[0m16:06:16.899229 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-intermediate"
[0m16:06:16.899229 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "create_integrity-db-dev_prod-dbt-intermediate"} */
create schema if not exists "prod-dbt-intermediate"
[0m16:06:17.055341 [debug] [ThreadPool]: SQL status: SUCCESS in 0.177 seconds
[0m16:06:17.057340 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-base: COMMIT
[0m16:06:17.057340 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-base"
[0m16:06:17.058339 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-base: COMMIT
[0m16:06:17.082172 [debug] [ThreadPool]: SQL status: SUCCESS in 0.188 seconds
[0m16:06:17.083157 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-mart: COMMIT
[0m16:06:17.084351 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-mart"
[0m16:06:17.084351 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-mart: COMMIT
[0m16:06:17.112479 [debug] [ThreadPool]: SQL status: SUCCESS in 0.212 seconds
[0m16:06:17.113495 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-intermediate: COMMIT
[0m16:06:17.113495 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_prod-dbt-intermediate"
[0m16:06:17.114503 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-intermediate: COMMIT
[0m16:06:17.268028 [debug] [ThreadPool]: SQL status: SUCCESS in 0.209 seconds
[0m16:06:17.268028 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-base: Close
[0m16:06:17.275172 [debug] [ThreadPool]: SQL status: SUCCESS in 0.191 seconds
[0m16:06:17.276137 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-mart: Close
[0m16:06:17.336372 [debug] [ThreadPool]: SQL status: SUCCESS in 0.221 seconds
[0m16:06:17.336372 [debug] [ThreadPool]: On create_integrity-db-dev_prod-dbt-intermediate: Close
[0m16:06:17.339654 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-base'
[0m16:06:17.341073 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-intermediate'
[0m16:06:17.347080 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-base"
[0m16:06:17.348080 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-mart'
[0m16:06:17.353080 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-intermediate"
[0m16:06:17.354085 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: BEGIN
[0m16:06:17.356079 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-mart"
[0m16:06:17.357089 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: BEGIN
[0m16:06:17.357089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:17.357089 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: BEGIN
[0m16:06:17.358086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:17.359084 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:17.359084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:17.359084 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:17.359084 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:17.360462 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:17.360462 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:17.361909 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:17.872672 [debug] [ThreadPool]: SQL status: SUCCESS in 0.514 seconds
[0m16:06:17.872672 [debug] [ThreadPool]: SQL status: SUCCESS in 0.514 seconds
[0m16:06:17.873672 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-intermediate"
[0m16:06:17.873672 [debug] [ThreadPool]: SQL status: SUCCESS in 0.516 seconds
[0m16:06:17.873672 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-mart"
[0m16:06:17.874671 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-intermediate"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-intermediate'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-intermediate'
[0m16:06:17.874671 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-base"
[0m16:06:17.875672 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-mart"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-mart'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-mart'
[0m16:06:17.876674 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-base"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-base'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-base'
[0m16:06:17.991853 [debug] [ThreadPool]: SQL status: SUCCESS in 0.116 seconds
[0m16:06:17.994268 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: ROLLBACK
[0m16:06:18.013576 [debug] [ThreadPool]: SQL status: SUCCESS in 0.136 seconds
[0m16:06:18.013576 [debug] [ThreadPool]: SQL status: SUCCESS in 0.137 seconds
[0m16:06:18.015726 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: ROLLBACK
[0m16:06:18.016231 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: ROLLBACK
[0m16:06:18.055319 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: Close
[0m16:06:18.081652 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: Close
[0m16:06:18.088332 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: Close
[0m16:06:18.096626 [debug] [MainThread]: Using redshift connection "master"
[0m16:06:18.097626 [debug] [MainThread]: On master: BEGIN
[0m16:06:18.097626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:18.097626 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:18.099104 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:18.465407 [debug] [MainThread]: SQL status: SUCCESS in 0.367 seconds
[0m16:06:18.466307 [debug] [MainThread]: Using redshift connection "master"
[0m16:06:18.466307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:06:18.569341 [debug] [MainThread]: SQL status: SUCCESS in 0.102 seconds
[0m16:06:18.571341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FF307DD0>]}
[0m16:06:18.571341 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:18.638401 [debug] [MainThread]: Using redshift connection "master"
[0m16:06:18.639412 [debug] [MainThread]: On master: BEGIN
[0m16:06:18.671713 [debug] [MainThread]: SQL status: SUCCESS in 0.032 seconds
[0m16:06:18.672728 [debug] [MainThread]: On master: COMMIT
[0m16:06:18.672728 [debug] [MainThread]: Using redshift connection "master"
[0m16:06:18.672728 [debug] [MainThread]: On master: COMMIT
[0m16:06:18.741451 [debug] [MainThread]: SQL status: SUCCESS in 0.068 seconds
[0m16:06:18.742546 [debug] [MainThread]: On master: Close
[0m16:06:18.756043 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:06:18.756043 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.deal_intermediate
[0m16:06:18.757045 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.deal_prod
[0m16:06:18.757045 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.facebook_daily_base
[0m16:06:18.758043 [info ] [Thread-1 (]: 1 of 20 START sql view model prod-dbt-base.bing_ads_daily_base ................. [RUN]
[0m16:06:18.758043 [info ] [Thread-2 (]: 2 of 20 START sql view model prod-dbt-intermediate.deal_intermediate ........... [RUN]
[0m16:06:18.759045 [info ] [Thread-3 (]: 3 of 20 START sql table model prod-dbt-mart.deal_prod .......................... [RUN]
[0m16:06:18.759045 [info ] [Thread-4 (]: 4 of 20 START sql view model prod-dbt-base.facebook_daily_base ................. [RUN]
[0m16:06:18.760047 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.bing_ads_daily_base'
[0m16:06:18.761044 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.deal_intermediate'
[0m16:06:18.761044 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.deal_prod'
[0m16:06:18.761044 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.facebook_daily_base'
[0m16:06:18.762044 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:06:18.762044 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.deal_intermediate
[0m16:06:18.763043 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.deal_prod
[0m16:06:18.763043 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.facebook_daily_base
[0m16:06:18.766048 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:06:18.769042 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.deal_intermediate"
[0m16:06:18.771042 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.deal_prod"
[0m16:06:18.775044 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:06:18.777047 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:06:18.778044 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.deal_prod
[0m16:06:18.778044 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.facebook_daily_base
[0m16:06:18.831689 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.deal_intermediate
[0m16:06:18.857135 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:06:18.876122 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:06:18.881601 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.deal_prod"
[0m16:06:18.884588 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.deal_intermediate"
[0m16:06:18.887777 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.deal_prod"
[0m16:06:18.888783 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:06:18.889782 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:06:18.897782 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.deal_intermediate"
[0m16:06:18.898015 [debug] [Thread-3 (]: On model.integrity_energy_dbt.deal_prod: BEGIN
[0m16:06:18.898015 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: BEGIN
[0m16:06:18.899031 [debug] [Thread-4 (]: On model.integrity_energy_dbt.facebook_daily_base: BEGIN
[0m16:06:18.899031 [debug] [Thread-2 (]: On model.integrity_energy_dbt.deal_intermediate: BEGIN
[0m16:06:18.899031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:06:18.899031 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:06:18.900286 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:06:18.900286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:06:18.901291 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:18.901291 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:18.901291 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:18.902672 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:18.902672 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:18.902672 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:18.903677 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:18.903677 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:19.357765 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.457 seconds
[0m16:06:19.357765 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.459 seconds
[0m16:06:19.359083 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.459 seconds
[0m16:06:19.359083 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.458 seconds
[0m16:06:19.359083 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:06:19.360188 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.deal_prod"
[0m16:06:19.360188 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:06:19.361198 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.deal_intermediate"
[0m16:06:19.361198 [debug] [Thread-4 (]: On model.integrity_energy_dbt.facebook_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.facebook_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."facebook_daily_base__dbt_tmp" as (
    

select
    date_start, 
    sum(impressions) as facebook_impressions,
    sum(reach) as facebook_reach,
    sum(spend) as facebook_spend, 
    sum(clicks) as facebook_clicks,
    sum(unique_clicks) as facebook_unique_clicks
from facebook.ads_insights
group by date_start
  ) ;
[0m16:06:19.362246 [debug] [Thread-3 (]: On model.integrity_energy_dbt.deal_prod: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.deal_prod"} */

  
    

  create  table
    "integrity-db-dev"."prod-dbt-mart"."deal_prod__dbt_tmp"
    
    
    
  as (
    

select
    *
from "integrity-db"."prod-dbt-intermediate"."deal_intermediate"
  );
[0m16:06:19.362246 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.bing_ads_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."bing_ads_daily_base__dbt_tmp" as (
    

select
    spend,
    impressions,
    clicks,
    timeperiod,
    adgroupname,
    campaignname
from bing_ads.ad_performance_report_daily
  ) ;
[0m16:06:19.363254 [debug] [Thread-2 (]: On model.integrity_energy_dbt.deal_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.deal_intermediate"} */


  create view "integrity-db-dev"."prod-dbt-intermediate"."deal_intermediate__dbt_tmp" as (
    

with salesforce_opportunities as (
    select
        id,
        name,
        type,
        iswon,
        fiscal,
        mils__c,
        ownerid,
        rate__c,
        term__c,
        team__c,
        source__c,
        marketing_generator__c,
        isclosed,
        notes__c,
        accountid,
        csdate__c,
        closedate,
        driver__c,
        meters__c,
        points__c,
        stagename,
        status__c,
        channel__c,
        leadsource,
        manager__c,
        re_sold__c,
        renewed__c,
        createddate,
        residual__c,
        sp_rt_id__c,
        subagent__c,
        supplier__c,
        commodity__c,
        rate_type__c,
        sp_points__c,
        sold_date__c,
        broker_fee__c,
        cancel_fee__c,
        usage_type__c,
        cancel_date__c,
        dl_rate_gas__c,
        dl_owner_alias__c,
        dl_term_gas__c,
        lost_reason__c,
        meter_usage__c,
        owner_title__c,
        real_points__c,
        total_usage__c,
        dl_start_gas__c,
        dl_usage_gas__c,
        do_not_renew__c,
        renewal_date__c,
        sales_person__c,
        total_points__c,
        utility_text__c,
        sales_manager__c,
        supplier_text__c,
        agent_takeback__c,
        canceled_usage__c,
        commodity_text__c,
        contract_signer__c,
        cancelled_points__c,
        supplier_credits__c,
        commission_matrix__c,
        contract_end_date__c,
        broker_fee_rounded__c,
        commission_percent__c,
        last_activity_note__c,
        confirmation_number__c,
        contract_start_date__c,
        contract_signer_email__c,
        contract_signer_phone_email__c,
        contract_signer_facilitator__c
    from "integrity-db"."prod-dbt-base"."salesforce_opportunity_base"
),

salesforce_contacts as (
    select
        id as contact_id,
        name as contact_name,
        email as contact_email,
        phone as contact_phone,
        mobilephone as contact_mobilephone,
        main_phone__c as contact_mainphone,
        title as contact_title,
        createddate as contact_createddate,
        mailingcity as contact_mailingcity,
        mailingstate as contact_mailingstate,
        mailingstatecode as contact_mailingstatecode,
        mailingcountry as contact_mailingcountry,
        accountid as contact_accountid,
        rep_last_first__c as contact_rep_last_first,
        customer_account_number__c as contact_customer_account_number,
        contract_signer_phone_email__c as contact_contract_signer_phone_email
    from "integrity-db"."prod-dbt-base"."salesforce_contact_base"
),

salesforce_leads as (
    select
        id as lead_id,
        city as lead_city,
        name as lead_name,
        email as lead_email,
        phone as lead_phone,
        state as lead_state,
        title as lead_title,
        status as lead_status,
        street as lead_street,
        company as lead_company,
        country as lead_country,
        firstname as lead_firstname,
        lastname as lead_lastname,
        source__c as lead_source,
        channel__c as lead_channel,
        leadsource as lead_leadsource,
        postalcode as lead_postalcode,
        createddate as lead_createddate,
        isconverted as lead_isconverted,
        commodity__c as lead_commodity,
        converteddate as lead_converteddate,
        lastactivitydate as lead_lastactivitydate,
        convertedaccountid as lead_convertedaccountid,
        convertedcontactid as lead_convertedcontactid,
        average_bill_amount__c as lead_average_bill_amount,
        convertedopportunityid as lead_convertedopportunityid,
        marketing_generator__c as lead_marketing_generator,
        new_ready_to_work_date__c as lead_new_ready_to_work_date
    from "integrity-db"."prod-dbt-base"."salesforce_lead_base"
)

select
*
from salesforce_opportunities as o
left join salesforce_leads as l on l.lead_convertedcontactid = o.contract_signer__c
left join salesforce_contacts as c on c.contact_id = o.contract_signer__c
  ) ;
[0m16:06:19.399150 [debug] [Thread-3 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:19.399150 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "facebook" does not exist
[0m16:06:19.400150 [debug] [Thread-3 (]: On model.integrity_energy_dbt.deal_prod: ROLLBACK
[0m16:06:19.401151 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "bing_ads" does not exist
[0m16:06:19.401658 [debug] [Thread-4 (]: On model.integrity_energy_dbt.facebook_daily_base: ROLLBACK
[0m16:06:19.401658 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: ROLLBACK
[0m16:06:19.405663 [debug] [Thread-2 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:19.405663 [debug] [Thread-2 (]: On model.integrity_energy_dbt.deal_intermediate: ROLLBACK
[0m16:06:19.467181 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: Close
[0m16:06:19.468182 [debug] [Thread-4 (]: On model.integrity_energy_dbt.facebook_daily_base: Close
[0m16:06:19.468182 [debug] [Thread-2 (]: On model.integrity_energy_dbt.deal_intermediate: Close
[0m16:06:19.475161 [debug] [Thread-3 (]: On model.integrity_energy_dbt.deal_prod: Close
[0m16:06:19.481748 [debug] [Thread-4 (]: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:06:19.481748 [debug] [Thread-1 (]: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:06:19.485255 [debug] [Thread-3 (]: Database Error in model deal_prod (models\prod-dbt-mart\deal_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\deal_prod.sql
[0m16:06:19.485255 [debug] [Thread-2 (]: Database Error in model deal_intermediate (models\prod-dbt-intermediate\deal_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\deal_intermediate.sql
[0m16:06:19.488647 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483AA7C90>]}
[0m16:06:19.488647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214832D74D0>]}
[0m16:06:19.488647 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FFA45350>]}
[0m16:06:19.488647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483A370D0>]}
[0m16:06:19.488647 [error] [Thread-4 (]: 4 of 20 ERROR creating sql view model prod-dbt-base.facebook_daily_base ........ [[31mERROR[0m in 0.72s]
[0m16:06:19.488647 [error] [Thread-1 (]: 1 of 20 ERROR creating sql view model prod-dbt-base.bing_ads_daily_base ........ [[31mERROR[0m in 0.73s]
[0m16:06:19.488647 [error] [Thread-3 (]: 3 of 20 ERROR creating sql table model prod-dbt-mart.deal_prod ................. [[31mERROR[0m in 0.73s]
[0m16:06:19.488647 [error] [Thread-2 (]: 2 of 20 ERROR creating sql view model prod-dbt-intermediate.deal_intermediate .. [[31mERROR[0m in 0.73s]
[0m16:06:19.488647 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.facebook_daily_base
[0m16:06:19.488647 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:06:19.488647 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.deal_prod
[0m16:06:19.496579 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.deal_intermediate
[0m16:06:19.497084 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:06:19.497084 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.facebook_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql.
[0m16:06:19.497084 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:06:19.497084 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.lead_intermediate
[0m16:06:19.497084 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.lead_prod
[0m16:06:19.497084 [info ] [Thread-4 (]: 5 of 20 START sql view model prod-dbt-base.google_ads_daily_base ............... [RUN]
[0m16:06:19.497084 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.bing_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql.
[0m16:06:19.497084 [info ] [Thread-1 (]: 6 of 20 START sql view model prod-dbt-base.hubspot_daily_base .................. [RUN]
[0m16:06:19.501102 [info ] [Thread-3 (]: 7 of 20 START sql view model prod-dbt-intermediate.lead_intermediate ........... [RUN]
[0m16:06:19.501102 [info ] [Thread-2 (]: 8 of 20 START sql table model prod-dbt-mart.lead_prod .......................... [RUN]
[0m16:06:19.502968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.facebook_daily_base, now model.integrity_energy_dbt.google_ads_daily_base)
[0m16:06:19.502968 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.deal_prod' to be skipped because of status 'error'.  Reason: Database Error in model deal_prod (models\prod-dbt-mart\deal_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\deal_prod.sql.
[0m16:06:19.502968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.bing_ads_daily_base, now model.integrity_energy_dbt.hubspot_daily_base)
[0m16:06:19.502968 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.deal_prod, now model.integrity_energy_dbt.lead_intermediate)
[0m16:06:19.502968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.deal_intermediate, now model.integrity_energy_dbt.lead_prod)
[0m16:06:19.502968 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.google_ads_daily_base
[0m16:06:19.502968 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.deal_intermediate' to be skipped because of status 'error'.  Reason: Database Error in model deal_intermediate (models\prod-dbt-intermediate\deal_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\deal_intermediate.sql.
[0m16:06:19.502968 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.hubspot_daily_base
[0m16:06:19.502968 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.lead_intermediate
[0m16:06:19.502968 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.lead_prod
[0m16:06:19.513175 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:06:19.517178 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:06:19.521340 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.lead_intermediate"
[0m16:06:19.521340 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.lead_prod"
[0m16:06:19.529172 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.lead_intermediate
[0m16:06:19.529172 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.lead_prod
[0m16:06:19.532483 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.lead_intermediate"
[0m16:06:19.532483 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.lead_prod"
[0m16:06:19.532483 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.google_ads_daily_base
[0m16:06:19.532483 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.hubspot_daily_base
[0m16:06:19.545105 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.lead_intermediate"
[0m16:06:19.548609 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:06:19.548609 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.lead_prod"
[0m16:06:19.548609 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:06:19.548609 [debug] [Thread-3 (]: On model.integrity_energy_dbt.lead_intermediate: BEGIN
[0m16:06:19.548609 [debug] [Thread-2 (]: On model.integrity_energy_dbt.lead_prod: BEGIN
[0m16:06:19.561201 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:06:19.561201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:19.561201 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:19.564725 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:06:19.564725 [debug] [Thread-4 (]: On model.integrity_energy_dbt.google_ads_daily_base: BEGIN
[0m16:06:19.564725 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:19.564725 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:19.564725 [debug] [Thread-1 (]: On model.integrity_energy_dbt.hubspot_daily_base: BEGIN
[0m16:06:19.564725 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:19.564725 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:19.564725 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:19.564725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:19.568641 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:19.569161 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:19.569161 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:19.569161 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:19.954629 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.390 seconds
[0m16:06:19.954629 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:06:19.954629 [debug] [Thread-1 (]: On model.integrity_energy_dbt.hubspot_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.hubspot_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."hubspot_daily_base__dbt_tmp" as (
    

with hubspot_daily as (
    SELECT
        (TIMESTAMP 'epoch' + created / 1000 * INTERVAL '1 second')::DATE AS converted_date,
        type
    FROM "integrity-db"."hubspot"."email_events")

SELECT
    converted_date,
    sum(case when type = 'SENT' then 1 else 0 end) as sent_emails,
    sum(case when type = 'OPEN' then 1 else 0 end) as opened_emails,
    sum(case when type = 'CLICK' then 1 else 0 end) as clicks,
    sum(case when type = 'BOUNCE' then 1 else 0 end) as bounces,
    sum(case when type = 'SPAMREPORT' then 1 else 0 end) as spam_reports
from hubspot_daily
group by converted_date
order by converted_date desc
  ) ;
[0m16:06:19.980118 [debug] [Thread-1 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:19.980118 [debug] [Thread-1 (]: On model.integrity_energy_dbt.hubspot_daily_base: ROLLBACK
[0m16:06:20.002040 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.440 seconds
[0m16:06:20.002040 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.lead_prod"
[0m16:06:20.002040 [debug] [Thread-2 (]: On model.integrity_energy_dbt.lead_prod: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.lead_prod"} */

  
    

  create  table
    "integrity-db-dev"."prod-dbt-mart"."lead_prod__dbt_tmp"
    
    
    
  as (
    

select
    *
from "integrity-db"."prod-dbt-intermediate"."lead_intermediate"
  );
[0m16:06:20.009875 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.449 seconds
[0m16:06:20.009875 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.lead_intermediate"
[0m16:06:20.009875 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.445 seconds
[0m16:06:20.009875 [debug] [Thread-3 (]: On model.integrity_energy_dbt.lead_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.lead_intermediate"} */


  create view "integrity-db-dev"."prod-dbt-intermediate"."lead_intermediate__dbt_tmp" as (
    

with salesforce_leads as (
    select
        id as lead_id,
        city as lead_city,
        name as lead_name,
        email as lead_email,
        phone as lead_phone,
        state as lead_state,
        title as lead_title,
        status as lead_status,
        street as lead_street,
        company as lead_company,
        country as lead_country,
        firstname as lead_firstname,
        lastname as lead_lastname,
        source__c as lead_source,
        channel__c as lead_channel,
        leadsource as lead_leadsource,
        postalcode as lead_postalcode,
        createddate as lead_createddate,
        createdday as lead_createdday,
        isconverted as lead_isconverted,
        commodity__c as lead_commodity,
        converteddate as lead_converteddate,
        lastactivitydate as lead_lastactivitydate,
        convertedaccountid as lead_convertedaccountid,
        convertedcontactid as lead_convertedcontactid,
        average_bill_amount__c as lead_average_bill_amount,
        convertedopportunityid as lead_convertedopportunityid,
        marketing_generator__c as lead_marketing_generator,
        new_ready_to_work_date__c as lead_new_ready_to_work_date,
        Concat(company,regexp_substr(street, '^[0-9]+')) as util_join
    from "integrity-db"."prod-dbt-base"."salesforce_lead_base"
),

salesforce_contacts as (
    select
        id as contact_id,
        name as contact_name,
        email as contact_email,
        phone as contact_phone,
        mobilephone as contact_mobilephone,
        main_phone__c as contact_mainphone,
        title as contact_title,
        createddate as contact_createddate,
        mailingcity as contact_mailingcity,
        mailingstate as contact_mailingstate,
        mailingstatecode as contact_mailingstatecode,
        mailingcountry as contact_mailingcountry,
        accountid as contact_accountid,
        rep_last_first__c as contact_rep_last_first,
        customer_account_number__c as contact_customer_account_number,
        contract_signer_phone_email__c as contact_contract_signer_phone_email
    from "integrity-db"."prod-dbt-base"."salesforce_contact_base"
),

salesforce_opportunities as (
    select
        contract_signer__c as opp_contract_signer,
        count(distinct(id)) as total_opportunities,
        sum((case when iswon = true then 1 else 0 end)) as won_opportunities,
        sum((case when iswon = true then points__c else 0 end)) as won_points,
        sum((case when iswon = false and isclosed = true then 1 else 0 end)) as lost_opportunities,
        sum((case when isclosed = false then 1 else 0 end)) as open_opportunities,
        sum((case when isclosed = true then 1 else 0 end)) as closed_opportunities
    from "integrity-db"."prod-dbt-base"."salesforce_opportunity_base"
    group by opp_contract_signer
),

utility_lead as (
    select
        companyname as utility_companyname,
        serviceaddress as utility_serviceaddress,
        servicecity as utility_servicecity,
        servicezip as utility_servicezip,
        phone as utility_phone,
        Concat(companyname,regexp_substr(serviceaddress, '^[0-9]+')) as lead_join
    from "integrity-db"."prod-dbt-base"."utility_lead_base"
)

select
(NVL(l.lead_id,'-') || NVL(c.contact_id,'-') || NVL(u.lead_join,'-')) as lead_master_id,
*
from salesforce_leads as l
full join salesforce_contacts as c on l.lead_convertedcontactid = c.contact_id
full join utility_lead as u on l.util_join = u.lead_join
left join salesforce_opportunities as o on c.contact_id = o.opp_contract_signer
  ) ;
[0m16:06:20.012838 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:06:20.013344 [debug] [Thread-4 (]: On model.integrity_energy_dbt.google_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.google_ads_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."google_ads_daily_base__dbt_tmp" as (
    

select
    DATE(_data_date) as activity_date, 
    metrics_impressions as googleads_impressions,
    metrics_cost_micros  as googleads_cost, 
    metrics_clicks as googleads_clicks
from google_ads.ads_campaignbasicstats_7446470445
  ) ;
[0m16:06:20.050868 [debug] [Thread-2 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:20.050868 [debug] [Thread-2 (]: On model.integrity_energy_dbt.lead_prod: ROLLBACK
[0m16:06:20.056610 [debug] [Thread-3 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:20.057819 [debug] [Thread-3 (]: On model.integrity_energy_dbt.lead_intermediate: ROLLBACK
[0m16:06:20.058324 [debug] [Thread-1 (]: On model.integrity_energy_dbt.hubspot_daily_base: Close
[0m16:06:20.058324 [debug] [Thread-1 (]: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:06:20.058324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021481EE8050>]}
[0m16:06:20.058324 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "google_ads" does not exist
[0m16:06:20.058324 [error] [Thread-1 (]: 6 of 20 ERROR creating sql view model prod-dbt-base.hubspot_daily_base ......... [[31mERROR[0m in 0.56s]
[0m16:06:20.058324 [debug] [Thread-4 (]: On model.integrity_energy_dbt.google_ads_daily_base: ROLLBACK
[0m16:06:20.058324 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:06:20.058324 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.marketing_cost_base
[0m16:06:20.058324 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.hubspot_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql.
[0m16:06:20.058324 [info ] [Thread-1 (]: 9 of 20 START sql view model prod-dbt-base.marketing_cost_base ................. [RUN]
[0m16:06:20.058324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.hubspot_daily_base, now model.integrity_energy_dbt.marketing_cost_base)
[0m16:06:20.058324 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.marketing_cost_base
[0m16:06:20.072331 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:06:20.072331 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.marketing_cost_base
[0m16:06:20.072331 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:06:20.072331 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:06:20.072331 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: BEGIN
[0m16:06:20.072331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:20.072331 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.072331 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.125009 [debug] [Thread-3 (]: On model.integrity_energy_dbt.lead_intermediate: Close
[0m16:06:20.125009 [debug] [Thread-2 (]: On model.integrity_energy_dbt.lead_prod: Close
[0m16:06:20.132351 [debug] [Thread-3 (]: Database Error in model lead_intermediate (models\prod-dbt-intermediate\lead_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\lead_intermediate.sql
[0m16:06:20.132351 [debug] [Thread-2 (]: Database Error in model lead_prod (models\prod-dbt-mart\lead_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\lead_prod.sql
[0m16:06:20.135355 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148216E090>]}
[0m16:06:20.135355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214819C0E50>]}
[0m16:06:20.135355 [error] [Thread-3 (]: 7 of 20 ERROR creating sql view model prod-dbt-intermediate.lead_intermediate .. [[31mERROR[0m in 0.63s]
[0m16:06:20.135355 [error] [Thread-2 (]: 8 of 20 ERROR creating sql table model prod-dbt-mart.lead_prod ................. [[31mERROR[0m in 0.63s]
[0m16:06:20.135355 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.lead_intermediate
[0m16:06:20.135355 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.lead_prod
[0m16:06:20.135355 [debug] [Thread-4 (]: On model.integrity_energy_dbt.google_ads_daily_base: Close
[0m16:06:20.135355 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.marketing_intermediate
[0m16:06:20.135355 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.lead_intermediate' to be skipped because of status 'error'.  Reason: Database Error in model lead_intermediate (models\prod-dbt-intermediate\lead_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\lead_intermediate.sql.
[0m16:06:20.135355 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.marketing_prod
[0m16:06:20.135355 [info ] [Thread-3 (]: 10 of 20 START sql view model prod-dbt-intermediate.marketing_intermediate ..... [RUN]
[0m16:06:20.135355 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.lead_prod' to be skipped because of status 'error'.  Reason: Database Error in model lead_prod (models\prod-dbt-mart\lead_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\lead_prod.sql.
[0m16:06:20.135355 [info ] [Thread-2 (]: 11 of 20 START sql table model prod-dbt-mart.marketing_prod .................... [RUN]
[0m16:06:20.143329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.lead_intermediate, now model.integrity_energy_dbt.marketing_intermediate)
[0m16:06:20.143834 [debug] [Thread-4 (]: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:06:20.143834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.lead_prod, now model.integrity_energy_dbt.marketing_prod)
[0m16:06:20.143834 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.marketing_intermediate
[0m16:06:20.143834 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148365A810>]}
[0m16:06:20.143834 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.marketing_prod
[0m16:06:20.143834 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.marketing_intermediate"
[0m16:06:20.151339 [error] [Thread-4 (]: 5 of 20 ERROR creating sql view model prod-dbt-base.google_ads_daily_base ...... [[31mERROR[0m in 0.64s]
[0m16:06:20.151339 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.marketing_prod"
[0m16:06:20.154964 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:06:20.154964 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.salesforce_account_base
[0m16:06:20.155970 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.google_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql.
[0m16:06:20.155970 [info ] [Thread-4 (]: 12 of 20 START sql view model prod-dbt-base.salesforce_account_base ............ [RUN]
[0m16:06:20.157007 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.marketing_intermediate
[0m16:06:20.157512 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.marketing_prod
[0m16:06:20.157512 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.google_ads_daily_base, now model.integrity_energy_dbt.salesforce_account_base)
[0m16:06:20.160386 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.marketing_intermediate"
[0m16:06:20.162067 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.marketing_prod"
[0m16:06:20.162067 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.salesforce_account_base
[0m16:06:20.167074 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:06:20.183199 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.marketing_prod"
[0m16:06:20.183199 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.marketing_intermediate"
[0m16:06:20.194837 [debug] [Thread-2 (]: On model.integrity_energy_dbt.marketing_prod: BEGIN
[0m16:06:20.194837 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.salesforce_account_base
[0m16:06:20.194837 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_intermediate: BEGIN
[0m16:06:20.194837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:20.196689 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:06:20.196689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:20.199534 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.199534 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.199534 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.201699 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:06:20.202902 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.203407 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: BEGIN
[0m16:06:20.203407 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:20.203407 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.203407 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.432692 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.349 seconds
[0m16:06:20.432692 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:06:20.432692 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.marketing_cost_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."marketing_cost_base__dbt_tmp" as (
    

select
    team,
    CAST(month as date) as month,
    CAST(REPLACE(hom_cost, ',', '') as decimal(10,2)) as hom_cost,
    CAST(REPLACE(ipr_cost, ',', '')  as decimal(10,2)) as ipr_cost,
    CAST(REPLACE(copywriter, ',', '') as decimal(10,2)) as copywriter,
    CAST(REPLACE(dango_costs, ',', '') as decimal(10,2)) as dango_costs,
    CAST(REPLACE(designer_costs, ',', '') as decimal(10,2)) as designer_costs,
    CAST(REPLACE(paid_lead_cost, ',', '') as decimal(10,2)) as paid_lead_cost,
    CAST(REPLACE(data_contractor, ',', '') as decimal(10,2)) as data_contractor,
    CAST(REPLACE(seo_lead_salary, ',', '') as decimal(10,2)) as seo_lead_salary,
    CAST(REPLACE(contractor_costs, ',', '') as decimal(10,2)) as contractor_costs,
    CAST(REPLACE(paid_agency_cost, ',', '') as decimal(10,2)) as paid_agency_cost,
    CAST(REPLACE(paid_support_cost, ',', '') as decimal(10,2)) as paid_support_cost,
    CAST(REPLACE(project_management, ',', '') as decimal(10,2)) as project_management,
    CAST(REPLACE(crowd_content_costs, ',', '') as decimal(10,2)) as crowd_content_costs,
    CAST(REPLACE(email_contractor_costs, ',', '') as decimal(10,2)) as email_contractor_costs,
    CAST(REPLACE(hubspot_contractor_costs, ',', '') as decimal(10,2)) as hubspot_contractor_costs
from google_sheets.monthly_cost
  ) ;
[0m16:06:20.468956 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "google_sheets" does not exist
[0m16:06:20.468956 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: ROLLBACK
[0m16:06:20.533102 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: Close
[0m16:06:20.533102 [debug] [Thread-1 (]: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:06:20.533102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483658210>]}
[0m16:06:20.533102 [error] [Thread-1 (]: 9 of 20 ERROR creating sql view model prod-dbt-base.marketing_cost_base ........ [[31mERROR[0m in 0.47s]
[0m16:06:20.533102 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.marketing_cost_base
[0m16:06:20.533102 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:06:20.533102 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.marketing_cost_base' to be skipped because of status 'error'.  Reason: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql.
[0m16:06:20.533102 [info ] [Thread-1 (]: 13 of 20 START sql view model prod-dbt-base.salesforce_contact_base ............ [RUN]
[0m16:06:20.533102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.marketing_cost_base, now model.integrity_energy_dbt.salesforce_contact_base)
[0m16:06:20.533102 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.salesforce_contact_base
[0m16:06:20.547108 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:06:20.548271 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.salesforce_contact_base
[0m16:06:20.548271 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:06:20.548271 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:06:20.548271 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_contact_base: BEGIN
[0m16:06:20.548271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:20.548271 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.548271 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.610339 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.404 seconds
[0m16:06:20.610339 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:06:20.611854 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_account_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_account_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    phone,
    industry,
    billingcity,
    billingcountry,
    billingcountrycode,
    billingpostalcode,
    billingstreet,
    main_phone__c
    --utility_company__c
from salesforce.account
  ) ;
[0m16:06:20.626398 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.434 seconds
[0m16:06:20.626398 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.marketing_prod"
[0m16:06:20.626398 [debug] [Thread-2 (]: On model.integrity_energy_dbt.marketing_prod: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.marketing_prod"} */

  
    

  create  table
    "integrity-db-dev"."prod-dbt-mart"."marketing_prod__dbt_tmp"
    
    
    
  as (
    

select
    *
from "integrity-db"."prod-dbt-intermediate"."marketing_intermediate"
where activity_date IS NOT NULL
  );
[0m16:06:20.633438 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.441 seconds
[0m16:06:20.633438 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.marketing_intermediate"
[0m16:06:20.642446 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.marketing_intermediate"} */


  create view "integrity-db-dev"."prod-dbt-intermediate"."marketing_intermediate__dbt_tmp" as (
    

with google_ads as (
    select
        activity_date,
        sum(googleads_impressions) as googleads_impressions,
        ROUND((sum(googleads_cost) / 1000000),2) as googleads_cost,
        sum(googleads_clicks) as googleads_clicks
    from "integrity-db"."prod-dbt-base"."google_ads_daily_base"
    group by activity_date
),

bing_ads as (
    select
        timeperiod,
        sum(spend) as bing_spend,
        sum(impressions) as bing_impressions,
        sum(clicks) as bing_clicks
    from "integrity-db"."prod-dbt-base"."bing_ads_daily_base"
    group by timeperiod
),

hubspot as (
    select
        converted_date,
        sent_emails as hubspot_sent_emails,
        opened_emails as hubspot_opened_emails,
        clicks as hubspot_clicks,
        bounces as hubspot_bounces,
        spam_reports as hubspot_spam_reports
    from "integrity-db"."prod-dbt-base"."hubspot_daily_base"
),

facebook as (
    select
        date_start,
        facebook_impressions,
        facebook_reach,
        facebook_spend, 
        facebook_clicks,
        facebook_unique_clicks
    from "integrity-db"."prod-dbt-base"."facebook_daily_base"
),

opportunity_sold as (
    SELECT 
    sold_date__c,
    sum(case when iswon = true and status__c <> 'Cancelled' then 1 else 0 end) as total_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' then points__c else 0 end) as total_won_points,
    sum(case when iswon = true and status__c <> 'Cancelled' and team__c = 'Paid' then 1 else 0 end) as paid_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' and team__c = 'Paid' then points__c else 0 end) as paid_won_points,
    sum(case when iswon = true and status__c <> 'Cancelled' and team__c = 'Earned' then 1 else 0 end) as earned_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' and team__c = 'Earned' then points__c else 0 end) as earned_won_points,
    sum(case when iswon = true and status__c <> 'Cancelled' and team__c = 'Owned' then 1 else 0 end) as owned_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' and team__c = 'Owned' then points__c else 0 end) as owned_won_points,
    sum(case when iswon = true and status__c <> 'Cancelled' and source__c = 'Google' then 1 else 0 end) as google_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' and source__c = 'Google' then points__c else 0 end) as google_won_points,
    sum(case when iswon = true and status__c <> 'Cancelled' and source__c = 'Microsoft' then 1 else 0 end) as microsoft_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' and source__c = 'Microsoft' then points__c else 0 end) as microsoft_won_points,
    sum(case when iswon = true and status__c <> 'Cancelled' and source__c = 'Email' then 1 else 0 end) as email_won_opportunities,
    sum(case when iswon = true and status__c <> 'Cancelled' and source__c = 'Email' then points__c else 0 end) as email_won_points
from "integrity-db"."prod-dbt-base"."salesforce_opportunity_base"
where marketing_generator__c = '0035f00000G8KYcAAN'
group by sold_date__c
),

opportunity_cancelled as (
SELECT
    cancel_date__c,
    sum(case when iswon = true and status__c = 'Cancelled' then 1 else 0 end) as total_cancelled_opportunities,
    sum(case when iswon = true and cancel_date__c <> NULL then cancelled_points__c else 0 end) as total_cancelled_points
from "integrity-db"."prod-dbt-base"."salesforce_opportunity_base"
where marketing_generator__c = '0035f00000G8KYcAAN'
group by cancel_date__c
),

marketing_cost as (
select
    team,
    month,
    hom_cost,
    ipr_cost,
    copywriter,
    dango_costs,
    designer_costs,
    paid_lead_cost,
    data_contractor,
    seo_lead_salary,
    contractor_costs,
    paid_agency_cost,
    paid_support_cost,
    project_management,
    crowd_content_costs,
    email_contractor_costs,
    hubspot_contractor_costs
from "integrity-db"."prod-dbt-base"."marketing_cost_base"
),

base_dates as (
    select
        CAST(date as date)
    from google_sheets.dates
)

select 
    COALESCE(d.date, o.sold_date__c, b.timeperiod, h.converted_date, f.date_start, g.activity_date, c.cancel_date__c, m.month) AS activity_date,
    COALESCE(g.googleads_cost, 0) AS googleads_cost,
    COALESCE(g.googleads_impressions, 0) AS googleads_impressions,
    COALESCE(g.googleads_clicks, 0) AS googleads_clicks,
    COALESCE(b.bing_spend, 0) AS bing_spend,
    COALESCE(b.bing_impressions, 0) AS bing_impressions,
    COALESCE(b.bing_clicks, 0) AS bing_clicks,
    COALESCE(h.hubspot_sent_emails, 0) AS hubspot_sent_emails,
    COALESCE(h.hubspot_opened_emails, 0) AS hubspot_opened_emails,
    COALESCE(h.hubspot_clicks, 0) AS hubspot_clicks,
    COALESCE(h.hubspot_bounces, 0) AS hubspot_bounces,
    COALESCE(h.hubspot_spam_reports, 0) AS hubspot_spam_reports,
    COALESCE(f.facebook_impressions, 0) AS facebook_impressions,
    COALESCE(f.facebook_reach, 0) AS facebook_reach,
    COALESCE(f.facebook_spend, 0) AS facebook_spend, 
    COALESCE(f.facebook_clicks, 0) AS facebook_clicks,
    COALESCE(f.facebook_unique_clicks, 0) AS facebook_unique_clicks,
    COALESCE(o.total_won_opportunities, 0) AS total_won_opportunities,
    COALESCE(o.total_won_points, 0) AS total_won_points,
    COALESCE(o.paid_won_opportunities, 0) AS paid_won_opportunities,
    COALESCE(o.paid_won_points, 0) AS paid_won_points,
    COALESCE(o.earned_won_opportunities, 0) AS earned_won_opportunities,
    COALESCE(o.earned_won_points, 0) AS earned_won_points,
    COALESCE(o.owned_won_opportunities, 0) AS owned_won_opportunities,
    COALESCE(o.owned_won_points, 0) AS owned_won_points,
    COALESCE(o.google_won_opportunities, 0) AS google_won_opportunities,
    COALESCE(o.google_won_points, 0) AS google_won_points,
    COALESCE(o.microsoft_won_opportunities, 0) AS microsoft_won_opportunities,
    COALESCE(o.microsoft_won_points, 0) AS microsoft_won_points,
    COALESCE(o.email_won_opportunities, 0) AS email_won_opportunities,
    COALESCE(o.email_won_points, 0) AS email_won_points,
    COALESCE(c.total_cancelled_opportunities, 0) AS total_cancelled_opportunities,
    COALESCE(c.total_cancelled_points, 0) AS total_cancelled_points,
    m.team AS team,
    m.month AS cost_month,
    COALESCE(m.hom_cost, 0) AS hom_cost,
    COALESCE(m.ipr_cost, 0) AS ipr_cost,
    COALESCE(m.copywriter, 0) AS copywriter,
    COALESCE(m.dango_costs, 0) AS dango_costs,
    COALESCE(m.designer_costs, 0) AS designer_costs,
    COALESCE(m.paid_lead_cost, 0) AS paid_lead_cost,
    COALESCE(m.data_contractor, 0) AS data_contractor,
    COALESCE(m.seo_lead_salary, 0) AS seo_lead_salary,
    COALESCE(m.contractor_costs, 0) AS contractor_costs,
    COALESCE(m.paid_agency_cost, 0) AS paid_agency_cost,
    COALESCE(m.paid_support_cost, 0) AS paid_support_cost,
    COALESCE(m.project_management, 0) AS project_management,
    COALESCE(m.crowd_content_costs, 0) AS crowd_content_costs,
    COALESCE(m.email_contractor_costs, 0) AS email_contractor_costs,
    COALESCE(m.hubspot_contractor_costs, 0) AS hubspot_contractor_costs,
    COALESCE(SUM(COALESCE(m.data_contractor, 0) + COALESCE(m.hubspot_contractor_costs, 0) + COALESCE(m.email_contractor_costs, 0)),0) as total_contractor_costs,
    COALESCE(SUM(COALESCE(m.hom_cost, 0) + COALESCE(m.ipr_cost, 0) + COALESCE(m.copywriter, 0) + COALESCE(m.designer_costs, 0) + COALESCE(m.paid_lead_cost, 0) + COALESCE(m.seo_lead_salary, 0) + COALESCE(m.paid_support_cost, 0) + COALESCE(m.project_management, 0)),0) as operational_costs, 
    COALESCE(SUM(COALESCE(g.googleads_cost,0) + COALESCE(b.bing_spend,0) + COALESCE(f.facebook_spend,0)),0) as total_spend,
    COALESCE(SUM(COALESCE(g.googleads_clicks,0) + COALESCE(b.bing_clicks,0) + COALESCE(f.facebook_clicks,0)),0) as total_clicks,
    COALESCE(SUM(COALESCE(g.googleads_impressions,0) + COALESCE(b.bing_impressions,0) + COALESCE(f.facebook_impressions,0)),0) as total_impressions,
    CASE
        WHEN COALESCE(SUM(COALESCE(g.googleads_clicks,0) + COALESCE(b.bing_clicks,0) + COALESCE(f.facebook_clicks,0)),0) = 0 THEN 0
        ELSE COALESCE(SUM(COALESCE(g.googleads_cost,0) + COALESCE(b.bing_spend,0) + COALESCE(f.facebook_spend,0)),0) / COALESCE(SUM(COALESCE(g.googleads_clicks,0) + COALESCE(b.bing_clicks,0) + COALESCE(f.facebook_clicks,0)),0)
    END AS cost_per_click,
    CASE
        WHEN COALESCE(SUM(COALESCE(g.googleads_impressions,0) + COALESCE(b.bing_impressions,0) + COALESCE(f.facebook_impressions,0)),0) = 0 THEN 0
        ELSE COALESCE(SUM(COALESCE(g.googleads_cost,0) + COALESCE(b.bing_spend,0) + COALESCE(f.facebook_spend,0)),0) / COALESCE(SUM(COALESCE(g.googleads_impressions,0) + COALESCE(b.bing_impressions,0) + COALESCE(f.facebook_impressions,0)),0)
    END AS cost_per_impression,
    CASE
        WHEN COALESCE(SUM(o.total_won_opportunities), 0) = 0 THEN 0
        ELSE COALESCE(SUM(COALESCE(g.googleads_cost,0) + COALESCE(b.bing_spend,0) + COALESCE(f.facebook_spend,0)),0) / COALESCE(SUM(o.total_won_opportunities), 0)
    END AS cost_per_deal,
    CASE
        WHEN COALESCE(SUM(COALESCE(g.googleads_cost,0) + COALESCE(b.bing_spend,0) + COALESCE(f.facebook_spend,0)),0) = 0 THEN 0
        ELSE (((SUM(o.total_won_points) * 100) / COALESCE(SUM(COALESCE(g.googleads_cost,0) + COALESCE(b.bing_spend,0) + COALESCE(f.facebook_spend,0)),0)) / 100)
    END AS return_on_investment
from base_dates as d 
left outer join opportunity_sold as o on d.date = o.sold_date__c
left outer join hubspot as h on d.date = h.converted_date
left outer join bing_ads as b on b.timeperiod = d.date
left outer join facebook as f on f.date_start = d.date
left outer join google_ads as g on g.activity_date = d.date
left outer join opportunity_cancelled as c on c.cancel_date__c = d.date
left outer join marketing_cost as m on d.date = m.month
group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50
  ) ;
[0m16:06:20.644174 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:06:20.644174 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: ROLLBACK
[0m16:06:20.658418 [debug] [Thread-2 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:20.658418 [debug] [Thread-2 (]: On model.integrity_energy_dbt.marketing_prod: ROLLBACK
[0m16:06:20.707847 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: Close
[0m16:06:20.707847 [debug] [Thread-4 (]: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:06:20.707847 [debug] [Thread-3 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:20.707847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148173E150>]}
[0m16:06:20.707847 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_intermediate: ROLLBACK
[0m16:06:20.707847 [error] [Thread-4 (]: 12 of 20 ERROR creating sql view model prod-dbt-base.salesforce_account_base ... [[31mERROR[0m in 0.55s]
[0m16:06:20.707847 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.salesforce_account_base
[0m16:06:20.707847 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:06:20.707847 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_account_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql.
[0m16:06:20.707847 [info ] [Thread-4 (]: 14 of 20 START sql view model prod-dbt-base.salesforce_lead_base ............... [RUN]
[0m16:06:20.721803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_account_base, now model.integrity_energy_dbt.salesforce_lead_base)
[0m16:06:20.721803 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.salesforce_lead_base
[0m16:06:20.721803 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:06:20.721803 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.salesforce_lead_base
[0m16:06:20.721803 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:06:20.721803 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:06:20.721803 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: BEGIN
[0m16:06:20.721803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:20.733813 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.733813 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.745220 [debug] [Thread-2 (]: On model.integrity_energy_dbt.marketing_prod: Close
[0m16:06:20.749360 [debug] [Thread-2 (]: Database Error in model marketing_prod (models\prod-dbt-mart\marketing_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\marketing_prod.sql
[0m16:06:20.749360 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021481278150>]}
[0m16:06:20.749360 [error] [Thread-2 (]: 11 of 20 ERROR creating sql table model prod-dbt-mart.marketing_prod ........... [[31mERROR[0m in 0.61s]
[0m16:06:20.749360 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.marketing_prod
[0m16:06:20.749360 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:06:20.749360 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.marketing_prod' to be skipped because of status 'error'.  Reason: Database Error in model marketing_prod (models\prod-dbt-mart\marketing_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\marketing_prod.sql.
[0m16:06:20.749360 [info ] [Thread-2 (]: 15 of 20 START sql view model prod-dbt-base.salesforce_meter_number_base ....... [RUN]
[0m16:06:20.753364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.marketing_prod, now model.integrity_energy_dbt.salesforce_meter_number_base)
[0m16:06:20.753364 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:06:20.753364 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:06:20.753364 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:06:20.753364 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:06:20.753364 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:06:20.753364 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: BEGIN
[0m16:06:20.753364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:20.753364 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.753364 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.786605 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_intermediate: Close
[0m16:06:20.792362 [debug] [Thread-3 (]: Database Error in model marketing_intermediate (models\prod-dbt-intermediate\marketing_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\marketing_intermediate.sql
[0m16:06:20.792362 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214833FCE90>]}
[0m16:06:20.792362 [error] [Thread-3 (]: 10 of 20 ERROR creating sql view model prod-dbt-intermediate.marketing_intermediate  [[31mERROR[0m in 0.65s]
[0m16:06:20.792362 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.marketing_intermediate
[0m16:06:20.792362 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:06:20.792362 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.marketing_intermediate' to be skipped because of status 'error'.  Reason: Database Error in model marketing_intermediate (models\prod-dbt-intermediate\marketing_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\marketing_intermediate.sql.
[0m16:06:20.792362 [info ] [Thread-3 (]: 16 of 20 START sql view model prod-dbt-base.salesforce_opportunity_base ........ [RUN]
[0m16:06:20.792362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.marketing_intermediate, now model.integrity_energy_dbt.salesforce_opportunity_base)
[0m16:06:20.792362 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:06:20.801378 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:06:20.802588 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:06:20.802588 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:06:20.802588 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:06:20.802588 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: BEGIN
[0m16:06:20.802588 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:20.802588 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:20.802588 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:20.944994 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.399 seconds
[0m16:06:20.944994 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:06:20.944994 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_contact_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_contact_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_contact_base__dbt_tmp" as (
    

select
    id,
    name,
    email,
    phone,
    mobilephone,
    main_phone__c,
    title,
    createddate,
    mailingcity,
    mailingstate,
    mailingstatecode,
    mailingcountry,
    accountid,
    rep_last_first__c,
    customer_account_number__c,
    contract_signer_phone_email__c
from salesforce.contact
  ) ;
[0m16:06:20.979183 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:06:20.992192 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_contact_base: ROLLBACK
[0m16:06:21.057056 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_contact_base: Close
[0m16:06:21.057056 [debug] [Thread-1 (]: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:06:21.057056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483A6BE90>]}
[0m16:06:21.057056 [error] [Thread-1 (]: 13 of 20 ERROR creating sql view model prod-dbt-base.salesforce_contact_base ... [[31mERROR[0m in 0.52s]
[0m16:06:21.057056 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:06:21.068559 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.utility_lead_base
[0m16:06:21.068559 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_contact_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql.
[0m16:06:21.068559 [info ] [Thread-1 (]: 17 of 20 START sql view model prod-dbt-base.utility_lead_base .................. [RUN]
[0m16:06:21.070772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_contact_base, now model.integrity_energy_dbt.utility_lead_base)
[0m16:06:21.071277 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.utility_lead_base
[0m16:06:21.072849 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:06:21.072849 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.utility_lead_base
[0m16:06:21.072849 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:06:21.072849 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:06:21.072849 [debug] [Thread-1 (]: On model.integrity_energy_dbt.utility_lead_base: BEGIN
[0m16:06:21.072849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:21.072849 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:21.072849 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:21.135053 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.402 seconds
[0m16:06:21.135053 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:06:21.142473 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_lead_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_lead_base__dbt_tmp" as (
    

select
    id,
    city,
    name,
    email,
    phone,
    state,
    title,
    status,
    street,
    company,
    country,
    firstname,
    lastname,
    source__c,
    channel__c,
    leadsource,
    postalcode,
    createddate,
    CAST(createddate as DATE) as createdday,
    isconverted,
    commodity__c,
    converteddate,
    lastactivitydate,
    convertedaccountid,
    convertedcontactid,
    lead_id_for_opp__c,
    average_bill_amount__c,
    convertedopportunityid,
    converted_from_lead__c,
    marketing_generator__c,
    new_ready_to_work_date__c,
    last_activity_note_date__c
from salesforce.lead
  ) ;
[0m16:06:21.166834 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:06:21.166834 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: ROLLBACK
[0m16:06:21.166834 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.363 seconds
[0m16:06:21.166834 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:06:21.166834 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_opportunity_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_opportunity_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    iswon,
    fiscal,
    mils__c,
    ownerid,
    rate__c,
    term__c,
    team__c,
    source__c,
    marketing_generator__c,
    isclosed,
    notes__c,
    accountid,
    csdate__c,
    closedate,
    driver__c,
    meters__c,
    points__c,
    stagename,
    status__c,
    channel__c,
    dl_2000__c,
    dl_4000__c,
    dl_6000__c,
    leadsource,
    manager__c,
    re_sold__c,
    renewed__c,
    createddate,
    residual__c,
    sp_rt_id__c,
    subagent__c,
    supplier__c,
    commodity__c,
    rate_type__c,
    sp_points__c,
    sold_date__c,
    broker_fee__c,
    cancel_fee__c,
    usage_type__c,
    cancel_date__c,
    dl_1500_kwh__c,
    dl_2500_kwh__c,
    dl_3500_kwh__c,
    dl_rate_gas__c,
    dl_term_gas__c,
    dl_owner_alias__c,
    lost_reason__c,
    meter_usage__c,
    owner_title__c,
    real_points__c,
    total_usage__c,
    dl_start_gas__c,
    dl_usage_gas__c,
    do_not_renew__c,
    renewal_date__c,
    sales_person__c,
    total_points__c,
    utility_text__c,
    sales_manager__c,
    supplier_text__c,
    agent_takeback__c,
    canceled_usage__c,
    commodity_text__c,
    contract_signer__c,
    cancelled_points__c,
    supplier_credits__c,
    commission_matrix__c,
    contract_end_date__c,
    broker_fee_rounded__c,
    commission_percent__c,
    last_activity_note__c,
    confirmation_number__c,
    contract_start_date__c,
    contract_signer_email__c,
    contract_signer_phone_email__c,
    contract_signer_facilitator__c
from salesforce.opportunity
  ) ;
[0m16:06:21.182977 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.420 seconds
[0m16:06:21.182977 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:06:21.182977 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_meter_number_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_meter_number_base__dbt_tmp" as (
    

select
    id,
    name,
    city__c,
    state__c,
    street__c,
    zip_code__c,
    mils__c,
    commodity__c,
    createddate,
    service_address__c,
    status__c,
    account__c,
    dl_account__c,
    account_number__c
from salesforce.meter_number__c
  ) ;
[0m16:06:21.213079 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:06:21.213079 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: ROLLBACK
[0m16:06:21.213079 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:06:21.213079 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: ROLLBACK
[0m16:06:21.239044 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: Close
[0m16:06:21.239044 [debug] [Thread-4 (]: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:06:21.239044 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148173DFD0>]}
[0m16:06:21.239044 [error] [Thread-4 (]: 14 of 20 ERROR creating sql view model prod-dbt-base.salesforce_lead_base ...... [[31mERROR[0m in 0.52s]
[0m16:06:21.239044 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:06:21.239044 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:06:21.245050 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql.
[0m16:06:21.245050 [info ] [Thread-4 (]: 18 of 20 START sql view model prod-dbt-intermediate.utility_lead_intermediate .. [RUN]
[0m16:06:21.245050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_lead_base, now model.integrity_energy_dbt.utility_lead_intermediate)
[0m16:06:21.245050 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:06:21.250545 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.utility_lead_intermediate"
[0m16:06:21.250545 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:06:21.254819 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.utility_lead_intermediate"
[0m16:06:21.260914 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_intermediate"
[0m16:06:21.260914 [debug] [Thread-4 (]: On model.integrity_energy_dbt.utility_lead_intermediate: BEGIN
[0m16:06:21.260914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:21.260914 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:21.260914 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:21.276186 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: Close
[0m16:06:21.279162 [debug] [Thread-3 (]: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:06:21.279162 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214820A5E90>]}
[0m16:06:21.279162 [error] [Thread-3 (]: 16 of 20 ERROR creating sql view model prod-dbt-base.salesforce_opportunity_base  [[31mERROR[0m in 0.49s]
[0m16:06:21.279162 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:06:21.279162 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.utility_lead_prod
[0m16:06:21.279162 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_opportunity_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql.
[0m16:06:21.279162 [info ] [Thread-3 (]: 19 of 20 START sql view model prod-dbt-mart.utility_lead_prod .................. [RUN]
[0m16:06:21.279162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_opportunity_base, now model.integrity_energy_dbt.utility_lead_prod)
[0m16:06:21.279162 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.utility_lead_prod
[0m16:06:21.279162 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.utility_lead_prod"
[0m16:06:21.279162 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.utility_lead_prod
[0m16:06:21.279162 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.utility_lead_prod"
[0m16:06:21.279162 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_prod"
[0m16:06:21.279162 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: Close
[0m16:06:21.292173 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_prod: BEGIN
[0m16:06:21.292173 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:21.292173 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:21.294794 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:21.296823 [debug] [Thread-2 (]: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:06:21.296823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021482095C90>]}
[0m16:06:21.298418 [error] [Thread-2 (]: 15 of 20 ERROR creating sql view model prod-dbt-base.salesforce_meter_number_base  [[31mERROR[0m in 0.54s]
[0m16:06:21.298924 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:06:21.298924 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.zoominfo_base
[0m16:06:21.298924 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_meter_number_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql.
[0m16:06:21.298924 [info ] [Thread-2 (]: 20 of 20 START sql view model prod-dbt-base.zoominfo_base ...................... [RUN]
[0m16:06:21.298924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_meter_number_base, now model.integrity_energy_dbt.zoominfo_base)
[0m16:06:21.298924 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.zoominfo_base
[0m16:06:21.298924 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:06:21.298924 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.zoominfo_base
[0m16:06:21.307940 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:06:21.307940 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:06:21.318482 [debug] [Thread-2 (]: On model.integrity_energy_dbt.zoominfo_base: BEGIN
[0m16:06:21.318988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:21.320001 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:21.320001 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:21.451060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.376 seconds
[0m16:06:21.451060 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:06:21.451060 [debug] [Thread-1 (]: On model.integrity_energy_dbt.utility_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.utility_lead_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."utility_lead_base__dbt_tmp" as (
    

select
        u.companyname,
        u.serviceaddress,
        u.servicecity,
        u.servicestate,
        u.servicezip,
        u.utility,
        u.accountnumber,
        u.annualusage,
        u.ratecode,
        e."eru lastname" as lastname,
        e."eru firstname" as firstname,
        e."eru titledesc" as title,
        e."be telephone number10" as phone,
        e."bee email addr80" as email
from utility_leads.utilitylead as u
left join utility_leads.enriched as e 
on u.companyname = e.companyname 
AND u.serviceaddress = e.serviceaddress
AND u.utility = e.utility
AND u.servicecity = e.servicecity
AND u.servicestate = e.servicestate
AND u.ratecode = e.ratecode
GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14
  ) ;
[0m16:06:21.494762 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "utility_leads" does not exist
[0m16:06:21.495788 [debug] [Thread-1 (]: On model.integrity_energy_dbt.utility_lead_base: ROLLBACK
[0m16:06:21.597540 [debug] [Thread-1 (]: On model.integrity_energy_dbt.utility_lead_base: Close
[0m16:06:21.601092 [debug] [Thread-1 (]: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:06:21.602092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148330DD50>]}
[0m16:06:21.602092 [error] [Thread-1 (]: 17 of 20 ERROR creating sql view model prod-dbt-base.utility_lead_base ......... [[31mERROR[0m in 0.53s]
[0m16:06:21.603088 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.utility_lead_base
[0m16:06:21.604376 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.utility_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql.
[0m16:06:21.626024 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.363 seconds
[0m16:06:21.627051 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_intermediate"
[0m16:06:21.628051 [debug] [Thread-4 (]: On model.integrity_energy_dbt.utility_lead_intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.utility_lead_intermediate"} */


  create view "integrity-db-dev"."prod-dbt-intermediate"."utility_lead_intermediate__dbt_tmp" as (
    

with meter_number as (
    select
        id,
        name,
        city__c,
        state__c,
        street__c,
        zip_code__c,
        mils__c,
        commodity__c,
        createddate,
        service_address__c,
        status__c,
        account__c
    from "integrity-db"."prod-dbt-base"."salesforce_meter_number_base"
),

account as (
    select
        id,
        name,
        type,
        phone,
        industry,
        billingcity,
        billingcountry,
        billingcountrycode,
        billingpostalcode,
        billingstreet,
        main_phone__c
    from "integrity-db"."prod-dbt-base"."salesforce_account_base"
),

utility_leads as (
    select
        companyname,
        serviceaddress,
        servicecity,
        servicestate,
        servicezip,
        utility,
        accountnumber,
        annualusage,
        ratecode,
        lastname,
        firstname,
        title,
        phone,
        email
    from "integrity-db"."prod-dbt-base"."utility_lead_base"
)

select
    m.id as meter_number_id,
    MIN(m.name) as meter_number_name,
    MIN(m.city__c) as meter_number_city,
    MIN(m.state__c) as meter_number_state,
    MIN(m.street__c) as meter_number_street,
    MIN(m.zip_code__c) as meter_number_zip_code,
    MIN(m.mils__c) as meter_number_mils,
    MIN(m.commodity__c) as meter_number_commodity,
    MIN(m.createddate) as meter_number_createddate,
    MIN(m.service_address__c) as meter_number_service_address,
    MIN(m.status__c) as meter_number_status,
    MIN(m.account__c) as meter_number_account_id,
    MIN(a.id) as account_id,
    MIN(a.name) as account_name,
    MIN(a.type) as account_type,
    MIN(a.phone) as account_phone,
    MIN(a.industry) as account_industry,
    MIN(a.billingcity) as account_billingcity,
    MIN(a.billingcountry) as account_billingcountry,
    MIN(a.billingcountrycode) as account_billingcountrycode,
    MIN(a.billingpostalcode) as account_billingpostalcode,
    MIN(a.billingstreet) as account_billingstreet,
    MIN(a.main_phone__c) as account_main_phone,
    MIN(u.companyname) as utility_companyname,
    MIN(u.serviceaddress) as utility_serviceaddress,
    MIN(u.servicecity) as utility_servicecity,
    MIN(u.servicestate) as utility_servicestate,
    MIN(u.servicezip) as utility_servicezip,
    MIN(u.utility) as utility_utility,
    MIN(u.accountnumber) as utility_accountnumber,
    MIN(u.annualusage) as utility_annualusage,
    MIN(u.ratecode) as utility_ratecode,
    MIN(u.firstname) as utility_firstname,
    MIN(u.lastname) as utility_lastname,
    MIN(u.title) as utility_title,
    MIN(u.phone) as utility_phone,
    MIN(u.email) as utility_email
from meter_number as m
left join account as a on m.account__c = a.id
left join utility_leads as u 
on 
    (trim(lower(a.name)) = trim(lower(u.companyname)) AND
    trim(m.zip_code__c) = trim(u.servicezip) AND
    trim(lower(m.city__c)) = trim(lower(u.servicecity)) AND
    regexp_substr(m.street__c, '^[0-9]+') = regexp_substr(u.serviceaddress, '^[0-9]+'))
    --OR (trim(lower(m.street__c)) = trim(lower(u.serviceaddress)))
group by m.id
  ) ;
[0m16:06:21.665136 [debug] [Thread-4 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:21.666399 [debug] [Thread-4 (]: On model.integrity_energy_dbt.utility_lead_intermediate: ROLLBACK
[0m16:06:21.706300 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.413 seconds
[0m16:06:21.707324 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.388 seconds
[0m16:06:21.708384 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_prod"
[0m16:06:21.708648 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:06:21.709187 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_prod: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.utility_lead_prod"} */


  create view "integrity-db-dev"."prod-dbt-mart"."utility_lead_prod__dbt_tmp" as (
    

select
    *
from "integrity-db"."prod-dbt-intermediate"."utility_lead_intermediate"
  ) ;
[0m16:06:21.709789 [debug] [Thread-2 (]: On model.integrity_energy_dbt.zoominfo_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.zoominfo_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."zoominfo_base__dbt_tmp" as (
    select * from zoominfo.zoominfo_upload_09202024
  ) ;
[0m16:06:21.729411 [debug] [Thread-4 (]: On model.integrity_energy_dbt.utility_lead_intermediate: Close
[0m16:06:21.732140 [debug] [Thread-4 (]: Database Error in model utility_lead_intermediate (models\prod-dbt-intermediate\utility_lead_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\utility_lead_intermediate.sql
[0m16:06:21.733140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FFA6CA50>]}
[0m16:06:21.733140 [error] [Thread-4 (]: 18 of 20 ERROR creating sql view model prod-dbt-intermediate.utility_lead_intermediate  [[31mERROR[0m in 0.49s]
[0m16:06:21.734650 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:06:21.735669 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.utility_lead_intermediate' to be skipped because of status 'error'.  Reason: Database Error in model utility_lead_intermediate (models\prod-dbt-intermediate\utility_lead_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\utility_lead_intermediate.sql.
[0m16:06:21.744305 [debug] [Thread-3 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:06:21.745311 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "zoominfo" does not exist
[0m16:06:21.745311 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_prod: ROLLBACK
[0m16:06:21.746312 [debug] [Thread-2 (]: On model.integrity_energy_dbt.zoominfo_base: ROLLBACK
[0m16:06:21.813391 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_prod: Close
[0m16:06:21.814810 [debug] [Thread-2 (]: On model.integrity_energy_dbt.zoominfo_base: Close
[0m16:06:21.818835 [debug] [Thread-3 (]: Database Error in model utility_lead_prod (models\prod-dbt-mart\utility_lead_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\utility_lead_prod.sql
[0m16:06:21.820832 [debug] [Thread-2 (]: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:06:21.820832 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FFAD58D0>]}
[0m16:06:21.821871 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bbfc8-609c-4e54-9962-747e56777b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148332E250>]}
[0m16:06:21.822507 [error] [Thread-3 (]: 19 of 20 ERROR creating sql view model prod-dbt-mart.utility_lead_prod ......... [[31mERROR[0m in 0.54s]
[0m16:06:21.823655 [error] [Thread-2 (]: 20 of 20 ERROR creating sql view model prod-dbt-base.zoominfo_base ............. [[31mERROR[0m in 0.52s]
[0m16:06:21.823655 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.utility_lead_prod
[0m16:06:21.824663 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.zoominfo_base
[0m16:06:21.825668 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.utility_lead_prod' to be skipped because of status 'error'.  Reason: Database Error in model utility_lead_prod (models\prod-dbt-mart\utility_lead_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\utility_lead_prod.sql.
[0m16:06:21.825668 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.zoominfo_base' to be skipped because of status 'error'.  Reason: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql.
[0m16:06:21.827665 [debug] [MainThread]: Using redshift connection "master"
[0m16:06:21.827665 [debug] [MainThread]: On master: BEGIN
[0m16:06:21.828663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:21.828663 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:06:21.829663 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:06:22.197030 [debug] [MainThread]: SQL status: SUCCESS in 0.369 seconds
[0m16:06:22.199063 [debug] [MainThread]: On master: COMMIT
[0m16:06:22.199063 [debug] [MainThread]: Using redshift connection "master"
[0m16:06:22.200057 [debug] [MainThread]: On master: COMMIT
[0m16:06:22.264184 [debug] [MainThread]: SQL status: SUCCESS in 0.064 seconds
[0m16:06:22.265194 [debug] [MainThread]: On master: Close
[0m16:06:22.266479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:22.266479 [debug] [MainThread]: Connection 'create_integrity-db-dev_prod-dbt-intermediate' was properly closed.
[0m16:06:22.266479 [debug] [MainThread]: Connection 'create_integrity-db-dev_prod-dbt-mart' was properly closed.
[0m16:06:22.267503 [debug] [MainThread]: Connection 'create_integrity-db-dev_prod-dbt-base' was properly closed.
[0m16:06:22.267503 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-base' was properly closed.
[0m16:06:22.268490 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-intermediate' was properly closed.
[0m16:06:22.268490 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-mart' was properly closed.
[0m16:06:22.268490 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.utility_lead_base' was properly closed.
[0m16:06:22.269487 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.zoominfo_base' was properly closed.
[0m16:06:22.269487 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.utility_lead_prod' was properly closed.
[0m16:06:22.269487 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.utility_lead_intermediate' was properly closed.
[0m16:06:22.270488 [info ] [MainThread]: 
[0m16:06:22.270488 [info ] [MainThread]: Finished running 3 table models, 17 view models in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m16:06:22.274002 [debug] [MainThread]: Command end result
[0m16:06:22.306730 [info ] [MainThread]: 
[0m16:06:22.307742 [info ] [MainThread]: [31mCompleted with 20 errors, 0 partial successs, and 0 warnings:[0m
[0m16:06:22.307742 [info ] [MainThread]: 
[0m16:06:22.308938 [error] [MainThread]:   Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:06:22.308938 [info ] [MainThread]: 
[0m16:06:22.310001 [error] [MainThread]:   Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:06:22.310001 [info ] [MainThread]: 
[0m16:06:22.311108 [error] [MainThread]:   Database Error in model deal_prod (models\prod-dbt-mart\deal_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\deal_prod.sql
[0m16:06:22.311108 [info ] [MainThread]: 
[0m16:06:22.311108 [error] [MainThread]:   Database Error in model deal_intermediate (models\prod-dbt-intermediate\deal_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\deal_intermediate.sql
[0m16:06:22.312217 [info ] [MainThread]: 
[0m16:06:22.312217 [error] [MainThread]:   Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:06:22.312217 [info ] [MainThread]: 
[0m16:06:22.313283 [error] [MainThread]:   Database Error in model lead_intermediate (models\prod-dbt-intermediate\lead_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\lead_intermediate.sql
[0m16:06:22.313283 [info ] [MainThread]: 
[0m16:06:22.314437 [error] [MainThread]:   Database Error in model lead_prod (models\prod-dbt-mart\lead_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\lead_prod.sql
[0m16:06:22.314437 [info ] [MainThread]: 
[0m16:06:22.314437 [error] [MainThread]:   Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:06:22.314437 [info ] [MainThread]: 
[0m16:06:22.315633 [error] [MainThread]:   Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:06:22.315633 [info ] [MainThread]: 
[0m16:06:22.316773 [error] [MainThread]:   Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:06:22.316773 [info ] [MainThread]: 
[0m16:06:22.316773 [error] [MainThread]:   Database Error in model marketing_prod (models\prod-dbt-mart\marketing_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\marketing_prod.sql
[0m16:06:22.316773 [info ] [MainThread]: 
[0m16:06:22.318475 [error] [MainThread]:   Database Error in model marketing_intermediate (models\prod-dbt-intermediate\marketing_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\marketing_intermediate.sql
[0m16:06:22.318475 [info ] [MainThread]: 
[0m16:06:22.318475 [error] [MainThread]:   Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:06:22.319482 [info ] [MainThread]: 
[0m16:06:22.319482 [error] [MainThread]:   Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:06:22.320583 [info ] [MainThread]: 
[0m16:06:22.320583 [error] [MainThread]:   Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:06:22.320583 [info ] [MainThread]: 
[0m16:06:22.321588 [error] [MainThread]:   Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:06:22.322597 [info ] [MainThread]: 
[0m16:06:22.322597 [error] [MainThread]:   Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:06:22.323597 [info ] [MainThread]: 
[0m16:06:22.324596 [error] [MainThread]:   Database Error in model utility_lead_intermediate (models\prod-dbt-intermediate\utility_lead_intermediate.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-intermediate\utility_lead_intermediate.sql
[0m16:06:22.324596 [info ] [MainThread]: 
[0m16:06:22.325596 [error] [MainThread]:   Database Error in model utility_lead_prod (models\prod-dbt-mart\utility_lead_prod.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-mart\utility_lead_prod.sql
[0m16:06:22.325596 [info ] [MainThread]: 
[0m16:06:22.326595 [error] [MainThread]:   Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:06:22.326595 [info ] [MainThread]: 
[0m16:06:22.327596 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=20 SKIP=0 TOTAL=20
[0m16:06:22.328598 [debug] [MainThread]: Command `dbt run` failed at 16:06:22.327596 after 7.89 seconds
[0m16:06:22.328598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FB40E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148171FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148171FE50>]}
[0m16:06:22.328598 [debug] [MainThread]: Flushing usage events
[0m16:06:22.557289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:15.561006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F8CBC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F8CB210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F8CBA90>]}


============================== 16:18:15.563517 | 4acca903-b0a9-41c3-9c5a-64210663a96d ==============================
[0m16:18:15.563517 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:18:15.564519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:daily --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:15.689610 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:18:15.689610 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:18:15.814813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F912F10>]}
[0m16:18:15.858709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17C9D0C10>]}
[0m16:18:15.859710 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:18:15.871714 [debug] [MainThread]: checksum: 28c00772bd96551ae2f98126ebf7713c9e121e5f4a1fdbf780c14a568fdbecdb, vars: {}, profile: , target: dev, version: 1.9.0b2
[0m16:18:16.023283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m16:18:16.024284 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-intermediate\utility_lead_intermediate.sql
[0m16:18:16.024284 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-intermediate\lead_intermediate.sql
[0m16:18:16.024284 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-mart\marketing_prod.sql
[0m16:18:16.025283 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-intermediate\deal_intermediate.sql
[0m16:18:16.025283 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-mart\utility_lead_prod.sql
[0m16:18:16.026283 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-mart\lead_prod.sql
[0m16:18:16.026283 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-intermediate\marketing_intermediate.sql
[0m16:18:16.027283 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\prod-dbt-mart\deal_prod.sql
[0m16:18:16.222269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1003C7890>]}
[0m16:18:16.292786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1017120D0>]}
[0m16:18:16.292786 [info ] [MainThread]: Found 20 models, 20 sources, 602 macros
[0m16:18:16.293786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1017B0C10>]}
[0m16:18:16.295785 [info ] [MainThread]: 
[0m16:18:16.296785 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:16.296785 [info ] [MainThread]: 
[0m16:18:16.297785 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:18:16.301790 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:18:16.301790 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:18:16.302787 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:18:16.313783 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:18:16.315895 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:18:16.369979 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:18:16.370483 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:18:16.371155 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:18:16.371155 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:18:16.371854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:16.372360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:16.372360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:16.375920 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:16.375920 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:16.375920 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:16.376921 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:16.377922 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:16.377922 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:16.998580 [debug] [ThreadPool]: SQL status: SUCCESS in 0.627 seconds
[0m16:18:16.999787 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:18:17.020924 [debug] [ThreadPool]: SQL status: SUCCESS in 0.648 seconds
[0m16:18:17.020924 [debug] [ThreadPool]: SQL status: SUCCESS in 0.649 seconds
[0m16:18:17.021886 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:18:17.023644 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:18:17.026649 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-base'
[0m16:18:17.027656 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-mart'
[0m16:18:17.034980 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-base"
[0m16:18:17.034980 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-intermediate'
[0m16:18:17.038739 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-mart"
[0m16:18:17.039746 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: BEGIN
[0m16:18:17.041744 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-intermediate"
[0m16:18:17.043248 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: BEGIN
[0m16:18:17.043248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:17.044256 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: BEGIN
[0m16:18:17.044256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:17.044256 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:17.045254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:17.045254 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:17.045254 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:17.046253 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:17.046253 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:17.047857 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:17.438035 [debug] [ThreadPool]: SQL status: SUCCESS in 0.394 seconds
[0m16:18:17.439060 [debug] [ThreadPool]: SQL status: SUCCESS in 0.394 seconds
[0m16:18:17.439060 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-mart"
[0m16:18:17.440064 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-intermediate"
[0m16:18:17.440064 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-mart"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-mart'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-mart'
[0m16:18:17.441045 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-intermediate"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-intermediate'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-intermediate'
[0m16:18:17.461494 [debug] [ThreadPool]: SQL status: SUCCESS in 0.418 seconds
[0m16:18:17.462496 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-base"
[0m16:18:17.462496 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-base"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-base'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-base'
[0m16:18:17.533316 [debug] [ThreadPool]: SQL status: SUCCESS in 0.094 seconds
[0m16:18:17.533316 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: ROLLBACK
[0m16:18:17.553047 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m16:18:17.553047 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: ROLLBACK
[0m16:18:17.564997 [debug] [ThreadPool]: SQL status: SUCCESS in 0.102 seconds
[0m16:18:17.567031 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: ROLLBACK
[0m16:18:17.599220 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: Close
[0m16:18:17.616667 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: Close
[0m16:18:17.635975 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: Close
[0m16:18:17.645508 [debug] [MainThread]: Using redshift connection "master"
[0m16:18:17.645508 [debug] [MainThread]: On master: BEGIN
[0m16:18:17.645508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:17.645508 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:17.645508 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.047478 [debug] [MainThread]: SQL status: SUCCESS in 0.405 seconds
[0m16:18:18.047478 [debug] [MainThread]: Using redshift connection "master"
[0m16:18:18.047478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:18:18.144744 [debug] [MainThread]: SQL status: SUCCESS in 0.086 seconds
[0m16:18:18.144744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101595250>]}
[0m16:18:18.144744 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:18.203052 [debug] [MainThread]: Using redshift connection "master"
[0m16:18:18.203052 [debug] [MainThread]: On master: BEGIN
[0m16:18:18.244756 [debug] [MainThread]: SQL status: SUCCESS in 0.034 seconds
[0m16:18:18.244756 [debug] [MainThread]: On master: COMMIT
[0m16:18:18.244756 [debug] [MainThread]: Using redshift connection "master"
[0m16:18:18.244756 [debug] [MainThread]: On master: COMMIT
[0m16:18:18.313880 [debug] [MainThread]: SQL status: SUCCESS in 0.065 seconds
[0m16:18:18.313880 [debug] [MainThread]: On master: Close
[0m16:18:18.324791 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:18:18.324791 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.facebook_daily_base
[0m16:18:18.324791 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:18:18.326881 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:18:18.326881 [info ] [Thread-1 (]: 1 of 20 START sql view model prod-dbt-base.bing_ads_daily_base ................. [RUN]
[0m16:18:18.328054 [info ] [Thread-2 (]: 2 of 20 START sql view model prod-dbt-base.facebook_daily_base ................. [RUN]
[0m16:18:18.328054 [info ] [Thread-3 (]: 3 of 20 START sql view model prod-dbt-base.google_ads_daily_base ............... [RUN]
[0m16:18:18.329559 [info ] [Thread-4 (]: 4 of 20 START sql view model prod-dbt-base.hubspot_daily_base .................. [RUN]
[0m16:18:18.329559 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.bing_ads_daily_base'
[0m16:18:18.330603 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.facebook_daily_base'
[0m16:18:18.331109 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.google_ads_daily_base'
[0m16:18:18.331109 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.hubspot_daily_base'
[0m16:18:18.331109 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:18:18.331109 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.facebook_daily_base
[0m16:18:18.333412 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.google_ads_daily_base
[0m16:18:18.333412 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.hubspot_daily_base
[0m16:18:18.334874 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:18:18.337891 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:18:18.337891 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:18:18.342380 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:18:18.342380 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:18:18.344907 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.facebook_daily_base
[0m16:18:18.344907 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.google_ads_daily_base
[0m16:18:18.368913 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:18:18.368913 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.hubspot_daily_base
[0m16:18:18.373420 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:18:18.373420 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:18:18.380536 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:18:18.381547 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:18:18.383613 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:18:18.383613 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:18:18.384620 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: BEGIN
[0m16:18:18.386996 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:18:18.386996 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: BEGIN
[0m16:18:18.387502 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: BEGIN
[0m16:18:18.387502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:18:18.387502 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: BEGIN
[0m16:18:18.387502 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:18.387502 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:18:18.389606 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.389606 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:18:18.389606 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.389606 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.389606 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.389606 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.389606 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.389606 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.393252 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.765351 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.387 seconds
[0m16:18:18.765351 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:18:18.765351 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.bing_ads_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."bing_ads_daily_base__dbt_tmp" as (
    

select
    spend,
    impressions,
    clicks,
    timeperiod,
    adgroupname,
    campaignname
from bing_ads.ad_performance_report_daily
  ) ;
[0m16:18:18.781293 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.393 seconds
[0m16:18:18.781293 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:18:18.781293 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.google_ads_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."google_ads_daily_base__dbt_tmp" as (
    

select
    DATE(_data_date) as activity_date, 
    metrics_impressions as googleads_impressions,
    metrics_cost_micros  as googleads_cost, 
    metrics_clicks as googleads_clicks
from google_ads.ads_campaignbasicstats_7446470445
  ) ;
[0m16:18:18.802173 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "bing_ads" does not exist
[0m16:18:18.802173 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: ROLLBACK
[0m16:18:18.812732 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.428 seconds
[0m16:18:18.812732 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "google_ads" does not exist
[0m16:18:18.812732 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.431 seconds
[0m16:18:18.812732 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:18:18.812732 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: ROLLBACK
[0m16:18:18.820794 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:18:18.820794 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.hubspot_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."hubspot_daily_base__dbt_tmp" as (
    

with hubspot_daily as (
    SELECT
        (TIMESTAMP 'epoch' + created / 1000 * INTERVAL '1 second')::DATE AS converted_date,
        type
    FROM "integrity-db"."hubspot"."email_events")

SELECT
    converted_date,
    sum(case when type = 'SENT' then 1 else 0 end) as sent_emails,
    sum(case when type = 'OPEN' then 1 else 0 end) as opened_emails,
    sum(case when type = 'CLICK' then 1 else 0 end) as clicks,
    sum(case when type = 'BOUNCE' then 1 else 0 end) as bounces,
    sum(case when type = 'SPAMREPORT' then 1 else 0 end) as spam_reports
from hubspot_daily
group by converted_date
order by converted_date desc
  ) ;
[0m16:18:18.820794 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.facebook_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."facebook_daily_base__dbt_tmp" as (
    

select
    date_start, 
    sum(impressions) as facebook_impressions,
    sum(reach) as facebook_reach,
    sum(spend) as facebook_spend, 
    sum(clicks) as facebook_clicks,
    sum(unique_clicks) as facebook_unique_clicks
from facebook.ads_insights
group by date_start
  ) ;
[0m16:18:18.860106 [debug] [Thread-4 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:18:18.860106 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "facebook" does not exist
[0m16:18:18.860106 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: ROLLBACK
[0m16:18:18.860106 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: ROLLBACK
[0m16:18:18.875642 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: Close
[0m16:18:18.875642 [debug] [Thread-1 (]: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:18:18.875642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101483290>]}
[0m16:18:18.875642 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: Close
[0m16:18:18.875642 [error] [Thread-1 (]: 1 of 20 ERROR creating sql view model prod-dbt-base.bing_ads_daily_base ........ [[31mERROR[0m in 0.55s]
[0m16:18:18.875642 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:18:18.875642 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.marketing_cost_base
[0m16:18:18.875642 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.bing_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql.
[0m16:18:18.891287 [info ] [Thread-1 (]: 5 of 20 START sql view model prod-dbt-base.marketing_cost_base ................. [RUN]
[0m16:18:18.891287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.bing_ads_daily_base, now model.integrity_energy_dbt.marketing_cost_base)
[0m16:18:18.891287 [debug] [Thread-3 (]: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:18:18.891287 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.marketing_cost_base
[0m16:18:18.891287 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101483A90>]}
[0m16:18:18.891287 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:18:18.891287 [error] [Thread-3 (]: 3 of 20 ERROR creating sql view model prod-dbt-base.google_ads_daily_base ...... [[31mERROR[0m in 0.56s]
[0m16:18:18.891287 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:18:18.891287 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.salesforce_account_base
[0m16:18:18.891287 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.google_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql.
[0m16:18:18.891287 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.marketing_cost_base
[0m16:18:18.891287 [info ] [Thread-3 (]: 6 of 20 START sql view model prod-dbt-base.salesforce_account_base ............. [RUN]
[0m16:18:18.891287 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:18:18.891287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.google_ads_daily_base, now model.integrity_energy_dbt.salesforce_account_base)
[0m16:18:18.906905 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.salesforce_account_base
[0m16:18:18.908024 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:18:18.908024 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:18:18.908024 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: BEGIN
[0m16:18:18.908024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:18.908024 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.salesforce_account_base
[0m16:18:18.908024 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.916860 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:18:18.916860 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.920590 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:18:18.920590 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: BEGIN
[0m16:18:18.920590 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:18:18.922594 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.922594 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.934667 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: Close
[0m16:18:18.936182 [debug] [Thread-2 (]: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:18:18.938689 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: Close
[0m16:18:18.938689 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101430E50>]}
[0m16:18:18.938689 [error] [Thread-2 (]: 2 of 20 ERROR creating sql view model prod-dbt-base.facebook_daily_base ........ [[31mERROR[0m in 0.61s]
[0m16:18:18.938689 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.facebook_daily_base
[0m16:18:18.938689 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:18:18.942449 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.facebook_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql.
[0m16:18:18.943712 [debug] [Thread-4 (]: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:18:18.943712 [info ] [Thread-2 (]: 7 of 20 START sql view model prod-dbt-base.salesforce_contact_base ............. [RUN]
[0m16:18:18.943712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101614F50>]}
[0m16:18:18.943712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.facebook_daily_base, now model.integrity_energy_dbt.salesforce_contact_base)
[0m16:18:18.943712 [error] [Thread-4 (]: 4 of 20 ERROR creating sql view model prod-dbt-base.hubspot_daily_base ......... [[31mERROR[0m in 0.61s]
[0m16:18:18.943712 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.salesforce_contact_base
[0m16:18:18.946720 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:18:18.946720 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:18:18.946720 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:18:18.946720 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.hubspot_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql.
[0m16:18:18.946720 [info ] [Thread-4 (]: 8 of 20 START sql view model prod-dbt-base.salesforce_lead_base ................ [RUN]
[0m16:18:18.946720 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.salesforce_contact_base
[0m16:18:18.946720 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.hubspot_daily_base, now model.integrity_energy_dbt.salesforce_lead_base)
[0m16:18:18.956349 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:18:18.956349 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.salesforce_lead_base
[0m16:18:18.956349 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:18:18.956349 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:18:18.956349 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: BEGIN
[0m16:18:18.956349 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.salesforce_lead_base
[0m16:18:18.956349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:18:18.956349 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:18:18.956349 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.956349 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:18.956349 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:18:18.956349 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: BEGIN
[0m16:18:18.973673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:18:18.977628 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:18.977628 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:19.319620 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.412 seconds
[0m16:18:19.319620 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:18:19.319620 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.marketing_cost_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."marketing_cost_base__dbt_tmp" as (
    

select
    team,
    CAST(month as date) as month,
    CAST(REPLACE(hom_cost, ',', '') as decimal(10,2)) as hom_cost,
    CAST(REPLACE(ipr_cost, ',', '')  as decimal(10,2)) as ipr_cost,
    CAST(REPLACE(copywriter, ',', '') as decimal(10,2)) as copywriter,
    CAST(REPLACE(dango_costs, ',', '') as decimal(10,2)) as dango_costs,
    CAST(REPLACE(designer_costs, ',', '') as decimal(10,2)) as designer_costs,
    CAST(REPLACE(paid_lead_cost, ',', '') as decimal(10,2)) as paid_lead_cost,
    CAST(REPLACE(data_contractor, ',', '') as decimal(10,2)) as data_contractor,
    CAST(REPLACE(seo_lead_salary, ',', '') as decimal(10,2)) as seo_lead_salary,
    CAST(REPLACE(contractor_costs, ',', '') as decimal(10,2)) as contractor_costs,
    CAST(REPLACE(paid_agency_cost, ',', '') as decimal(10,2)) as paid_agency_cost,
    CAST(REPLACE(paid_support_cost, ',', '') as decimal(10,2)) as paid_support_cost,
    CAST(REPLACE(project_management, ',', '') as decimal(10,2)) as project_management,
    CAST(REPLACE(crowd_content_costs, ',', '') as decimal(10,2)) as crowd_content_costs,
    CAST(REPLACE(email_contractor_costs, ',', '') as decimal(10,2)) as email_contractor_costs,
    CAST(REPLACE(hubspot_contractor_costs, ',', '') as decimal(10,2)) as hubspot_contractor_costs
from google_sheets.monthly_cost
  ) ;
[0m16:18:19.335723 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.422 seconds
[0m16:18:19.344786 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:18:19.344786 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_account_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_account_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    phone,
    industry,
    billingcity,
    billingcountry,
    billingcountrycode,
    billingpostalcode,
    billingstreet,
    main_phone__c
    --utility_company__c
from salesforce.account
  ) ;
[0m16:18:19.367985 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "google_sheets" does not exist
[0m16:18:19.367985 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: ROLLBACK
[0m16:18:19.374126 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.411 seconds
[0m16:18:19.375311 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:18:19.375311 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_contact_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_contact_base__dbt_tmp" as (
    

select
    id,
    name,
    email,
    phone,
    mobilephone,
    main_phone__c,
    title,
    createddate,
    mailingcity,
    mailingstate,
    mailingstatecode,
    mailingcountry,
    accountid,
    rep_last_first__c,
    customer_account_number__c,
    contract_signer_phone_email__c
from salesforce.contact
  ) ;
[0m16:18:19.375311 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.402 seconds
[0m16:18:19.375311 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:18:19.378808 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_lead_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_lead_base__dbt_tmp" as (
    

select
    id,
    city,
    name,
    email,
    phone,
    state,
    title,
    status,
    street,
    company,
    country,
    firstname,
    lastname,
    source__c,
    channel__c,
    leadsource,
    postalcode,
    createddate,
    CAST(createddate as DATE) as createdday,
    isconverted,
    commodity__c,
    converteddate,
    lastactivitydate,
    convertedaccountid,
    convertedcontactid,
    lead_id_for_opp__c,
    average_bill_amount__c,
    convertedopportunityid,
    converted_from_lead__c,
    marketing_generator__c,
    new_ready_to_work_date__c,
    last_activity_note_date__c
from salesforce.lead
  ) ;
[0m16:18:19.378808 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:18:19.381639 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: ROLLBACK
[0m16:18:19.407431 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:18:19.407431 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:18:19.414047 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: ROLLBACK
[0m16:18:19.414047 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: ROLLBACK
[0m16:18:19.435985 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: Close
[0m16:18:19.439723 [debug] [Thread-1 (]: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:18:19.439723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101614210>]}
[0m16:18:19.439723 [error] [Thread-1 (]: 5 of 20 ERROR creating sql view model prod-dbt-base.marketing_cost_base ........ [[31mERROR[0m in 0.55s]
[0m16:18:19.439723 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.marketing_cost_base
[0m16:18:19.439723 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:18:19.439723 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.marketing_cost_base' to be skipped because of status 'error'.  Reason: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql.
[0m16:18:19.439723 [info ] [Thread-1 (]: 9 of 20 START sql view model prod-dbt-base.salesforce_meter_number_base ........ [RUN]
[0m16:18:19.439723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.marketing_cost_base, now model.integrity_energy_dbt.salesforce_meter_number_base)
[0m16:18:19.439723 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:18:19.447234 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:18:19.447234 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:18:19.451953 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:18:19.451953 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: Close
[0m16:18:19.454184 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:18:19.454184 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: BEGIN
[0m16:18:19.455772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:19.455772 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:19.456979 [debug] [Thread-3 (]: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:18:19.456979 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:19.456979 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101410310>]}
[0m16:18:19.459015 [error] [Thread-3 (]: 6 of 20 ERROR creating sql view model prod-dbt-base.salesforce_account_base .... [[31mERROR[0m in 0.57s]
[0m16:18:19.460444 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.salesforce_account_base
[0m16:18:19.460444 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:18:19.460444 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_account_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql.
[0m16:18:19.460444 [info ] [Thread-3 (]: 10 of 20 START sql view model prod-dbt-base.salesforce_opportunity_base ........ [RUN]
[0m16:18:19.460444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_account_base, now model.integrity_energy_dbt.salesforce_opportunity_base)
[0m16:18:19.463156 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:18:19.465493 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:18:19.466921 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:18:19.469479 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:18:19.473278 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:18:19.473278 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: BEGIN
[0m16:18:19.473278 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:18:19.477396 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:19.477396 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:19.479418 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: Close
[0m16:18:19.482909 [debug] [Thread-2 (]: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:18:19.482909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17ED27FD0>]}
[0m16:18:19.482909 [error] [Thread-2 (]: 7 of 20 ERROR creating sql view model prod-dbt-base.salesforce_contact_base .... [[31mERROR[0m in 0.54s]
[0m16:18:19.484773 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:18:19.484773 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.utility_lead_base
[0m16:18:19.486197 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_contact_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql.
[0m16:18:19.486197 [info ] [Thread-2 (]: 11 of 20 START sql view model prod-dbt-base.utility_lead_base .................. [RUN]
[0m16:18:19.487406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_contact_base, now model.integrity_energy_dbt.utility_lead_base)
[0m16:18:19.488528 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.utility_lead_base
[0m16:18:19.489551 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:18:19.489551 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: Close
[0m16:18:19.495091 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.utility_lead_base
[0m16:18:19.497596 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:18:19.500601 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:18:19.500601 [debug] [Thread-4 (]: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:18:19.500601 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: BEGIN
[0m16:18:19.500601 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1003EB450>]}
[0m16:18:19.505596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:18:19.505596 [error] [Thread-4 (]: 8 of 20 ERROR creating sql view model prod-dbt-base.salesforce_lead_base ....... [[31mERROR[0m in 0.55s]
[0m16:18:19.505596 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:19.506997 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:18:19.506997 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:19.508208 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.zoominfo_base
[0m16:18:19.508208 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql.
[0m16:18:19.509478 [info ] [Thread-4 (]: 12 of 20 START sql view model prod-dbt-base.zoominfo_base ...................... [RUN]
[0m16:18:19.510651 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_lead_base, now model.integrity_energy_dbt.zoominfo_base)
[0m16:18:19.510651 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.zoominfo_base
[0m16:18:19.512188 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:18:19.513441 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.zoominfo_base
[0m16:18:19.515871 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:18:19.515871 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:18:19.518780 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: BEGIN
[0m16:18:19.520265 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:18:19.520265 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:19.526036 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:19.851013 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.395 seconds
[0m16:18:19.851013 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:18:19.852280 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_meter_number_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_meter_number_base__dbt_tmp" as (
    

select
    id,
    name,
    city__c,
    state__c,
    street__c,
    zip_code__c,
    mils__c,
    commodity__c,
    createddate,
    service_address__c,
    status__c,
    account__c,
    dl_account__c,
    account_number__c
from salesforce.meter_number__c
  ) ;
[0m16:18:19.882213 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.409 seconds
[0m16:18:19.882213 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:18:19.882213 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_opportunity_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_opportunity_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    iswon,
    fiscal,
    mils__c,
    ownerid,
    rate__c,
    term__c,
    team__c,
    source__c,
    marketing_generator__c,
    isclosed,
    notes__c,
    accountid,
    csdate__c,
    closedate,
    driver__c,
    meters__c,
    points__c,
    stagename,
    status__c,
    channel__c,
    dl_2000__c,
    dl_4000__c,
    dl_6000__c,
    leadsource,
    manager__c,
    re_sold__c,
    renewed__c,
    createddate,
    residual__c,
    sp_rt_id__c,
    subagent__c,
    supplier__c,
    commodity__c,
    rate_type__c,
    sp_points__c,
    sold_date__c,
    broker_fee__c,
    cancel_fee__c,
    usage_type__c,
    cancel_date__c,
    dl_1500_kwh__c,
    dl_2500_kwh__c,
    dl_3500_kwh__c,
    dl_rate_gas__c,
    dl_term_gas__c,
    dl_owner_alias__c,
    lost_reason__c,
    meter_usage__c,
    owner_title__c,
    real_points__c,
    total_usage__c,
    dl_start_gas__c,
    dl_usage_gas__c,
    do_not_renew__c,
    renewal_date__c,
    sales_person__c,
    total_points__c,
    utility_text__c,
    sales_manager__c,
    supplier_text__c,
    agent_takeback__c,
    canceled_usage__c,
    commodity_text__c,
    contract_signer__c,
    cancelled_points__c,
    supplier_credits__c,
    commission_matrix__c,
    contract_end_date__c,
    broker_fee_rounded__c,
    commission_percent__c,
    last_activity_note__c,
    confirmation_number__c,
    contract_start_date__c,
    contract_signer_email__c,
    contract_signer_phone_email__c,
    contract_signer_facilitator__c
from salesforce.opportunity
  ) ;
[0m16:18:19.882213 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:18:19.882213 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: ROLLBACK
[0m16:18:19.929368 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:18:19.929368 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: ROLLBACK
[0m16:18:19.929368 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.431 seconds
[0m16:18:19.929368 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:18:19.929368 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.utility_lead_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."utility_lead_base__dbt_tmp" as (
    

select
        u.companyname,
        u.serviceaddress,
        u.servicecity,
        u.servicestate,
        u.servicezip,
        u.utility,
        u.accountnumber,
        u.annualusage,
        u.ratecode,
        e."eru lastname" as lastname,
        e."eru firstname" as firstname,
        e."eru titledesc" as title,
        e."be telephone number10" as phone,
        e."bee email addr80" as email
from utility_leads.utilitylead as u
left join utility_leads.enriched as e 
on u.companyname = e.companyname 
AND u.serviceaddress = e.serviceaddress
AND u.utility = e.utility
AND u.servicecity = e.servicecity
AND u.servicestate = e.servicestate
AND u.ratecode = e.ratecode
GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14
  ) ;
[0m16:18:19.929368 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.419 seconds
[0m16:18:19.929368 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:18:19.929368 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.zoominfo_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."zoominfo_base__dbt_tmp" as (
    select * from zoominfo.zoominfo_upload_09202024
  ) ;
[0m16:18:19.948764 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: Close
[0m16:18:19.948764 [debug] [Thread-1 (]: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:18:19.948764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17EDD3F90>]}
[0m16:18:19.948764 [error] [Thread-1 (]: 9 of 20 ERROR creating sql view model prod-dbt-base.salesforce_meter_number_base  [[31mERROR[0m in 0.51s]
[0m16:18:19.957376 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:18:19.957376 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_meter_number_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql.
[0m16:18:19.976469 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "utility_leads" does not exist
[0m16:18:19.976469 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: ROLLBACK
[0m16:18:19.976469 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "zoominfo" does not exist
[0m16:18:19.976469 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: ROLLBACK
[0m16:18:19.997057 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: Close
[0m16:18:20.008063 [debug] [Thread-3 (]: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:18:20.008063 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101E2CDD0>]}
[0m16:18:20.008063 [error] [Thread-3 (]: 10 of 20 ERROR creating sql view model prod-dbt-base.salesforce_opportunity_base  [[31mERROR[0m in 0.55s]
[0m16:18:20.008063 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:18:20.008063 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_opportunity_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql.
[0m16:18:20.008063 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.deal_intermediate
[0m16:18:20.008063 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.marketing_intermediate
[0m16:18:20.013317 [info ] [Thread-1 (]: 13 of 20 SKIP relation prod-dbt-intermediate.deal_intermediate ................. [[33mSKIP[0m]
[0m16:18:20.013317 [info ] [Thread-3 (]: 14 of 20 SKIP relation prod-dbt-intermediate.marketing_intermediate ............ [[33mSKIP[0m]
[0m16:18:20.013317 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.deal_intermediate
[0m16:18:20.014607 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.marketing_intermediate
[0m16:18:20.015872 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.deal_prod
[0m16:18:20.016412 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.marketing_prod
[0m16:18:20.016412 [info ] [Thread-1 (]: 15 of 20 SKIP relation prod-dbt-mart.deal_prod ................................. [[33mSKIP[0m]
[0m16:18:20.016412 [info ] [Thread-3 (]: 16 of 20 SKIP relation prod-dbt-mart.marketing_prod ............................ [[33mSKIP[0m]
[0m16:18:20.016412 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.deal_prod
[0m16:18:20.016412 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.marketing_prod
[0m16:18:20.039839 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: Close
[0m16:18:20.048848 [debug] [Thread-2 (]: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:18:20.048848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1017E9390>]}
[0m16:18:20.048848 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: Close
[0m16:18:20.048848 [error] [Thread-2 (]: 11 of 20 ERROR creating sql view model prod-dbt-base.utility_lead_base ......... [[31mERROR[0m in 0.56s]
[0m16:18:20.052052 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.utility_lead_base
[0m16:18:20.052052 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.utility_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql.
[0m16:18:20.052052 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.lead_intermediate
[0m16:18:20.052052 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:18:20.055537 [debug] [Thread-4 (]: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:18:20.055537 [info ] [Thread-1 (]: 17 of 20 SKIP relation prod-dbt-intermediate.lead_intermediate ................. [[33mSKIP[0m]
[0m16:18:20.055537 [info ] [Thread-3 (]: 18 of 20 SKIP relation prod-dbt-intermediate.utility_lead_intermediate ......... [[33mSKIP[0m]
[0m16:18:20.055537 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acca903-b0a9-41c3-9c5a-64210663a96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F101430E50>]}
[0m16:18:20.055537 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.lead_intermediate
[0m16:18:20.055537 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:18:20.055537 [error] [Thread-4 (]: 12 of 20 ERROR creating sql view model prod-dbt-base.zoominfo_base ............. [[31mERROR[0m in 0.54s]
[0m16:18:20.055537 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.lead_prod
[0m16:18:20.055537 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.utility_lead_prod
[0m16:18:20.055537 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.zoominfo_base
[0m16:18:20.055537 [info ] [Thread-2 (]: 19 of 20 SKIP relation prod-dbt-mart.lead_prod ................................. [[33mSKIP[0m]
[0m16:18:20.055537 [info ] [Thread-1 (]: 20 of 20 SKIP relation prod-dbt-mart.utility_lead_prod ......................... [[33mSKIP[0m]
[0m16:18:20.055537 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.zoominfo_base' to be skipped because of status 'error'.  Reason: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql.
[0m16:18:20.055537 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.lead_prod
[0m16:18:20.055537 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.utility_lead_prod
[0m16:18:20.065098 [debug] [MainThread]: Using redshift connection "master"
[0m16:18:20.065098 [debug] [MainThread]: On master: BEGIN
[0m16:18:20.065098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:20.065098 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:18:20.065098 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:18:20.439337 [debug] [MainThread]: SQL status: SUCCESS in 0.374 seconds
[0m16:18:20.439337 [debug] [MainThread]: On master: COMMIT
[0m16:18:20.439337 [debug] [MainThread]: Using redshift connection "master"
[0m16:18:20.439337 [debug] [MainThread]: On master: COMMIT
[0m16:18:20.521099 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m16:18:20.521099 [debug] [MainThread]: On master: Close
[0m16:18:20.521099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:20.521099 [debug] [MainThread]: Connection 'list_integrity-db-dev' was properly closed.
[0m16:18:20.524646 [debug] [MainThread]: Connection 'list_integrity-db-dev' was properly closed.
[0m16:18:20.524646 [debug] [MainThread]: Connection 'list_integrity-db-dev' was properly closed.
[0m16:18:20.524646 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-base' was properly closed.
[0m16:18:20.525860 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-mart' was properly closed.
[0m16:18:20.526366 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-intermediate' was properly closed.
[0m16:18:20.526366 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.salesforce_meter_number_base' was properly closed.
[0m16:18:20.526366 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.utility_lead_base' was properly closed.
[0m16:18:20.527386 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.salesforce_opportunity_base' was properly closed.
[0m16:18:20.527386 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.zoominfo_base' was properly closed.
[0m16:18:20.527386 [info ] [MainThread]: 
[0m16:18:20.528715 [info ] [MainThread]: Finished running 3 table models, 17 view models in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m16:18:20.530260 [debug] [MainThread]: Command end result
[0m16:18:20.549905 [info ] [MainThread]: 
[0m16:18:20.549905 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successs, and 0 warnings:[0m
[0m16:18:20.549905 [info ] [MainThread]: 
[0m16:18:20.565309 [error] [MainThread]:   Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:18:20.565309 [info ] [MainThread]: 
[0m16:18:20.565309 [error] [MainThread]:   Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:18:20.565309 [info ] [MainThread]: 
[0m16:18:20.565309 [error] [MainThread]:   Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:18:20.565309 [info ] [MainThread]: 
[0m16:18:20.568475 [error] [MainThread]:   Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:18:20.568475 [info ] [MainThread]: 
[0m16:18:20.568475 [error] [MainThread]:   Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:18:20.569739 [info ] [MainThread]: 
[0m16:18:20.569739 [error] [MainThread]:   Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:18:20.569739 [info ] [MainThread]: 
[0m16:18:20.571442 [error] [MainThread]:   Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:18:20.571442 [info ] [MainThread]: 
[0m16:18:20.572533 [error] [MainThread]:   Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:18:20.572533 [info ] [MainThread]: 
[0m16:18:20.572533 [error] [MainThread]:   Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:18:20.573851 [info ] [MainThread]: 
[0m16:18:20.573851 [error] [MainThread]:   Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:18:20.573851 [info ] [MainThread]: 
[0m16:18:20.575020 [error] [MainThread]:   Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:18:20.575020 [info ] [MainThread]: 
[0m16:18:20.575020 [error] [MainThread]:   Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:18:20.575020 [info ] [MainThread]: 
[0m16:18:20.576224 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=12 SKIP=8 TOTAL=20
[0m16:18:20.577368 [debug] [MainThread]: Command `dbt run` failed at 16:18:20.577368 after 5.09 seconds
[0m16:18:20.577368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F9132D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17961E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F71C210>]}
[0m16:18:20.577368 [debug] [MainThread]: Flushing usage events
[0m16:18:20.886428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:54.398483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AAABE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AAABF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AAABE250>]}


============================== 16:19:54.401588 | bf3e21ac-48aa-4922-8492-ac5be8e7cfd8 ==============================
[0m16:19:54.401588 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:19:54.402588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:19:54.498656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf3e21ac-48aa-4922-8492-ac5be8e7cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AAB67D10>]}
[0m16:19:54.551815 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-xdwbxlrg'
[0m16:19:54.551815 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:19:54.815345 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:19:54.816343 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:19:54.978140 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:19:54.982453 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:19:55.636666 [info ] [MainThread]: Installed from version 1.0.0
[0m16:19:55.636666 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:19:55.637671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bf3e21ac-48aa-4922-8492-ac5be8e7cfd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AABB45D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AAAEE5D0>]}
[0m16:19:55.638666 [info ] [MainThread]: 
[0m16:19:55.638666 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:19:55.640877 [debug] [MainThread]: Command `dbt deps` succeeded at 16:19:55.640877 after 1.31 seconds
[0m16:19:55.640877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243A47BA010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243A451FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243A451FE10>]}
[0m16:19:55.640877 [debug] [MainThread]: Flushing usage events
[0m16:19:55.859186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:04.226939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DBE22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DBE3BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DBE2690>]}


============================== 16:20:04.233956 | 22910c34-1cbf-42cb-855c-5096ea3dca9d ==============================
[0m16:20:04.233956 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:20:04.233956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:daily --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:04.355966 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:20:04.355966 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:20:04.479894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112E49ED50>]}
[0m16:20:04.532007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112ACA1310>]}
[0m16:20:04.532007 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:20:04.543024 [debug] [MainThread]: checksum: 28c00772bd96551ae2f98126ebf7713c9e121e5f4a1fdbf780c14a568fdbecdb, vars: {}, profile: , target: dev, version: 1.9.0b2
[0m16:20:04.699870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:04.699870 [debug] [MainThread]: Partial parsing: updated file: integrity_energy_dbt://models\sources.yml
[0m16:20:04.826294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112E5E3F90>]}
[0m16:20:04.889458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F8A5D50>]}
[0m16:20:04.889458 [info ] [MainThread]: Found 20 models, 20 sources, 602 macros
[0m16:20:04.889458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F9AC4D0>]}
[0m16:20:04.905100 [info ] [MainThread]: 
[0m16:20:04.906733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:04.906733 [info ] [MainThread]: 
[0m16:20:04.906733 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:20:04.908654 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:20:04.908654 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:20:04.921193 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:20:04.921193 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:20:04.921193 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:20:04.984004 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:20:04.984004 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:20:04.984004 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:20:04.984004 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:20:04.984004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:04.984004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:04.984004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:04.984004 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:04.984004 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:04.984004 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:04.984004 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:04.984004 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:04.984004 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:05.554946 [debug] [ThreadPool]: SQL status: SUCCESS in 0.569 seconds
[0m16:20:05.557079 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:20:05.572497 [debug] [ThreadPool]: SQL status: SUCCESS in 0.587 seconds
[0m16:20:05.574527 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:20:05.590487 [debug] [ThreadPool]: SQL status: SUCCESS in 0.605 seconds
[0m16:20:05.592709 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:20:05.595681 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-base'
[0m16:20:05.595681 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-intermediate'
[0m16:20:05.603202 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-base"
[0m16:20:05.603202 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_prod-dbt-mart'
[0m16:20:05.606202 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-intermediate"
[0m16:20:05.607207 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: BEGIN
[0m16:20:05.609202 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-mart"
[0m16:20:05.610203 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: BEGIN
[0m16:20:05.610203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:05.610203 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: BEGIN
[0m16:20:05.611207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:05.611207 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:05.612204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:05.612204 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:05.612204 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:05.613264 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:05.613264 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:05.614954 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:05.979741 [debug] [ThreadPool]: SQL status: SUCCESS in 0.368 seconds
[0m16:20:05.980680 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-mart"
[0m16:20:05.980680 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-mart"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-mart'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-mart'
[0m16:20:06.013239 [debug] [ThreadPool]: SQL status: SUCCESS in 0.402 seconds
[0m16:20:06.014238 [debug] [ThreadPool]: SQL status: SUCCESS in 0.404 seconds
[0m16:20:06.014238 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-intermediate"
[0m16:20:06.015225 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_prod-dbt-base"
[0m16:20:06.015225 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-intermediate"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-intermediate'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-intermediate'
[0m16:20:06.015225 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_prod-dbt-base"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'prod-dbt-base'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'prod-dbt-base'
[0m16:20:06.091909 [debug] [ThreadPool]: SQL status: SUCCESS in 0.110 seconds
[0m16:20:06.093552 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: ROLLBACK
[0m16:20:06.119705 [debug] [ThreadPool]: SQL status: SUCCESS in 0.103 seconds
[0m16:20:06.120704 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: ROLLBACK
[0m16:20:06.128838 [debug] [ThreadPool]: SQL status: SUCCESS in 0.112 seconds
[0m16:20:06.130866 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: ROLLBACK
[0m16:20:06.153865 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-mart: Close
[0m16:20:06.209825 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-intermediate: Close
[0m16:20:06.210827 [debug] [ThreadPool]: On list_integrity-db-dev_prod-dbt-base: Close
[0m16:20:06.219747 [debug] [MainThread]: Using redshift connection "master"
[0m16:20:06.220748 [debug] [MainThread]: On master: BEGIN
[0m16:20:06.220748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:06.220748 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:06.222044 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:06.579252 [debug] [MainThread]: SQL status: SUCCESS in 0.358 seconds
[0m16:20:06.580274 [debug] [MainThread]: Using redshift connection "master"
[0m16:20:06.580274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:20:06.662055 [debug] [MainThread]: SQL status: SUCCESS in 0.081 seconds
[0m16:20:06.663392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F95AD90>]}
[0m16:20:06.663392 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:06.729354 [debug] [MainThread]: Using redshift connection "master"
[0m16:20:06.730350 [debug] [MainThread]: On master: BEGIN
[0m16:20:06.760456 [debug] [MainThread]: SQL status: SUCCESS in 0.030 seconds
[0m16:20:06.761456 [debug] [MainThread]: On master: COMMIT
[0m16:20:06.761456 [debug] [MainThread]: Using redshift connection "master"
[0m16:20:06.761456 [debug] [MainThread]: On master: COMMIT
[0m16:20:06.826699 [debug] [MainThread]: SQL status: SUCCESS in 0.064 seconds
[0m16:20:06.827518 [debug] [MainThread]: On master: Close
[0m16:20:06.835794 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:20:06.836801 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.facebook_daily_base
[0m16:20:06.836801 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:20:06.836801 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:20:06.838093 [info ] [Thread-1 (]: 1 of 20 START sql view model prod-dbt-base.bing_ads_daily_base ................. [RUN]
[0m16:20:06.838600 [info ] [Thread-2 (]: 2 of 20 START sql view model prod-dbt-base.facebook_daily_base ................. [RUN]
[0m16:20:06.839626 [info ] [Thread-3 (]: 3 of 20 START sql view model prod-dbt-base.google_ads_daily_base ............... [RUN]
[0m16:20:06.839626 [info ] [Thread-4 (]: 4 of 20 START sql view model prod-dbt-base.hubspot_daily_base .................. [RUN]
[0m16:20:06.840631 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.bing_ads_daily_base'
[0m16:20:06.840631 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.facebook_daily_base'
[0m16:20:06.841910 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.google_ads_daily_base'
[0m16:20:06.841910 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.hubspot_daily_base'
[0m16:20:06.843080 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:20:06.843080 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.facebook_daily_base
[0m16:20:06.844090 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.google_ads_daily_base
[0m16:20:06.845088 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.hubspot_daily_base
[0m16:20:06.848087 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:20:06.850089 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:20:06.852593 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:20:06.854604 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:20:06.855623 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:20:06.856599 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.facebook_daily_base
[0m16:20:06.868181 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.google_ads_daily_base
[0m16:20:06.883396 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:20:06.883396 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.hubspot_daily_base
[0m16:20:06.886399 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:20:06.889395 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:20:06.892967 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:20:06.893969 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:20:06.896064 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:20:06.896064 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: BEGIN
[0m16:20:06.897480 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:20:06.898990 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:20:06.899991 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: BEGIN
[0m16:20:06.899991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:06.899991 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: BEGIN
[0m16:20:06.900991 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: BEGIN
[0m16:20:06.900991 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:20:06.900991 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:06.902398 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:20:06.902398 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:06.902398 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:06.903402 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:06.903402 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:06.904414 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:06.904414 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:06.905410 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:06.905410 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:07.317852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.418 seconds
[0m16:20:07.318871 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.418 seconds
[0m16:20:07.319877 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.417 seconds
[0m16:20:07.319877 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:20:07.320863 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:20:07.320863 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:20:07.321890 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.bing_ads_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."bing_ads_daily_base__dbt_tmp" as (
    

select
    spend,
    impressions,
    clicks,
    timeperiod,
    adgroupname,
    campaignname
from bing_ads.ad_performance_report_daily
  ) ;
[0m16:20:07.322402 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.facebook_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."facebook_daily_base__dbt_tmp" as (
    

select
    date_start, 
    sum(impressions) as facebook_impressions,
    sum(reach) as facebook_reach,
    sum(spend) as facebook_spend, 
    sum(clicks) as facebook_clicks,
    sum(unique_clicks) as facebook_unique_clicks
from facebook.ads_insights
group by date_start
  ) ;
[0m16:20:07.322402 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.google_ads_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."google_ads_daily_base__dbt_tmp" as (
    

select
    DATE(_data_date) as activity_date, 
    metrics_impressions as googleads_impressions,
    metrics_cost_micros  as googleads_cost, 
    metrics_clicks as googleads_clicks
from google_ads.ads_campaignbasicstats_7446470445
  ) ;
[0m16:20:07.324553 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.423 seconds
[0m16:20:07.325566 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:20:07.325566 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.hubspot_daily_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."hubspot_daily_base__dbt_tmp" as (
    

with hubspot_daily as (
    SELECT
        (TIMESTAMP 'epoch' + created / 1000 * INTERVAL '1 second')::DATE AS converted_date,
        type
    FROM "integrity-db"."hubspot"."email_events")

SELECT
    converted_date,
    sum(case when type = 'SENT' then 1 else 0 end) as sent_emails,
    sum(case when type = 'OPEN' then 1 else 0 end) as opened_emails,
    sum(case when type = 'CLICK' then 1 else 0 end) as clicks,
    sum(case when type = 'BOUNCE' then 1 else 0 end) as bounces,
    sum(case when type = 'SPAMREPORT' then 1 else 0 end) as spam_reports
from hubspot_daily
group by converted_date
order by converted_date desc
  ) ;
[0m16:20:07.371570 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "google_ads" does not exist
[0m16:20:07.372566 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "bing_ads" does not exist
[0m16:20:07.372566 [debug] [Thread-4 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:20:07.373564 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "facebook" does not exist
[0m16:20:07.373564 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: ROLLBACK
[0m16:20:07.374563 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: ROLLBACK
[0m16:20:07.374563 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: ROLLBACK
[0m16:20:07.375562 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: ROLLBACK
[0m16:20:07.443401 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: Close
[0m16:20:07.443401 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: Close
[0m16:20:07.444663 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: Close
[0m16:20:07.445167 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: Close
[0m16:20:07.453606 [debug] [Thread-3 (]: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:20:07.455613 [debug] [Thread-4 (]: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:20:07.455613 [debug] [Thread-2 (]: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:20:07.457526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112E482B90>]}
[0m16:20:07.459035 [debug] [Thread-1 (]: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:20:07.460041 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DC12350>]}
[0m16:20:07.460041 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DBC2690>]}
[0m16:20:07.461042 [error] [Thread-3 (]: 3 of 20 ERROR creating sql view model prod-dbt-base.google_ads_daily_base ...... [[31mERROR[0m in 0.62s]
[0m16:20:07.461042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F8BF690>]}
[0m16:20:07.462042 [error] [Thread-4 (]: 4 of 20 ERROR creating sql view model prod-dbt-base.hubspot_daily_base ......... [[31mERROR[0m in 0.62s]
[0m16:20:07.463042 [error] [Thread-2 (]: 2 of 20 ERROR creating sql view model prod-dbt-base.facebook_daily_base ........ [[31mERROR[0m in 0.62s]
[0m16:20:07.463042 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:20:07.464042 [error] [Thread-1 (]: 1 of 20 ERROR creating sql view model prod-dbt-base.bing_ads_daily_base ........ [[31mERROR[0m in 0.62s]
[0m16:20:07.465041 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:20:07.465041 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.facebook_daily_base
[0m16:20:07.466043 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.marketing_cost_base
[0m16:20:07.466043 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.google_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql.
[0m16:20:07.467043 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:20:07.467043 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.salesforce_account_base
[0m16:20:07.468041 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:20:07.468041 [info ] [Thread-3 (]: 5 of 20 START sql view model prod-dbt-base.marketing_cost_base ................. [RUN]
[0m16:20:07.469235 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.hubspot_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql.
[0m16:20:07.470264 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:20:07.470264 [info ] [Thread-4 (]: 6 of 20 START sql view model prod-dbt-base.salesforce_account_base ............. [RUN]
[0m16:20:07.470264 [info ] [Thread-2 (]: 7 of 20 START sql view model prod-dbt-base.salesforce_contact_base ............. [RUN]
[0m16:20:07.470264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.google_ads_daily_base, now model.integrity_energy_dbt.marketing_cost_base)
[0m16:20:07.470264 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.facebook_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql.
[0m16:20:07.470264 [info ] [Thread-1 (]: 8 of 20 START sql view model prod-dbt-base.salesforce_lead_base ................ [RUN]
[0m16:20:07.470264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.hubspot_daily_base, now model.integrity_energy_dbt.salesforce_account_base)
[0m16:20:07.470264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.facebook_daily_base, now model.integrity_energy_dbt.salesforce_contact_base)
[0m16:20:07.470264 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.marketing_cost_base
[0m16:20:07.470264 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.bing_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql.
[0m16:20:07.470264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.bing_ads_daily_base, now model.integrity_energy_dbt.salesforce_lead_base)
[0m16:20:07.470264 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.salesforce_account_base
[0m16:20:07.470264 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.salesforce_contact_base
[0m16:20:07.470264 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:20:07.470264 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.salesforce_lead_base
[0m16:20:07.470264 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:20:07.484773 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:20:07.487173 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:20:07.487173 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.marketing_cost_base
[0m16:20:07.490281 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.salesforce_account_base
[0m16:20:07.492273 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:20:07.492273 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.salesforce_contact_base
[0m16:20:07.492273 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.salesforce_lead_base
[0m16:20:07.496689 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:20:07.498867 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:20:07.500872 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:20:07.500872 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:20:07.500872 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:20:07.500872 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_cost_base: BEGIN
[0m16:20:07.500872 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:20:07.513888 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:20:07.513888 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: BEGIN
[0m16:20:07.513888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:07.513888 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: BEGIN
[0m16:20:07.513888 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_lead_base: BEGIN
[0m16:20:07.516894 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:07.516894 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:07.517901 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:07.517901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:07.517901 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:07.517901 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:07.517901 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:07.517901 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:07.517901 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:07.517901 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:07.517901 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:07.918579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.404 seconds
[0m16:20:07.918579 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:20:07.918579 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_lead_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_lead_base__dbt_tmp" as (
    

select
    id,
    city,
    name,
    email,
    phone,
    state,
    title,
    status,
    street,
    company,
    country,
    firstname,
    lastname,
    source__c,
    channel__c,
    leadsource,
    postalcode,
    createddate,
    CAST(createddate as DATE) as createdday,
    isconverted,
    commodity__c,
    converteddate,
    lastactivitydate,
    convertedaccountid,
    convertedcontactid,
    lead_id_for_opp__c,
    average_bill_amount__c,
    convertedopportunityid,
    converted_from_lead__c,
    marketing_generator__c,
    new_ready_to_work_date__c,
    last_activity_note_date__c
from salesforce.lead
  ) ;
[0m16:20:07.918579 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.411 seconds
[0m16:20:07.929586 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:20:07.929586 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_contact_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_contact_base__dbt_tmp" as (
    

select
    id,
    name,
    email,
    phone,
    mobilephone,
    main_phone__c,
    title,
    createddate,
    mailingcity,
    mailingstate,
    mailingstatecode,
    mailingcountry,
    accountid,
    rep_last_first__c,
    customer_account_number__c,
    contract_signer_phone_email__c
from salesforce.contact
  ) ;
[0m16:20:07.932546 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.418 seconds
[0m16:20:07.932546 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:20:07.932546 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_cost_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.marketing_cost_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."marketing_cost_base__dbt_tmp" as (
    

select
    team,
    CAST(month as date) as month,
    CAST(REPLACE(hom_cost, ',', '') as decimal(10,2)) as hom_cost,
    CAST(REPLACE(ipr_cost, ',', '')  as decimal(10,2)) as ipr_cost,
    CAST(REPLACE(copywriter, ',', '') as decimal(10,2)) as copywriter,
    CAST(REPLACE(dango_costs, ',', '') as decimal(10,2)) as dango_costs,
    CAST(REPLACE(designer_costs, ',', '') as decimal(10,2)) as designer_costs,
    CAST(REPLACE(paid_lead_cost, ',', '') as decimal(10,2)) as paid_lead_cost,
    CAST(REPLACE(data_contractor, ',', '') as decimal(10,2)) as data_contractor,
    CAST(REPLACE(seo_lead_salary, ',', '') as decimal(10,2)) as seo_lead_salary,
    CAST(REPLACE(contractor_costs, ',', '') as decimal(10,2)) as contractor_costs,
    CAST(REPLACE(paid_agency_cost, ',', '') as decimal(10,2)) as paid_agency_cost,
    CAST(REPLACE(paid_support_cost, ',', '') as decimal(10,2)) as paid_support_cost,
    CAST(REPLACE(project_management, ',', '') as decimal(10,2)) as project_management,
    CAST(REPLACE(crowd_content_costs, ',', '') as decimal(10,2)) as crowd_content_costs,
    CAST(REPLACE(email_contractor_costs, ',', '') as decimal(10,2)) as email_contractor_costs,
    CAST(REPLACE(hubspot_contractor_costs, ',', '') as decimal(10,2)) as hubspot_contractor_costs
from google_sheets.monthly_cost
  ) ;
[0m16:20:07.932546 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.425 seconds
[0m16:20:07.932546 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:20:07.932546 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_account_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_account_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    phone,
    industry,
    billingcity,
    billingcountry,
    billingcountrycode,
    billingpostalcode,
    billingstreet,
    main_phone__c
    --utility_company__c
from salesforce.account
  ) ;
[0m16:20:07.945552 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:20:07.945552 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_lead_base: ROLLBACK
[0m16:20:07.959171 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:20:07.961692 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: ROLLBACK
[0m16:20:07.964719 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "google_sheets" does not exist
[0m16:20:07.964719 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_cost_base: ROLLBACK
[0m16:20:07.964719 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:20:07.964719 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: ROLLBACK
[0m16:20:08.025039 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_lead_base: Close
[0m16:20:08.025039 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: Close
[0m16:20:08.029885 [debug] [Thread-1 (]: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:20:08.029885 [debug] [Thread-2 (]: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:20:08.031497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F6A5650>]}
[0m16:20:08.032002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F6A5A50>]}
[0m16:20:08.032002 [error] [Thread-1 (]: 8 of 20 ERROR creating sql view model prod-dbt-base.salesforce_lead_base ....... [[31mERROR[0m in 0.56s]
[0m16:20:08.032002 [error] [Thread-2 (]: 7 of 20 ERROR creating sql view model prod-dbt-base.salesforce_contact_base .... [[31mERROR[0m in 0.56s]
[0m16:20:08.032002 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:20:08.032002 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:20:08.035933 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:20:08.036442 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql.
[0m16:20:08.036442 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:20:08.036442 [debug] [Thread-3 (]: On model.integrity_energy_dbt.marketing_cost_base: Close
[0m16:20:08.036442 [info ] [Thread-1 (]: 9 of 20 START sql view model prod-dbt-base.salesforce_meter_number_base ........ [RUN]
[0m16:20:08.036442 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_contact_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql.
[0m16:20:08.036442 [info ] [Thread-2 (]: 10 of 20 START sql view model prod-dbt-base.salesforce_opportunity_base ........ [RUN]
[0m16:20:08.036442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_lead_base, now model.integrity_energy_dbt.salesforce_meter_number_base)
[0m16:20:08.040947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_contact_base, now model.integrity_energy_dbt.salesforce_opportunity_base)
[0m16:20:08.040947 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:20:08.040947 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_account_base: Close
[0m16:20:08.044223 [debug] [Thread-3 (]: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:20:08.044223 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:20:08.044223 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:20:08.044223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021130009850>]}
[0m16:20:08.051867 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:20:08.051867 [error] [Thread-3 (]: 5 of 20 ERROR creating sql view model prod-dbt-base.marketing_cost_base ........ [[31mERROR[0m in 0.57s]
[0m16:20:08.054129 [debug] [Thread-4 (]: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:20:08.054129 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:20:08.054633 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.marketing_cost_base
[0m16:20:08.054633 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DA90850>]}
[0m16:20:08.054633 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:20:08.056638 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:20:08.056638 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.utility_lead_base
[0m16:20:08.056638 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.marketing_cost_base' to be skipped because of status 'error'.  Reason: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql.
[0m16:20:08.056638 [error] [Thread-4 (]: 6 of 20 ERROR creating sql view model prod-dbt-base.salesforce_account_base .... [[31mERROR[0m in 0.58s]
[0m16:20:08.061514 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:20:08.061514 [info ] [Thread-3 (]: 11 of 20 START sql view model prod-dbt-base.utility_lead_base .................. [RUN]
[0m16:20:08.061514 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:20:08.061514 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.salesforce_account_base
[0m16:20:08.061514 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.marketing_cost_base, now model.integrity_energy_dbt.utility_lead_base)
[0m16:20:08.061514 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:20:08.061514 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: BEGIN
[0m16:20:08.061514 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.zoominfo_base
[0m16:20:08.061514 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_account_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql.
[0m16:20:08.072546 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.utility_lead_base
[0m16:20:08.072546 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: BEGIN
[0m16:20:08.072546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:08.073688 [info ] [Thread-4 (]: 12 of 20 START sql view model prod-dbt-base.zoominfo_base ...................... [RUN]
[0m16:20:08.073688 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:20:08.073688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:08.073688 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:08.073688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_account_base, now model.integrity_energy_dbt.zoominfo_base)
[0m16:20:08.073688 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:08.073688 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:08.073688 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.utility_lead_base
[0m16:20:08.073688 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.zoominfo_base
[0m16:20:08.073688 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:08.073688 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:20:08.073688 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:20:08.088193 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.zoominfo_base
[0m16:20:08.088193 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:20:08.094398 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:20:08.094398 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_base: BEGIN
[0m16:20:08.094398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:08.097271 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:08.098505 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:20:08.098505 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:08.099703 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: BEGIN
[0m16:20:08.100209 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:08.100209 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:08.102528 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:08.552618 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.483 seconds
[0m16:20:08.552618 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:20:08.552618 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_opportunity_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_opportunity_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    iswon,
    fiscal,
    mils__c,
    ownerid,
    rate__c,
    term__c,
    team__c,
    source__c,
    marketing_generator__c,
    isclosed,
    notes__c,
    accountid,
    csdate__c,
    closedate,
    driver__c,
    meters__c,
    points__c,
    stagename,
    status__c,
    channel__c,
    dl_2000__c,
    dl_4000__c,
    dl_6000__c,
    leadsource,
    manager__c,
    re_sold__c,
    renewed__c,
    createddate,
    residual__c,
    sp_rt_id__c,
    subagent__c,
    supplier__c,
    commodity__c,
    rate_type__c,
    sp_points__c,
    sold_date__c,
    broker_fee__c,
    cancel_fee__c,
    usage_type__c,
    cancel_date__c,
    dl_1500_kwh__c,
    dl_2500_kwh__c,
    dl_3500_kwh__c,
    dl_rate_gas__c,
    dl_term_gas__c,
    dl_owner_alias__c,
    lost_reason__c,
    meter_usage__c,
    owner_title__c,
    real_points__c,
    total_usage__c,
    dl_start_gas__c,
    dl_usage_gas__c,
    do_not_renew__c,
    renewal_date__c,
    sales_person__c,
    total_points__c,
    utility_text__c,
    sales_manager__c,
    supplier_text__c,
    agent_takeback__c,
    canceled_usage__c,
    commodity_text__c,
    contract_signer__c,
    cancelled_points__c,
    supplier_credits__c,
    commission_matrix__c,
    contract_end_date__c,
    broker_fee_rounded__c,
    commission_percent__c,
    last_activity_note__c,
    confirmation_number__c,
    contract_start_date__c,
    contract_signer_email__c,
    contract_signer_phone_email__c,
    contract_signer_facilitator__c
from salesforce.opportunity
  ) ;
[0m16:20:08.614838 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.542 seconds
[0m16:20:08.614838 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:20:08.614838 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_meter_number_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."salesforce_meter_number_base__dbt_tmp" as (
    

select
    id,
    name,
    city__c,
    state__c,
    street__c,
    zip_code__c,
    mils__c,
    commodity__c,
    createddate,
    service_address__c,
    status__c,
    account__c,
    dl_account__c,
    account_number__c
from salesforce.meter_number__c
  ) ;
[0m16:20:08.614838 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.520 seconds
[0m16:20:08.618183 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:20:08.618690 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:20:08.618690 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: ROLLBACK
[0m16:20:08.618690 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.utility_lead_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."utility_lead_base__dbt_tmp" as (
    

select
        u.companyname,
        u.serviceaddress,
        u.servicecity,
        u.servicestate,
        u.servicezip,
        u.utility,
        u.accountnumber,
        u.annualusage,
        u.ratecode,
        e."eru lastname" as lastname,
        e."eru firstname" as firstname,
        e."eru titledesc" as title,
        e."be telephone number10" as phone,
        e."bee email addr80" as email
from utility_leads.utilitylead as u
left join utility_leads.enriched as e 
on u.companyname = e.companyname 
AND u.serviceaddress = e.serviceaddress
AND u.utility = e.utility
AND u.servicecity = e.servicecity
AND u.servicestate = e.servicestate
AND u.ratecode = e.ratecode
GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14
  ) ;
[0m16:20:08.644692 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:20:08.644692 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: ROLLBACK
[0m16:20:08.659476 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "utility_leads" does not exist
[0m16:20:08.660480 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.560 seconds
[0m16:20:08.660480 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_base: ROLLBACK
[0m16:20:08.661603 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:20:08.662107 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.zoominfo_base"} */


  create view "integrity-db-dev"."prod-dbt-base"."zoominfo_base__dbt_tmp" as (
    select * from zoominfo.zoominfo_upload_09202024
  ) ;
[0m16:20:08.682759 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: Close
[0m16:20:08.682759 [debug] [Thread-2 (]: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:20:08.682759 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112D6BFC10>]}
[0m16:20:08.682759 [error] [Thread-2 (]: 10 of 20 ERROR creating sql view model prod-dbt-base.salesforce_opportunity_base  [[31mERROR[0m in 0.64s]
[0m16:20:08.682759 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:20:08.682759 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_opportunity_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql.
[0m16:20:08.682759 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.deal_intermediate
[0m16:20:08.682759 [info ] [Thread-2 (]: 13 of 20 SKIP relation prod-dbt-intermediate.deal_intermediate ................. [[33mSKIP[0m]
[0m16:20:08.692279 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.deal_intermediate
[0m16:20:08.692279 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.marketing_intermediate
[0m16:20:08.692279 [info ] [Thread-2 (]: 14 of 20 SKIP relation prod-dbt-intermediate.marketing_intermediate ............ [[33mSKIP[0m]
[0m16:20:08.692279 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.marketing_intermediate
[0m16:20:08.692279 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.deal_prod
[0m16:20:08.692279 [info ] [Thread-2 (]: 15 of 20 SKIP relation prod-dbt-mart.deal_prod ................................. [[33mSKIP[0m]
[0m16:20:08.692279 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.deal_prod
[0m16:20:08.692279 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.marketing_prod
[0m16:20:08.692279 [info ] [Thread-2 (]: 16 of 20 SKIP relation prod-dbt-mart.marketing_prod ............................ [[33mSKIP[0m]
[0m16:20:08.692279 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.marketing_prod
[0m16:20:08.698783 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "zoominfo" does not exist
[0m16:20:08.698783 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: ROLLBACK
[0m16:20:08.708002 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: Close
[0m16:20:08.718508 [debug] [Thread-1 (]: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:20:08.718508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112E4C5250>]}
[0m16:20:08.718508 [error] [Thread-1 (]: 9 of 20 ERROR creating sql view model prod-dbt-base.salesforce_meter_number_base  [[31mERROR[0m in 0.68s]
[0m16:20:08.718508 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:20:08.724029 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_meter_number_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql.
[0m16:20:08.730773 [debug] [Thread-3 (]: On model.integrity_energy_dbt.utility_lead_base: Close
[0m16:20:08.739778 [debug] [Thread-3 (]: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:20:08.739778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112E59E590>]}
[0m16:20:08.739778 [error] [Thread-3 (]: 11 of 20 ERROR creating sql view model prod-dbt-base.utility_lead_base ......... [[31mERROR[0m in 0.68s]
[0m16:20:08.739778 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.utility_lead_base
[0m16:20:08.739778 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.utility_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql.
[0m16:20:08.739778 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.lead_intermediate
[0m16:20:08.739778 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:20:08.739778 [info ] [Thread-2 (]: 17 of 20 SKIP relation prod-dbt-intermediate.lead_intermediate ................. [[33mSKIP[0m]
[0m16:20:08.739778 [info ] [Thread-1 (]: 18 of 20 SKIP relation prod-dbt-intermediate.utility_lead_intermediate ......... [[33mSKIP[0m]
[0m16:20:08.739778 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.lead_intermediate
[0m16:20:08.739778 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:20:08.739778 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.lead_prod
[0m16:20:08.739778 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.utility_lead_prod
[0m16:20:08.739778 [info ] [Thread-3 (]: 19 of 20 SKIP relation prod-dbt-mart.lead_prod ................................. [[33mSKIP[0m]
[0m16:20:08.739778 [info ] [Thread-2 (]: 20 of 20 SKIP relation prod-dbt-mart.utility_lead_prod ......................... [[33mSKIP[0m]
[0m16:20:08.739778 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.lead_prod
[0m16:20:08.739778 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.utility_lead_prod
[0m16:20:08.802539 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: Close
[0m16:20:08.802539 [debug] [Thread-4 (]: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:20:08.802539 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22910c34-1cbf-42cb-855c-5096ea3dca9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112F890B10>]}
[0m16:20:08.818546 [error] [Thread-4 (]: 12 of 20 ERROR creating sql view model prod-dbt-base.zoominfo_base ............. [[31mERROR[0m in 0.73s]
[0m16:20:08.819069 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.zoominfo_base
[0m16:20:08.819069 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.zoominfo_base' to be skipped because of status 'error'.  Reason: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql.
[0m16:20:08.819069 [debug] [MainThread]: Using redshift connection "master"
[0m16:20:08.819069 [debug] [MainThread]: On master: BEGIN
[0m16:20:08.819069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:08.819069 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:20:08.819069 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:20:09.197925 [debug] [MainThread]: SQL status: SUCCESS in 0.377 seconds
[0m16:20:09.197925 [debug] [MainThread]: On master: COMMIT
[0m16:20:09.197925 [debug] [MainThread]: Using redshift connection "master"
[0m16:20:09.197925 [debug] [MainThread]: On master: COMMIT
[0m16:20:09.263738 [debug] [MainThread]: SQL status: SUCCESS in 0.063 seconds
[0m16:20:09.263738 [debug] [MainThread]: On master: Close
[0m16:20:09.263738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'list_integrity-db-dev' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'list_integrity-db-dev' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'list_integrity-db-dev' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-base' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-intermediate' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'list_integrity-db-dev_prod-dbt-mart' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.salesforce_meter_number_base' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.salesforce_opportunity_base' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.utility_lead_base' was properly closed.
[0m16:20:09.263738 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.zoominfo_base' was properly closed.
[0m16:20:09.263738 [info ] [MainThread]: 
[0m16:20:09.263738 [info ] [MainThread]: Finished running 3 table models, 17 view models in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m16:20:09.263738 [debug] [MainThread]: Command end result
[0m16:20:09.293645 [info ] [MainThread]: 
[0m16:20:09.293645 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successs, and 0 warnings:[0m
[0m16:20:09.293645 [info ] [MainThread]: 
[0m16:20:09.293645 [error] [MainThread]:   Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:20:09.293645 [info ] [MainThread]: 
[0m16:20:09.293645 [error] [MainThread]:   Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [error] [MainThread]:   Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:20:09.309271 [info ] [MainThread]: 
[0m16:20:09.309271 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=12 SKIP=8 TOTAL=20
[0m16:20:09.309271 [debug] [MainThread]: Command `dbt run` failed at 16:20:09.309271 after 5.15 seconds
[0m16:20:09.309271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DBE2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211278DE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002112DBEB0D0>]}
[0m16:20:09.309271 [debug] [MainThread]: Flushing usage events
[0m16:20:09.580202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:13.682163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40946DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40960BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40960BC90>]}


============================== 16:21:13.685481 | 68e68581-8620-4f83-b79f-53e7fd45b4ec ==============================
[0m16:21:13.685481 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:21:13.686483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:21:13.781905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68e68581-8620-4f83-b79f-53e7fd45b4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40946DC10>]}
[0m16:21:13.835729 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-9okenfys'
[0m16:21:13.835729 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:21:14.165489 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:21:14.166488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:21:14.290889 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:21:14.295209 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:21:14.742443 [info ] [MainThread]: Installed from version 1.0.0
[0m16:21:14.743472 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:21:14.743472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68e68581-8620-4f83-b79f-53e7fd45b4ec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C408A7C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C408A66810>]}
[0m16:21:14.743472 [info ] [MainThread]: 
[0m16:21:14.744937 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:21:14.746036 [debug] [MainThread]: Command `dbt deps` succeeded at 16:21:14.746036 after 1.13 seconds
[0m16:21:14.746036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4033EA010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40314FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40314FE10>]}
[0m16:21:14.747096 [debug] [MainThread]: Flushing usage events
[0m16:21:15.021780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:18.450222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD9C93B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD9FC8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD9FC9290>]}


============================== 16:21:18.453222 | 882028a9-4187-4fe9-828c-43e7a37e7943 ==============================
[0m16:21:18.453222 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:21:18.454220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:daily --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:21:18.581542 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:21:18.582543 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:21:18.709693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD9FDD810>]}
[0m16:21:18.752212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD70D0750>]}
[0m16:21:18.753212 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:21:18.765909 [debug] [MainThread]: checksum: 28c00772bd96551ae2f98126ebf7713c9e121e5f4a1fdbf780c14a568fdbecdb, vars: {}, profile: , target: dev, version: 1.9.0b2
[0m16:21:18.828698 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:21:18.829698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDA9FEED0>]}
[0m16:21:19.940160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDA8F7990>]}
[0m16:21:20.006503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBF24050>]}
[0m16:21:20.007503 [info ] [MainThread]: Found 20 models, 20 sources, 602 macros
[0m16:21:20.007503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBDC4950>]}
[0m16:21:20.010275 [info ] [MainThread]: 
[0m16:21:20.010275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:20.010275 [info ] [MainThread]: 
[0m16:21:20.011741 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:21:20.015874 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev'
[0m16:21:20.028849 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev"
[0m16:21:20.028849 [debug] [ThreadPool]: On list_integrity-db-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev"} */

    select distinct nspname from pg_namespace
[0m16:21:20.029850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:20.032358 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:20.033358 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:20.724636 [debug] [ThreadPool]: SQL status: SUCCESS in 0.695 seconds
[0m16:21:20.726938 [debug] [ThreadPool]: On list_integrity-db-dev: Close
[0m16:21:20.727924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_integrity-db-dev, now create_integrity-db-dev_integrity-dev)
[0m16:21:20.729047 [debug] [ThreadPool]: Creating schema "database: "integrity-db-dev"
schema: "integrity-dev"
"
[0m16:21:20.734412 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_integrity-dev"
[0m16:21:20.734412 [debug] [ThreadPool]: On create_integrity-db-dev_integrity-dev: BEGIN
[0m16:21:20.735412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:20.735412 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:20.736396 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:21.161374 [debug] [ThreadPool]: SQL status: SUCCESS in 0.426 seconds
[0m16:21:21.162378 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_integrity-dev"
[0m16:21:21.162378 [debug] [ThreadPool]: On create_integrity-db-dev_integrity-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "create_integrity-db-dev_integrity-dev"} */
create schema if not exists "integrity-dev"
[0m16:21:21.332082 [debug] [ThreadPool]: SQL status: SUCCESS in 0.168 seconds
[0m16:21:21.333065 [debug] [ThreadPool]: On create_integrity-db-dev_integrity-dev: COMMIT
[0m16:21:21.333065 [debug] [ThreadPool]: Using redshift connection "create_integrity-db-dev_integrity-dev"
[0m16:21:21.334065 [debug] [ThreadPool]: On create_integrity-db-dev_integrity-dev: COMMIT
[0m16:21:21.496451 [debug] [ThreadPool]: SQL status: SUCCESS in 0.162 seconds
[0m16:21:21.497452 [debug] [ThreadPool]: On create_integrity-db-dev_integrity-dev: Close
[0m16:21:21.500501 [debug] [ThreadPool]: Acquiring new redshift connection 'list_integrity-db-dev_integrity-dev'
[0m16:21:21.506810 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_integrity-dev"
[0m16:21:21.507810 [debug] [ThreadPool]: On list_integrity-db-dev_integrity-dev: BEGIN
[0m16:21:21.507810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:21.508810 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:21.508810 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:21.897471 [debug] [ThreadPool]: SQL status: SUCCESS in 0.389 seconds
[0m16:21:21.898461 [debug] [ThreadPool]: Using redshift connection "list_integrity-db-dev_integrity-dev"
[0m16:21:21.898461 [debug] [ThreadPool]: On list_integrity-db-dev_integrity-dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "list_integrity-db-dev_integrity-dev"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'integrity-dev'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'integrity-dev'
[0m16:21:22.006456 [debug] [ThreadPool]: SQL status: SUCCESS in 0.107 seconds
[0m16:21:22.007456 [debug] [ThreadPool]: On list_integrity-db-dev_integrity-dev: ROLLBACK
[0m16:21:22.073440 [debug] [ThreadPool]: On list_integrity-db-dev_integrity-dev: Close
[0m16:21:22.082999 [debug] [MainThread]: Using redshift connection "master"
[0m16:21:22.082999 [debug] [MainThread]: On master: BEGIN
[0m16:21:22.084002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:22.084002 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:22.085002 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:22.500662 [debug] [MainThread]: SQL status: SUCCESS in 0.417 seconds
[0m16:21:22.501661 [debug] [MainThread]: Using redshift connection "master"
[0m16:21:22.501661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:21:22.595086 [debug] [MainThread]: SQL status: SUCCESS in 0.093 seconds
[0m16:21:22.597457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD70D19D0>]}
[0m16:21:22.597457 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:22.663397 [debug] [MainThread]: Using redshift connection "master"
[0m16:21:22.664395 [debug] [MainThread]: On master: BEGIN
[0m16:21:22.698192 [debug] [MainThread]: SQL status: SUCCESS in 0.033 seconds
[0m16:21:22.699221 [debug] [MainThread]: On master: COMMIT
[0m16:21:22.699221 [debug] [MainThread]: Using redshift connection "master"
[0m16:21:22.700365 [debug] [MainThread]: On master: COMMIT
[0m16:21:22.769314 [debug] [MainThread]: SQL status: SUCCESS in 0.069 seconds
[0m16:21:22.770315 [debug] [MainThread]: On master: Close
[0m16:21:22.778903 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:21:22.780029 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.facebook_daily_base
[0m16:21:22.780029 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:21:22.780029 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:21:22.781203 [info ] [Thread-1 (]: 1 of 20 START sql view model integrity-dev.bing_ads_daily_base ................. [RUN]
[0m16:21:22.781713 [info ] [Thread-2 (]: 2 of 20 START sql view model integrity-dev.facebook_daily_base ................. [RUN]
[0m16:21:22.781713 [info ] [Thread-3 (]: 3 of 20 START sql view model integrity-dev.google_ads_daily_base ............... [RUN]
[0m16:21:22.783158 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.bing_ads_daily_base'
[0m16:21:22.783158 [info ] [Thread-4 (]: 4 of 20 START sql view model integrity-dev.hubspot_daily_base .................. [RUN]
[0m16:21:22.784171 [debug] [Thread-2 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.facebook_daily_base'
[0m16:21:22.785218 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.google_ads_daily_base'
[0m16:21:22.785728 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:21:22.785728 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.integrity_energy_dbt.hubspot_daily_base'
[0m16:21:22.786741 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.facebook_daily_base
[0m16:21:22.786741 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.google_ads_daily_base
[0m16:21:22.789136 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:21:22.790137 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.hubspot_daily_base
[0m16:21:22.792170 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:21:22.795601 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:21:22.797602 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:21:22.797602 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:21:22.798605 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.facebook_daily_base
[0m16:21:22.799606 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.google_ads_daily_base
[0m16:21:22.824778 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:21:22.827787 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.facebook_daily_base"
[0m16:21:22.827787 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.hubspot_daily_base
[0m16:21:22.830782 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:21:22.833680 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:21:22.834681 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:21:22.835684 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:21:22.836685 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:21:22.837681 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: BEGIN
[0m16:21:22.839680 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:21:22.840183 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: BEGIN
[0m16:21:22.840183 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: BEGIN
[0m16:21:22.841193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:22.841193 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: BEGIN
[0m16:21:22.841193 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:21:22.842193 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:21:22.842193 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:22.843189 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:21:22.843189 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:22.843189 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:22.844189 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:22.844696 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:22.844696 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:22.844696 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:22.846706 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:23.249367 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.408 seconds
[0m16:21:23.249367 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.bing_ads_daily_base"
[0m16:21:23.250372 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.bing_ads_daily_base"} */


  create view "integrity-db-dev"."integrity-dev"."bing_ads_daily_base__dbt_tmp" as (
    

select
    spend,
    impressions,
    clicks,
    timeperiod,
    adgroupname,
    campaignname
from bing_ads.ad_performance_report_daily
  ) ;
[0m16:21:23.277125 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.435 seconds
[0m16:21:23.277993 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.436 seconds
[0m16:21:23.277993 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.hubspot_daily_base"
[0m16:21:23.278996 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.google_ads_daily_base"
[0m16:21:23.279994 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.hubspot_daily_base"} */


  create view "integrity-db-dev"."integrity-dev"."hubspot_daily_base__dbt_tmp" as (
    

with hubspot_daily as (
    SELECT
        (TIMESTAMP 'epoch' + created / 1000 * INTERVAL '1 second')::DATE AS converted_date,
        type
    FROM "integrity-db"."hubspot"."email_events")

SELECT
    converted_date,
    sum(case when type = 'SENT' then 1 else 0 end) as sent_emails,
    sum(case when type = 'OPEN' then 1 else 0 end) as opened_emails,
    sum(case when type = 'CLICK' then 1 else 0 end) as clicks,
    sum(case when type = 'BOUNCE' then 1 else 0 end) as bounces,
    sum(case when type = 'SPAMREPORT' then 1 else 0 end) as spam_reports
from hubspot_daily
group by converted_date
order by converted_date desc
  ) ;
[0m16:21:23.279994 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.google_ads_daily_base"} */


  create view "integrity-db-dev"."integrity-dev"."google_ads_daily_base__dbt_tmp" as (
    

select
    DATE(_data_date) as activity_date, 
    metrics_impressions as googleads_impressions,
    metrics_cost_micros  as googleads_cost, 
    metrics_clicks as googleads_clicks
from google_ads.ads_campaignbasicstats_7446470445
  ) ;
[0m16:21:23.280998 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.439 seconds
[0m16:21:23.281999 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.facebook_daily_base"
[0m16:21:23.281999 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.facebook_daily_base"} */


  create view "integrity-db-dev"."integrity-dev"."facebook_daily_base__dbt_tmp" as (
    

select
    date_start, 
    sum(impressions) as facebook_impressions,
    sum(reach) as facebook_reach,
    sum(spend) as facebook_spend, 
    sum(clicks) as facebook_clicks,
    sum(unique_clicks) as facebook_unique_clicks
from facebook.ads_insights
group by date_start
  ) ;
[0m16:21:23.283994 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "bing_ads" does not exist
[0m16:21:23.283994 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: ROLLBACK
[0m16:21:23.319893 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "facebook" does not exist
[0m16:21:23.320953 [debug] [Thread-4 (]: Redshift adapter: Redshift error: Datasharing is not enabled on this cluster
[0m16:21:23.321936 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: ROLLBACK
[0m16:21:23.321936 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "google_ads" does not exist
[0m16:21:23.322936 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: ROLLBACK
[0m16:21:23.323936 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: ROLLBACK
[0m16:21:23.350167 [debug] [Thread-1 (]: On model.integrity_energy_dbt.bing_ads_daily_base: Close
[0m16:21:23.354201 [debug] [Thread-1 (]: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:21:23.356073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBD889D0>]}
[0m16:21:23.357097 [error] [Thread-1 (]: 1 of 20 ERROR creating sql view model integrity-dev.bing_ads_daily_base ........ [[31mERROR[0m in 0.57s]
[0m16:21:23.358097 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.bing_ads_daily_base
[0m16:21:23.358097 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.marketing_cost_base
[0m16:21:23.359097 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.bing_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql.
[0m16:21:23.359097 [info ] [Thread-1 (]: 5 of 20 START sql view model integrity-dev.marketing_cost_base ................. [RUN]
[0m16:21:23.361094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.bing_ads_daily_base, now model.integrity_energy_dbt.marketing_cost_base)
[0m16:21:23.361094 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.marketing_cost_base
[0m16:21:23.366097 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:21:23.366097 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.marketing_cost_base
[0m16:21:23.368080 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.marketing_cost_base"
[0m16:21:23.373263 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:21:23.374263 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: BEGIN
[0m16:21:23.374263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:23.375263 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:23.375263 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:23.402936 [debug] [Thread-3 (]: On model.integrity_energy_dbt.google_ads_daily_base: Close
[0m16:21:23.403934 [debug] [Thread-2 (]: On model.integrity_energy_dbt.facebook_daily_base: Close
[0m16:21:23.403934 [debug] [Thread-4 (]: On model.integrity_energy_dbt.hubspot_daily_base: Close
[0m16:21:23.409739 [debug] [Thread-3 (]: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:21:23.411747 [debug] [Thread-2 (]: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:21:23.412748 [debug] [Thread-4 (]: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:21:23.412748 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDC4AB1D0>]}
[0m16:21:23.413746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDC067CD0>]}
[0m16:21:23.413746 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDC4877D0>]}
[0m16:21:23.415252 [error] [Thread-3 (]: 3 of 20 ERROR creating sql view model integrity-dev.google_ads_daily_base ...... [[31mERROR[0m in 0.63s]
[0m16:21:23.415252 [error] [Thread-2 (]: 2 of 20 ERROR creating sql view model integrity-dev.facebook_daily_base ........ [[31mERROR[0m in 0.63s]
[0m16:21:23.415252 [error] [Thread-4 (]: 4 of 20 ERROR creating sql view model integrity-dev.hubspot_daily_base ......... [[31mERROR[0m in 0.63s]
[0m16:21:23.421599 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.google_ads_daily_base
[0m16:21:23.422598 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.facebook_daily_base
[0m16:21:23.422598 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.hubspot_daily_base
[0m16:21:23.423597 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.salesforce_account_base
[0m16:21:23.423597 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.google_ads_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql.
[0m16:21:23.423597 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:21:23.424598 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:21:23.424598 [info ] [Thread-3 (]: 6 of 20 START sql view model integrity-dev.salesforce_account_base ............. [RUN]
[0m16:21:23.425684 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.facebook_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql.
[0m16:21:23.425684 [info ] [Thread-2 (]: 7 of 20 START sql view model integrity-dev.salesforce_contact_base ............. [RUN]
[0m16:21:23.426698 [info ] [Thread-4 (]: 8 of 20 START sql view model integrity-dev.salesforce_lead_base ................ [RUN]
[0m16:21:23.426698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.google_ads_daily_base, now model.integrity_energy_dbt.salesforce_account_base)
[0m16:21:23.427708 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.hubspot_daily_base' to be skipped because of status 'error'.  Reason: Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql.
[0m16:21:23.427708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.facebook_daily_base, now model.integrity_energy_dbt.salesforce_contact_base)
[0m16:21:23.428718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.hubspot_daily_base, now model.integrity_energy_dbt.salesforce_lead_base)
[0m16:21:23.428718 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.salesforce_account_base
[0m16:21:23.429715 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.salesforce_contact_base
[0m16:21:23.429715 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.salesforce_lead_base
[0m16:21:23.432714 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:21:23.434715 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:21:23.437217 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:21:23.437217 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.salesforce_account_base
[0m16:21:23.440785 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_account_base"
[0m16:21:23.440785 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.salesforce_contact_base
[0m16:21:23.440785 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.salesforce_lead_base
[0m16:21:23.443819 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:21:23.444828 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:21:23.447825 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:21:23.448825 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: BEGIN
[0m16:21:23.450014 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:21:23.450014 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:21:23.450014 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: BEGIN
[0m16:21:23.453533 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:21:23.453533 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:23.454535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:23.454535 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: BEGIN
[0m16:21:23.454535 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:23.455805 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:23.455805 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:23.456814 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:23.457812 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:23.458811 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:23.836216 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.462 seconds
[0m16:21:23.838184 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.marketing_cost_base"
[0m16:21:23.838184 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.marketing_cost_base"} */


  create view "integrity-db-dev"."integrity-dev"."marketing_cost_base__dbt_tmp" as (
    

select
    team,
    CAST(month as date) as month,
    CAST(REPLACE(hom_cost, ',', '') as decimal(10,2)) as hom_cost,
    CAST(REPLACE(ipr_cost, ',', '')  as decimal(10,2)) as ipr_cost,
    CAST(REPLACE(copywriter, ',', '') as decimal(10,2)) as copywriter,
    CAST(REPLACE(dango_costs, ',', '') as decimal(10,2)) as dango_costs,
    CAST(REPLACE(designer_costs, ',', '') as decimal(10,2)) as designer_costs,
    CAST(REPLACE(paid_lead_cost, ',', '') as decimal(10,2)) as paid_lead_cost,
    CAST(REPLACE(data_contractor, ',', '') as decimal(10,2)) as data_contractor,
    CAST(REPLACE(seo_lead_salary, ',', '') as decimal(10,2)) as seo_lead_salary,
    CAST(REPLACE(contractor_costs, ',', '') as decimal(10,2)) as contractor_costs,
    CAST(REPLACE(paid_agency_cost, ',', '') as decimal(10,2)) as paid_agency_cost,
    CAST(REPLACE(paid_support_cost, ',', '') as decimal(10,2)) as paid_support_cost,
    CAST(REPLACE(project_management, ',', '') as decimal(10,2)) as project_management,
    CAST(REPLACE(crowd_content_costs, ',', '') as decimal(10,2)) as crowd_content_costs,
    CAST(REPLACE(email_contractor_costs, ',', '') as decimal(10,2)) as email_contractor_costs,
    CAST(REPLACE(hubspot_contractor_costs, ',', '') as decimal(10,2)) as hubspot_contractor_costs
from google_sheets.monthly_cost
  ) ;
[0m16:21:23.873386 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "google_sheets" does not exist
[0m16:21:23.875083 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: ROLLBACK
[0m16:21:23.907354 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.457 seconds
[0m16:21:23.908405 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_account_base"
[0m16:21:23.908405 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_account_base"} */


  create view "integrity-db-dev"."integrity-dev"."salesforce_account_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    phone,
    industry,
    billingcity,
    billingcountry,
    billingcountrycode,
    billingpostalcode,
    billingstreet,
    main_phone__c
    --utility_company__c
from salesforce.account
  ) ;
[0m16:21:23.916774 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.463 seconds
[0m16:21:23.917601 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_contact_base"
[0m16:21:23.917601 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_contact_base"} */


  create view "integrity-db-dev"."integrity-dev"."salesforce_contact_base__dbt_tmp" as (
    

select
    id,
    name,
    email,
    phone,
    mobilephone,
    main_phone__c,
    title,
    createddate,
    mailingcity,
    mailingstate,
    mailingstatecode,
    mailingcountry,
    accountid,
    rep_last_first__c,
    customer_account_number__c,
    contract_signer_phone_email__c
from salesforce.contact
  ) ;
[0m16:21:23.919025 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.463 seconds
[0m16:21:23.919025 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_lead_base"
[0m16:21:23.920036 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_lead_base"} */


  create view "integrity-db-dev"."integrity-dev"."salesforce_lead_base__dbt_tmp" as (
    

select
    id,
    city,
    name,
    email,
    phone,
    state,
    title,
    status,
    street,
    company,
    country,
    firstname,
    lastname,
    source__c,
    channel__c,
    leadsource,
    postalcode,
    createddate,
    CAST(createddate as DATE) as createdday,
    isconverted,
    commodity__c,
    converteddate,
    lastactivitydate,
    convertedaccountid,
    convertedcontactid,
    lead_id_for_opp__c,
    average_bill_amount__c,
    convertedopportunityid,
    converted_from_lead__c,
    marketing_generator__c,
    new_ready_to_work_date__c,
    last_activity_note_date__c
from salesforce.lead
  ) ;
[0m16:21:23.941849 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:21:23.942841 [debug] [Thread-1 (]: On model.integrity_energy_dbt.marketing_cost_base: Close
[0m16:21:23.943839 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: ROLLBACK
[0m16:21:23.946839 [debug] [Thread-1 (]: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:21:23.947838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDC638410>]}
[0m16:21:23.948839 [error] [Thread-1 (]: 5 of 20 ERROR creating sql view model integrity-dev.marketing_cost_base ........ [[31mERROR[0m in 0.59s]
[0m16:21:23.949834 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.marketing_cost_base
[0m16:21:23.949834 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:21:23.950835 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.marketing_cost_base' to be skipped because of status 'error'.  Reason: Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql.
[0m16:21:23.950835 [info ] [Thread-1 (]: 9 of 20 START sql view model integrity-dev.salesforce_meter_number_base ........ [RUN]
[0m16:21:23.951833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.marketing_cost_base, now model.integrity_energy_dbt.salesforce_meter_number_base)
[0m16:21:23.952911 [debug] [Thread-1 (]: Began compiling node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:21:23.956920 [debug] [Thread-1 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:21:23.956920 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:21:23.957921 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:21:23.957921 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: ROLLBACK
[0m16:21:23.958925 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: ROLLBACK
[0m16:21:23.958925 [debug] [Thread-1 (]: Began executing node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:21:23.961924 [debug] [Thread-1 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:21:23.963922 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:21:23.963922 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: BEGIN
[0m16:21:23.963922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:23.964923 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:23.964923 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:24.011887 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_account_base: Close
[0m16:21:24.015887 [debug] [Thread-3 (]: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:21:24.015887 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDC6042D0>]}
[0m16:21:24.016887 [error] [Thread-3 (]: 6 of 20 ERROR creating sql view model integrity-dev.salesforce_account_base .... [[31mERROR[0m in 0.59s]
[0m16:21:24.017887 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.salesforce_account_base
[0m16:21:24.018888 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:21:24.018888 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_account_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql.
[0m16:21:24.019887 [info ] [Thread-3 (]: 10 of 20 START sql view model integrity-dev.salesforce_opportunity_base ........ [RUN]
[0m16:21:24.020873 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_account_base, now model.integrity_energy_dbt.salesforce_opportunity_base)
[0m16:21:24.020873 [debug] [Thread-3 (]: Began compiling node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:21:24.023869 [debug] [Thread-3 (]: Writing injected SQL for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:21:24.024872 [debug] [Thread-3 (]: Began executing node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:21:24.024872 [debug] [Thread-2 (]: On model.integrity_energy_dbt.salesforce_contact_base: Close
[0m16:21:24.025954 [debug] [Thread-4 (]: On model.integrity_energy_dbt.salesforce_lead_base: Close
[0m16:21:24.028463 [debug] [Thread-3 (]: Writing runtime sql for node "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:21:24.034309 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:21:24.035874 [debug] [Thread-2 (]: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:21:24.035874 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: BEGIN
[0m16:21:24.037886 [debug] [Thread-4 (]: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:21:24.037886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDC639250>]}
[0m16:21:24.037886 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:21:24.038881 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBB1FCD0>]}
[0m16:21:24.038881 [error] [Thread-2 (]: 7 of 20 ERROR creating sql view model integrity-dev.salesforce_contact_base .... [[31mERROR[0m in 0.61s]
[0m16:21:24.039879 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:24.040880 [error] [Thread-4 (]: 8 of 20 ERROR creating sql view model integrity-dev.salesforce_lead_base ....... [[31mERROR[0m in 0.61s]
[0m16:21:24.041388 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.salesforce_contact_base
[0m16:21:24.041388 [debug] [Thread-3 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:24.041388 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.salesforce_lead_base
[0m16:21:24.042394 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.utility_lead_base
[0m16:21:24.042394 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_contact_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql.
[0m16:21:24.043394 [debug] [Thread-4 (]: Began running node model.integrity_energy_dbt.zoominfo_base
[0m16:21:24.044394 [info ] [Thread-2 (]: 11 of 20 START sql view model integrity-dev.utility_lead_base .................. [RUN]
[0m16:21:24.045397 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql.
[0m16:21:24.045397 [info ] [Thread-4 (]: 12 of 20 START sql view model integrity-dev.zoominfo_base ...................... [RUN]
[0m16:21:24.046394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_contact_base, now model.integrity_energy_dbt.utility_lead_base)
[0m16:21:24.047396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.integrity_energy_dbt.salesforce_lead_base, now model.integrity_energy_dbt.zoominfo_base)
[0m16:21:24.047396 [debug] [Thread-2 (]: Began compiling node model.integrity_energy_dbt.utility_lead_base
[0m16:21:24.048395 [debug] [Thread-4 (]: Began compiling node model.integrity_energy_dbt.zoominfo_base
[0m16:21:24.050971 [debug] [Thread-2 (]: Writing injected SQL for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:21:24.051976 [debug] [Thread-4 (]: Writing injected SQL for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:21:24.053977 [debug] [Thread-2 (]: Began executing node model.integrity_energy_dbt.utility_lead_base
[0m16:21:24.053977 [debug] [Thread-4 (]: Began executing node model.integrity_energy_dbt.zoominfo_base
[0m16:21:24.058976 [debug] [Thread-2 (]: Writing runtime sql for node "model.integrity_energy_dbt.utility_lead_base"
[0m16:21:24.062766 [debug] [Thread-4 (]: Writing runtime sql for node "model.integrity_energy_dbt.zoominfo_base"
[0m16:21:24.066553 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:21:24.068497 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:21:24.069504 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: BEGIN
[0m16:21:24.069504 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: BEGIN
[0m16:21:24.070514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:24.070514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:24.071590 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:24.071590 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:24.072599 [debug] [Thread-2 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:24.072599 [debug] [Thread-4 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:24.345997 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.382 seconds
[0m16:21:24.347021 [debug] [Thread-1 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_meter_number_base"
[0m16:21:24.347021 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_meter_number_base"} */


  create view "integrity-db-dev"."integrity-dev"."salesforce_meter_number_base__dbt_tmp" as (
    

select
    id,
    name,
    city__c,
    state__c,
    street__c,
    zip_code__c,
    mils__c,
    commodity__c,
    createddate,
    service_address__c,
    status__c,
    account__c,
    dl_account__c,
    account_number__c
from salesforce.meter_number__c
  ) ;
[0m16:21:24.383058 [debug] [Thread-1 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:21:24.384071 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: ROLLBACK
[0m16:21:24.450368 [debug] [Thread-1 (]: On model.integrity_energy_dbt.salesforce_meter_number_base: Close
[0m16:21:24.453252 [debug] [Thread-1 (]: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:21:24.454607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBC2CB10>]}
[0m16:21:24.454607 [error] [Thread-1 (]: 9 of 20 ERROR creating sql view model integrity-dev.salesforce_meter_number_base  [[31mERROR[0m in 0.50s]
[0m16:21:24.456015 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.salesforce_meter_number_base
[0m16:21:24.456015 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_meter_number_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql.
[0m16:21:24.468835 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.430 seconds
[0m16:21:24.468835 [debug] [Thread-3 (]: Using redshift connection "model.integrity_energy_dbt.salesforce_opportunity_base"
[0m16:21:24.469905 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.salesforce_opportunity_base"} */


  create view "integrity-db-dev"."integrity-dev"."salesforce_opportunity_base__dbt_tmp" as (
    

select
    id,
    name,
    type,
    iswon,
    fiscal,
    mils__c,
    ownerid,
    rate__c,
    term__c,
    team__c,
    source__c,
    marketing_generator__c,
    isclosed,
    notes__c,
    accountid,
    csdate__c,
    closedate,
    driver__c,
    meters__c,
    points__c,
    stagename,
    status__c,
    channel__c,
    dl_2000__c,
    dl_4000__c,
    dl_6000__c,
    leadsource,
    manager__c,
    re_sold__c,
    renewed__c,
    createddate,
    residual__c,
    sp_rt_id__c,
    subagent__c,
    supplier__c,
    commodity__c,
    rate_type__c,
    sp_points__c,
    sold_date__c,
    broker_fee__c,
    cancel_fee__c,
    usage_type__c,
    cancel_date__c,
    dl_1500_kwh__c,
    dl_2500_kwh__c,
    dl_3500_kwh__c,
    dl_rate_gas__c,
    dl_term_gas__c,
    dl_owner_alias__c,
    lost_reason__c,
    meter_usage__c,
    owner_title__c,
    real_points__c,
    total_usage__c,
    dl_start_gas__c,
    dl_usage_gas__c,
    do_not_renew__c,
    renewal_date__c,
    sales_person__c,
    total_points__c,
    utility_text__c,
    sales_manager__c,
    supplier_text__c,
    agent_takeback__c,
    canceled_usage__c,
    commodity_text__c,
    contract_signer__c,
    cancelled_points__c,
    supplier_credits__c,
    commission_matrix__c,
    contract_end_date__c,
    broker_fee_rounded__c,
    commission_percent__c,
    last_activity_note__c,
    confirmation_number__c,
    contract_start_date__c,
    contract_signer_email__c,
    contract_signer_phone_email__c,
    contract_signer_facilitator__c
from salesforce.opportunity
  ) ;
[0m16:21:24.505556 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.436 seconds
[0m16:21:24.506576 [debug] [Thread-2 (]: Using redshift connection "model.integrity_energy_dbt.utility_lead_base"
[0m16:21:24.507931 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.utility_lead_base"} */


  create view "integrity-db-dev"."integrity-dev"."utility_lead_base__dbt_tmp" as (
    

select
        u.companyname,
        u.serviceaddress,
        u.servicecity,
        u.servicestate,
        u.servicezip,
        u.utility,
        u.accountnumber,
        u.annualusage,
        u.ratecode,
        e."eru lastname" as lastname,
        e."eru firstname" as firstname,
        e."eru titledesc" as title,
        e."be telephone number10" as phone,
        e."bee email addr80" as email
from utility_leads.utilitylead as u
left join utility_leads.enriched as e 
on u.companyname = e.companyname 
AND u.serviceaddress = e.serviceaddress
AND u.utility = e.utility
AND u.servicecity = e.servicecity
AND u.servicestate = e.servicestate
AND u.ratecode = e.ratecode
GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14
  ) ;
[0m16:21:24.510587 [debug] [Thread-3 (]: Redshift adapter: Redshift error: schema "salesforce" does not exist
[0m16:21:24.511999 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.441 seconds
[0m16:21:24.512506 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: ROLLBACK
[0m16:21:24.512506 [debug] [Thread-4 (]: Using redshift connection "model.integrity_energy_dbt.zoominfo_base"
[0m16:21:24.513618 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "integrity_energy_dbt", "target_name": "dev", "node_id": "model.integrity_energy_dbt.zoominfo_base"} */


  create view "integrity-db-dev"."integrity-dev"."zoominfo_base__dbt_tmp" as (
    select * from zoominfo.zoominfo_upload_09202024
  ) ;
[0m16:21:24.545267 [debug] [Thread-2 (]: Redshift adapter: Redshift error: schema "utility_leads" does not exist
[0m16:21:24.545267 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: ROLLBACK
[0m16:21:24.551592 [debug] [Thread-4 (]: Redshift adapter: Redshift error: schema "zoominfo" does not exist
[0m16:21:24.552599 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: ROLLBACK
[0m16:21:24.583863 [debug] [Thread-3 (]: On model.integrity_energy_dbt.salesforce_opportunity_base: Close
[0m16:21:24.586642 [debug] [Thread-3 (]: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:21:24.587670 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBC3B9D0>]}
[0m16:21:24.587670 [error] [Thread-3 (]: 10 of 20 ERROR creating sql view model integrity-dev.salesforce_opportunity_base  [[31mERROR[0m in 0.57s]
[0m16:21:24.588651 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.salesforce_opportunity_base
[0m16:21:24.589653 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.salesforce_opportunity_base' to be skipped because of status 'error'.  Reason: Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql.
[0m16:21:24.590653 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.deal_intermediate
[0m16:21:24.590653 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.marketing_intermediate
[0m16:21:24.590653 [info ] [Thread-1 (]: 13 of 20 SKIP relation integrity-dev.deal_intermediate ......................... [[33mSKIP[0m]
[0m16:21:24.591650 [info ] [Thread-3 (]: 14 of 20 SKIP relation integrity-dev.marketing_intermediate .................... [[33mSKIP[0m]
[0m16:21:24.592654 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.deal_intermediate
[0m16:21:24.592654 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.marketing_intermediate
[0m16:21:24.593651 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.deal_prod
[0m16:21:24.594672 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.marketing_prod
[0m16:21:24.594672 [info ] [Thread-1 (]: 15 of 20 SKIP relation integrity-dev.deal_prod ................................. [[33mSKIP[0m]
[0m16:21:24.595655 [info ] [Thread-3 (]: 16 of 20 SKIP relation integrity-dev.marketing_prod ............................ [[33mSKIP[0m]
[0m16:21:24.595655 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.deal_prod
[0m16:21:24.596651 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.marketing_prod
[0m16:21:24.612654 [debug] [Thread-2 (]: On model.integrity_energy_dbt.utility_lead_base: Close
[0m16:21:24.616654 [debug] [Thread-2 (]: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:21:24.616654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFDBC8A650>]}
[0m16:21:24.617655 [error] [Thread-2 (]: 11 of 20 ERROR creating sql view model integrity-dev.utility_lead_base ......... [[31mERROR[0m in 0.57s]
[0m16:21:24.618898 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.utility_lead_base
[0m16:21:24.619654 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.utility_lead_base' to be skipped because of status 'error'.  Reason: Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql.
[0m16:21:24.620666 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.lead_intermediate
[0m16:21:24.620666 [debug] [Thread-3 (]: Began running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:21:24.621992 [info ] [Thread-1 (]: 17 of 20 SKIP relation integrity-dev.lead_intermediate ......................... [[33mSKIP[0m]
[0m16:21:24.622999 [info ] [Thread-3 (]: 18 of 20 SKIP relation integrity-dev.utility_lead_intermediate ................. [[33mSKIP[0m]
[0m16:21:24.622999 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.lead_intermediate
[0m16:21:24.624001 [debug] [Thread-4 (]: On model.integrity_energy_dbt.zoominfo_base: Close
[0m16:21:24.624001 [debug] [Thread-3 (]: Finished running node model.integrity_energy_dbt.utility_lead_intermediate
[0m16:21:24.625000 [debug] [Thread-2 (]: Began running node model.integrity_energy_dbt.lead_prod
[0m16:21:24.626101 [debug] [Thread-1 (]: Began running node model.integrity_energy_dbt.utility_lead_prod
[0m16:21:24.627108 [info ] [Thread-2 (]: 19 of 20 SKIP relation integrity-dev.lead_prod ................................. [[33mSKIP[0m]
[0m16:21:24.627108 [info ] [Thread-1 (]: 20 of 20 SKIP relation integrity-dev.utility_lead_prod ......................... [[33mSKIP[0m]
[0m16:21:24.628301 [debug] [Thread-2 (]: Finished running node model.integrity_energy_dbt.lead_prod
[0m16:21:24.628301 [debug] [Thread-1 (]: Finished running node model.integrity_energy_dbt.utility_lead_prod
[0m16:21:24.629450 [debug] [Thread-4 (]: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:21:24.630457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882028a9-4187-4fe9-828c-43e7a37e7943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD9373110>]}
[0m16:21:24.630457 [error] [Thread-4 (]: 12 of 20 ERROR creating sql view model integrity-dev.zoominfo_base ............. [[31mERROR[0m in 0.58s]
[0m16:21:24.631593 [debug] [Thread-4 (]: Finished running node model.integrity_energy_dbt.zoominfo_base
[0m16:21:24.632601 [debug] [Thread-7 (]: Marking all children of 'model.integrity_energy_dbt.zoominfo_base' to be skipped because of status 'error'.  Reason: Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql.
[0m16:21:24.633604 [debug] [MainThread]: Using redshift connection "master"
[0m16:21:24.633604 [debug] [MainThread]: On master: BEGIN
[0m16:21:24.634604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:24.634604 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:21:24.635605 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:21:25.043351 [debug] [MainThread]: SQL status: SUCCESS in 0.409 seconds
[0m16:21:25.044213 [debug] [MainThread]: On master: COMMIT
[0m16:21:25.045215 [debug] [MainThread]: Using redshift connection "master"
[0m16:21:25.045215 [debug] [MainThread]: On master: COMMIT
[0m16:21:25.117353 [debug] [MainThread]: SQL status: SUCCESS in 0.071 seconds
[0m16:21:25.118362 [debug] [MainThread]: On master: Close
[0m16:21:25.119362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:25.119362 [debug] [MainThread]: Connection 'create_integrity-db-dev_integrity-dev' was properly closed.
[0m16:21:25.120357 [debug] [MainThread]: Connection 'list_integrity-db-dev_integrity-dev' was properly closed.
[0m16:21:25.120357 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.salesforce_meter_number_base' was properly closed.
[0m16:21:25.120357 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.utility_lead_base' was properly closed.
[0m16:21:25.121628 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.salesforce_opportunity_base' was properly closed.
[0m16:21:25.121628 [debug] [MainThread]: Connection 'model.integrity_energy_dbt.zoominfo_base' was properly closed.
[0m16:21:25.121628 [info ] [MainThread]: 
[0m16:21:25.123052 [info ] [MainThread]: Finished running 3 table models, 17 view models in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m16:21:25.125058 [debug] [MainThread]: Command end result
[0m16:21:25.158257 [info ] [MainThread]: 
[0m16:21:25.158257 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successs, and 0 warnings:[0m
[0m16:21:25.159667 [info ] [MainThread]: 
[0m16:21:25.159667 [error] [MainThread]:   Database Error in model bing_ads_daily_base (models\prod-dbt-base\bing_ads_daily_base.sql)
  schema "bing_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\bing_ads_daily_base.sql
[0m16:21:25.160738 [info ] [MainThread]: 
[0m16:21:25.161291 [error] [MainThread]:   Database Error in model google_ads_daily_base (models\prod-dbt-base\google_ads_daily_base.sql)
  schema "google_ads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\google_ads_daily_base.sql
[0m16:21:25.161291 [info ] [MainThread]: 
[0m16:21:25.162388 [error] [MainThread]:   Database Error in model facebook_daily_base (models\prod-dbt-base\facebook_daily_base.sql)
  schema "facebook" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\facebook_daily_base.sql
[0m16:21:25.162388 [info ] [MainThread]: 
[0m16:21:25.163544 [error] [MainThread]:   Database Error in model hubspot_daily_base (models\prod-dbt-base\hubspot_daily_base.sql)
  Datasharing is not enabled on this cluster
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\hubspot_daily_base.sql
[0m16:21:25.163544 [info ] [MainThread]: 
[0m16:21:25.163544 [error] [MainThread]:   Database Error in model marketing_cost_base (models\prod-dbt-base\marketing_cost_base.sql)
  schema "google_sheets" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\marketing_cost_base.sql
[0m16:21:25.164860 [info ] [MainThread]: 
[0m16:21:25.164860 [error] [MainThread]:   Database Error in model salesforce_account_base (models\prod-dbt-base\salesforce_account_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_account_base.sql
[0m16:21:25.164860 [info ] [MainThread]: 
[0m16:21:25.166100 [error] [MainThread]:   Database Error in model salesforce_contact_base (models\prod-dbt-base\salesforce_contact_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_contact_base.sql
[0m16:21:25.166100 [info ] [MainThread]: 
[0m16:21:25.166100 [error] [MainThread]:   Database Error in model salesforce_lead_base (models\prod-dbt-base\salesforce_lead_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_lead_base.sql
[0m16:21:25.166100 [info ] [MainThread]: 
[0m16:21:25.167349 [error] [MainThread]:   Database Error in model salesforce_meter_number_base (models\prod-dbt-base\salesforce_meter_number_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_meter_number_base.sql
[0m16:21:25.168405 [info ] [MainThread]: 
[0m16:21:25.168405 [error] [MainThread]:   Database Error in model salesforce_opportunity_base (models\prod-dbt-base\salesforce_opportunity_base.sql)
  schema "salesforce" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\salesforce_opportunity_base.sql
[0m16:21:25.168405 [info ] [MainThread]: 
[0m16:21:25.169721 [error] [MainThread]:   Database Error in model utility_lead_base (models\prod-dbt-base\utility_lead_base.sql)
  schema "utility_leads" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\utility_lead_base.sql
[0m16:21:25.169721 [info ] [MainThread]: 
[0m16:21:25.170729 [error] [MainThread]:   Database Error in model zoominfo_base (models\prod-dbt-base\zoominfo_base.sql)
  schema "zoominfo" does not exist
  compiled code at target\run\integrity_energy_dbt\models\prod-dbt-base\zoominfo_base.sql
[0m16:21:25.171727 [info ] [MainThread]: 
[0m16:21:25.171727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=12 SKIP=8 TOTAL=20
[0m16:21:25.172728 [debug] [MainThread]: Command `dbt run` failed at 16:21:25.172728 after 6.79 seconds
[0m16:21:25.172728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD3D9E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD3B180D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD8BC3550>]}
[0m16:21:25.173773 [debug] [MainThread]: Flushing usage events
[0m16:21:25.661138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:21.634819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027980C5B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027980C5B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027980C5B550>]}


============================== 16:48:21.636326 | 45582d7f-9471-429d-ab53-ca02546347c7 ==============================
[0m16:48:21.636326 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:48:21.636326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:21.720911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45582d7f-9471-429d-ab53-ca02546347c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027980D88090>]}
[0m16:48:21.787176 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-9016a04z'
[0m16:48:21.787176 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:48:22.104509 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:48:22.104509 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:48:22.243334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:48:22.245063 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:48:22.707447 [info ] [MainThread]: Installed from version 1.0.0
[0m16:48:22.707447 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:48:22.707447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '45582d7f-9471-429d-ab53-ca02546347c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027980C798D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027980CA80D0>]}
[0m16:48:22.707447 [info ] [MainThread]: 
[0m16:48:22.707447 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:48:22.710631 [debug] [MainThread]: Command `dbt deps` succeeded at 16:48:22.710631 after 1.14 seconds
[0m16:48:22.710631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA97A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA6DFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA6DFE10>]}
[0m16:48:22.710631 [debug] [MainThread]: Flushing usage events
[0m16:48:22.969390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:02.555864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B8145B810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B8145BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B8145A4D0>]}


============================== 16:49:02.555864 | 100b1fc7-3f02-43f0-b0d7-8d973050d6d9 ==============================
[0m16:49:02.555864 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:49:02.555864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:02.650894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100b1fc7-3f02-43f0-b0d7-8d973050d6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B8158E010>]}
[0m16:49:02.666519 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-azzcu5ja'
[0m16:49:02.666519 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:49:02.811448 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:49:02.811448 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:49:02.936354 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:49:02.938953 [info ] [MainThread]: Updating lock file in file path: C:\Users\2ewol\Documents\Clients\Integrity_Energy\integrity-energy-dbt/package-lock.yml
[0m16:49:02.984974 [debug] [MainThread]: Set downloads directory='C:\Users\2ewol\AppData\Local\Temp\dbt-downloads-blt7hj1i'
[0m16:49:02.987118 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:49:03.409017 [info ] [MainThread]: Installed from version 1.3.0
[0m16:49:03.409017 [info ] [MainThread]: Up to date!
[0m16:49:03.410078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '100b1fc7-3f02-43f0-b0d7-8d973050d6d9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B8156B5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B814D91D0>]}
[0m16:49:03.411192 [debug] [MainThread]: Command `dbt deps` succeeded at 16:49:03.411192 after 0.92 seconds
[0m16:49:03.411192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFB1BA010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFAF1FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFAF1FE10>]}
[0m16:49:03.412301 [debug] [MainThread]: Flushing usage events
[0m16:49:03.617769 [debug] [MainThread]: An error was encountered while trying to flush usage events
