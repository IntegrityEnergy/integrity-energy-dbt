{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b2", "generated_at": "2025-01-30T19:31:00.062691Z", "invocation_id": "5aa0ea8e-88a6-49a9-b2ff-d4dec9427be6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-30T19:30:51.623151Z", "completed_at": "2025-01-30T19:30:51.628723Z"}, {"name": "execute", "started_at": "2025-01-30T19:30:51.628723Z", "completed_at": "2025-01-30T19:30:59.482584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.928888320922852, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.integrity_energy_dbt.sales_renewal_dash", "compiled": true, "compiled_code": "\n\n-- Step 1: Select from the `contact` table in the Salesforce schema\nWITH salesforce_contact AS (\n\n    SELECT\n        *\n    FROM\n        \"integrity-db\".\"prod_dbt-base\".\"salesforce_contact_base\"\n\n),\n\n-- Step 2: Remove unnecessary columns\ncontact_filtered AS (\n\n    SELECT\n        id\n        ,reportstoid\n        ,name\n        ,lastname\n        ,department\n    FROM\n        salesforce_contact\n\n),\n\n-- Step 3: Perform a LEFT JOIN on `reportstoid` and `id` within the same dataset\nmerged_contacts AS (\n\n    SELECT\n        cf.*\n        ,rc.name AS rc_name\n        ,rc.lastname AS rc_lastname\n    FROM\n        contact_filtered cf\n        LEFT JOIN contact_filtered rc\n            ON cf.reportstoid = rc.id\n\n),\n\n-- Step 4: Add a new column with a static value (\"Team\")\nadded_custom_column AS (\n\n    SELECT\n        *\n        ,CAST('Team' AS VARCHAR) AS team_prefix\n    FROM\n        merged_contacts\n\n),\n\n-- Step 5: Filter rows where `Removed Columns.lastname` is not NULL\nfiltered_rows AS (\n\n    SELECT\n        *\n    FROM\n        added_custom_column\n    WHERE\n        rc_lastname IS NOT NULL\n\n),\n\n-- Step 6: Combine the \"Team Prefix\" and \"Removed Columns.lastname\" columns into a new column\nmerged_columns AS (\n\n    SELECT\n        *\n        ,team_prefix || ' ' || rc_lastname AS team\n    FROM\n        filtered_rows\n\n),\n\n-- Step 7: Replace specific values in the \"Team\" column\nreplaced_value AS (\n\n    SELECT\n        *\n        ,CASE\n           WHEN team = 'Team Leads' THEN 'Website Leads'\n           ELSE team\n        END AS team_updated\n    FROM\n        merged_columns\n\n),\n\n-- Step 8: Duplicate the \"department\" column and rename it\nduplicated_column AS (\n\n    SELECT\n        *\n        ,department AS renewals_distinction\n    FROM\n        replaced_value\n\n),\n\n-- Step 9: Replace values in the \"Renewals Distinction\" column\nupdated_renewals AS (\n\n    SELECT\n        *\n        ,CASE\n           WHEN renewals_distinction = 'Lead Generator'\n            THEN 'Inside Sales'\n           WHEN renewals_distinction = 'New Sales'\n            THEN 'Inside Sales'\n           WHEN renewals_distinction = 'Sub Agent'\n            THEN 'SubAgent'\n           WHEN renewals_distinction = 'Renewals'\n            THEN 'Inside Sales'\n           WHEN renewals_distinction = 'Sales Director'\n            THEN 'Inside Sales'\n           WHEN renewals_distinction = 'Retention'\n            THEN 'Inside Sales'\n           ELSE renewals_distinction\n        END AS renewals_distinction_Updated\n    FROM\n        duplicated_column\n\n)\n\n-- Step 10: Select final filtered rows\nSELECT\n    *\nFROM\n    updated_renewals", "relation_name": "\"integrity-db\".\"prod_dbt-intermediate\".\"sales_renewal_dash\"", "batch_results": null}], "elapsed_time": 10.699803113937378, "args": {"select": ["tag:renewal_dash"], "populate_cache": true, "print": true, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "state_modified_compare_vars": false, "macro_debugging": false, "introspect": true, "partial_parse": true, "defer": false, "strict_mode": false, "empty": false, "use_colors": true, "static_parser": true, "log_path": "C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs", "state_modified_compare_more_unrendered_values": false, "use_colors_file": true, "show_resource_report": false, "exclude": [], "log_format_file": "debug", "profiles_dir": "C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt", "indirect_selection": "eager", "printer_width": 80, "log_level_file": "debug", "project_dir": "C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt", "write_json": true, "quiet": false, "skip_nodes_if_on_run_start_fails": false, "which": "run", "log_level": "info", "log_file_max_bytes": 10485760, "cache_selected_only": false, "require_resource_names_without_spaces": false, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "vars": {}, "invocation_command": "dbt run --select tag:renewal_dash", "version_check": true, "log_format": "default"}}