{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b2", "generated_at": "2025-01-02T17:13:50.555497Z", "invocation_id": "55a1552e-2101-4085-a0b8-67705f620bf5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-02T17:13:30.387204Z", "completed_at": "2025-01-02T17:13:30.390204Z"}, {"name": "execute", "started_at": "2025-01-02T17:13:30.391205Z", "completed_at": "2025-01-02T17:13:39.411998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 9.090179681777954, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.integrity_energy_dbt._1_fuzzy_data_clean", "compiled": true, "compiled_code": "\n\n-- Data Cleaning\n\nSELECT\n  LOWER(REGEXP_REPLACE(lead_lastname, '[^a-zA-Z]', '')) AS fuzzy_match_lastname_key,\n  LOWER(REGEXP_REPLACE(lead_firstname, '[^a-zA-Z]', '')) AS fuzzy_match_firstname_key,\n  LOWER(REGEXP_REPLACE(lead_email, '[^a-zA-Z]', '')) AS fuzzy_match_email_key,\n  LOWER(REGEXP_REPLACE(lead_phone, '[^a-zA-Z]', '')) AS fuzzy_match_phone_key,\n  LOWER(REGEXP_REPLACE(lead_master_id, '[^a-zA-Z]', '')) AS fuzzy_match_key,\n  RANK() OVER (ORDER BY lead_email ASC, lead_phone ASC, lead_lastname ASC, lead_firstname ASC) AS seq_nbr\nFROM\n  \"integrity-db\".\"prod_dbt-intermediate\".\"lead_intermediate\"", "relation_name": "\"integrity-db\".\"prod_dbt-unification\".\"_1_fuzzy_data_clean\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-02T17:13:39.476387Z", "completed_at": "2025-01-02T17:13:39.491647Z"}, {"name": "execute", "started_at": "2025-01-02T17:13:39.491647Z", "completed_at": "2025-01-02T17:13:42.213724Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.808596611022949, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.integrity_energy_dbt._2_soundex", "compiled": true, "compiled_code": "\n\n--Soundex algortihm\n\nSELECT\n  fuzzy_match_key,\n  SOUNDEX(fuzzy_match_lastname_key) ||\n  SOUNDEX(fuzzy_match_firstname_key) ||\n  SOUNDEX(fuzzy_match_phone_key) ||\n  SOUNDEX(fuzzy_match_email_key) AS group_key,\n  seq_nbr\nFROM\n  \"integrity-db\".\"prod_dbt-unification\".\"_1_fuzzy_data_clean\"", "relation_name": "\"integrity-db\".\"prod_dbt-unification\".\"_2_soundex\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-02T17:13:42.290353Z", "completed_at": "2025-01-02T17:13:42.293960Z"}, {"name": "execute", "started_at": "2025-01-02T17:13:42.293960Z", "completed_at": "2025-01-02T17:13:44.354093Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.1293234825134277, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.integrity_energy_dbt._3_master_key", "compiled": true, "compiled_code": "\n\nSELECT\n    fuzzy_data.fuzzy_match_key,\n    fuzzy_data.group_key,\n    temp.fuzzy_match_key AS master_key,\n    fuzzy_data.seq_nbr AS seq_nbr\nFROM\n    (SELECT\n         fuzzy_match_key,\n         group_key\n     FROM\n        (SELECT\n          fuzzy_match_key,\n          group_key,\n          ROW_NUMBER() OVER (PARTITION BY group_key ORDER BY group_key DESC) AS rn\n         FROM\n          \"integrity-db\".\"prod_dbt-unification\".\"_2_soundex\") t1\n     WHERE\n         rn = 1) AS temp,\n         \"integrity-db\".\"prod_dbt-unification\".\"_2_soundex\" AS fuzzy_data\nWHERE\n    temp.group_key = fuzzy_data.group_key", "relation_name": "\"integrity-db\".\"prod_dbt-unification\".\"_3_master_key\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-02T17:13:44.437273Z", "completed_at": "2025-01-02T17:13:44.440692Z"}, {"name": "execute", "started_at": "2025-01-02T17:13:44.440692Z", "completed_at": "2025-01-02T17:13:46.905983Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.548111915588379, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.integrity_energy_dbt._4_levenshtein", "compiled": true, "compiled_code": "\n\n-- Levenshtein with Filtering\n\nSELECT\n    fuzzy_match_key,\n    master_key,\n    group_key,\n    CASE\n        WHEN fuzzy_match_key = master_key THEN 100\n        ELSE 100 - ABS(LENGTH(fuzzy_match_key) - LENGTH(master_key))\n    END AS levenshtein_ratio,\n    seq_nbr\nFROM\n    \"integrity-db\".\"prod_dbt-unification\".\"_3_master_key\"\nWHERE\n    CASE\n        WHEN fuzzy_match_key = master_key THEN 100\n        ELSE 100 - ABS(LENGTH(fuzzy_match_key) - LENGTH(master_key))\n    END >= 80.0", "relation_name": "\"integrity-db\".\"prod_dbt-unification\".\"_4_levenshtein\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-02T17:13:46.985385Z", "completed_at": "2025-01-02T17:13:46.985385Z"}, {"name": "execute", "started_at": "2025-01-02T17:13:46.985385Z", "completed_at": "2025-01-02T17:13:49.287560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3973984718322754, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.integrity_energy_dbt._5_match_store", "compiled": true, "compiled_code": "\n\n--Match Store\n\nSELECT\n  group_key,\n  LISTAGG(seq_nbr, ',') WITHIN GROUP (ORDER BY seq_nbr) AS groups\nFROM\n  \"integrity-db\".\"prod_dbt-unification\".\"_4_levenshtein\"\nGROUP BY\n  group_key", "relation_name": "\"integrity-db\".\"prod_dbt-unification\".\"_5_match_store\"", "batch_results": null}], "elapsed_time": 22.457143545150757, "args": {"send_anonymous_usage_stats": true, "require_resource_names_without_spaces": false, "use_colors_file": true, "quiet": false, "vars": {}, "partial_parse": true, "printer_width": 80, "macro_debugging": false, "state_modified_compare_vars": false, "static_parser": true, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": false, "log_format_file": "debug", "use_colors": true, "empty": false, "profiles_dir": "C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt", "select": ["tag:unification"], "log_level_file": "debug", "log_file_max_bytes": 10485760, "which": "run", "indirect_selection": "eager", "cache_selected_only": false, "show_resource_report": false, "log_path": "C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt\\logs", "state_modified_compare_more_unrendered_values": false, "log_format": "default", "favor_state": false, "version_check": true, "populate_cache": true, "defer": false, "introspect": true, "partial_parse_file_diff": true, "project_dir": "C:\\Users\\2ewol\\Documents\\Clients\\Integrity_Energy\\integrity-energy-dbt", "invocation_command": "dbt run --select tag:unification", "warn_error_options": {"include": [], "exclude": []}, "print": true, "log_level": "info", "strict_mode": false, "exclude": []}}